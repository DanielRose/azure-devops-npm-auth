/* eslint-disable */
//prettier-ignore
module.exports = {
name: "@yarnpkg/plugin-azure-devops-auth",
factory: function (require) {
var plugin=(()=>{var WC=Object.create;var Cs=Object.defineProperty;var HC=Object.getOwnPropertyDescriptor;var FC=Object.getOwnPropertyNames;var GC=Object.getPrototypeOf,zC=Object.prototype.hasOwnProperty;var g=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});var h=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),YC=(e,t)=>{for(var r in t)Cs(e,r,{get:t[r],enumerable:!0})},Ty=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of FC(t))!zC.call(e,i)&&i!==r&&Cs(e,i,{get:()=>t[i],enumerable:!(n=HC(t,i))||n.enumerable});return e};var Ge=(e,t,r)=>(r=e!=null?WC(GC(e)):{},Ty(t||!e||!e.__esModule?Cs(r,"default",{value:e,enumerable:!0}):r,e)),VC=e=>Ty(Cs({},"__esModule",{value:!0}),e);var qy=h((Sz,Ay)=>{"use strict";Ay.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}});var ja=h((xz,ky)=>{var Qn=qy(),Oy={};for(let e of Object.keys(Qn))Oy[Qn[e]]=e;var A={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};ky.exports=A;for(let e of Object.keys(A)){if(!("channels"in A[e]))throw new Error("missing channels property: "+e);if(!("labels"in A[e]))throw new Error("missing channel labels property: "+e);if(A[e].labels.length!==A[e].channels)throw new Error("channel and label counts mismatch: "+e);let{channels:t,labels:r}=A[e];delete A[e].channels,delete A[e].labels,Object.defineProperty(A[e],"channels",{value:t}),Object.defineProperty(A[e],"labels",{value:r})}A.rgb.hsl=function(e){let t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.min(t,r,n),s=Math.max(t,r,n),o=s-i,c,a;s===i?c=0:t===s?c=(r-n)/o:r===s?c=2+(n-t)/o:n===s&&(c=4+(t-r)/o),c=Math.min(c*60,360),c<0&&(c+=360);let l=(i+s)/2;return s===i?a=0:l<=.5?a=o/(s+i):a=o/(2-s-i),[c,a*100,l*100]};A.rgb.hsv=function(e){let t,r,n,i,s,o=e[0]/255,c=e[1]/255,a=e[2]/255,l=Math.max(o,c,a),f=l-Math.min(o,c,a),u=function(d){return(l-d)/6/f+1/2};return f===0?(i=0,s=0):(s=f/l,t=u(o),r=u(c),n=u(a),o===l?i=n-r:c===l?i=1/3+t-n:a===l&&(i=2/3+r-t),i<0?i+=1:i>1&&(i-=1)),[i*360,s*100,l*100]};A.rgb.hwb=function(e){let t=e[0],r=e[1],n=e[2],i=A.rgb.hsl(e)[0],s=1/255*Math.min(t,Math.min(r,n));return n=1-1/255*Math.max(t,Math.max(r,n)),[i,s*100,n*100]};A.rgb.cmyk=function(e){let t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.min(1-t,1-r,1-n),s=(1-t-i)/(1-i)||0,o=(1-r-i)/(1-i)||0,c=(1-n-i)/(1-i)||0;return[s*100,o*100,c*100,i*100]};function XC(e,t){return(e[0]-t[0])**2+(e[1]-t[1])**2+(e[2]-t[2])**2}A.rgb.keyword=function(e){let t=Oy[e];if(t)return t;let r=1/0,n;for(let i of Object.keys(Qn)){let s=Qn[i],o=XC(e,s);o<r&&(r=o,n=i)}return n};A.keyword.rgb=function(e){return Qn[e]};A.rgb.xyz=function(e){let t=e[0]/255,r=e[1]/255,n=e[2]/255;t=t>.04045?((t+.055)/1.055)**2.4:t/12.92,r=r>.04045?((r+.055)/1.055)**2.4:r/12.92,n=n>.04045?((n+.055)/1.055)**2.4:n/12.92;let i=t*.4124+r*.3576+n*.1805,s=t*.2126+r*.7152+n*.0722,o=t*.0193+r*.1192+n*.9505;return[i*100,s*100,o*100]};A.rgb.lab=function(e){let t=A.rgb.xyz(e),r=t[0],n=t[1],i=t[2];r/=95.047,n/=100,i/=108.883,r=r>.008856?r**(1/3):7.787*r+16/116,n=n>.008856?n**(1/3):7.787*n+16/116,i=i>.008856?i**(1/3):7.787*i+16/116;let s=116*n-16,o=500*(r-n),c=200*(n-i);return[s,o,c]};A.hsl.rgb=function(e){let t=e[0]/360,r=e[1]/100,n=e[2]/100,i,s,o;if(r===0)return o=n*255,[o,o,o];n<.5?i=n*(1+r):i=n+r-n*r;let c=2*n-i,a=[0,0,0];for(let l=0;l<3;l++)s=t+1/3*-(l-1),s<0&&s++,s>1&&s--,6*s<1?o=c+(i-c)*6*s:2*s<1?o=i:3*s<2?o=c+(i-c)*(2/3-s)*6:o=c,a[l]=o*255;return a};A.hsl.hsv=function(e){let t=e[0],r=e[1]/100,n=e[2]/100,i=r,s=Math.max(n,.01);n*=2,r*=n<=1?n:2-n,i*=s<=1?s:2-s;let o=(n+r)/2,c=n===0?2*i/(s+i):2*r/(n+r);return[t,c*100,o*100]};A.hsv.rgb=function(e){let t=e[0]/60,r=e[1]/100,n=e[2]/100,i=Math.floor(t)%6,s=t-Math.floor(t),o=255*n*(1-r),c=255*n*(1-r*s),a=255*n*(1-r*(1-s));switch(n*=255,i){case 0:return[n,a,o];case 1:return[c,n,o];case 2:return[o,n,a];case 3:return[o,c,n];case 4:return[a,o,n];case 5:return[n,o,c]}};A.hsv.hsl=function(e){let t=e[0],r=e[1]/100,n=e[2]/100,i=Math.max(n,.01),s,o;o=(2-r)*n;let c=(2-r)*i;return s=r*i,s/=c<=1?c:2-c,s=s||0,o/=2,[t,s*100,o*100]};A.hwb.rgb=function(e){let t=e[0]/360,r=e[1]/100,n=e[2]/100,i=r+n,s;i>1&&(r/=i,n/=i);let o=Math.floor(6*t),c=1-n;s=6*t-o,(o&1)!==0&&(s=1-s);let a=r+s*(c-r),l,f,u;switch(o){default:case 6:case 0:l=c,f=a,u=r;break;case 1:l=a,f=c,u=r;break;case 2:l=r,f=c,u=a;break;case 3:l=r,f=a,u=c;break;case 4:l=a,f=r,u=c;break;case 5:l=c,f=r,u=a;break}return[l*255,f*255,u*255]};A.cmyk.rgb=function(e){let t=e[0]/100,r=e[1]/100,n=e[2]/100,i=e[3]/100,s=1-Math.min(1,t*(1-i)+i),o=1-Math.min(1,r*(1-i)+i),c=1-Math.min(1,n*(1-i)+i);return[s*255,o*255,c*255]};A.xyz.rgb=function(e){let t=e[0]/100,r=e[1]/100,n=e[2]/100,i,s,o;return i=t*3.2406+r*-1.5372+n*-.4986,s=t*-.9689+r*1.8758+n*.0415,o=t*.0557+r*-.204+n*1.057,i=i>.0031308?1.055*i**(1/2.4)-.055:i*12.92,s=s>.0031308?1.055*s**(1/2.4)-.055:s*12.92,o=o>.0031308?1.055*o**(1/2.4)-.055:o*12.92,i=Math.min(Math.max(0,i),1),s=Math.min(Math.max(0,s),1),o=Math.min(Math.max(0,o),1),[i*255,s*255,o*255]};A.xyz.lab=function(e){let t=e[0],r=e[1],n=e[2];t/=95.047,r/=100,n/=108.883,t=t>.008856?t**(1/3):7.787*t+16/116,r=r>.008856?r**(1/3):7.787*r+16/116,n=n>.008856?n**(1/3):7.787*n+16/116;let i=116*r-16,s=500*(t-r),o=200*(r-n);return[i,s,o]};A.lab.xyz=function(e){let t=e[0],r=e[1],n=e[2],i,s,o;s=(t+16)/116,i=r/500+s,o=s-n/200;let c=s**3,a=i**3,l=o**3;return s=c>.008856?c:(s-16/116)/7.787,i=a>.008856?a:(i-16/116)/7.787,o=l>.008856?l:(o-16/116)/7.787,i*=95.047,s*=100,o*=108.883,[i,s,o]};A.lab.lch=function(e){let t=e[0],r=e[1],n=e[2],i;i=Math.atan2(n,r)*360/2/Math.PI,i<0&&(i+=360);let o=Math.sqrt(r*r+n*n);return[t,o,i]};A.lch.lab=function(e){let t=e[0],r=e[1],i=e[2]/360*2*Math.PI,s=r*Math.cos(i),o=r*Math.sin(i);return[t,s,o]};A.rgb.ansi16=function(e,t=null){let[r,n,i]=e,s=t===null?A.rgb.hsv(e)[2]:t;if(s=Math.round(s/50),s===0)return 30;let o=30+(Math.round(i/255)<<2|Math.round(n/255)<<1|Math.round(r/255));return s===2&&(o+=60),o};A.hsv.ansi16=function(e){return A.rgb.ansi16(A.hsv.rgb(e),e[2])};A.rgb.ansi256=function(e){let t=e[0],r=e[1],n=e[2];return t===r&&r===n?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(r/255*5)+Math.round(n/255*5)};A.ansi16.rgb=function(e){let t=e%10;if(t===0||t===7)return e>50&&(t+=3.5),t=t/10.5*255,[t,t,t];let r=(~~(e>50)+1)*.5,n=(t&1)*r*255,i=(t>>1&1)*r*255,s=(t>>2&1)*r*255;return[n,i,s]};A.ansi256.rgb=function(e){if(e>=232){let s=(e-232)*10+8;return[s,s,s]}e-=16;let t,r=Math.floor(e/36)/5*255,n=Math.floor((t=e%36)/6)/5*255,i=t%6/5*255;return[r,n,i]};A.rgb.hex=function(e){let r=(((Math.round(e[0])&255)<<16)+((Math.round(e[1])&255)<<8)+(Math.round(e[2])&255)).toString(16).toUpperCase();return"000000".substring(r.length)+r};A.hex.rgb=function(e){let t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];let r=t[0];t[0].length===3&&(r=r.split("").map(c=>c+c).join(""));let n=parseInt(r,16),i=n>>16&255,s=n>>8&255,o=n&255;return[i,s,o]};A.rgb.hcg=function(e){let t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(Math.max(t,r),n),s=Math.min(Math.min(t,r),n),o=i-s,c,a;return o<1?c=s/(1-o):c=0,o<=0?a=0:i===t?a=(r-n)/o%6:i===r?a=2+(n-t)/o:a=4+(t-r)/o,a/=6,a%=1,[a*360,o*100,c*100]};A.hsl.hcg=function(e){let t=e[1]/100,r=e[2]/100,n=r<.5?2*t*r:2*t*(1-r),i=0;return n<1&&(i=(r-.5*n)/(1-n)),[e[0],n*100,i*100]};A.hsv.hcg=function(e){let t=e[1]/100,r=e[2]/100,n=t*r,i=0;return n<1&&(i=(r-n)/(1-n)),[e[0],n*100,i*100]};A.hcg.rgb=function(e){let t=e[0]/360,r=e[1]/100,n=e[2]/100;if(r===0)return[n*255,n*255,n*255];let i=[0,0,0],s=t%1*6,o=s%1,c=1-o,a=0;switch(Math.floor(s)){case 0:i[0]=1,i[1]=o,i[2]=0;break;case 1:i[0]=c,i[1]=1,i[2]=0;break;case 2:i[0]=0,i[1]=1,i[2]=o;break;case 3:i[0]=0,i[1]=c,i[2]=1;break;case 4:i[0]=o,i[1]=0,i[2]=1;break;default:i[0]=1,i[1]=0,i[2]=c}return a=(1-r)*n,[(r*i[0]+a)*255,(r*i[1]+a)*255,(r*i[2]+a)*255]};A.hcg.hsv=function(e){let t=e[1]/100,r=e[2]/100,n=t+r*(1-t),i=0;return n>0&&(i=t/n),[e[0],i*100,n*100]};A.hcg.hsl=function(e){let t=e[1]/100,n=e[2]/100*(1-t)+.5*t,i=0;return n>0&&n<.5?i=t/(2*n):n>=.5&&n<1&&(i=t/(2*(1-n))),[e[0],i*100,n*100]};A.hcg.hwb=function(e){let t=e[1]/100,r=e[2]/100,n=t+r*(1-t);return[e[0],(n-t)*100,(1-n)*100]};A.hwb.hcg=function(e){let t=e[1]/100,n=1-e[2]/100,i=n-t,s=0;return i<1&&(s=(n-i)/(1-i)),[e[0],i*100,s*100]};A.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]};A.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]};A.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]};A.gray.hsl=function(e){return[0,0,e[0]]};A.gray.hsv=A.gray.hsl;A.gray.hwb=function(e){return[0,100,e[0]]};A.gray.cmyk=function(e){return[0,0,0,e[0]]};A.gray.lab=function(e){return[e[0],0,0]};A.gray.hex=function(e){let t=Math.round(e[0]/100*255)&255,n=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(n.length)+n};A.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]}});var Py=h((Tz,Cy)=>{var Ps=ja();function QC(){let e={},t=Object.keys(Ps);for(let r=t.length,n=0;n<r;n++)e[t[n]]={distance:-1,parent:null};return e}function ZC(e){let t=QC(),r=[e];for(t[e].distance=0;r.length;){let n=r.pop(),i=Object.keys(Ps[n]);for(let s=i.length,o=0;o<s;o++){let c=i[o],a=t[c];a.distance===-1&&(a.distance=t[n].distance+1,a.parent=n,r.unshift(c))}}return t}function eP(e,t){return function(r){return t(e(r))}}function tP(e,t){let r=[t[e].parent,e],n=Ps[t[e].parent][e],i=t[e].parent;for(;t[i].parent;)r.unshift(t[i].parent),n=eP(Ps[t[i].parent][i],n),i=t[i].parent;return n.conversion=r,n}Cy.exports=function(e){let t=ZC(e),r={},n=Object.keys(t);for(let i=n.length,s=0;s<i;s++){let o=n[s];t[o].parent!==null&&(r[o]=tP(o,t))}return r}});var Ky=h((Az,Ry)=>{var Ma=ja(),rP=Py(),en={},nP=Object.keys(Ma);function iP(e){let t=function(...r){let n=r[0];return n==null?n:(n.length>1&&(r=n),e(r))};return"conversion"in e&&(t.conversion=e.conversion),t}function sP(e){let t=function(...r){let n=r[0];if(n==null)return n;n.length>1&&(r=n);let i=e(r);if(typeof i=="object")for(let s=i.length,o=0;o<s;o++)i[o]=Math.round(i[o]);return i};return"conversion"in e&&(t.conversion=e.conversion),t}nP.forEach(e=>{en[e]={},Object.defineProperty(en[e],"channels",{value:Ma[e].channels}),Object.defineProperty(en[e],"labels",{value:Ma[e].labels});let t=rP(e);Object.keys(t).forEach(n=>{let i=t[n];en[e][n]=sP(i),en[e][n].raw=iP(i)})});Ry.exports=en});var Dy=h((qz,My)=>{"use strict";var Iy=(e,t)=>(...r)=>`\x1B[${e(...r)+t}m`,By=(e,t)=>(...r)=>{let n=e(...r);return`\x1B[${38+t};5;${n}m`},Ny=(e,t)=>(...r)=>{let n=e(...r);return`\x1B[${38+t};2;${n[0]};${n[1]};${n[2]}m`},Rs=e=>e,jy=(e,t,r)=>[e,t,r],tn=(e,t,r)=>{Object.defineProperty(e,t,{get:()=>{let n=r();return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0}),n},enumerable:!0,configurable:!0})},Da,rn=(e,t,r,n)=>{Da===void 0&&(Da=Ky());let i=n?10:0,s={};for(let[o,c]of Object.entries(Da)){let a=o==="ansi16"?"ansi":o;o===t?s[a]=e(r,i):typeof c=="object"&&(s[a]=e(c[t],i))}return s};function oP(){let e=new Map,t={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};t.color.gray=t.color.blackBright,t.bgColor.bgGray=t.bgColor.bgBlackBright,t.color.grey=t.color.blackBright,t.bgColor.bgGrey=t.bgColor.bgBlackBright;for(let[r,n]of Object.entries(t)){for(let[i,s]of Object.entries(n))t[i]={open:`\x1B[${s[0]}m`,close:`\x1B[${s[1]}m`},n[i]=t[i],e.set(s[0],s[1]);Object.defineProperty(t,r,{value:n,enumerable:!1})}return Object.defineProperty(t,"codes",{value:e,enumerable:!1}),t.color.close="\x1B[39m",t.bgColor.close="\x1B[49m",tn(t.color,"ansi",()=>rn(Iy,"ansi16",Rs,!1)),tn(t.color,"ansi256",()=>rn(By,"ansi256",Rs,!1)),tn(t.color,"ansi16m",()=>rn(Ny,"rgb",jy,!1)),tn(t.bgColor,"ansi",()=>rn(Iy,"ansi16",Rs,!0)),tn(t.bgColor,"ansi256",()=>rn(By,"ansi256",Rs,!0)),tn(t.bgColor,"ansi16m",()=>rn(Ny,"rgb",jy,!0)),t}Object.defineProperty(My,"exports",{enumerable:!0,get:oP})});var Ly=h((Oz,Jy)=>{"use strict";Jy.exports=(e,t=process.argv)=>{let r=e.startsWith("-")?"":e.length===1?"-":"--",n=t.indexOf(r+e),i=t.indexOf("--");return n!==-1&&(i===-1||n<i)}});var Wy=h((kz,Uy)=>{"use strict";var cP=g("os"),$y=g("tty"),Me=Ly(),{env:re}=process,Yt;Me("no-color")||Me("no-colors")||Me("color=false")||Me("color=never")?Yt=0:(Me("color")||Me("colors")||Me("color=true")||Me("color=always"))&&(Yt=1);"FORCE_COLOR"in re&&(re.FORCE_COLOR==="true"?Yt=1:re.FORCE_COLOR==="false"?Yt=0:Yt=re.FORCE_COLOR.length===0?1:Math.min(parseInt(re.FORCE_COLOR,10),3));function Ja(e){return e===0?!1:{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}function La(e,t){if(Yt===0)return 0;if(Me("color=16m")||Me("color=full")||Me("color=truecolor"))return 3;if(Me("color=256"))return 2;if(e&&!t&&Yt===void 0)return 0;let r=Yt||0;if(re.TERM==="dumb")return r;if(process.platform==="win32"){let n=cP.release().split(".");return Number(n[0])>=10&&Number(n[2])>=10586?Number(n[2])>=14931?3:2:1}if("CI"in re)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(n=>n in re)||re.CI_NAME==="codeship"?1:r;if("TEAMCITY_VERSION"in re)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(re.TEAMCITY_VERSION)?1:0;if(re.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in re){let n=parseInt((re.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(re.TERM_PROGRAM){case"iTerm.app":return n>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(re.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(re.TERM)||"COLORTERM"in re?1:r}function aP(e){let t=La(e,e&&e.isTTY);return Ja(t)}Uy.exports={supportsColor:aP,stdout:Ja(La(!0,$y.isatty(1))),stderr:Ja(La(!0,$y.isatty(2)))}});var Fy=h((Cz,Hy)=>{"use strict";var uP=(e,t,r)=>{let n=e.indexOf(t);if(n===-1)return e;let i=t.length,s=0,o="";do o+=e.substr(s,n-s)+t+r,s=n+i,n=e.indexOf(t,s);while(n!==-1);return o+=e.substr(s),o},lP=(e,t,r,n)=>{let i=0,s="";do{let o=e[n-1]==="\r";s+=e.substr(i,(o?n-1:n)-i)+t+(o?`\r
`:`
`)+r,i=n+1,n=e.indexOf(`
`,i)}while(n!==-1);return s+=e.substr(i),s};Hy.exports={stringReplaceAll:uP,stringEncaseCRLFWithFirstIndex:lP}});var Xy=h((Pz,Vy)=>{"use strict";var fP=/(?:\\(u(?:[a-f\d]{4}|\{[a-f\d]{1,6}\})|x[a-f\d]{2}|.))|(?:\{(~)?(\w+(?:\([^)]*\))?(?:\.\w+(?:\([^)]*\))?)*)(?:[ \t]|(?=\r?\n)))|(\})|((?:.|[\r\n\f])+?)/gi,Gy=/(?:^|\.)(\w+)(?:\(([^)]*)\))?/g,dP=/^(['"])((?:\\.|(?!\1)[^\\])*)\1$/,hP=/\\(u(?:[a-f\d]{4}|\{[a-f\d]{1,6}\})|x[a-f\d]{2}|.)|([^\\])/gi,pP=new Map([["n",`
`],["r","\r"],["t","	"],["b","\b"],["f","\f"],["v","\v"],["0","\0"],["\\","\\"],["e","\x1B"],["a","\x07"]]);function Yy(e){let t=e[0]==="u",r=e[1]==="{";return t&&!r&&e.length===5||e[0]==="x"&&e.length===3?String.fromCharCode(parseInt(e.slice(1),16)):t&&r?String.fromCodePoint(parseInt(e.slice(2,-1),16)):pP.get(e)||e}function yP(e,t){let r=[],n=t.trim().split(/\s*,\s*/g),i;for(let s of n){let o=Number(s);if(!Number.isNaN(o))r.push(o);else if(i=s.match(dP))r.push(i[2].replace(hP,(c,a,l)=>a?Yy(a):l));else throw new Error(`Invalid Chalk template style argument: ${s} (in style '${e}')`)}return r}function mP(e){Gy.lastIndex=0;let t=[],r;for(;(r=Gy.exec(e))!==null;){let n=r[1];if(r[2]){let i=yP(n,r[2]);t.push([n].concat(i))}else t.push([n])}return t}function zy(e,t){let r={};for(let i of t)for(let s of i.styles)r[s[0]]=i.inverse?null:s.slice(1);let n=e;for(let[i,s]of Object.entries(r))if(!!Array.isArray(s)){if(!(i in n))throw new Error(`Unknown Chalk style: ${i}`);n=s.length>0?n[i](...s):n[i]}return n}Vy.exports=(e,t)=>{let r=[],n=[],i=[];if(t.replace(fP,(s,o,c,a,l,f)=>{if(o)i.push(Yy(o));else if(a){let u=i.join("");i=[],n.push(r.length===0?u:zy(e,r)(u)),r.push({inverse:c,styles:mP(a)})}else if(l){if(r.length===0)throw new Error("Found extraneous } in Chalk template literal");n.push(zy(e,r)(i.join(""))),i=[],r.pop()}else i.push(f)}),n.push(i.join("")),r.length>0){let s=`Chalk template literal is missing ${r.length} closing bracket${r.length===1?"":"s"} (\`}\`)`;throw new Error(s)}return n.join("")}});var rm=h((Rz,tm)=>{"use strict";var Zn=Dy(),{stdout:Ua,stderr:Wa}=Wy(),{stringReplaceAll:gP,stringEncaseCRLFWithFirstIndex:_P}=Fy(),Qy=["ansi","ansi","ansi256","ansi16m"],nn=Object.create(null),wP=(e,t={})=>{if(t.level>3||t.level<0)throw new Error("The `level` option should be an integer from 0 to 3");let r=Ua?Ua.level:0;e.level=t.level===void 0?r:t.level},Ha=class{constructor(t){return Zy(t)}},Zy=e=>{let t={};return wP(t,e),t.template=(...r)=>vP(t.template,...r),Object.setPrototypeOf(t,Ks.prototype),Object.setPrototypeOf(t.template,t),t.template.constructor=()=>{throw new Error("`chalk.constructor()` is deprecated. Use `new chalk.Instance()` instead.")},t.template.Instance=Ha,t.template};function Ks(e){return Zy(e)}for(let[e,t]of Object.entries(Zn))nn[e]={get(){let r=Is(this,Fa(t.open,t.close,this._styler),this._isEmpty);return Object.defineProperty(this,e,{value:r}),r}};nn.visible={get(){let e=Is(this,this._styler,!0);return Object.defineProperty(this,"visible",{value:e}),e}};var em=["rgb","hex","keyword","hsl","hsv","hwb","ansi","ansi256"];for(let e of em)nn[e]={get(){let{level:t}=this;return function(...r){let n=Fa(Zn.color[Qy[t]][e](...r),Zn.color.close,this._styler);return Is(this,n,this._isEmpty)}}};for(let e of em){let t="bg"+e[0].toUpperCase()+e.slice(1);nn[t]={get(){let{level:r}=this;return function(...n){let i=Fa(Zn.bgColor[Qy[r]][e](...n),Zn.bgColor.close,this._styler);return Is(this,i,this._isEmpty)}}}}var bP=Object.defineProperties(()=>{},{...nn,level:{enumerable:!0,get(){return this._generator.level},set(e){this._generator.level=e}}}),Fa=(e,t,r)=>{let n,i;return r===void 0?(n=e,i=t):(n=r.openAll+e,i=t+r.closeAll),{open:e,close:t,openAll:n,closeAll:i,parent:r}},Is=(e,t,r)=>{let n=(...i)=>EP(n,i.length===1?""+i[0]:i.join(" "));return n.__proto__=bP,n._generator=e,n._styler=t,n._isEmpty=r,n},EP=(e,t)=>{if(e.level<=0||!t)return e._isEmpty?"":t;let r=e._styler;if(r===void 0)return t;let{openAll:n,closeAll:i}=r;if(t.indexOf("\x1B")!==-1)for(;r!==void 0;)t=gP(t,r.close,r.open),r=r.parent;let s=t.indexOf(`
`);return s!==-1&&(t=_P(t,i,n,s)),n+t+i},$a,vP=(e,...t)=>{let[r]=t;if(!Array.isArray(r))return t.join(" ");let n=t.slice(1),i=[r.raw[0]];for(let s=1;s<r.length;s++)i.push(String(n[s-1]).replace(/[{}\\]/g,"\\$&"),String(r.raw[s]));return $a===void 0&&($a=Xy()),$a(e,i.join(""))};Object.defineProperties(Ks.prototype,nn);var ei=Ks();ei.supportsColor=Ua;ei.stderr=Ks({level:Wa?Wa.level:0});ei.stderr.supportsColor=Wa;ei.Level={None:0,Basic:1,Ansi256:2,TrueColor:3,0:"None",1:"Basic",2:"Ansi256",3:"TrueColor"};tm.exports=ei});var X=h((Kz,ze)=>{ze.exports.KEYOBJECT=Symbol("KEYOBJECT");ze.exports.PRIVATE_MEMBERS=Symbol("PRIVATE_MEMBERS");ze.exports.PUBLIC_MEMBERS=Symbol("PUBLIC_MEMBERS");ze.exports.THUMBPRINT_MATERIAL=Symbol("THUMBPRINT_MATERIAL");ze.exports.JWK_MEMBERS=Symbol("JWK_MEMBERS");ze.exports.KEY_MANAGEMENT_ENCRYPT=Symbol("KEY_MANAGEMENT_ENCRYPT");ze.exports.KEY_MANAGEMENT_DECRYPT=Symbol("KEY_MANAGEMENT_DECRYPT");var Bs={sig:new Set(["sign","verify"]),enc:new Set(["encrypt","decrypt","wrapKey","unwrapKey","deriveKey"])},SP=new Set([...Bs.sig,...Bs.enc]),xP=new Set(Object.keys(Bs));ze.exports.USES_MAPPING=Bs;ze.exports.OPS=SP;ze.exports.USES=xP});var gr=h((Iz,Ga)=>{var{deprecate:TP}=g("util"),AP=TP(()=>{},'"P-256K" EC curve name is deprecated');Ga.exports={name:"secp256k1",rename(e){e!=="secp256k1"&&AP(),Ga.exports.name=e}}});var im=h((Bz,nm)=>{var{getCurves:Ns}=g("crypto"),{name:qP}=gr(),ti=new Set;Ns().includes("prime256v1")&&ti.add("P-256");Ns().includes("secp256k1")&&ti.add(qP);Ns().includes("secp384r1")&&ti.add("P-384");Ns().includes("secp521r1")&&ti.add("P-521");nm.exports=ti});var om=h((Nz,sm)=>{sm.exports=new Map([["A128CBC-HS256",128],["A128GCM",96],["A128GCMKW",96],["A192CBC-HS384",128],["A192GCM",96],["A192GCMKW",96],["A256CBC-HS512",128],["A256GCM",96],["A256GCMKW",96]])});var am=h((jz,cm)=>{cm.exports={sign:new Map,verify:new Map,keyManagementEncrypt:new Map,keyManagementDecrypt:new Map,encrypt:new Map,decrypt:new Map}});var lm=h((Mz,um)=>{um.exports={oct:{decrypt:{},deriveKey:{},encrypt:{},sign:{},unwrapKey:{},verify:{},wrapKey:{}},EC:{decrypt:{},deriveKey:{},encrypt:{},sign:{},unwrapKey:{},verify:{},wrapKey:{}},RSA:{decrypt:{},deriveKey:{},encrypt:{},sign:{},unwrapKey:{},verify:{},wrapKey:{}},OKP:{decrypt:{},deriveKey:{},encrypt:{},sign:{},unwrapKey:{},verify:{},wrapKey:{}}}});var dm=h((Dz,fm)=>{fm.exports=new Map([["A128CBC-HS256",256],["A128GCM",128],["A192CBC-HS384",384],["A192GCM",192],["A256CBC-HS512",512],["A256GCM",256]])});var pm=h((Jz,hm)=>{var js=new Set(["Ed25519"]);"electron"in process.versions||(js.add("Ed448"),js.add("X25519"),js.add("X448"));hm.exports=js});var mm=h((Lz,ym)=>{ym.exports=new Map});var _t=h(($z,gm)=>{var OP=im(),kP=om(),CP=am(),PP=lm(),RP=dm(),KP=pm(),IP=mm();gm.exports={EC_CURVES:OP,ECDH_DERIVE_LENGTHS:IP,IVLENGTHS:kP,JWA:CP,JWK:PP,KEYLENGTHS:RP,OKP_CURVES:KP}});var za=h((Uz,_m)=>{var{randomBytes:BP}=g("crypto"),{IVLENGTHS:NP}=_t();_m.exports=e=>BP(NP.get(e)/8)});var we=h((Wz,_r)=>{var wm=e=>e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"),bm=(e,t="utf8")=>wm(Buffer.from(e,t).toString("base64")),Em=e=>wm(e.toString("base64")),vm=e=>Buffer.from(e,"base64"),Va=(e,t="utf8")=>vm(e).toString(t),Ya={encode:e=>bm(JSON.stringify(e)),decode:(e,t="utf8")=>JSON.parse(Va(e,t))};Ya.decode.try=(e,t="utf8")=>{try{return Ya.decode(e,t)}catch{return Va(e,t)}};var jP=e=>{let t=BigInt(e).toString(16);t.length%2&&(t=`0${t}`);let r=t.length/2,n=new Uint8Array(r),i=0,s=0;for(;i<r;)n[i]=parseInt(t.slice(s,s+2),16),i+=1,s+=2;return n},MP=e=>Em(Buffer.from(jP(e)));_r.exports.decode=Va;_r.exports.decodeToBuffer=vm;_r.exports.encode=bm;_r.exports.encodeBuffer=Em;_r.exports.JSON=Ya;_r.exports.encodeBigInt=MP});var L=h((s9,ie)=>{var DP={JOSEAlgNotWhitelisted:"ERR_JOSE_ALG_NOT_WHITELISTED",JOSECritNotUnderstood:"ERR_JOSE_CRIT_NOT_UNDERSTOOD",JOSEInvalidEncoding:"ERR_JOSE_INVALID_ENCODING",JOSEMultiError:"ERR_JOSE_MULTIPLE_ERRORS",JOSENotSupported:"ERR_JOSE_NOT_SUPPORTED",JWEDecryptionFailed:"ERR_JWE_DECRYPTION_FAILED",JWEInvalid:"ERR_JWE_INVALID",JWKImportFailed:"ERR_JWK_IMPORT_FAILED",JWKInvalid:"ERR_JWK_INVALID",JWKKeySupport:"ERR_JWK_KEY_SUPPORT",JWKSNoMatchingKey:"ERR_JWKS_NO_MATCHING_KEY",JWSInvalid:"ERR_JWS_INVALID",JWSVerificationFailed:"ERR_JWS_VERIFICATION_FAILED",JWTClaimInvalid:"ERR_JWT_CLAIM_INVALID",JWTExpired:"ERR_JWT_EXPIRED",JWTMalformed:"ERR_JWT_MALFORMED"},JP={JWEDecryptionFailed:"decryption operation failed",JWEInvalid:"JWE invalid",JWKSNoMatchingKey:"no matching key found in the KeyStore",JWSInvalid:"JWS invalid",JWSVerificationFailed:"signature verification failed"},ne=class extends Error{constructor(t){super(t),t===void 0&&(this.message=JP[this.constructor.name]),this.name=this.constructor.name,this.code=DP[this.constructor.name],Error.captureStackTrace(this,this.constructor)}},LP=e=>e instanceof Ms,Ms=class extends ne{constructor(t){super();let r;for(;(r=t.findIndex(LP))&&r!==-1;)t.splice(r,1,...t[r]);Object.defineProperty(this,"errors",{value:t})}*[Symbol.iterator](){for(let t of this.errors)yield t}};ie.exports.JOSEError=ne;ie.exports.JOSEAlgNotWhitelisted=class extends ne{};ie.exports.JOSECritNotUnderstood=class extends ne{};ie.exports.JOSEInvalidEncoding=class extends ne{};ie.exports.JOSEMultiError=Ms;ie.exports.JOSENotSupported=class extends ne{};ie.exports.JWEDecryptionFailed=class extends ne{};ie.exports.JWEInvalid=class extends ne{};ie.exports.JWKImportFailed=class extends ne{};ie.exports.JWKInvalid=class extends ne{};ie.exports.JWKKeySupport=class extends ne{};ie.exports.JWKSNoMatchingKey=class extends ne{};ie.exports.JWSInvalid=class extends ne{};ie.exports.JWSVerificationFailed=class extends ne{};var Ds=class extends ne{constructor(t,r="unspecified",n="unspecified"){super(t),this.claim=r,this.reason=n}};ie.exports.JWTClaimInvalid=Ds;ie.exports.JWTExpired=class extends Ds{};ie.exports.JWTMalformed=class extends ne{}});var Pe=h((o9,Sm)=>{var{diffieHellman:$P,KeyObject:UP,sign:WP,verify:HP}=g("crypto"),[sn,Xa]=process.version.substr(1).split(".").map(e=>parseInt(e,10));Sm.exports={oaepHashSupported:sn>12||sn===12&&Xa>=9,keyObjectSupported:!!UP&&sn>=12,edDSASupported:!!WP&&!!HP,dsaEncodingSupported:sn>13||sn===13&&Xa>=2||sn===12&&Xa>=16,improvedDH:!!$P}});var De=h((c9,xm)=>{xm.exports=e=>!!e&&e.constructor===Object});var Js=h(Tm=>{var{inherits:FP}=g("util");function Je(e){this._reporterState={obj:null,path:[],options:e||{},errors:[]}}Je.prototype.isError=function(t){return t instanceof on};Je.prototype.save=function(){let t=this._reporterState;return{obj:t.obj,pathLen:t.path.length}};Je.prototype.restore=function(t){let r=this._reporterState;r.obj=t.obj,r.path=r.path.slice(0,t.pathLen)};Je.prototype.enterKey=function(t){return this._reporterState.path.push(t)};Je.prototype.exitKey=function(t){let r=this._reporterState;r.path=r.path.slice(0,t-1)};Je.prototype.leaveKey=function(t,r,n){let i=this._reporterState;this.exitKey(t),i.obj!==null&&(i.obj[r]=n)};Je.prototype.path=function(){return this._reporterState.path.join("/")};Je.prototype.enterObject=function(){let t=this._reporterState,r=t.obj;return t.obj={},r};Je.prototype.leaveObject=function(t){let r=this._reporterState,n=r.obj;return r.obj=t,n};Je.prototype.error=function(t){let r,n=this._reporterState,i=t instanceof on;if(i?r=t:r=new on(n.path.map(function(s){return`[${JSON.stringify(s)}]`}).join(""),t.message||t,t.stack),!n.options.partial)throw r;return i||n.errors.push(r),r};Je.prototype.wrapResult=function(t){let r=this._reporterState;return r.options.partial?{result:this.isError(t)?null:t,errors:r.errors}:t};function on(e,t){this.path=e,this.rethrow(t)}FP(on,Error);on.prototype.rethrow=function(t){if(this.message=`${t} at: ${this.path||"(shallow)"}`,Error.captureStackTrace&&Error.captureStackTrace(this,on),!this.stack)try{throw new Error(this.message)}catch(r){this.stack=r.stack}return this};Tm.Reporter=Je});var $s=h((u9,Am)=>{var{inherits:GP}=g("util"),{Reporter:Ls}=Js();function Le(e,t){if(Ls.call(this,t),!Buffer.isBuffer(e)){this.error("Input not Buffer");return}this.base=e,this.offset=0,this.length=e.length}GP(Le,Ls);Le.isDecoderBuffer=function(t){return t instanceof Le?!0:typeof t=="object"&&Buffer.isBuffer(t.base)&&t.constructor.name==="DecoderBuffer"&&typeof t.offset=="number"&&typeof t.length=="number"&&typeof t.save=="function"&&typeof t.restore=="function"&&typeof t.isEmpty=="function"&&typeof t.readUInt8=="function"&&typeof t.skip=="function"&&typeof t.raw=="function"};Le.prototype.save=function(){return{offset:this.offset,reporter:Ls.prototype.save.call(this)}};Le.prototype.restore=function(t){let r=new Le(this.base);return r.offset=t.offset,r.length=this.offset,this.offset=t.offset,Ls.prototype.restore.call(this,t.reporter),r};Le.prototype.isEmpty=function(){return this.offset===this.length};Le.prototype.readUInt8=function(t){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(t||"DecoderBuffer overrun")};Le.prototype.skip=function(t,r){if(!(this.offset+t<=this.length))return this.error(r||"DecoderBuffer overrun");let n=new Le(this.base);return n._reporterState=this._reporterState,n.offset=this.offset,n.length=this.offset+t,this.offset+=t,n};Le.prototype.raw=function(t){return this.base.slice(t?t.offset:this.offset,this.length)};function cn(e,t){if(Array.isArray(e))this.length=0,this.value=e.map(function(r){return cn.isEncoderBuffer(r)||(r=new cn(r,t)),this.length+=r.length,r},this);else if(typeof e=="number"){if(!(e>=0&&e<=255))return t.error("non-byte EncoderBuffer value");this.value=e,this.length=1}else if(typeof e=="string")this.value=e,this.length=Buffer.byteLength(e);else if(Buffer.isBuffer(e))this.value=e,this.length=e.length;else return t.error(`Unsupported type: ${typeof e}`)}cn.isEncoderBuffer=function(t){return t instanceof cn?!0:typeof t=="object"&&t.constructor.name==="EncoderBuffer"&&typeof t.length=="number"&&typeof t.join=="function"};cn.prototype.join=function(t,r){return t||(t=Buffer.alloc(this.length)),r||(r=0),this.length===0||(Array.isArray(this.value)?this.value.forEach(function(n){n.join(t,r),r+=n.length}):(typeof this.value=="number"?t[r]=this.value:typeof this.value=="string"?t.write(this.value,r):Buffer.isBuffer(this.value)&&this.value.copy(t,r),r+=this.length)),t};Am.exports={DecoderBuffer:Le,EncoderBuffer:cn}});var Us=h((l9,Om)=>{var{strict:be}=g("assert"),{Reporter:zP}=Js(),{DecoderBuffer:YP,EncoderBuffer:VP}=$s(),qm=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],XP=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(qm),QP=["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"];function D(e,t,r){let n={};this._baseState=n,n.name=r,n.enc=e,n.parent=t||null,n.children=null,n.tag=null,n.args=null,n.reverseArgs=null,n.choice=null,n.optional=!1,n.any=!1,n.obj=!1,n.use=null,n.useDecoder=null,n.key=null,n.default=null,n.explicit=null,n.implicit=null,n.contains=null,n.parent||(n.children=[],this._wrap())}var ZP=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];D.prototype.clone=function(){let t=this._baseState,r={};ZP.forEach(function(i){r[i]=t[i]});let n=new this.constructor(r.parent);return n._baseState=r,n};D.prototype._wrap=function(){let t=this._baseState;XP.forEach(function(r){this[r]=function(){let i=new this.constructor(this);return t.children.push(i),i[r].apply(i,arguments)}},this)};D.prototype._init=function(t){let r=this._baseState;be(r.parent===null),t.call(this),r.children=r.children.filter(function(n){return n._baseState.parent===this},this),be.equal(r.children.length,1,"Root node can have only one child")};D.prototype._useArgs=function(t){let r=this._baseState,n=t.filter(function(i){return i instanceof this.constructor},this);t=t.filter(function(i){return!(i instanceof this.constructor)},this),n.length!==0&&(be(r.children===null),r.children=n,n.forEach(function(i){i._baseState.parent=this},this)),t.length!==0&&(be(r.args===null),r.args=t,r.reverseArgs=t.map(function(i){if(typeof i!="object"||i.constructor!==Object)return i;let s={};return Object.keys(i).forEach(function(o){o==(o|0)&&(o|=0);let c=i[o];s[c]=o}),s}))};QP.forEach(function(e){D.prototype[e]=function(){let r=this._baseState;throw new Error(`${e} not implemented for encoding: ${r.enc}`)}});qm.forEach(function(e){D.prototype[e]=function(){let r=this._baseState,n=Array.prototype.slice.call(arguments);return be(r.tag===null),r.tag=e,this._useArgs(n),this}});D.prototype.use=function(t){be(t);let r=this._baseState;return be(r.use===null),r.use=t,this};D.prototype.optional=function(){let t=this._baseState;return t.optional=!0,this};D.prototype.def=function(t){let r=this._baseState;return be(r.default===null),r.default=t,r.optional=!0,this};D.prototype.explicit=function(t){let r=this._baseState;return be(r.explicit===null&&r.implicit===null),r.explicit=t,this};D.prototype.implicit=function(t){let r=this._baseState;return be(r.explicit===null&&r.implicit===null),r.implicit=t,this};D.prototype.obj=function(){let t=this._baseState,r=Array.prototype.slice.call(arguments);return t.obj=!0,r.length!==0&&this._useArgs(r),this};D.prototype.key=function(t){let r=this._baseState;return be(r.key===null),r.key=t,this};D.prototype.any=function(){let t=this._baseState;return t.any=!0,this};D.prototype.choice=function(t){let r=this._baseState;return be(r.choice===null),r.choice=t,this._useArgs(Object.keys(t).map(function(n){return t[n]})),this};D.prototype.contains=function(t){let r=this._baseState;return be(r.use===null),r.contains=t,this};D.prototype._decode=function(t,r){let n=this._baseState;if(n.parent===null)return t.wrapResult(n.children[0]._decode(t,r));let i=n.default,s=!0,o=null;if(n.key!==null&&(o=t.enterKey(n.key)),n.optional){let a=null;if(n.explicit!==null?a=n.explicit:n.implicit!==null?a=n.implicit:n.tag!==null&&(a=n.tag),a===null&&!n.any){let l=t.save();try{n.choice===null?this._decodeGeneric(n.tag,t,r):this._decodeChoice(t,r),s=!0}catch{s=!1}t.restore(l)}else if(s=this._peekTag(t,a,n.any),t.isError(s))return s}let c;if(n.obj&&s&&(c=t.enterObject()),s){if(n.explicit!==null){let l=this._decodeTag(t,n.explicit);if(t.isError(l))return l;t=l}let a=t.offset;if(n.use===null&&n.choice===null){let l;n.any&&(l=t.save());let f=this._decodeTag(t,n.implicit!==null?n.implicit:n.tag,n.any);if(t.isError(f))return f;n.any?i=t.raw(l):t=f}if(r&&r.track&&n.tag!==null&&r.track(t.path(),a,t.length,"tagged"),r&&r.track&&n.tag!==null&&r.track(t.path(),t.offset,t.length,"content"),n.any||(n.choice===null?i=this._decodeGeneric(n.tag,t,r):i=this._decodeChoice(t,r)),t.isError(i))return i;if(!n.any&&n.choice===null&&n.children!==null&&n.children.forEach(function(f){f._decode(t,r)}),n.contains&&(n.tag==="octstr"||n.tag==="bitstr")){let l=new YP(i);i=this._getUse(n.contains,t._reporterState.obj)._decode(l,r)}}return n.obj&&s&&(i=t.leaveObject(c)),n.key!==null&&(i!==null||s===!0)?t.leaveKey(o,n.key,i):o!==null&&t.exitKey(o),i};D.prototype._decodeGeneric=function(t,r,n){let i=this._baseState;return t==="seq"||t==="set"?null:t==="seqof"||t==="setof"?this._decodeList(r,t,i.args[0],n):/str$/.test(t)?this._decodeStr(r,t,n):t==="objid"&&i.args?this._decodeObjid(r,i.args[0],i.args[1],n):t==="objid"?this._decodeObjid(r,null,null,n):t==="gentime"||t==="utctime"?this._decodeTime(r,t,n):t==="null_"?this._decodeNull(r,n):t==="bool"?this._decodeBool(r,n):t==="objDesc"?this._decodeStr(r,t,n):t==="int"||t==="enum"?this._decodeInt(r,i.args&&i.args[0],n):i.use!==null?this._getUse(i.use,r._reporterState.obj)._decode(r,n):r.error(`unknown tag: ${t}`)};D.prototype._getUse=function(t,r){let n=this._baseState;return n.useDecoder=this._use(t,r),be(n.useDecoder._baseState.parent===null),n.useDecoder=n.useDecoder._baseState.children[0],n.implicit!==n.useDecoder._baseState.implicit&&(n.useDecoder=n.useDecoder.clone(),n.useDecoder._baseState.implicit=n.implicit),n.useDecoder};D.prototype._decodeChoice=function(t,r){let n=this._baseState,i=null,s=!1;return Object.keys(n.choice).some(function(o){let c=t.save(),a=n.choice[o];try{let l=a._decode(t,r);if(t.isError(l))return!1;i={type:o,value:l},s=!0}catch{return t.restore(c),!1}return!0},this),s?i:t.error("Choice not matched")};D.prototype._createEncoderBuffer=function(t){return new VP(t,this.reporter)};D.prototype._encode=function(t,r,n){let i=this._baseState;if(i.default!==null&&i.default===t)return;let s=this._encodeValue(t,r,n);if(s!==void 0&&!this._skipDefault(s,r,n))return s};D.prototype._encodeValue=function(t,r,n){let i=this._baseState;if(i.parent===null)return i.children[0]._encode(t,r||new zP);let s=null;if(this.reporter=r,i.optional&&t===void 0)if(i.default!==null)t=i.default;else return;let o=null,c=!1;if(i.any)s=this._createEncoderBuffer(t);else if(i.choice)s=this._encodeChoice(t,r);else if(i.contains)o=this._getUse(i.contains,n)._encode(t,r),c=!0;else if(i.children)o=i.children.map(function(a){if(a._baseState.tag==="null_")return a._encode(null,r,t);if(a._baseState.key===null)return r.error("Child should have a key");let l=r.enterKey(a._baseState.key);if(typeof t!="object")return r.error("Child expected, but input is not object");let f=a._encode(t[a._baseState.key],r,t);return r.leaveKey(l),f},this).filter(function(a){return a}),o=this._createEncoderBuffer(o);else if(i.tag==="seqof"||i.tag==="setof"){if(!(i.args&&i.args.length===1))return r.error(`Too many args for: ${i.tag}`);if(!Array.isArray(t))return r.error("seqof/setof, but data is not Array");let a=this.clone();a._baseState.implicit=null,o=this._createEncoderBuffer(t.map(function(l){let f=this._baseState;return this._getUse(f.args[0],t)._encode(l,r)},a))}else i.use!==null?s=this._getUse(i.use,n)._encode(t,r):(o=this._encodePrimitive(i.tag,t),c=!0);if(!i.any&&i.choice===null){let a=i.implicit!==null?i.implicit:i.tag,l=i.implicit===null?"universal":"context";a===null?i.use===null&&r.error("Tag could be omitted only for .use()"):i.use===null&&(s=this._encodeComposite(a,c,l,o))}return i.explicit!==null&&(s=this._encodeComposite(i.explicit,!1,"context",s)),s};D.prototype._encodeChoice=function(t,r){let n=this._baseState,i=n.choice[t.type];return i||be(!1,`${t.type} not found in ${JSON.stringify(Object.keys(n.choice))}`),i._encode(t.value,r)};D.prototype._encodePrimitive=function(t,r){let n=this._baseState;if(/str$/.test(t))return this._encodeStr(r,t);if(t==="objid"&&n.args)return this._encodeObjid(r,n.reverseArgs[0],n.args[1]);if(t==="objid")return this._encodeObjid(r,null,null);if(t==="gentime"||t==="utctime")return this._encodeTime(r,t);if(t==="null_")return this._encodeNull();if(t==="int"||t==="enum")return this._encodeInt(r,n.args&&n.reverseArgs[0]);if(t==="bool")return this._encodeBool(r);if(t==="objDesc")return this._encodeStr(r,t);throw new Error(`Unsupported tag: ${t}`)};D.prototype._isNumstr=function(t){return/^[0-9 ]*$/.test(t)};D.prototype._isPrintstr=function(t){return/^[A-Za-z0-9 '()+,-./:=?]*$/.test(t)};Om.exports=D});var Ws=h(wr=>{function km(e){let t={};return Object.keys(e).forEach(function(r){(r|0)==r&&(r=r|0);let n=e[r];t[n]=r}),t}wr.tagClass={0:"universal",1:"application",2:"context",3:"private"};wr.tagClassByName=km(wr.tagClass);wr.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"};wr.tagByName=km(wr.tag)});var Za=h((d9,Rm)=>{var{inherits:eR}=g("util"),Cm=Us(),Qa=Ws();function Pm(e){this.enc="der",this.name=e.name,this.entity=e,this.tree=new Ye,this.tree._init(e.body)}Pm.prototype.encode=function(t,r){return this.tree._encode(t,r).join()};function Ye(e){Cm.call(this,"der",e)}eR(Ye,Cm);Ye.prototype._encodeComposite=function(t,r,n,i){let s=rR(t,r,n,this.reporter);if(i.length<128){let a=Buffer.alloc(2);return a[0]=s,a[1]=i.length,this._createEncoderBuffer([a,i])}let o=1;for(let a=i.length;a>=256;a>>=8)o++;let c=Buffer.alloc(1+1+o);c[0]=s,c[1]=128|o;for(let a=1+o,l=i.length;l>0;a--,l>>=8)c[a]=l&255;return this._createEncoderBuffer([c,i])};Ye.prototype._encodeStr=function(t,r){if(r==="bitstr")return this._createEncoderBuffer([t.unused|0,t.data]);if(r==="bmpstr"){let n=Buffer.alloc(t.length*2);for(let i=0;i<t.length;i++)n.writeUInt16BE(t.charCodeAt(i),i*2);return this._createEncoderBuffer(n)}else return r==="numstr"?this._isNumstr(t)?this._createEncoderBuffer(t):this.reporter.error("Encoding of string type: numstr supports only digits and space"):r==="printstr"?this._isPrintstr(t)?this._createEncoderBuffer(t):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(r)?this._createEncoderBuffer(t):r==="objDesc"?this._createEncoderBuffer(t):this.reporter.error(`Encoding of string type: ${r} unsupported`)};Ye.prototype._encodeObjid=function(t,r,n){if(typeof t=="string"){if(!r)return this.reporter.error("string objid given, but no values map found");if(!Object.prototype.hasOwnProperty.call(r,t))return this.reporter.error("objid not found in values map");t=r[t].split(/[\s.]+/g);for(let c=0;c<t.length;c++)t[c]|=0}else if(Array.isArray(t)){t=t.slice();for(let c=0;c<t.length;c++)t[c]|=0}if(!Array.isArray(t))return this.reporter.error(`objid() should be either array or string, got: ${JSON.stringify(t)}`);if(!n){if(t[1]>=40)return this.reporter.error("Second objid identifier OOB");t.splice(0,2,t[0]*40+t[1])}let i=0;for(let c=0;c<t.length;c++){let a=t[c];for(i++;a>=128;a>>=7)i++}let s=Buffer.alloc(i),o=s.length-1;for(let c=t.length-1;c>=0;c--){let a=t[c];for(s[o--]=a&127;(a>>=7)>0;)s[o--]=128|a&127}return this._createEncoderBuffer(s)};function $e(e){return e<10?`0${e}`:e}Ye.prototype._encodeTime=function(t,r){let n,i=new Date(t);return r==="gentime"?n=[$e(i.getUTCFullYear()),$e(i.getUTCMonth()+1),$e(i.getUTCDate()),$e(i.getUTCHours()),$e(i.getUTCMinutes()),$e(i.getUTCSeconds()),"Z"].join(""):r==="utctime"?n=[$e(i.getUTCFullYear()%100),$e(i.getUTCMonth()+1),$e(i.getUTCDate()),$e(i.getUTCHours()),$e(i.getUTCMinutes()),$e(i.getUTCSeconds()),"Z"].join(""):this.reporter.error(`Encoding ${r} time is not supported yet`),this._encodeStr(n,"octstr")};Ye.prototype._encodeNull=function(){return this._createEncoderBuffer("")};function tR(e){var t=BigInt(e).toString(16);t.length%2&&(t="0"+t);for(var r=t.length/2,n=new Uint8Array(r),i=0,s=0;i<r;)n[i]=parseInt(t.slice(s,s+2),16),i+=1,s+=2;return n}Ye.prototype._encodeInt=function(t,r){if(typeof t=="string"){if(!r)return this.reporter.error("String int or enum given, but no values map");if(!Object.prototype.hasOwnProperty.call(r,t))return this.reporter.error(`Values map doesn't contain: ${JSON.stringify(t)}`);t=r[t]}if(typeof t=="bigint"){let s=[...tR(t)];s[0]&128&&s.unshift(0),t=Buffer.from(s)}if(Buffer.isBuffer(t)){let s=t.length;t.length===0&&s++;let o=Buffer.alloc(s);return t.copy(o),t.length===0&&(o[0]=0),this._createEncoderBuffer(o)}if(t<128)return this._createEncoderBuffer(t);if(t<256)return this._createEncoderBuffer([0,t]);let n=1;for(let s=t;s>=256;s>>=8)n++;let i=new Array(n);for(let s=i.length-1;s>=0;s--)i[s]=t&255,t>>=8;return i[0]&128&&i.unshift(0),this._createEncoderBuffer(Buffer.from(i))};Ye.prototype._encodeBool=function(t){return this._createEncoderBuffer(t?255:0)};Ye.prototype._use=function(t,r){return typeof t=="function"&&(t=t(r)),t._getEncoder("der").tree};Ye.prototype._skipDefault=function(t,r,n){let i=this._baseState,s;if(i.default===null)return!1;let o=t.join();if(i.defaultBuffer===void 0&&(i.defaultBuffer=this._encodeValue(i.default,r,n).join()),o.length!==i.defaultBuffer.length)return!1;for(s=0;s<o.length;s++)if(o[s]!==i.defaultBuffer[s])return!1;return!0};function rR(e,t,r,n){let i;if(e==="seqof"?e="seq":e==="setof"&&(e="set"),Object.prototype.hasOwnProperty.call(Qa.tagByName,e))i=Qa.tagByName[e];else if(typeof e=="number"&&(e|0)===e)i=e;else return n.error(`Unknown tag: ${e}`);return i>=31?n.error("Multi-octet tag encoding unsupported"):(t||(i|=32),i|=Qa.tagClassByName[r||"universal"]<<6,i)}Rm.exports=Pm});var Im=h((h9,Km)=>{var{inherits:nR}=g("util"),eu=Za();function tu(e){eu.call(this,e),this.enc="pem"}nR(tu,eu);tu.prototype.encode=function(t,r){let i=eu.prototype.encode.call(this,t).toString("base64"),s=[`-----BEGIN ${r.label}-----`];for(let o=0;o<i.length;o+=64)s.push(i.slice(o,o+64));return s.push(`-----END ${r.label}-----`),s.join(`
`)};Km.exports=tu});var ru=h((p9,Bm)=>{Bm.exports={der:Za(),pem:Im()}});var iu=h((y9,Lm)=>{var{inherits:iR}=g("util"),{DecoderBuffer:Nm}=$s(),Mm=Us(),jm=Ws();function Dm(e){this.enc="der",this.name=e.name,this.entity=e,this.tree=new Re,this.tree._init(e.body)}Dm.prototype.decode=function(t,r){return Nm.isDecoderBuffer(t)||(t=new Nm(t,r)),this.tree._decode(t,r)};function Re(e){Mm.call(this,"der",e)}iR(Re,Mm);Re.prototype._peekTag=function(t,r,n){if(t.isEmpty())return!1;let i=t.save(),s=nu(t,`Failed to peek tag: "${r}"`);return t.isError(s)?s:(t.restore(i),s.tag===r||s.tagStr===r||s.tagStr+"of"===r||n)};Re.prototype._decodeTag=function(t,r,n){let i=nu(t,`Failed to decode tag of "${r}"`);if(t.isError(i))return i;let s=Jm(t,i.primitive,`Failed to get length of "${r}"`);if(t.isError(s))return s;if(!n&&i.tag!==r&&i.tagStr!==r&&i.tagStr+"of"!==r)return t.error(`Failed to match tag: "${r}"`);if(i.primitive||s!==null)return t.skip(s,`Failed to match body of: "${r}"`);let o=t.save(),c=this._skipUntilEnd(t,`Failed to skip indefinite length body: "${this.tag}"`);return t.isError(c)?c:(s=t.offset-o.offset,t.restore(o),t.skip(s,`Failed to match body of: "${r}"`))};Re.prototype._skipUntilEnd=function(t,r){for(;;){let n=nu(t,r);if(t.isError(n))return n;let i=Jm(t,n.primitive,r);if(t.isError(i))return i;let s;if(n.primitive||i!==null?s=t.skip(i):s=this._skipUntilEnd(t,r),t.isError(s))return s;if(n.tagStr==="end")break}};Re.prototype._decodeList=function(t,r,n,i){let s=[];for(;!t.isEmpty();){let o=this._peekTag(t,"end");if(t.isError(o))return o;let c=n.decode(t,"der",i);if(t.isError(c)&&o)break;s.push(c)}return s};Re.prototype._decodeStr=function(t,r){if(r==="bitstr"){let n=t.readUInt8();return t.isError(n)?n:{unused:n,data:t.raw()}}else if(r==="bmpstr"){let n=t.raw();if(n.length%2===1)return t.error("Decoding of string type: bmpstr length mismatch");let i="";for(let s=0;s<n.length/2;s++)i+=String.fromCharCode(n.readUInt16BE(s*2));return i}else if(r==="numstr"){let n=t.raw().toString("ascii");return this._isNumstr(n)?n:t.error("Decoding of string type: numstr unsupported characters")}else{if(r==="octstr")return t.raw();if(r==="objDesc")return t.raw();if(r==="printstr"){let n=t.raw().toString("ascii");return this._isPrintstr(n)?n:t.error("Decoding of string type: printstr unsupported characters")}else return/str$/.test(r)?t.raw().toString():t.error(`Decoding of string type: ${r} unsupported`)}};Re.prototype._decodeObjid=function(t,r,n){let i,s=[],o=0,c=0;for(;!t.isEmpty();)c=t.readUInt8(),o<<=7,o|=c&127,(c&128)===0&&(s.push(o),o=0);c&128&&s.push(o);let a=s[0]/40|0,l=s[0]%40;if(n?i=s:i=[a,l].concat(s.slice(1)),r){let f=r[i.join(" ")];f===void 0&&(f=r[i.join(".")]),f!==void 0&&(i=f)}return i};Re.prototype._decodeTime=function(t,r){let n=t.raw().toString(),i,s,o,c,a,l;if(r==="gentime")i=n.slice(0,4)|0,s=n.slice(4,6)|0,o=n.slice(6,8)|0,c=n.slice(8,10)|0,a=n.slice(10,12)|0,l=n.slice(12,14)|0;else if(r==="utctime")i=n.slice(0,2)|0,s=n.slice(2,4)|0,o=n.slice(4,6)|0,c=n.slice(6,8)|0,a=n.slice(8,10)|0,l=n.slice(10,12)|0,i<70?i=2e3+i:i=1900+i;else return t.error(`Decoding ${r} time is not supported yet`);return Date.UTC(i,s-1,o,c,a,l,0)};Re.prototype._decodeNull=function(){return null};Re.prototype._decodeBool=function(t){let r=t.readUInt8();return t.isError(r)?r:r!==0};Re.prototype._decodeInt=function(t,r){let n=t.raw(),i=BigInt(`0x${n.toString("hex")}`);return r&&(i=r[i.toString(10)]||i),i};Re.prototype._use=function(t,r){return typeof t=="function"&&(t=t(r)),t._getDecoder("der").tree};function nu(e,t){let r=e.readUInt8(t);if(e.isError(r))return r;let n=jm.tagClass[r>>6],i=(r&32)===0;if((r&31)===31){let o=r;for(r=0;(o&128)===128;){if(o=e.readUInt8(t),e.isError(o))return o;r<<=7,r|=o&127}}else r&=31;let s=jm.tag[r];return{cls:n,primitive:i,tag:r,tagStr:s}}function Jm(e,t,r){let n=e.readUInt8(r);if(e.isError(n))return n;if(!t&&n===128)return null;if((n&128)===0)return n;let i=n&127;if(i>4)return e.error("length octect is too long");n=0;for(let s=0;s<i;s++){n<<=8;let o=e.readUInt8(r);if(e.isError(o))return o;n|=o}return n}Lm.exports=Dm});var Um=h((m9,$m)=>{var{inherits:sR}=g("util"),su=iu();function ou(e){su.call(this,e),this.enc="pem"}sR(ou,su);ou.prototype.decode=function(t,r){let n=t.toString().split(/[\r\n]+/g),i=r.label.toUpperCase(),s=/^-----(BEGIN|END) ([^-]+)-----$/,o=-1,c=-1;for(let f=0;f<n.length;f++){let u=n[f].match(s);if(u!==null&&u[2]===i)if(o===-1){if(u[1]!=="BEGIN")break;o=f}else{if(u[1]!=="END")break;c=f;break}}if(o===-1||c===-1)throw new Error(`PEM section not found for: ${i}`);let a=n.slice(o+1,c).join("");a.replace(/[^a-z0-9+/=]+/gi,"");let l=Buffer.from(a,"base64");return su.prototype.decode.call(this,l,r)};$m.exports=ou});var cu=h((g9,Wm)=>{Wm.exports={der:iu(),pem:Um()}});var Fm=h((_9,Hm)=>{var{inherits:oR}=g("util"),cR=ru(),aR=cu();Hm.exports.define=function(t,r){return new an(t,r)};function an(e,t){this.name=e,this.body=t,this.decoders={},this.encoders={}}an.prototype._createNamed=function(t){let r=this.name;function n(i){this._initNamed(i,r)}return oR(n,t),n.prototype._initNamed=function(s,o){t.call(this,s,o)},new n(this)};an.prototype._getDecoder=function(t){return t=t||"der",Object.prototype.hasOwnProperty.call(this.decoders,t)||(this.decoders[t]=this._createNamed(aR[t])),this.decoders[t]};an.prototype.decode=function(t,r,n){return this._getDecoder(r).decode(t,n)};an.prototype._getEncoder=function(t){return t=t||"der",Object.prototype.hasOwnProperty.call(this.encoders,t)||(this.encoders[t]=this._createNamed(cR[t])),this.encoders[t]};an.prototype.encode=function(t,r,n){return this._getEncoder(r).encode(t,n)}});var zm=h((w9,Gm)=>{var{Reporter:uR}=Js(),{DecoderBuffer:lR,EncoderBuffer:fR}=$s(),dR=Us();Gm.exports={DecoderBuffer:lR,EncoderBuffer:fR,Node:dR,Reporter:uR}});var Vm=h((b9,Ym)=>{Ym.exports={der:Ws()}});var Qm=h((E9,Xm)=>{var{define:hR}=Fm(),pR=zm(),yR=Vm(),mR=cu(),gR=ru();Xm.exports={base:pR,constants:yR,decoders:mR,define:hR,encoders:gR}});var au=h((v9,Zm)=>{var{name:_R}=gr(),wR={"1 2 840 10045 3 1 7":"P-256","1 3 132 0 10":_R,"1 3 132 0 34":"P-384","1 3 132 0 35":"P-521","1 2 840 10045 2 1":"ecPublicKey","1 2 840 113549 1 1 1":"rsaEncryption","1 3 101 110":"X25519","1 3 101 111":"X448","1 3 101 112":"Ed25519","1 3 101 113":"Ed448"};Zm.exports=wR});var rg=h((S9,tg)=>{var eg=au();tg.exports=function(){this.seq().obj(this.key("algorithm").objid(eg),this.key("parameters").optional().choice({namedCurve:this.objid(eg),null:this.null_()}))}});var ig=h((x9,ng)=>{var bR=au();ng.exports=function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").explicit(0).optional().choice({namedCurve:this.objid(bR)}),this.key("publicKey").explicit(1).optional().bitstr())}});var og=h((T9,sg)=>{sg.exports=e=>function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(e),this.key("privateKey").octstr())}});var ag=h((A9,cg)=>{cg.exports=e=>function(){this.seq().obj(this.key("algorithm").use(e),this.key("publicKey").bitstr())}});var lg=h((q9,ug)=>{ug.exports=function(){this.octstr().contains().obj(this.key("privateKey").octstr())}});var dg=h((O9,fg)=>{fg.exports=(e,t)=>function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(e),this.key("privateKey").use(t))}});var pg=h((k9,hg)=>{hg.exports=function(){this.seq().obj(this.key("version").int({0:"two-prime",1:"multi"}),this.key("n").int(),this.key("e").int(),this.key("d").int(),this.key("p").int(),this.key("q").int(),this.key("dp").int(),this.key("dq").int(),this.key("qi").int())}});var mg=h((C9,yg)=>{yg.exports=function(){this.seq().obj(this.key("n").int(),this.key("e").int())}});var uu=h((P9,_g)=>{var Vt=Qm(),qt=new Map,Hs=Vt.define("AlgorithmIdentifier",rg());qt.set("AlgorithmIdentifier",Hs);var ER=Vt.define("ECPrivateKey",ig());qt.set("ECPrivateKey",ER);var vR=Vt.define("PrivateKeyInfo",og()(Hs));qt.set("PrivateKeyInfo",vR);var SR=Vt.define("PublicKeyInfo",ag()(Hs));qt.set("PublicKeyInfo",SR);var gg=Vt.define("PrivateKey",lg());qt.set("PrivateKey",gg);var xR=Vt.define("OneAsymmetricKey",dg()(Hs,gg));qt.set("OneAsymmetricKey",xR);var TR=Vt.define("RSAPrivateKey",pg());qt.set("RSAPrivateKey",TR);var AR=Vt.define("RSAPublicKey",mg());qt.set("RSAPublicKey",AR);_g.exports=qt});var se=h((K9,wg)=>{var{keyObjectSupported:qR}=Pe(),wt,Xt,Fs,bt,lu;if(qR)({createPublicKey:wt,createPrivateKey:Xt,createSecretKey:Fs,KeyObject:bt}=g("crypto")),lu=e=>e;else{let{EOL:e}=g("os"),t=L(),r=De(),n=uu(),i=Symbol("toInput"),s=Symbol("namedCurve");lu=(l,f)=>l instanceof bt?l[i](f):Fs(l)[i](f);let o=l=>Buffer.from(l.replace(/(?:-----(?:BEGIN|END)(?: (?:RSA|EC))? (?:PRIVATE|PUBLIC) KEY-----|\s)/g,""),"base64"),c=(l,f)=>`-----BEGIN ${f}-----${e}${(l.toString("base64").match(/.{1,64}/g)||[]).join(e)}${e}-----END ${f}-----`,a=l=>{let f=typeof l=="string"?l:`OID ${l.join(".")}`;throw new t.JOSENotSupported(`${f} is not supported in your Node.js runtime version`)};bt=class{export({cipher:f,passphrase:u,type:d,format:p}={}){if(this._type==="secret")return this._buffer;if(this._type==="public"){if(this.asymmetricKeyType==="rsa")switch(d){case"pkcs1":return p==="pem"?this._pem:o(this._pem);case"spki":{let y=n.get("PublicKeyInfo").encode({algorithm:{algorithm:"rsaEncryption",parameters:{type:"null"}},publicKey:{unused:0,data:o(this._pem)}},"pem",{label:"PUBLIC KEY"});return p==="pem"?y:o(y)}default:throw new TypeError(`The value ${d} is invalid for option "type"`)}if(this.asymmetricKeyType==="ec"){if(d!=="spki")throw new TypeError(`The value ${d} is invalid for option "type"`);return p==="pem"?this._pem:o(this._pem)}}if(this._type==="private"){if(u!==void 0||f!==void 0)throw new t.JOSENotSupported("encrypted private keys are not supported in your Node.js runtime version");if(d==="pkcs8"){if(this._pkcs8)return p==="der"&&typeof this._pkcs8=="string"?o(this._pkcs8):p==="pem"&&Buffer.isBuffer(this._pkcs8)?c(this._pkcs8,"PRIVATE KEY"):this._pkcs8;if(this.asymmetricKeyType==="rsa"){let m=this._asn1,_=n.get("RSAPrivateKey").encode(m),w=n.get("PrivateKeyInfo").encode({version:0,privateKey:_,algorithm:{algorithm:"rsaEncryption",parameters:{type:"null"}}});return this._pkcs8=w,this.export({type:d,format:p})}if(this.asymmetricKeyType==="ec"){let m=this._asn1,_=n.get("ECPrivateKey").encode({version:m.version,privateKey:m.privateKey,publicKey:m.publicKey}),w=n.get("PrivateKeyInfo").encode({version:0,privateKey:_,algorithm:{algorithm:"ecPublicKey",parameters:this._asn1.parameters}});return this._pkcs8=w,this.export({type:d,format:p})}}if(this.asymmetricKeyType==="rsa"&&d==="pkcs1")return p==="pem"?this._pem:o(this._pem);if(this.asymmetricKeyType==="ec"&&d==="sec1")return p==="pem"?this._pem:o(this._pem);throw new TypeError(`The value ${d} is invalid for option "type"`)}}get type(){return this._type}get asymmetricKeyType(){return this._asymmetricKeyType}get symmetricKeySize(){return this._symmetricKeySize}[i](f){switch(this._type){case"secret":return this._buffer;case"public":return this._pem;default:return f?("_pub"in this||(this._pub=wt(this)),this._pub[i](!1)):this._pem}}},Fs=l=>{if(!Buffer.isBuffer(l)||!l.length)throw new TypeError("input must be a non-empty Buffer instance");let f=new bt;return f._buffer=Buffer.from(l),f._symmetricKeySize=l.length,f._type="secret",f},wt=l=>{if(l instanceof bt){if(l.type!=="private")throw new TypeError(`Invalid key object type ${l.type}, expected private.`);switch(l.asymmetricKeyType){case"ec":{let _=n.get("PublicKeyInfo").encode({algorithm:{algorithm:"ecPublicKey",parameters:l._asn1.parameters},publicKey:l._asn1.publicKey});return wt({key:_,format:"der",type:"spki"})}case"rsa":{let _=n.get("RSAPublicKey").encode(l._asn1);return wt({key:_,format:"der",type:"pkcs1"})}}}if((typeof l=="string"||Buffer.isBuffer(l))&&(l={key:l,format:"pem"}),!r(l))throw new TypeError("input must be a string, Buffer or an object");let{format:f,passphrase:u}=l,{key:d,type:p}=l;if(typeof d!="string"&&!Buffer.isBuffer(d))throw new TypeError("key must be a string or Buffer");if(f!=="pem"&&f!=="der")throw new TypeError('format must be one of "pem" or "der"');let m;if(f==="pem")switch(d=d.toString(),d.split(/\r?\n/g)[0].toString()){case"-----BEGIN PUBLIC KEY-----":p="spki",m="PUBLIC KEY";break;case"-----BEGIN RSA PUBLIC KEY-----":p="pkcs1",m="RSA PUBLIC KEY";break;case"-----BEGIN CERTIFICATE-----":throw new t.JOSENotSupported("X.509 certificates are not supported in your Node.js runtime version");case"-----BEGIN PRIVATE KEY-----":case"-----BEGIN EC PRIVATE KEY-----":case"-----BEGIN RSA PRIVATE KEY-----":return wt(Xt(d));default:throw new TypeError("unknown/unsupported PEM type")}switch(p){case"spki":{let y=n.get("PublicKeyInfo"),_=y.decode(d,f,{label:m}),b,w;switch(_.algorithm.algorithm){case"ecPublicKey":{w=new bt,w._asn1=_,w._asymmetricKeyType="ec",w._type="public",w._pem=y.encode(_,"pem",{label:"PUBLIC KEY"});break}case"rsaEncryption":{b="pkcs1",w=wt({type:b,key:_.publicKey.data,format:"der"});break}default:a(_.algorithm.algorithm)}return w}case"pkcs1":{let y=n.get("RSAPublicKey"),_=y.decode(d,f,{label:m});if(_.n===BigInt(0))return wt(Xt({key:d,format:f,type:p,passphrase:u}));let b=new bt;return b._asn1=_,b._asymmetricKeyType="rsa",b._type="public",b._pem=y.encode(_,"pem",{label:"RSA PUBLIC KEY"}),b}case"pkcs8":case"sec1":return wt(Xt({format:f,key:d,type:p,passphrase:u}));default:throw new TypeError(`The value ${p} is invalid for option "type"`)}},Xt=(l,f)=>{if((typeof l=="string"||Buffer.isBuffer(l))&&(l={key:l,format:"pem"}),!r(l))throw new TypeError("input must be a string, Buffer or an object");let{format:u,passphrase:d}=l,{key:p,type:m}=l;if(typeof p!="string"&&!Buffer.isBuffer(p))throw new TypeError("key must be a string or Buffer");if(d!==void 0)throw new t.JOSENotSupported("encrypted private keys are not supported in your Node.js runtime version");if(u!=="pem"&&u!=="der")throw new TypeError('format must be one of "pem" or "der"');let y;if(u==="pem")switch(p=p.toString(),p.split(/\r?\n/g)[0].toString()){case"-----BEGIN PRIVATE KEY-----":m="pkcs8",y="PRIVATE KEY";break;case"-----BEGIN EC PRIVATE KEY-----":m="sec1",y="EC PRIVATE KEY";break;case"-----BEGIN RSA PRIVATE KEY-----":m="pkcs1",y="RSA PRIVATE KEY";break;default:throw new TypeError("unknown/unsupported PEM type")}switch(m){case"pkcs8":{let b=n.get("PrivateKeyInfo").decode(p,u,{label:y}),w,v;switch(b.algorithm.algorithm){case"ecPublicKey":{w="sec1",v=Xt({type:w,key:b.privateKey,format:"der"},{[s]:b.algorithm.parameters.value});break}case"rsaEncryption":{w="pkcs1",v=Xt({type:w,key:b.privateKey,format:"der"});break}default:a(b.algorithm.algorithm)}return v._pkcs8=p,v}case"pkcs1":{let _=n.get("RSAPrivateKey"),b=_.decode(p,u,{label:y}),w=new bt;return w._asn1=b,w._asymmetricKeyType="rsa",w._type="private",w._pem=_.encode(b,"pem",{label:"RSA PRIVATE KEY"}),w}case"sec1":{let _=n.get("ECPrivateKey"),b=_.decode(p,u,{label:y});if(!("parameters"in b)&&!f[s])throw new Error("invalid sec1");"parameters"in b||(b={...b,parameters:{type:"namedCurve",value:f[s]}});let w=new bt;return w._asn1=b,w._asymmetricKeyType="ec",w._type="private",w._pem=_.encode(b,"pem",{label:"EC PRIVATE KEY"}),w}default:throw new TypeError(`The value ${m} is invalid for option "type"`)}}}wg.exports={createPublicKey:wt,createPrivateKey:Xt,createSecretKey:Fs,KeyObject:bt,asInput:lu}});var Eg=h((I9,bg)=>{var{randomBytes:OR}=g("crypto"),Gs=we(),fu=L(),un=BigInt(0),he=BigInt(1),ni=BigInt(2),ri=e=>{let t=e.toString(16);return Gs.encodeBuffer(Buffer.from(t.length%2?`0${t}`:t,"hex"))},zs=e=>BigInt(`0x${e.toString("hex")}`),kR=e=>e.toString(2).length,CR=(e,t)=>{let r=un,n=he,i=he,s=un;for(;e!==un;){let o=t/e,c=t%e,a=r-i*o,l=n-s*o;t=e,e=c,r=i,n=s,i=a,s=l}return r},PR=(e,t)=>{let r=un;for(;!((e|t)&he);)e>>=he,t>>=he,r++;for(;!(e&he);)e>>=he;do{for(;!(t&he);)t>>=he;if(e>t){let n=e;e=t,t=n}t-=e}while(t);return e<<r},RR=(e,t,r)=>{e=du(e,r);let n=he,i=e;for(;t>0;){var s=t%ni;t=t/ni,s===he&&(n=n*i,n=n%r),i=i*i,i=i%r}return n},KR=(e,t)=>{let r=t-e,n=kR(r),i;do i=zs(IR(n));while(i>r);return i+e},IR=e=>{let t=Math.ceil(e/8),r=OR(t);return r[0]=r[0]&2**(e%8)-1,r},du=(e,t)=>(e=e%t,e<0?e+t:e),BR=e=>{let t=e;for(;t%ni===un;)t=t/ni;return t},NR=30,jR=22,MR=(e,t,r)=>{let n=BR(e*t-he),i=0,s;do{if(i++,i===NR)throw new fu.JWKImportFailed("failed to calculate missing primes");let a=0,l=RR(KR(ni,r),n,r),f=un;for(;l!==he;){if(a++,a===jR)throw new fu.JWKImportFailed("failed to calculate missing primes");f=l,l=l*l%r}f!==r-he&&(s=f)}while(!s);let o=PR(s-he,r),c=r/o;return o>c?{p:o,q:c}:{p:c,q:o}};bg.exports=e=>{let t=zs(Gs.decodeToBuffer(e.e)),r=zs(Gs.decodeToBuffer(e.d)),n=zs(Gs.decodeToBuffer(e.n));if(r>=n)throw new fu.JWKInvalid("invalid RSA private exponent");let{p:i,q:s}=MR(t,r,n),o=r%(i-he),c=r%(s-he),a=du(CR(du(s,i),i),i);return{...e,p:ri(i),q:ri(s),dp:ri(o),dq:ri(c),qi:ri(a)}}});var mu=h((B9,yu)=>{var{EOL:hu}=g("os"),Qt=L(),{keyObjectSupported:DR}=Pe(),{createPublicKey:xg}=se(),B=we(),Ee=uu(),JR=Eg(),{OKP_CURVES:LR,EC_CURVES:$R}=_t(),UR=(e,t)=>`-----BEGIN ${t} KEY-----${hu}${(e.match(/.{1,64}/g)||[]).join(hu)}${hu}-----END ${t} KEY-----`,Ot={private(e,t){let r=t.export({type:"pkcs8",format:"der"}),n=Ee.get("OneAsymmetricKey"),{privateKey:{privateKey:i}}=n.decode(r);return{...Ot.public(e,xg(t)),d:B.encodeBuffer(i)}},public(e,t){let r=t.export({type:"spki",format:"der"}),n=Ee.get("PublicKeyInfo"),{publicKey:{data:i}}=n.decode(r);return{kty:"OKP",crv:e,x:B.encodeBuffer(i)}}},pu={rsa:{private(e){let t=e.export({type:"pkcs8",format:"der"}),r=Ee.get("PrivateKeyInfo"),n=Ee.get("RSAPrivateKey"),{privateKey:i}=r.decode(t),{version:s,n:o,e:c,d:a,p:l,q:f,dp:u,dq:d,qi:p}=n.decode(i);if(s!=="two-prime")throw new Qt.JOSENotSupported("Private RSA keys with more than two primes are not supported");return{kty:"RSA",n:B.encodeBigInt(o),e:B.encodeBigInt(c),d:B.encodeBigInt(a),p:B.encodeBigInt(l),q:B.encodeBigInt(f),dp:B.encodeBigInt(u),dq:B.encodeBigInt(d),qi:B.encodeBigInt(p)}},public(e){let t=e.export({type:"spki",format:"der"}),r=Ee.get("PublicKeyInfo"),n=Ee.get("RSAPublicKey"),{publicKey:{data:i}}=r.decode(t),{n:s,e:o}=n.decode(i);return{kty:"RSA",n:B.encodeBigInt(s),e:B.encodeBigInt(o)}}},ec:{private(e){let t=e.export({type:"pkcs8",format:"der"}),r=Ee.get("PrivateKeyInfo"),n=Ee.get("ECPrivateKey"),{privateKey:i,algorithm:{parameters:{value:s}}}=r.decode(t),{privateKey:o,publicKey:c}=n.decode(i);if(typeof c>"u"){if(DR)return{...pu.ec.public(xg(e)),d:B.encodeBuffer(o)};throw new Qt.JOSENotSupported("Private EC keys without the public key embedded are not supported in your Node.js runtime version")}let a=c.data.slice(1,(c.data.length-1)/2+1),l=c.data.slice((c.data.length-1)/2+1);return{kty:"EC",crv:s,d:B.encodeBuffer(o),x:B.encodeBuffer(a),y:B.encodeBuffer(l)}},public(e){let t=e.export({type:"spki",format:"der"}),r=Ee.get("PublicKeyInfo"),{publicKey:{data:n},algorithm:{parameters:{value:i}}}=r.decode(t),s=n.slice(1,(n.length-1)/2+1),o=n.slice((n.length-1)/2+1);return{kty:"EC",crv:i,x:B.encodeBuffer(s),y:B.encodeBuffer(o)}}},ed25519:{private(e){return Ot.private("Ed25519",e)},public(e){return Ot.public("Ed25519",e)}},ed448:{private(e){return Ot.private("Ed448",e)},public(e){return Ot.public("Ed448",e)}},x25519:{private(e){return Ot.private("X25519",e)},public(e){return Ot.public("X25519",e)}},x448:{private(e){return Ot.private("X448",e)},public(e){return Ot.public("X448",e)}}};yu.exports.keyObjectToJWK=e=>e.type==="private"?pu[e.asymmetricKeyType].private(e):pu[e.asymmetricKeyType].public(e);var vg=(e,t)=>({unused:0,data:Buffer.concat([Buffer.alloc(1,4),B.decodeToBuffer(e),B.decodeToBuffer(t)])}),Sg={RSA:{private(e,{calculateMissingRSAPrimes:t}){let r=Ee.get("RSAPrivateKey");if("oth"in e)throw new Qt.JOSENotSupported("Private RSA keys with more than two primes are not supported");if(e.p||e.q||e.dp||e.dq||e.qi){if(!(e.p&&e.q&&e.dp&&e.dq&&e.qi))throw new Qt.JWKInvalid("all other private key parameters must be present when any one of them is present")}else if(t)e=JR(e);else if(!t)throw new Qt.JOSENotSupported("importing private RSA keys without all other private key parameters is not enabled, see documentation and its advisory on how and when its ok to enable it");return r.encode({version:0,n:BigInt(`0x${B.decodeToBuffer(e.n).toString("hex")}`),e:BigInt(`0x${B.decodeToBuffer(e.e).toString("hex")}`),d:BigInt(`0x${B.decodeToBuffer(e.d).toString("hex")}`),p:BigInt(`0x${B.decodeToBuffer(e.p).toString("hex")}`),q:BigInt(`0x${B.decodeToBuffer(e.q).toString("hex")}`),dp:BigInt(`0x${B.decodeToBuffer(e.dp).toString("hex")}`),dq:BigInt(`0x${B.decodeToBuffer(e.dq).toString("hex")}`),qi:BigInt(`0x${B.decodeToBuffer(e.qi).toString("hex")}`)},"pem",{label:"RSA PRIVATE KEY"})},public(e){return Ee.get("RSAPublicKey").encode({version:0,n:BigInt(`0x${B.decodeToBuffer(e.n).toString("hex")}`),e:BigInt(`0x${B.decodeToBuffer(e.e).toString("hex")}`)},"pem",{label:"RSA PUBLIC KEY"})}},EC:{private(e){return Ee.get("ECPrivateKey").encode({version:1,privateKey:B.decodeToBuffer(e.d),parameters:{type:"namedCurve",value:e.crv},publicKey:vg(e.x,e.y)},"pem",{label:"EC PRIVATE KEY"})},public(e){return Ee.get("PublicKeyInfo").encode({algorithm:{algorithm:"ecPublicKey",parameters:{type:"namedCurve",value:e.crv}},publicKey:vg(e.x,e.y)},"pem",{label:"PUBLIC KEY"})}},OKP:{private(e){let r=Ee.get("OneAsymmetricKey").encode({version:0,privateKey:{privateKey:B.decodeToBuffer(e.d)},algorithm:{algorithm:e.crv}},"der");return r.write("04",12,1,"hex"),UR(r.toString("base64"),"PRIVATE")},public(e){return Ee.get("PublicKeyInfo").encode({algorithm:{algorithm:e.crv},publicKey:{unused:0,data:B.decodeToBuffer(e.x)}},"pem",{label:"PUBLIC KEY"})}}};yu.exports.jwkToPem=(e,{calculateMissingRSAPrimes:t=!1}={})=>{switch(e.kty){case"EC":if(!$R.has(e.crv))throw new Qt.JOSENotSupported(`unsupported EC key curve: ${e.crv}`);break;case"OKP":if(!LR.has(e.crv))throw new Qt.JOSENotSupported(`unsupported OKP key curve: ${e.crv}`);break;case"RSA":break;default:throw new Qt.JOSENotSupported(`unsupported key type: ${e.kty}`)}return e.d?Sg[e.kty].private(e,{calculateMissingRSAPrimes:t}):Sg[e.kty].public(e)}});var Og=h((N9,Ys)=>{var{createHash:Tg}=g("crypto"),Ag=we(),qg=(e,t)=>Ag.encodeBuffer(Tg(e).update(Buffer.from(t,"base64")).digest());Ys.exports.kid=e=>Ag.encodeBuffer(Tg("sha256").update(JSON.stringify(e)).digest());Ys.exports.x5t=qg.bind(void 0,"sha1");Ys.exports["x5t#S256"]=qg.bind(void 0,"sha256")});var Et=h((j9,Ig)=>{var{strict:WR}=g("assert"),{inspect:kg}=g("util"),{EOL:gu}=g("os"),{keyObjectSupported:Cg}=Pe(),{createPublicKey:_u}=se(),{keyObjectToJWK:HR}=mu(),{THUMBPRINT_MATERIAL:Pg,PUBLIC_MEMBERS:ii,PRIVATE_MEMBERS:wu,JWK_MEMBERS:FR,KEYOBJECT:si,USES_MAPPING:Rg,OPS:GR,USES:zR}=X(),YR=De(),bu=Og(),Vs=L(),Kg=Symbol("privateApi"),{JWK:VR}=_t(),Eu=class{constructor(t,{alg:r,use:n,kid:i,key_ops:s,x5c:o,x5t:c,"x5t#S256":a}={}){if(n!==void 0&&(typeof n!="string"||!zR.has(n)))throw new TypeError('`use` must be either "sig" or "enc" string when provided');if(r!==void 0&&(typeof r!="string"||!r))throw new TypeError("`alg` must be a non-empty string when provided");if(i!==void 0&&(typeof i!="string"||!i))throw new TypeError("`kid` must be a non-empty string when provided");if(s!==void 0){if(!Array.isArray(s)||!s.length||s.some(l=>typeof l!="string"))throw new TypeError("`key_ops` must be a non-empty array of strings when provided");s=Array.from(new Set(s)).filter(l=>GR.has(l))}if(s&&n&&(n==="enc"&&s.some(l=>Rg.sig.has(l))||n==="sig"&&s.some(l=>Rg.enc.has(l))))throw new Vs.JWKInvalid('inconsistent JWK "use" and "key_ops"');if(Cg&&o!==void 0){if(!Array.isArray(o)||!o.length||o.some(l=>typeof l!="string"))throw new TypeError("`x5c` must be an array of one or more PKIX certificates when provided");o.forEach((l,f)=>{let u;try{u=_u({key:`-----BEGIN CERTIFICATE-----${gu}${(l.match(/.{1,64}/g)||[]).join(gu)}${gu}-----END CERTIFICATE-----`,format:"pem"})}catch{throw new Vs.JWKInvalid(`\`x5c\` member at index ${f} is not a valid base64-encoded DER PKIX certificate`)}if(f===0)try{WR.deepEqual(u.export({type:"spki",format:"der"}),(t.type==="public"?t:_u(t)).export({type:"spki",format:"der"}))}catch{throw new Vs.JWKInvalid("The key in the first `x5c` certificate MUST match the public key represented by the JWK")}})}Object.defineProperties(this,{[si]:{value:YR(t)?void 0:t},keyObject:{get(){if(!Cg)throw new Vs.JOSENotSupported("KeyObject class is not supported in your Node.js runtime version");return this[si]}},type:{value:t.type},private:{value:t.type==="private"},public:{value:t.type==="public"},secret:{value:t.type==="secret"},alg:{value:r,enumerable:r!==void 0},use:{value:n,enumerable:n!==void 0},x5c:{enumerable:o!==void 0,...o?{get(){return[...o]}}:{value:void 0}},key_ops:{enumerable:s!==void 0,...s?{get(){return[...s]}}:{value:void 0}},kid:{enumerable:!0,...i?{value:i}:{get(){return Object.defineProperty(this,"kid",{value:this.thumbprint,configurable:!1}),this.kid},configurable:!0}},...o?{x5t:{enumerable:!0,...c?{value:c}:{get(){return Object.defineProperty(this,"x5t",{value:bu.x5t(this.x5c[0]),configurable:!1}),this.x5t},configurable:!0}}}:void 0,...o?{"x5t#S256":{enumerable:!0,...a?{value:a}:{get(){return Object.defineProperty(this,"x5t#S256",{value:bu["x5t#S256"](this.x5c[0]),configurable:!1}),this["x5t#S256"]},configurable:!0}}}:void 0,thumbprint:{get(){return Object.defineProperty(this,"thumbprint",{value:bu.kid(this[Pg]()),configurable:!1}),this.thumbprint},configurable:!0}})}toPEM(t=!1,r={}){if(this.secret)throw new TypeError("symmetric keys cannot be exported as PEM");if(t&&this.public===!0)throw new TypeError("public key cannot be exported as private");let{type:n=t?"pkcs8":"spki",cipher:i,passphrase:s}=r,o=this[si];if(!t&&(this.private&&(o=_u(o)),i||s))throw new TypeError("cipher and passphrase can only be applied when exporting private keys");return t?o.export({format:"pem",type:n,cipher:i,passphrase:s}):o.export({format:"pem",type:n})}toJWK(t=!1){if(t&&this.public===!0)throw new TypeError("public key cannot be exported as private");let r=[...this.constructor[t?wu:ii]].map(i=>[i,this[i]]),n={};return Object.keys(r).forEach(i=>{let[s,o]=r[i];n[s]=o}),n.kty=this.kty,n.kid=this.kid,this.alg&&(n.alg=this.alg),this.key_ops&&this.key_ops.length&&(n.key_ops=this.key_ops),this.use&&(n.use=this.use),this.x5c&&(n.x5c=this.x5c),this.x5t&&(n.x5t=this.x5t),this["x5t#S256"]&&(n["x5t#S256"]=this["x5t#S256"]),n}[FR](){let t=this[si].type==="private"?this.constructor[wu]:this.constructor[ii];Object.defineProperties(this,[...t].reduce((r,n)=>(r[n]={get(){let i=HR(this[si]);return Object.defineProperties(this,Object.entries(i).filter(([s])=>t.has(s)).reduce((s,[o,c])=>(s[o]={value:c,enumerable:this.constructor[ii].has(o),configurable:!1},s),{})),this[n]},enumerable:this.constructor[ii].has(n),configurable:!0},r),{}))}[kg.custom](){return`${this.constructor.name} ${kg(this.toJWK(!1),{depth:1/0,colors:process.stdout.isTTY,compact:!1,sorted:!0})}`}[Pg](){throw new Error(`"[THUMBPRINT_MATERIAL]()" is not implemented on ${this.constructor.name}`)}algorithms(t,r,n){let{use:i=this.use,alg:s=this.alg,key_ops:o=this.key_ops}=r===Kg?n:{};if(s)return new Set(this.algorithms(t,Kg,{alg:null,use:i,key_ops:o}).has(s)?[s]:void 0);if(typeof t=="symbol")try{return this[t]()}catch{return new Set}if(t&&o&&!o.includes(t))return new Set;switch(t){case"decrypt":case"deriveKey":case"encrypt":case"sign":case"unwrapKey":case"verify":case"wrapKey":return new Set(Object.entries(VR[this.kty][t]).map(([c,a])=>a(this)?c:void 0).filter(Boolean));case void 0:return new Set([...this.algorithms("sign"),...this.algorithms("verify"),...this.algorithms("decrypt"),...this.algorithms("encrypt"),...this.algorithms("unwrapKey"),...this.algorithms("wrapKey"),...this.algorithms("deriveKey")]);default:throw new TypeError("invalid key operation")}}static async generate(){throw new Error(`"static async generate()" is not implemented on ${this.name}`)}static generateSync(){throw new Error(`"static generateSync()" is not implemented on ${this.name}`)}static get[ii](){throw new Error(`"static get [PUBLIC_MEMBERS]()" is not implemented on ${this.name}`)}static get[wu](){throw new Error(`"static get [PRIVATE_MEMBERS]()" is not implemented on ${this.name}`)}};Ig.exports=Eu});var xu=h((M9,Lg)=>{var{generateKeyPairSync:Bg,generateKeyPair:XR}=g("crypto"),{promisify:QR}=g("util"),{THUMBPRINT_MATERIAL:ZR,JWK_MEMBERS:eK,PUBLIC_MEMBERS:tK,PRIVATE_MEMBERS:rK,KEY_MANAGEMENT_DECRYPT:nK,KEY_MANAGEMENT_ENCRYPT:iK}=X(),{keyObjectSupported:Ng}=Pe(),{createPublicKey:jg,createPrivateKey:Mg}=se(),sK=Et(),Dg=QR(XR),Su=new Set(["e","n"]);Object.freeze(Su);var Jg=new Set([...Su,"d","p","q","dp","dq","qi"]);Object.freeze(Jg);var vu=class extends sK{constructor(...t){super(...t),this[eK](),Object.defineProperties(this,{kty:{value:"RSA",enumerable:!0},length:{get(){return Object.defineProperty(this,"length",{value:Buffer.byteLength(this.n,"base64")*8,configurable:!1}),this.length},configurable:!0}})}static get[tK](){return Su}static get[rK](){return Jg}[ZR](){return{e:this.e,kty:"RSA",n:this.n}}[iK](){return this.algorithms("wrapKey")}[nK](){return this.algorithms("unwrapKey")}static async generate(t=2048,r=!0){if(!Number.isSafeInteger(t)||t<512||t%8!==0||"electron"in process.versions&&t%128!==0)throw new TypeError("invalid bit length");let n,i;return Ng?({privateKey:n,publicKey:i}=await Dg("rsa",{modulusLength:t}),r?n:i):({privateKey:n,publicKey:i}=await Dg("rsa",{modulusLength:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}}),r?Mg(n):jg(i))}static generateSync(t=2048,r=!0){if(!Number.isSafeInteger(t)||t<512||t%8!==0||"electron"in process.versions&&t%128!==0)throw new TypeError("invalid bit length");let n,i;return Ng?({privateKey:n,publicKey:i}=Bg("rsa",{modulusLength:t}),r?n:i):({privateKey:n,publicKey:i}=Bg("rsa",{modulusLength:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}}),r?Mg(n):jg(i))}};Lg.exports=vu});var ku=h((D9,Yg)=>{var{generateKeyPairSync:$g,generateKeyPair:oK}=g("crypto"),{promisify:cK}=g("util"),{THUMBPRINT_MATERIAL:aK,JWK_MEMBERS:uK,PUBLIC_MEMBERS:lK,PRIVATE_MEMBERS:fK,KEY_MANAGEMENT_DECRYPT:dK,KEY_MANAGEMENT_ENCRYPT:hK}=X(),{EC_CURVES:Tu}=_t(),{keyObjectSupported:Ug}=Pe(),{createPublicKey:Wg,createPrivateKey:Hg}=se(),Au=L(),{name:Fg}=gr(),pK=Et(),Gg=cK(oK),Ou=new Set(["crv","x","y"]);Object.freeze(Ou);var zg=new Set([...Ou,"d"]);Object.freeze(zg);var qu=class extends pK{constructor(...t){if(super(...t),this[uK](),Object.defineProperty(this,"kty",{value:"EC",enumerable:!0}),!Tu.has(this.crv))throw new Au.JOSENotSupported("unsupported EC key curve")}static get[lK](){return Ou}static get[fK](){return zg}[aK](){return{crv:this.crv,kty:"EC",x:this.x,y:this.y}}[hK](){return this.algorithms("deriveKey")}[dK](){return this.public?new Set:this.algorithms("deriveKey")}static async generate(t="P-256",r=!0){if(!Tu.has(t))throw new Au.JOSENotSupported(`unsupported EC key curve: ${t}`);t===Fg&&t!=="secp256k1"&&(t="secp256k1");let n,i;return Ug?({privateKey:n,publicKey:i}=await Gg("ec",{namedCurve:t}),r?n:i):({privateKey:n,publicKey:i}=await Gg("ec",{namedCurve:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}}),r?Hg(n):Wg(i))}static generateSync(t="P-256",r=!0){if(!Tu.has(t))throw new Au.JOSENotSupported(`unsupported EC key curve: ${t}`);t===Fg&&t!=="secp256k1"&&(t="secp256k1");let n,i;return Ug?({privateKey:n,publicKey:i}=$g("ec",{namedCurve:t}),r?n:i):({privateKey:n,publicKey:i}=$g("ec",{namedCurve:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}}),r?Hg(n):Wg(i))}};Yg.exports=qu});var Ku=h((J9,Qg)=>{var{generateKeyPairSync:yK,generateKeyPair:mK}=g("crypto"),{promisify:gK}=g("util"),{THUMBPRINT_MATERIAL:_K,JWK_MEMBERS:wK,PUBLIC_MEMBERS:bK,PRIVATE_MEMBERS:EK,KEY_MANAGEMENT_DECRYPT:vK,KEY_MANAGEMENT_ENCRYPT:SK}=X(),{OKP_CURVES:Cu}=_t(),{edDSASupported:Vg}=Pe(),oi=L(),xK=Et(),TK=gK(mK),Ru=new Set(["crv","x"]);Object.freeze(Ru);var Xg=new Set([...Ru,"d"]);Object.freeze(Xg);var Pu=class extends xK{constructor(...t){if(super(...t),this[wK](),Object.defineProperty(this,"kty",{value:"OKP",enumerable:!0}),!Cu.has(this.crv))throw new oi.JOSENotSupported("unsupported OKP key curve")}static get[bK](){return Ru}static get[EK](){return Xg}[_K](){return{crv:this.crv,kty:"OKP",x:this.x}}[SK](){return this.algorithms("deriveKey")}[vK](){return this.public?new Set:this.algorithms("deriveKey")}static async generate(t="Ed25519",r=!0){if(!Vg)throw new oi.JOSENotSupported("OKP keys are not supported in your Node.js runtime version");if(!Cu.has(t))throw new oi.JOSENotSupported(`unsupported OKP key curve: ${t}`);let{privateKey:n,publicKey:i}=await TK(t.toLowerCase());return r?n:i}static generateSync(t="Ed25519",r=!0){if(!Vg)throw new oi.JOSENotSupported("OKP keys are not supported in your Node.js runtime version");if(!Cu.has(t))throw new oi.JOSENotSupported(`unsupported OKP key curve: ${t}`);let{privateKey:n,publicKey:i}=yK(t.toLowerCase());return r?n:i}};Qg.exports=Pu});var Xs=h((L9,n_)=>{var{randomBytes:AK}=g("crypto"),{createSecretKey:qK}=se(),OK=we(),{THUMBPRINT_MATERIAL:kK,PUBLIC_MEMBERS:CK,PRIVATE_MEMBERS:PK,KEY_MANAGEMENT_DECRYPT:RK,KEY_MANAGEMENT_ENCRYPT:Zg,KEYOBJECT:ln}=X(),e_=Et(),t_=new Set;Object.freeze(t_);var r_=new Set(["k"]);Object.freeze(r_);var Iu=class extends e_{constructor(...t){super(...t),Object.defineProperties(this,{kty:{value:"oct",enumerable:!0},length:{value:this[ln]?this[ln].symmetricKeySize*8:void 0},k:{enumerable:!1,get(){return this[ln]?Object.defineProperty(this,"k",{value:OK.encodeBuffer(this[ln].export()),configurable:!1}):Object.defineProperty(this,"k",{value:void 0,configurable:!1}),this.k},configurable:!0}})}static get[CK](){return t_}static get[PK](){return r_}[kK](){if(!this[ln])throw new TypeError('reference "oct" keys without "k" cannot have their thumbprint calculated');return{k:this.k,kty:"oct"}}[Zg](){return new Set([...this.algorithms("wrapKey"),...this.algorithms("deriveKey")])}[RK](){return this[Zg]()}algorithms(...t){return this[ln]?e_.prototype.algorithms.call(this,...t):new Set}static async generate(...t){return this.generateSync(...t)}static generateSync(t=256,r=!0){if(!r)throw new TypeError('"oct" keys cannot be generated as public');if(!Number.isSafeInteger(t)||!t||t%8!==0)throw new TypeError("invalid bit length");return qK(AK(t/8))}};n_.exports=Iu});var fn=h(($9,c_)=>{var{deprecate:KK}=g("util"),{createPublicKey:i_,createPrivateKey:s_,createSecretKey:o_,KeyObject:IK}=se(),BK=we(),NK=De(),{jwkToPem:jK}=mu(),ci=L(),MK=xu(),DK=ku(),JK=Ku(),LK=Xs(),$K=new Set(["string","buffer","object"]),Bu=(e={},t={})=>({alg:t.alg,key_ops:t.key_ops,kid:t.kid,use:t.use,x5c:t.x5c,x5t:t.x5t,"x5t#S256":t["x5t#S256"],...e}),UK=/^[a-zA-Z0-9-]+ AAAA(?:[0-9A-Za-z+/])+(?:==|=)?(?: .*)?$/,Nu=(e,t,{calculateMissingRSAPrimes:r=!1}={})=>{let n,i,s;if(!$K.has(typeof e))throw new TypeError("key argument must be a string, buffer or an object");if(t!==void 0&&!NK(t))throw new TypeError("parameters argument must be a plain object when provided");if(e instanceof IK)switch(e.type){case"private":n=e;break;case"public":i=e;break;case"secret":s=e;break}else if(typeof e=="object"&&e&&"kty"in e&&e.kty==="oct"){try{s=o_(BK.decodeToBuffer(e.k))}catch{"k"in e||(s={type:"secret"})}t=Bu(t,e)}else if(typeof e=="object"&&e&&"kty"in e){({calculateMissingRSAPrimes:r=!1}=t||{calculateMissingRSAPrimes:r});let c;try{c=jK(e,{calculateMissingRSAPrimes:r})}catch(a){if(a instanceof ci.JOSEError)throw a}c&&e.d?n=s_(c):c&&(i=i_(c)),t=Bu({},e)}else if(e&&(typeof e=="object"||typeof e=="string")){try{n=s_(e)}catch(c){if(c instanceof ci.JOSEError)throw c}try{i=i_(e),e.startsWith("-----BEGIN CERTIFICATE-----")&&(!t||!("x5c"in t))&&(t=Bu(t,{x5c:[e.replace(/(?:-----(?:BEGIN|END) CERTIFICATE-----|\s)/g,"")]}))}catch(c){if(c instanceof ci.JOSEError)throw c}try{!e.includes("-----BEGIN")&&!UK.test(e.toString("ascii").replace(/[\r\n]/g,""))&&(s=o_(Buffer.isBuffer(e)?e:Buffer.from(e)))}catch{}}let o=n||i||s;if(n||i)switch(o.asymmetricKeyType){case"rsa":return new MK(o,t);case"ec":return new DK(o,t);case"ed25519":case"ed448":case"x25519":case"x448":return new JK(o,t);default:throw new ci.JOSENotSupported("only RSA, EC and OKP asymmetric keys are supported")}else if(s)return new LK(o,t);throw new ci.JWKImportFailed("key import failed")};c_.exports=Nu;Object.defineProperty(Nu,"deprecated",{value:KK((e,t)=>Nu(e,t,{calculateMissingRSAPrimes:!0}),"JWK.importKey() is deprecated, use JWK.asKey() instead"),enumerable:!1})});var ai=h((U9,ju)=>{var a_=L(),Zt=fn(),u_=xu(),l_=ku(),f_=Ku(),d_=Xs(),WK=async(e,t,r,n=!0)=>{switch(e){case"RSA":return Zt(await u_.generate(t,n),r);case"EC":return Zt(await l_.generate(t,n),r);case"OKP":return Zt(await f_.generate(t,n),r);case"oct":return Zt(await d_.generate(t,n),r);default:throw new a_.JOSENotSupported(`unsupported key type: ${e}`)}},HK=(e,t,r,n=!0)=>{switch(e){case"RSA":return Zt(u_.generateSync(t,n),r);case"EC":return Zt(l_.generateSync(t,n),r);case"OKP":return Zt(f_.generateSync(t,n),r);case"oct":return Zt(d_.generateSync(t,n),r);default:throw new a_.JOSENotSupported(`unsupported key type: ${e}`)}};ju.exports.generate=WK;ju.exports.generateSync=HK});var p_=h((W9,h_)=>{var{inspect:FK}=g("util"),GK=Et(),Mu=class extends GK{constructor(){super({type:"unsecured"},{alg:"none"}),Object.defineProperties(this,{kid:{value:void 0},kty:{value:void 0},thumbprint:{value:void 0},toJWK:{value:void 0},toPEM:{value:void 0}})}[FK.custom](){return"None {}"}algorithms(t){switch(t){case"sign":case"verify":case void 0:return new Set(["none"]);default:return new Set}}};h_.exports=new Mu});var m_=h((H9,y_)=>{var{inspect:zK}=g("util"),YK=Et(),Du=class extends YK{constructor(){super({type:"embedded"}),Object.defineProperties(this,{kid:{value:void 0},kty:{value:void 0},thumbprint:{value:void 0},toJWK:{value:void 0},toPEM:{value:void 0}})}[zK.custom](){return"Embedded.JWK {}"}algorithms(){return new Set}};y_.exports=new Du});var __=h((F9,g_)=>{var{inspect:VK}=g("util"),XK=Et(),Ju=class extends XK{constructor(){super({type:"embedded"}),Object.defineProperties(this,{kid:{value:void 0},kty:{value:void 0},thumbprint:{value:void 0},toJWK:{value:void 0},toPEM:{value:void 0}})}[VK.custom](){return"Embedded.X5C {}"}algorithms(){return new Set}};g_.exports=new Ju});var ui=h((G9,Lu)=>{var QK=Et(),ZK=p_(),eI=m_(),tI=__(),w_=fn(),rI=ai();Lu.exports={...rI,asKey:w_,isKey:e=>e instanceof QK,None:ZK,EmbeddedJWK:eI,EmbeddedX5C:tI};Object.defineProperty(Lu.exports,"importKey",{value:w_.deprecated,enumerable:!1})});var Uu=h((z9,x_)=>{var{deprecate:nI,inspect:b_}=g("util"),E_=De(),{generate:iI,generateSync:sI}=ai(),{USES_MAPPING:oI}=X(),{isKey:$u,asKey:cI}=ui(),v_=(e,{alg:t,use:r,ops:n})=>{let i=0;return t&&e.alg&&i++,r&&e.use&&i++,n&&e.key_ops&&i++,i},li=class{constructor(...t){for(;t.some(Array.isArray);)t=t.flat?t.flat():t.reduce((r,n)=>Array.isArray(n)?[...r,...n]:(r.push(n),r),[]);if(t.some(r=>!$u(r)||!r.kty))throw new TypeError("all keys must be instances of a key instantiated by JWK.asKey");this._keys=new Set(t)}all({alg:t,kid:r,thumbprint:n,use:i,kty:s,key_ops:o,x5t:c,"x5t#S256":a,crv:l}={}){if(o!==void 0&&(!Array.isArray(o)||!o.length||o.some(u=>typeof u!="string")))throw new TypeError("`key_ops` must be a non-empty array of strings");let f={alg:t,use:i,ops:o};return[...this._keys].filter(u=>{let d=!0;if(d&&r!==void 0&&u.kid!==r&&(d=!1),d&&n!==void 0&&u.thumbprint!==n&&(d=!1),d&&c!==void 0&&u.x5t!==c&&(d=!1),d&&a!==void 0&&u["x5t#S256"]!==a&&(d=!1),d&&s!==void 0&&u.kty!==s&&(d=!1),d&&l!==void 0&&u.crv!==l&&(d=!1),t!==void 0&&!u.algorithms().has(t)&&(d=!1),d&&i!==void 0&&u.use!==void 0&&u.use!==i&&(d=!1),d&&o!==void 0&&(u.key_ops!==void 0||u.use!==void 0)){let p;u.key_ops?p=new Set(u.key_ops):p=oI[u.use],o.some(m=>!p.has(m))&&(d=!1)}return d}).sort((u,d)=>v_(d,f)-v_(u,f))}get(...t){return this.all(...t)[0]}add(t){if(!$u(t)||!t.kty)throw new TypeError("key must be an instance of a key instantiated by JWK.asKey");this._keys.add(t)}remove(t){if(!$u(t))throw new TypeError("key must be an instance of a key instantiated by JWK.asKey");this._keys.delete(t)}toJWKS(t=!1){return{keys:[...this._keys.values()].map(r=>r.toJWK(t&&(r.private||r.secret&&r.k)))}}async generate(...t){this._keys.add(await iI(...t))}generateSync(...t){this._keys.add(sI(...t))}get size(){return this._keys.size}[b_.custom](){return`${this.constructor.name} ${b_(this.toJWKS(!1),{depth:1/0,colors:process.stdout.isTTY,compact:!1,sorted:!0})}`}*[Symbol.iterator](){for(let t of this._keys)yield t}};function S_(e,{ignoreErrors:t=!1,calculateMissingRSAPrimes:r=!1}={}){if(!E_(e)||!Array.isArray(e.keys)||e.keys.some(i=>!E_(i)||!("kty"in i)))throw new TypeError("jwks must be a JSON Web Key Set formatted object");let n=e.keys.map(i=>{try{return cI(i,{calculateMissingRSAPrimes:r})}catch(s){if(!t)throw s}}).filter(Boolean);return new li(...n)}Object.defineProperty(li,"fromJWKS",{value:nI(e=>S_(e,{calculateMissingRSAPrimes:!0}),"JWKS.KeyStore.fromJWKS() is deprecated, use JWKS.asKeyStore() instead"),enumerable:!1});x_.exports={KeyStore:li,asKeyStore:S_}});var br=h((Y9,A_)=>{var T_=L(),aI=Et(),uI=fn(),{KeyStore:lI}=Uu();A_.exports=(e,t=!1)=>{if(e instanceof aI)return e;if(e instanceof lI){if(!t)throw new TypeError("key argument for this operation must not be a JWKS.KeyStore instance");return e}try{return uI(e)}catch(r){if(r instanceof T_.JOSEError&&!(r instanceof T_.JWKImportFailed))throw r;let n;throw t?n="key must be an instance of a key instantiated by JWK.asKey, a valid JWK.asKey input, or a JWKS.KeyStore instance":n="key must be an instance of a key instantiated by JWK.asKey, or a valid JWK.asKey input",new TypeError(n)}}});var Wu=h((V9,q_)=>{q_.exports=e=>JSON.parse(JSON.stringify(e))});var Hu=h((X9,k_)=>{var{timingSafeEqual:fI}=g("crypto"),O_=(e,t)=>{if(e.length===t)return e;let r=Buffer.alloc(t);return e.copy(r),r},dI=(e,t)=>{let r=Math.max(e.length,t.length);return fI(O_(e,r),O_(t,r))};k_.exports=dI});var fi=h((Q9,C_)=>{C_.exports=e=>`sha${e.substr(2,3)}`});var K_=h((Z9,R_)=>{var{createHmac:hI}=g("crypto"),{KEYOBJECT:pI}=X(),yI=Hu(),mI=fi(),{asInput:gI}=se(),P_=(e,t,{[pI]:r},n)=>{let i=hI(t,gI(r,!1));return i.update(n),i.digest()},_I=(e,t,r,n,i)=>{let s=P_(e,t,r,n);return yI(i,s)};R_.exports=(e,t)=>{["HS256","HS384","HS512"].forEach(r=>{let n=mI(r);e.sign.set(r,P_.bind(void 0,r,n)),e.verify.set(r,_I.bind(void 0,r,n)),t.oct.sign[r]=t.oct.verify[r]=i=>i.use==="sig"||i.use===void 0})}});var B_=h((eY,Fu)=>{var Qs=e=>(e/8|0)+(e%8===0?0:1),Zs={ES256:Qs(256),ES256K:Qs(256),ES384:Qs(384),ES512:Qs(521)},I_=(e,t,r)=>{let n=0;for(;t+n<r&&e[t+n]===0;)++n;return e[t+n]>=128&&--n,n};Fu.exports.derToJose=(e,t)=>{if(!Buffer.isBuffer(e))throw new TypeError("ECDSA signature must be a Buffer");if(!Zs[t])throw new Error(`Unknown algorithm "${t}"`);let r=Zs[t],n=r+1,i=e.length,s=0;if(e[s++]!==48)throw new Error('Could not find expected "seq"');let o=e[s++];if(o===129&&(o=e[s++]),i-s<o)throw new Error(`"seq" specified length of ${o}", only ${i-s}" remaining`);if(e[s++]!==2)throw new Error('Could not find expected "int" for "r"');let c=e[s++];if(i-s-2<c)throw new Error(`"r" specified length of "${c}", only "${i-s-2}" available`);if(n<c)throw new Error(`"r" specified length of "${c}", max of "${n}" is acceptable`);let a=s;if(s+=c,e[s++]!==2)throw new Error('Could not find expected "int" for "s"');let l=e[s++];if(i-s!==l)throw new Error(`"s" specified length of "${l}", expected "${i-s}"`);if(n<l)throw new Error(`"s" specified length of "${l}", max of "${n}" is acceptable`);let f=s;if(s+=l,s!==i)throw new Error(`Expected to consume entire buffer, but "${i-s}" bytes remain`);let u=r-c,d=r-l,p=Buffer.allocUnsafe(u+c+d+l);for(s=0;s<u;++s)p[s]=0;e.copy(p,s,a+Math.max(-u,0),a+c),s=r;for(let m=s;s<m+d;++s)p[s]=0;return e.copy(p,s,f+Math.max(-d,0),f+l),p};Fu.exports.joseToDer=(e,t)=>{if(!Buffer.isBuffer(e))throw new TypeError("ECDSA signature must be a Buffer");if(!Zs[t])throw new TypeError(`Unknown algorithm "${t}"`);let r=Zs[t],n=e.length;if(n!==r*2)throw new Error(`"${t}" signatures must be "${r*2}" bytes, saw "${n}"`);let i=I_(e,0,r),s=I_(e,r,e.length),o=r-i,c=r-s,a=1+1+o+1+1+c,l=a<128,f=Buffer.allocUnsafe((l?2:3)+a),u=0;return f[u++]=48,l?f[u++]=a:(f[u++]=129,f[u++]=a&255),f[u++]=2,f[u++]=o,i<0?(f[u++]=0,u+=e.copy(f,u,0,r)):u+=e.copy(f,u,i,r),f[u++]=2,f[u++]=c,s<0?(f[u++]=0,e.copy(f,u,r)):e.copy(f,u,r+s),f}});var j_=h((tY,N_)=>{var{sign:wI,verify:bI,createSign:EI,createVerify:vI,getCurves:eo}=g("crypto"),{derToJose:SI,joseToDer:xI}=B_(),{KEYOBJECT:to}=X(),TI=fi(),{asInput:ro}=se(),{dsaEncodingSupported:AI}=Pe(),{name:qI}=gr(),Gu,zu;AI?(Gu=(e,t,{[to]:r},n)=>(typeof n=="string"&&(n=Buffer.from(n)),wI(t,n,{key:ro(r,!1),dsaEncoding:"ieee-p1363"})),zu=(e,t,{[to]:r},n,i)=>{try{return bI(t,n,{key:ro(r,!0),dsaEncoding:"ieee-p1363"},i)}catch{return!1}}):(Gu=(e,t,{[to]:r},n)=>SI(EI(t).update(n).sign(ro(r,!1)),e),zu=(e,t,{[to]:r},n,i)=>{try{return vI(t).update(n).verify(ro(r,!0),xI(i,e))}catch{return!1}});var OI=e=>{switch(e){case"P-256":return"ES256";case qI:return"ES256K";case"P-384":return"ES384";case"P-521":return"ES512"}};N_.exports=(e,t)=>{let r=[];eo().includes("prime256v1")&&r.push("ES256"),eo().includes("secp256k1")&&r.push("ES256K"),eo().includes("secp384r1")&&r.push("ES384"),eo().includes("secp521r1")&&r.push("ES512"),r.forEach(n=>{let i=TI(n);e.sign.set(n,Gu.bind(void 0,n,i)),e.verify.set(n,zu.bind(void 0,n,i)),t.EC.sign[n]=s=>s.private&&t.EC.verify[n](s),t.EC.verify[n]=s=>(s.use==="sig"||s.use===void 0)&&OI(s.crv)===n})}});var J_=h((rY,D_)=>{var{sign:kI,verify:CI}=g("crypto"),{KEYOBJECT:M_}=X(),{edDSASupported:PI}=Pe(),RI=({[M_]:e},t)=>(typeof t=="string"&&(t=Buffer.from(t)),kI(void 0,t,e)),KI=({[M_]:e},t,r)=>CI(void 0,t,e,r);D_.exports=(e,t)=>{PI&&(e.sign.set("EdDSA",RI),e.verify.set("EdDSA",KI),t.OKP.sign.EdDSA=r=>r.private&&t.OKP.verify.EdDSA(r),t.OKP.verify.EdDSA=r=>(r.use==="sig"||r.use===void 0)&&r.keyObject.asymmetricKeyType.startsWith("ed"))}});var W_=h((nY,U_)=>{var{createSign:II,createVerify:BI,constants:no}=g("crypto"),{KEYOBJECT:L_}=X(),NI=fi(),{asInput:$_}=se(),jI=(e,{[L_]:t},r)=>{let n=$_(t,!1);return II(e).update(r).sign({key:n,padding:no.RSA_PKCS1_PSS_PADDING,saltLength:no.RSA_PSS_SALTLEN_DIGEST})},MI=(e,{[L_]:t},r,n)=>{let i=$_(t,!0);return BI(e).update(r).verify({key:i,padding:no.RSA_PKCS1_PSS_PADDING,saltLength:no.RSA_PSS_SALTLEN_DIGEST},n)},DI={PS256:528,PS384:784,PS512:1040};U_.exports=(e,t)=>{["PS256","PS384","PS512"].forEach(r=>{let n=NI(r);e.sign.set(r,jI.bind(void 0,n)),e.verify.set(r,MI.bind(void 0,n)),t.RSA.sign[r]=i=>i.private&&t.RSA.verify[r](i),t.RSA.verify[r]=i=>(i.use==="sig"||i.use===void 0)&&i.length>=DI[r]})}});var z_=h((iY,G_)=>{var{createSign:JI,createVerify:LI}=g("crypto"),{KEYOBJECT:H_}=X(),$I=fi(),{asInput:F_}=se(),UI=(e,{[H_]:t},r)=>JI(e).update(r).sign(F_(t,!1)),WI=(e,{[H_]:t},r,n)=>LI(e).update(r).verify(F_(t,!0),n),HI={RS256:0,RS384:624,RS512:752};G_.exports=(e,t)=>{["RS256","RS384","RS512"].forEach(r=>{let n=$I(r);e.sign.set(r,UI.bind(void 0,n)),e.verify.set(r,WI.bind(void 0,n)),t.RSA.sign[r]=i=>i.private&&t.RSA.verify[r](i),t.RSA.verify[r]=i=>(i.use==="sig"||i.use===void 0)&&i.length>=HI[r]})}});var V_=h((sY,Y_)=>{var FI=()=>Buffer.from(""),GI=(e,t,r)=>!r.length;Y_.exports=(e,t)=>{e.sign.set("none",FI),e.verify.set("none",GI)}});var Z_=h((oY,Q_)=>{var X_=Math.pow(2,32);Q_.exports=(e,t=Buffer.allocUnsafe(8))=>{let r=Math.floor(e/X_),n=e%X_;return t.writeUInt32BE(r,0),t.writeUInt32BE(n,4),t}});var sw=h((cY,iw)=>{var{createCipheriv:zI,createDecipheriv:YI,getCiphers:VI}=g("crypto"),rw=Z_(),XI=Hu(),{KEYOBJECT:io}=X(),{JWEInvalid:ew,JWEDecryptionFailed:tw}=L(),nw=function(e,t,r){if(t.length!==16)throw new ew("invalid iv");if(arguments.length===3&&r.length!==e/8)throw new ew("invalid tag")},QI=(e,t,{[io]:r},n,{iv:i,aad:s=Buffer.alloc(0)})=>{let o=r.export();nw(e,i);let c=e/8,a=o.slice(c),l=zI(`aes-${e}-cbc`,a,i),f=Buffer.concat([l.update(n),l.final()]),u=Buffer.concat([s,i,f,rw(s.length*8)]),d=o.slice(0,c),p=t({[io]:d},u).slice(0,c);return{ciphertext:f,tag:p}},ZI=(e,t,{[io]:r},n,{iv:i,tag:s=Buffer.alloc(0),aad:o=Buffer.alloc(0)})=>{nw(e,i,s);let c=e/8,a=r.export(),l=a.slice(c),f=a.slice(0,c),u=Buffer.concat([o,i,n,rw(o.length*8)]),d=t({[io]:f},u,s).slice(0,c);if(!XI(s,d))throw new tw;let m;try{let y=YI(`aes-${e}-cbc`,l,i);m=Buffer.concat([y.update(n),y.final()])}catch{}if(!m)throw new tw;return m};iw.exports=(e,t)=>{["A128CBC-HS256","A192CBC-HS384","A256CBC-HS512"].forEach(r=>{let n=parseInt(r.substr(1,3),10),i=e.sign.get(`HS${n*2}`);VI().includes(`aes-${n}-cbc`)&&(e.encrypt.set(r,QI.bind(void 0,n,i)),e.decrypt.set(r,ZI.bind(void 0,n,i)),t.oct.encrypt[r]=t.oct.decrypt[r]=s=>(s.use==="enc"||s.use===void 0)&&s.length/2===n)})}});var fw=h((aY,lw)=>{var{createCipheriv:eB,createDecipheriv:tB,getCiphers:rB}=g("crypto"),{KEYOBJECT:cw}=X(),{JWEInvalid:ow,JWEDecryptionFailed:nB}=L(),{asInput:aw}=se(),uw=function(e,t,r){if(t.length!==12)throw new ow("invalid iv");if(arguments.length===3&&r.length!==16)throw new ow("invalid tag")},iB=(e,{[cw]:t},r,{iv:n,aad:i=Buffer.alloc(0)})=>{let s=aw(t,!1);uw(e,n);let o=eB(`aes-${e}-gcm`,s,n,{authTagLength:16});o.setAAD(i);let c=Buffer.concat([o.update(r),o.final()]),a=o.getAuthTag();return{ciphertext:c,tag:a}},sB=(e,{[cw]:t},r,{iv:n,tag:i=Buffer.alloc(0),aad:s=Buffer.alloc(0)})=>{let o=aw(t,!1);uw(e,n,i);try{let c=tB(`aes-${e}-gcm`,o,n,{authTagLength:16});return c.setAuthTag(i),c.setAAD(s),Buffer.concat([c.update(r),c.final()])}catch{throw new nB}};lw.exports=(e,t)=>{["A128GCM","A192GCM","A256GCM"].forEach(r=>{let n=parseInt(r.substr(1,3),10);rB().includes(`aes-${n}-gcm`)&&(e.encrypt.set(r,iB.bind(void 0,n)),e.decrypt.set(r,sB.bind(void 0,n)),t.oct.encrypt[r]=t.oct.decrypt[r]=i=>(i.use==="enc"||i.use===void 0)&&i.length===n)})}});var gw=h((uY,mw)=>{var{publicEncrypt:oB,privateDecrypt:cB,constants:dw}=g("crypto"),{oaepHashSupported:aB}=Pe(),{KEYOBJECT:pw}=X(),{asInput:yw}=se(),uB=e=>{switch(e){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return dw.RSA_PKCS1_OAEP_PADDING;case"RSA1_5":return dw.RSA_PKCS1_PADDING}},lB=e=>{switch(e){case"RSA-OAEP":return"sha1";case"RSA-OAEP-256":return"sha256";case"RSA-OAEP-384":return"sha384";case"RSA-OAEP-512":return"sha512";default:return}},fB=(e,t,{[pw]:r},n)=>{let i=yw(r,!0);return{wrapped:oB({key:i,oaepHash:t,padding:e},n)}},dB=(e,t,{[pw]:r},n)=>{let i=yw(r,!1);return cB({key:i,oaepHash:t,padding:e},n)},hw={RSA1_5:0,"RSA-OAEP":592,"RSA-OAEP-256":784,"RSA-OAEP-384":1040,"RSA-OAEP-512":1296};mw.exports=(e,t)=>{let r=["RSA-OAEP","RSA1_5"];aB&&r.splice(1,0,"RSA-OAEP-256","RSA-OAEP-384","RSA-OAEP-512"),r.forEach(n=>{let i=uB(n),s=lB(n);e.keyManagementEncrypt.set(n,fB.bind(void 0,i,s)),e.keyManagementDecrypt.set(n,dB.bind(void 0,i,s)),t.RSA.wrapKey[n]=o=>(o.use==="enc"||o.use===void 0)&&o.length>=hw[n],t.RSA.unwrapKey[n]=o=>o.private&&(o.use==="enc"||o.use===void 0)&&o.length>=hw[n]})}});var Ew=h((lY,bw)=>{var{createCipheriv:hB,createDecipheriv:pB,getCiphers:yB}=g("crypto"),{KEYOBJECT:_w}=X(),{asInput:ww}=se(),mB=e=>{if(e!==void 0&&e.length%8!==0)throw new Error("invalid data length")},gB=(e,{[_w]:t},r)=>{let n=ww(t,!1),i=hB(e,n,Buffer.alloc(8,"a6","hex"));return{wrapped:Buffer.concat([i.update(r),i.final()])}},_B=(e,{[_w]:t},r)=>{let n=ww(t,!1);mB(r);let i=pB(e,n,Buffer.alloc(8,"a6","hex"));return Buffer.concat([i.update(r),i.final()])};bw.exports=(e,t)=>{["A128KW","A192KW","A256KW"].forEach(r=>{let n=parseInt(r.substr(1,3),10),i=`aes${n}-wrap`;yB().includes(i)&&(e.keyManagementEncrypt.set(r,gB.bind(void 0,i)),e.keyManagementDecrypt.set(r,_B.bind(void 0,i)),t.oct.wrapKey[r]=t.oct.unwrapKey[r]=s=>(s.use==="enc"||s.use===void 0)&&s.length===n)})}});var xw=h((fY,Sw)=>{var wB=za(),vw=we();Sw.exports=(e,t)=>{["A128GCMKW","A192GCMKW","A256GCMKW"].forEach(r=>{let n=r.substr(0,7),i=parseInt(r.substr(1,3),10),s=e.encrypt.get(n),o=e.decrypt.get(n);s&&o&&(e.keyManagementEncrypt.set(r,(c,a)=>{let l=wB(r),{ciphertext:f,tag:u}=s(c,a,{iv:l});return{wrapped:f,header:{tag:vw.encodeBuffer(u),iv:vw.encodeBuffer(l)}}}),e.keyManagementDecrypt.set(r,o),t.oct.wrapKey[r]=t.oct.unwrapKey[r]=c=>(c.use==="enc"||c.use===void 0)&&c.length===i)})}});var Ow=h((dY,qw)=>{var{pbkdf2Sync:Aw,randomBytes:bB}=g("crypto"),{KEYOBJECT:so}=X(),EB=we(),vB=16,SB=Buffer.alloc(1,0),Tw=(e,t)=>Buffer.concat([Buffer.from(e,"utf8"),SB,t]),xB=(e,t,r,n,{[so]:i},s)=>{let o=Math.floor(Math.random()*2049+2048),c=bB(vB),a=r(c),l=Aw(i.export(),a,o,e,t),f=n({[so]:l},s);return f.header=f.header||{},Object.assign(f.header,{p2c:o,p2s:EB.encodeBuffer(c)}),f},TB=(e,t,r,n,{[so]:i},s,o)=>{let{p2s:c,p2c:a}=o,l=r(c),f=Aw(i.export(),l,a,e,t);return n({[so]:f},s,o)};qw.exports=(e,t)=>{["PBES2-HS256+A128KW","PBES2-HS384+A192KW","PBES2-HS512+A256KW"].forEach(r=>{let n=r.substr(-6),i=e.keyManagementEncrypt.get(n),s=e.keyManagementDecrypt.get(n),o=parseInt(r.substr(13,3),10)/8,c=`sha${r.substr(8,3)}`;i&&s&&(e.keyManagementEncrypt.set(r,xB.bind(void 0,o,c,Tw.bind(void 0,r),i)),e.keyManagementDecrypt.set(r,TB.bind(void 0,o,c,Tw.bind(void 0,r),s)),t.oct.deriveKey[r]=a=>a.use==="enc"||a.use===void 0)})}});var kw=h((hY,Yu)=>{var{improvedDH:AB}=Pe();if(AB){let{diffieHellman:e}=g("crypto"),{KeyObject:t}=se(),r=fn();Yu.exports=({keyObject:n},i)=>(i instanceof t||({keyObject:i}=r(i)),e({privateKey:n,publicKey:i}))}else{let{createECDH:e,constants:{POINT_CONVERSION_UNCOMPRESSED:t}}=g("crypto"),r=we(),n=o=>{switch(o){case"P-256":return"prime256v1";case"P-384":return"secp384r1";case"P-521":return"secp521r1"}},i=Buffer.alloc(1,t),s=(o,c)=>Buffer.concat([i,r.decodeToBuffer(o),r.decodeToBuffer(c)]);Yu.exports=({crv:o,d:c},{x:a,y:l})=>{let f=n(o),u=e(f);return u.setPrivateKey(r.decodeToBuffer(c)),u.computeSecret(s(a,l))}}});var Xu=h((pY,Rw)=>{var{createHash:Cw}=g("crypto"),qB=kw(),OB=(e,t,r)=>{let n=Math.ceil(t/32),i;for(let s=1;s<=n;s++){let o=Buffer.allocUnsafe(4+e.length+r.length);o.writeUInt32BE(s,0),e.copy(o,4),r.copy(o,4+e.length),i?i=Buffer.concat([i,Cw("sha256").update(o).digest()]):i=Cw("sha256").update(o).digest()}return i.slice(0,t)},Pw=(e,t=Buffer.allocUnsafe(4))=>(t.writeUInt32BE(e),t),Vu=e=>Buffer.concat([Pw(e.length),e]);Rw.exports=(e,t,r,n,{apu:i=Buffer.alloc(0),apv:s=Buffer.alloc(0)}={},o=qB)=>{let c=Buffer.concat([Vu(Buffer.from(e)),Vu(i),Vu(s),Pw(t)]),a=o(r,n);return OB(a,t/8,c)}});var Nw=h((yY,Bw)=>{var{improvedDH:kB}=Pe(),{KEYLENGTHS:Kw}=_t(),{generateSync:CB}=ai(),{name:PB}=gr(),Iw=Xu(),RB=(e,t,{enc:r})=>{let n=CB(e.kty,e.crv);return{wrapped:Iw(r,Kw.get(r),n,e),header:{epk:{kty:e.kty,crv:e.crv,x:n.x,y:n.y}}}},KB=(e,t,r)=>{let{enc:n,epk:i}=r;return Iw(n,Kw.get(n),e,i,r)};Bw.exports=(e,t)=>{e.keyManagementEncrypt.set("ECDH-ES",RB),e.keyManagementDecrypt.set("ECDH-ES",KB),t.EC.deriveKey["ECDH-ES"]=r=>(r.use==="enc"||r.use===void 0)&&r.crv!==PB,kB&&(t.OKP.deriveKey["ECDH-ES"]=r=>(r.use==="enc"||r.use===void 0)&&r.keyObject.asymmetricKeyType.startsWith("x"))}});var Lw=h((mY,oo)=>{var{improvedDH:IB}=Pe(),{KEYOBJECT:Mw}=X(),{generateSync:BB}=ai(),{name:NB}=gr(),{ECDH_DERIVE_LENGTHS:jB}=_t(),jw=Xu(),Dw=(e,t,r,n)=>{let i=BB(r.kty,r.crv),s=t(i,r,n),o=e({[Mw]:s},n);return o.header=o.header||{},Object.assign(o.header,{epk:{kty:r.kty,crv:r.crv,x:i.x,y:i.y}}),o},Jw=(e,t,r,n,i)=>{let{epk:s}=i,o=t(r,s,i);return e({[Mw]:o},n,i)};oo.exports=(e,t)=>{["ECDH-ES+A128KW","ECDH-ES+A192KW","ECDH-ES+A256KW"].forEach(r=>{let n=r.substr(-6),i=e.keyManagementEncrypt.get(n),s=e.keyManagementDecrypt.get(n),o=parseInt(r.substr(9,3),10);jB.set(r,o),i&&s&&(e.keyManagementEncrypt.set(r,Dw.bind(void 0,i,jw.bind(void 0,r,o))),e.keyManagementDecrypt.set(r,Jw.bind(void 0,s,jw.bind(void 0,r,o))),t.EC.deriveKey[r]=c=>(c.use==="enc"||c.use===void 0)&&c.crv!==NB,IB&&(t.OKP.deriveKey[r]=c=>(c.use==="enc"||c.use===void 0)&&c.keyObject.asymmetricKeyType.startsWith("x")))})};oo.exports.wrapKey=Dw;oo.exports.unwrapKey=Jw});var di=h((gY,$w)=>{var{JWKKeySupport:MB,JOSENotSupported:DB}=L(),{KEY_MANAGEMENT_ENCRYPT:JB,KEY_MANAGEMENT_DECRYPT:LB}=X(),{JWA:G,JWK:Ke}=_t();K_()(G,Ke);j_()(G,Ke);J_()(G,Ke);W_()(G,Ke);z_()(G,Ke);V_()(G);sw()(G,Ke);fw()(G,Ke);gw()(G,Ke);Ew()(G,Ke);xw()(G,Ke);Ow()(G,Ke);Nw()(G,Ke);Lw()(G,Ke);var er=(e,t,r)=>{let n=`_${t}_${r}`,i,s;if(t==="keyManagementEncrypt"?(i="key management (encryption)",s=JB):t==="keyManagementDecrypt"&&(i="key management (decryption)",s=LB),n in e){if(e[n])return;throw new MB(`the key does not support ${r} ${i||t} algorithm`)}let o=!0;if(G[t].has(r))e.algorithms(s).has(r)||(o=!1);else throw new DB(`unsupported ${i||t} alg: ${r}`);if(Object.defineProperty(e,n,{value:o,enumerable:!1}),!o)return er(e,t,r)};$w.exports={check:er,sign:(e,t,r)=>(er(t,"sign",e),G.sign.get(e)(t,r)),verify:(e,t,r,n)=>(er(t,"verify",e),G.verify.get(e)(t,r,n)),keyManagementEncrypt:(e,t,r,n)=>(er(t,"keyManagementEncrypt",e),G.keyManagementEncrypt.get(e)(t,r,n)),keyManagementDecrypt:(e,t,r,n)=>(er(t,"keyManagementDecrypt",e),G.keyManagementDecrypt.get(e)(t,r,n)),encrypt:(e,t,r,n)=>(er(t,"encrypt",e),G.encrypt.get(e)(t,r,n)),decrypt:(e,t,r,n)=>(er(t,"decrypt",e),G.decrypt.get(e)(t,r,n))}});var hi=h((_Y,Ww)=>{var{JOSECritNotUnderstood:$B,JWSInvalid:Uw}=L(),UB=new Set(["alg","jku","jwk","kid","x5u","x5c","x5t","x5t#S256","typ","cty","crit","enc","zip","epk","apu","apv","iv","tag","p2s","p2c"]);Ww.exports=function(t,r,n,i){if(r&&"crit"in r){if(!Array.isArray(r.crit)||r.crit.length===0||r.crit.some(c=>typeof c!="string"||!c))throw new t('"crit" Header Parameter MUST be an array of non-empty strings when present');let s=new Set(i),o={...r,...n};r.crit.forEach(c=>{if(UB.has(c))throw new t(`The critical list contains a non-extension Header Parameter ${c}`);if(!s.has(c))throw new $B(`critical "${c}" is not understood`);if(c==="b64"){if(!("b64"in r))throw new Uw('"b64" critical parameter must be integrity protected');if(typeof r.b64!="boolean")throw new Uw('"b64" critical parameter must be a boolean')}else if(!(c in o))throw new t(`critical parameter "${c}" is missing`)})}if(n&&"crit"in n)throw new t('"crit" Header Parameter MUST be integrity protected when present')}});var Qu=h((wY,zw)=>{var pi=De(),yi=hi(),{JWEInvalid:co}=L();yi=yi.bind(void 0,co);var Hw=(e,[t])=>`${e.protected}.${t.encrypted_key}.${e.iv}.${e.ciphertext}.${e.tag}`;Hw.validate=(e,t,r,{0:{header:n},length:i})=>{if(i!==1||r||t||n)throw new co("JWE Compact Serialization doesn't support multiple recipients, JWE unprotected headers or AAD");yi(e,t,e?e.crit:void 0)};var Fw=(e,[t])=>{let{header:r,encrypted_key:n}=t;return{...e.protected?{protected:e.protected}:void 0,...e.unprotected?{unprotected:e.unprotected}:void 0,...r?{header:r}:void 0,...n?{encrypted_key:n}:void 0,...e.aad?{aad:e.aad}:void 0,iv:e.iv,ciphertext:e.ciphertext,tag:e.tag}};Fw.validate=(e,t,r,{0:{header:n},length:i})=>{if(i!==1)throw new co("Flattened JWE JSON Serialization doesn't support multiple recipients");yi(e,{...t,...n},e?e.crit:void 0)};var Gw=(e,t)=>{let r={...e.protected?{protected:e.protected}:void 0,...e.unprotected?{unprotected:e.unprotected}:void 0,recipients:t.map(({header:n,encrypted_key:i,generatedHeader:s})=>!n&&!i&&!s?!1:{...n||s?{header:{...n,...s}}:void 0,...i?{encrypted_key:i}:void 0}).filter(Boolean),...e.aad?{aad:e.aad}:void 0,iv:e.iv,ciphertext:e.ciphertext,tag:e.tag};return r.recipients.length||delete r.recipients,r};Gw.validate=(e,t,r,n)=>{n.forEach(({header:i})=>{yi(e,{...i,...t},e?e.crit:void 0)})};var WB=e=>pi(e)&&typeof e.ciphertext=="string"&&typeof e.iv=="string"&&typeof e.tag=="string"&&(e.unprotected===void 0||pi(e.unprotected))&&(e.protected===void 0||typeof e.protected=="string")&&(e.aad===void 0||typeof e.aad=="string"),HB=e=>(e.encrypted_key===void 0||typeof e.encrypted_key=="string")&&(e.header===void 0||pi(e.header)),FB=e=>pi(e)&&typeof e.encrypted_key=="string"&&(e.header===void 0||pi(e.header)),GB=e=>!!(Array.isArray(e.recipients)&&e.recipients.every(FB)),zB=e=>{if(typeof e=="string"&&e.split(".").length===5)return"compact";if(WB(e)){if(GB(e))return"general";if(HB(e))return"flattened"}throw new co("JWE malformed or invalid serialization")};zw.exports={compact:Hw,flattened:Fw,general:Gw,detect:zB}});var Zu=h((bY,Vw)=>{var{randomBytes:YB}=g("crypto"),{createSecretKey:VB}=se(),{KEYLENGTHS:XB}=_t(),Yw=Xs();Vw.exports=e=>{let t=XB.get(e);return t?new Yw(VB(YB(t/8)),{use:"enc",alg:e}):new Yw({type:"secret"})}});var ao=h((EY,Xw)=>{Xw.exports=(e={},t={})=>{let r=Object.keys(e),n=new Set(Object.keys(t));return!r.some(i=>n.has(i))}});var rl=h((vY,Qw)=>{var el=ao(),QB=we(),tl=hi(),{JWEInvalid:kt,JOSENotSupported:ZB}=L();tl=tl.bind(void 0,kt);Qw.exports=(e,t,r,n,i)=>{if(typeof e=="string")try{e=QB.JSON.decode(e)}catch{throw new kt("could not parse JWE protected header")}let s=[],o=new Set;if(!el(e,t)||!r.every(({header:c})=>{typeof c=="object"&&(s.push(c.alg),o.add(c.enc));let a={...t,...c};if(tl(e,a,i),"zip"in a)throw new kt('"zip" Header Parameter MUST be integrity protected');if(e&&"zip"in e&&e.zip!=="DEF")throw new ZB('only "DEF" compression algorithm is supported');return el(c,e)&&el(c,t)}))throw new kt("JWE Shared Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");if(typeof e=="object"&&(s.push(e.alg),o.add(e.enc)),typeof t=="object"&&(s.push(t.alg),o.add(t.enc)),s=s.filter(Boolean),o.delete(void 0),r.length!==1&&(s.includes("dir")||s.includes("ECDH-ES")))throw new kt("dir and ECDH-ES alg may only be used with a single recipient");if(n){if(s.length!==r.length)throw new kt("missing Key Management algorithm");if(o.size===0)throw new kt("missing Content Encryption algorithm");if(o.size!==1)throw new kt("there must only be one Content Encryption algorithm")}else if(o.size>1)throw new kt("there must only be one Content Encryption algorithm");return[...o][0]}});var ib=h((SY,nb)=>{var{deflateRawSync:e5}=g("zlib"),{KEYOBJECT:Zw}=X(),t5=za(),dn=we(),r5=br(),nl=De(),{createSecretKey:n5}=se(),il=Wu(),eb=fn(),{JWEInvalid:tb}=L(),{check:sl,keyManagementEncrypt:i5,encrypt:s5}=di(),o5=Qu(),c5=Zu(),a5=rl(),rb=Symbol("PROCESS_RECIPIENT"),ol=class{constructor(t,r,n,i){if(!Buffer.isBuffer(t)&&typeof t!="string")throw new TypeError("cleartext argument must be a Buffer or a string");if(t=Buffer.from(t),i!==void 0&&!Buffer.isBuffer(i)&&typeof i!="string")throw new TypeError("aad argument must be a Buffer or a string when provided");if(i=i?Buffer.from(i):void 0,r!==void 0&&!nl(r))throw new TypeError("protectedHeader argument must be a plain object when provided");if(n!==void 0&&!nl(n))throw new TypeError("unprotectedHeader argument must be a plain object when provided");this._recipients=[],this._cleartext=t,this._aad=i,this._unprotected=n?il(n):void 0,this._protected=r?il(r):void 0}recipient(t,r){if(t=r5(t),r!==void 0&&!nl(r))throw new TypeError("header argument must be a plain object when provided");return this._recipients.push({key:t,header:r?il(r):void 0}),this}[rb](t){let r=this._unprotected,n=this._protected,{length:i}=this._recipients,s={...n,...r,...t.header},{key:o}=t,c=s.enc,a=s.alg;if(o.use==="sig")throw new TypeError('a key with "use":"sig" is not usable for encryption');if(a==="dir")sl(o,"encrypt",c);else if(a)sl(o,"keyManagementEncrypt",a);else{if(a=o.alg||[...o.algorithms("wrapKey")][0]||[...o.algorithms("deriveKey")][0],a==="ECDH-ES"&&i!==1&&(a=[...o.algorithms("deriveKey")][1]),!a)throw new tb('could not resolve a usable "alg" for a recipient');i===1?n?n.alg=a:this._protected={alg:a}:t.header?t.header.alg=a:t.header={alg:a}}let l,f;o.kty==="oct"&&a==="dir"?this._cek=eb(o[Zw],{use:"enc",alg:c}):(sl(this._cek,"encrypt",c),{wrapped:l,header:f}=i5(a,o,this._cek[Zw].export(),{enc:c,alg:a}),a==="ECDH-ES"&&(this._cek=eb(n5(l),{use:"enc",alg:c}))),a==="dir"||a==="ECDH-ES"?t.encrypted_key="":t.encrypted_key=dn.encodeBuffer(l),f&&(t.generatedHeader=f)}encrypt(t){let r=o5[t];if(!r)throw new TypeError('serialization must be one of "compact", "flattened", "general"');if(!this._recipients.length)throw new tb("missing recipients");r.validate(this._protected,this._unprotected,this._aad,this._recipients);let n=a5(this._protected,this._unprotected,this._recipients,!1,this._protected?this._protected.crit:void 0);n||(n="A128CBC-HS256",this._protected?this._protected.enc=n:this._protected={enc:n});let i={};this._cek=c5(n);for(let f of this._recipients)this[rb](f);let s=t5(n);if(i.iv=dn.encodeBuffer(s),this._recipients.length===1&&this._recipients[0].generatedHeader){let[{generatedHeader:f}]=this._recipients;delete this._recipients[0].generatedHeader,this._protected={...this._protected,...f}}this._protected&&(i.protected=dn.JSON.encode(this._protected)),i.unprotected=this._unprotected;let o;this._aad?(i.aad=dn.encode(this._aad),o=Buffer.concat([Buffer.from(i.protected||""),Buffer.from("."),Buffer.from(i.aad)])):o=Buffer.from(i.protected||"");let c=this._cleartext;this._protected&&"zip"in this._protected&&(c=e5(c));let{ciphertext:a,tag:l}=s5(n,this._cek,c,{iv:s,aad:o});return i.tag=dn.encodeBuffer(l),i.ciphertext=dn.encodeBuffer(a),r(i,this._recipients)}};nb.exports=ol});var uo=h((xY,sb)=>{var u5=Uu();sb.exports=u5});var lb=h((TY,ub)=>{var{inflateRawSync:l5}=g("zlib"),Xe=we(),f5=br(),{KeyStore:d5}=uo(),Ve=L(),{check:h5,decrypt:p5,keyManagementDecrypt:ob}=di(),cl=ui(),{createSecretKey:cb}=se(),y5=Zu(),ab=rl(),{detect:m5}=Qu(),g5=new Set(["compact","flattened"]),_5=(e={},t={},r={})=>{typeof e=="string"&&(e=Xe.JSON.decode(e));let n=e.p2s||t.p2s||r.p2s,i=e.apu||t.apu||r.apu,s=e.apv||t.apv||r.apv,o=e.iv||t.iv||r.iv,c=e.tag||t.tag||r.tag;return{...e,...t,...r,...typeof n=="string"?{p2s:Xe.decodeToBuffer(n)}:void 0,...typeof i=="string"?{apu:Xe.decodeToBuffer(i)}:void 0,...typeof s=="string"?{apv:Xe.decodeToBuffer(s)}:void 0,...typeof o=="string"?{iv:Xe.decodeToBuffer(o)}:void 0,...typeof c=="string"?{tag:Xe.decodeToBuffer(c)}:void 0}},al=(e,t,r,n,{crit:i=[],complete:s=!1,algorithms:o,maxPBES2Count:c=1e4}={})=>{if(n=f5(n,!0),o!==void 0&&(!Array.isArray(o)||o.some(T=>typeof T!="string"||!T)))throw new TypeError('"algorithms" option must be an array of non-empty strings');if(o&&(o=new Set(o)),!Array.isArray(i)||i.some(T=>typeof T!="string"||!T))throw new TypeError('"crit" option must be an array of non-empty strings');t||(t=m5(r));let a,l,f,u,d,p,m,y,_,b,w,v;if(t==="general"&&r.recipients.length===1){t="flattened";let{recipients:T,...R}=r;r={...R,...T[0]}}if(g5.has(t)){if(t==="compact"?[m,u,d,l,y]=r.split("."):{protected:m,encrypted_key:u,iv:d,ciphertext:l,tag:y,unprotected:_,aad:w,header:v}=r,e||ab(m,_,[{header:v}],!0,i),p=_5(m,_,v),{alg:a,enc:f}=p,o&&!o.has(a==="dir"?f:a))throw new Ve.JOSEAlgNotWhitelisted("alg not whitelisted");if(n instanceof d5){let k=n,ee;switch(p.alg==="dir"?ee=k.all({kid:p.kid,alg:p.enc,key_ops:["decrypt"]}):ee=k.all({kid:p.kid,alg:p.alg,key_ops:["unwrapKey"]}),ee.length){case 0:throw new Ve.JWKSNoMatchingKey;case 1:n=ee[0];break;default:{let Vn=[];for(let mr of ee)try{return al(!0,t,r,mr,{crit:i,complete:s,algorithms:o?[...o]:void 0})}catch(Na){Vn.push(Na);continue}let Xn=new Ve.JOSEMultiError(Vn);throw[...Xn].some(mr=>mr instanceof Ve.JWEDecryptionFailed)?new Ve.JWEDecryptionFailed:Xn}}}if(h5(n,...a==="dir"?["decrypt",f]:["keyManagementDecrypt",a]),a.startsWith("PBES2")&&p&&p.p2c>c)throw new Ve.JWEInvalid('JOSE Header "p2c" (PBES2 Count) out is of acceptable bounds');try{if(a==="dir")b=cl.asKey(n,{alg:f,use:"enc"});else if(a==="ECDH-ES"){let k=ob(a,n,void 0,p);b=cl.asKey(cb(k),{alg:f,use:"enc"})}else{let k=ob(a,n,Xe.decodeToBuffer(u),p);b=cl.asKey(cb(k),{alg:f,use:"enc"})}}catch{b=y5(f)}let T;w?T=Buffer.concat([Buffer.from(m||""),Buffer.from("."),Buffer.from(w)]):T=Buffer.from(m||"");try{d=Xe.decodeToBuffer(d)}catch{}try{y=Xe.decodeToBuffer(y)}catch{}let R=p5(f,b,Xe.decodeToBuffer(l),{iv:d,tag:y,aad:T});if(p.zip&&(R=l5(R)),s){let k={cleartext:R,key:n,cek:b};return w&&(k.aad=w),v&&(k.header=v),_&&(k.unprotected=_),m&&(k.protected=Xe.JSON.decode(m)),k}return R}ab(r.protected,r.unprotected,r.recipients.map(({header:T})=>({header:T})),!0,i);let{recipients:S,...E}=r,x=[];for(let T of S)try{return al(!0,"flattened",{...E,...T},n,{crit:i,complete:s,algorithms:o?[...o]:void 0})}catch(R){x.push(R);continue}let q=new Ve.JOSEMultiError(x);throw[...q].some(T=>T instanceof Ve.JWEDecryptionFailed)?new Ve.JWEDecryptionFailed:[...q].every(T=>T instanceof Ve.JWKSNoMatchingKey)?new Ve.JWKSNoMatchingKey:q};ub.exports=al.bind(void 0,!1,void 0)});var db=h((AY,hn)=>{var fb=ib(),w5=lb(),ul=(e,t,r,n,i,s)=>new fb(t,n,i,s).recipient(r).encrypt(e);hn.exports.Encrypt=fb;hn.exports.encrypt=ul.bind(void 0,"compact");hn.exports.encrypt.flattened=ul.bind(void 0,"flattened");hn.exports.encrypt.general=ul.bind(void 0,"general");hn.exports.decrypt=w5});var fl=h((qY,gb)=>{var ll=De(),mi=hi(),{JWSInvalid:gi}=L();mi=mi.bind(void 0,gi);var hb=(e,[t])=>`${t.protected}.${e}.${t.signature}`;hb.validate=(e,{0:{unprotectedHeader:t,protectedHeader:r},length:n})=>{if(n!==1||t)throw new gi("JWS Compact Serialization doesn't support multiple recipients or JWS unprotected headers");mi(r,t,r?r.crit:void 0)};var pb=(e,[t])=>{let{header:r,signature:n,protected:i}=t;return{payload:e,...i?{protected:i}:void 0,...r?{header:r}:void 0,signature:n}};pb.validate=(e,{0:{unprotectedHeader:t,protectedHeader:r},length:n})=>{if(n!==1)throw new gi("Flattened JWS JSON Serialization doesn't support multiple recipients");mi(r,t,r?r.crit:void 0)};var yb=(e,t)=>({payload:e,signatures:t.map(({header:r,signature:n,protected:i})=>({...i?{protected:i}:void 0,...r?{header:r}:void 0,signature:n}))});yb.validate=(e,t)=>{let r=!1;if(t.forEach(({protectedHeader:n,unprotectedHeader:i})=>{n&&!r&&"b64"in n&&(r=!0),mi(n,i,n?n.crit:void 0)}),r&&!t.map(({protectedHeader:i})=>i&&i.b64).every((i,s,[o])=>i===o))throw new gi('the "b64" Header Parameter value MUST be the same for all recipients')};var b5=e=>ll(e)&&(typeof e.payload=="string"||Buffer.isBuffer(e.payload)),mb=e=>ll(e)&&typeof e.signature=="string"&&(e.header===void 0||ll(e.header))&&(e.protected===void 0||typeof e.protected=="string"),E5=e=>!!(Array.isArray(e.signatures)&&e.signatures.every(mb)),v5=e=>{if(typeof e=="string"&&e.split(".").length===3)return"compact";if(b5(e)){if(E5(e))return"general";if(mb(e))return"flattened"}throw new gi("JWS malformed or invalid serialization")};gb.exports={compact:hb,flattened:pb,general:yb,detect:v5}});var Eb=h((OY,bb)=>{var Er=we(),S5=ao(),dl=De(),_b=Wu(),{JWSInvalid:hl}=L(),{sign:x5}=di(),T5=br(),A5=fl(),wb=Symbol("PROCESS_RECIPIENT"),pl=class{constructor(t){if(typeof t=="string")t=Er.encode(t);else if(Buffer.isBuffer(t))t=Er.encodeBuffer(t),this._binary=!0;else if(dl(t))t=Er.JSON.encode(t);else throw new TypeError("payload argument must be a Buffer, string or an object");this._payload=t,this._recipients=[]}recipient(t,r,n){if(t=T5(t),r!==void 0&&!dl(r))throw new TypeError("protectedHeader argument must be a plain object when provided");if(n!==void 0&&!dl(n))throw new TypeError("unprotectedHeader argument must be a plain object when provided");if(!S5(r,n))throw new hl("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");return this._recipients.push({key:t,protectedHeader:r?_b(r):void 0,unprotectedHeader:n?_b(n):void 0}),this}[wb](t,r){let{key:n,protectedHeader:i,unprotectedHeader:s}=t;if(n.use==="enc")throw new TypeError('a key with "use":"enc" is not usable for signing');let o={protected:i||{},unprotected:s||{}},c=o.protected.alg||o.unprotected.alg;if(c||(c=n.alg||[...n.algorithms("sign")][0],t.protectedHeader?o.protected.alg=t.protectedHeader.alg=c:o.protected=t.protectedHeader={alg:c}),!c)throw new hl('could not resolve a usable "alg" for a recipient');t.header=s,t.protected=Object.keys(o.protected).length?Er.JSON.encode(o.protected):"",r&&o.protected.crit&&o.protected.crit.includes("b64")&&o.protected.b64===!1&&(this._binary?this._payload=Er.decodeToBuffer(this._payload):this._payload=Er.decode(this._payload));let a=Buffer.concat([Buffer.from(t.protected||""),Buffer.from("."),Buffer.from(this._payload)]);t.signature=Er.encodeBuffer(x5(c,n,a))}sign(t){let r=A5[t];if(!r)throw new TypeError('serialization must be one of "compact", "flattened", "general"');if(!this._recipients.length)throw new hl("missing recipients");return r.validate(this,this._recipients),this._recipients.forEach((n,i)=>{this[wb](n,i===0)}),r(this._payload,this._recipients)}};bb.exports=pl});var gl=h((kY,vb)=>{var{EOL:yl}=g("os"),lo=we(),q5=ao(),O5=De(),ml=hi(),k5=br(),{KeyStore:C5}=uo(),oe=L(),{check:P5,verify:R5}=di(),fo=ui(),{detect:K5}=fl();ml=ml.bind(void 0,oe.JWSInvalid);var I5=new Set(["compact","flattened","preparsed"]),ho=(e,t,r,n,{crit:i=[],complete:s=!1,algorithms:o,parse:c=!0,encoding:a="utf8"}={})=>{if(n=k5(n,!0),o!==void 0&&(!Array.isArray(o)||o.some(v=>typeof v!="string"||!v)))throw new TypeError('"algorithms" option must be an array of non-empty strings');if(o&&(o=new Set(o)),!Array.isArray(i)||i.some(v=>typeof v!="string"||!v))throw new TypeError('"crit" option must be an array of non-empty strings');t||(t=K5(r));let l,f,u,d,p;if(t==="general"&&r.signatures.length===1){t="flattened";let{signatures:v,...S}=r;r={...S,...v[0]}}let m;if(I5.has(t)){let v={};switch(t){case"compact":[l,u,d]=r.split(".");break;case"flattened":({protected:l,payload:u,signature:d,header:f}=r);break;case"preparsed":{({decoded:m}=r),[l,u,d]=r.token.split(".");break}}if(f||(e=!0),m)v=m.header;else if(l)try{v=lo.JSON.decode(l)}catch{throw new oe.JWSInvalid("could not parse JWS protected header")}else e=e||!0;if(!e&&!q5(v,f))throw new oe.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let S={...v,...f};if(ml(v,f,i),p=v.alg||f&&f.alg,p){if(o&&!o.has(p))throw new oe.JOSEAlgNotWhitelisted("alg not whitelisted")}else throw new oe.JWSInvalid("missing JWS signature algorithm");if(n instanceof C5){let q=n.all({kid:S.kid,alg:S.alg,key_ops:["verify"]});switch(q.length){case 0:throw new oe.JWKSNoMatchingKey;case 1:n=q[0];break;default:{let T=[];for(let k of q)try{return ho(!0,t,r,k,{crit:i,complete:s,encoding:a,parse:c,algorithms:o?[...o]:void 0})}catch(ee){T.push(ee);continue}let R=new oe.JOSEMultiError(T);throw[...R].some(k=>k instanceof oe.JWSVerificationFailed)?new oe.JWSVerificationFailed:R}}}if(n===fo.EmbeddedJWK){if(!O5(S.jwk))throw new oe.JWSInvalid('JWS Header Parameter "jwk" must be a JSON object');if(n=fo.asKey(S.jwk),n.type!=="public")throw new oe.JWSInvalid('JWS Header Parameter "jwk" must be a public key')}else if(n===fo.EmbeddedX5C){if(!Array.isArray(S.x5c)||!S.x5c.length||S.x5c.some(x=>typeof x!="string"||!x))throw new oe.JWSInvalid('JWS Header Parameter "x5c" must be a JSON array of certificate value strings');n=fo.asKey(`-----BEGIN CERTIFICATE-----${yl}${(S.x5c[0].match(/.{1,64}/g)||[]).join(yl)}${yl}-----END CERTIFICATE-----`,{x5c:S.x5c})}P5(n,"verify",p);let E=Buffer.concat([Buffer.from(l||""),Buffer.from("."),Buffer.isBuffer(u)?u:Buffer.from(u)]);if(!R5(p,n,E,lo.decodeToBuffer(d)))throw new oe.JWSVerificationFailed;if((!S.crit||!S.crit.includes("b64")||S.b64)&&(c?u=m?m.payload:lo.JSON.decode.try(u,a):u=lo.decodeToBuffer(u)),s){let x={payload:u,key:n};return l&&(x.protected=v),f&&(x.header=f),x}return u}let{signatures:y,..._}=r,b=[];for(let v of y)try{return ho(!1,"flattened",{..._,...v},n,{crit:i,complete:s,encoding:a,parse:c,algorithms:o?[...o]:void 0})}catch(S){b.push(S);continue}let w=new oe.JOSEMultiError(b);throw[...w].some(v=>v instanceof oe.JWSVerificationFailed)?new oe.JWSVerificationFailed:[...w].every(v=>v instanceof oe.JWKSNoMatchingKey)?new oe.JWKSNoMatchingKey:w};vb.exports={bare:ho,verify:ho.bind(void 0,!1,void 0)}});var wl=h((CY,pn)=>{var Sb=Eb(),{verify:B5}=gl(),_l=(e,t,r,n,i)=>new Sb(t).recipient(r,n,i).sign(e);pn.exports.Sign=Sb;pn.exports.sign=_l.bind(void 0,"compact");pn.exports.sign.flattened=_l.bind(void 0,"flattened");pn.exports.sign.general=_l.bind(void 0,"general");pn.exports.verify=B5});var bl=h((PY,Ab)=>{var xb=we(),Tb=L();Ab.exports=(e,{complete:t=!1}={})=>{if(typeof e!="string"||!e)throw new TypeError("JWT must be a string");let{0:r,1:n,2:i,length:s}=e.split(".");if(s===5)throw new TypeError("JWTs must be decrypted first");if(s!==3)throw new Tb.JWTMalformed("JWTs must have three components");try{let o={header:xb.JSON.decode(r),payload:xb.JSON.decode(n),signature:i};return t?o:o.payload}catch{throw new Tb.JWTMalformed("JWT is malformed")}}});var El=h((RY,qb)=>{var N5=/^(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)$/i;qb.exports=e=>{let t=N5.exec(e);if(!t)throw new TypeError(`invalid time period format ("${e}")`);let r=parseFloat(t[1]);switch(t[2].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":return Math.round(r);case"minute":case"minutes":case"min":case"mins":case"m":return Math.round(r*60);case"hour":case"hours":case"hr":case"hrs":case"h":return Math.round(r*3600);case"day":case"days":case"d":return Math.round(r*86400);case"week":case"weeks":case"w":return Math.round(r*604800);case"year":case"years":case"yr":case"yrs":case"y":return Math.round(r*31557600)}}});var vl=h((KY,Ob)=>{Ob.exports=e=>Math.floor(e.getTime()/1e3)});var xl=h((IY,Sl)=>{var kb=e=>typeof e!="string"||e.length===0;Sl.exports.isNotString=kb;Sl.exports.isString=function(t,r,n,i,s=!1){if(s&&r===void 0)throw new t(`${n} is missing`,i,"missing");if(r!==void 0&&kb(r))throw new t(`${n} must be a string`,i,"invalid")}});var Rb=h((BY,Pb)=>{var Tl=De(),Cb=El(),j5=vl(),M5=br(),D5=wl(),vr=xl().isString.bind(void 0,TypeError),J5=e=>{if(typeof e.iat!="boolean")throw new TypeError("options.iat must be a boolean");if(typeof e.kid!="boolean")throw new TypeError("options.kid must be a boolean");if(vr(e.subject,"options.subject"),vr(e.issuer,"options.issuer"),e.audience!==void 0&&(typeof e.audience!="string"||!e.audience)&&(!Array.isArray(e.audience)||e.audience.length===0||e.audience.some(t=>!t||typeof t!="string")))throw new TypeError("options.audience must be a string or an array of strings");if(!Tl(e.header))throw new TypeError("options.header must be an object");if(vr(e.algorithm,"options.algorithm"),vr(e.expiresIn,"options.expiresIn"),vr(e.notBefore,"options.notBefore"),vr(e.jti,"options.jti"),vr(e.nonce,"options.nonce"),e.now!==void 0&&(!(e.now instanceof Date)||!e.now.getTime()))throw new TypeError("options.now must be a valid Date object")};Pb.exports=(e,t,r={})=>{if(!Tl(r))throw new TypeError("options must be an object");let{algorithm:n,audience:i,expiresIn:s,header:o={},iat:c=!0,issuer:a,jti:l,kid:f=!0,nonce:u,notBefore:d,subject:p,now:m}=r;if(J5({algorithm:n,audience:i,expiresIn:s,header:o,iat:c,issuer:a,jti:l,kid:f,nonce:u,notBefore:d,now:m,subject:p}),!Tl(e))throw new TypeError("payload must be an object");let y;(s||d||c)&&(y=j5(m||new Date)),e={...e,sub:p||e.sub,aud:i||e.aud,iss:a||e.iss,jti:l||e.jti,iat:c?y:e.iat,nonce:u||e.nonce,exp:s?y+Cb(s):e.exp,nbf:d?y+Cb(d):e.nbf},t=M5(t);let _;return typeof r.kid=="boolean"?_=f:_=!t.secret,D5.sign(JSON.stringify(e),t,{...o,alg:n||o.alg,kid:_?t.kid:o.kid})}});var kl=h((NY,jb)=>{var Ol=De(),L5=vl(),Al=El(),$5=br(),{bare:Kb}=gl(),{JWTClaimInvalid:H,JWTExpired:Ib}=L(),{isString:Nb,isNotString:mo}=xl(),U5=bl(),Ct=Nb.bind(void 0,H),tr=Nb.bind(void 0,TypeError),yn="id_token",yo="logout_token",Sr="at+JWT",po=(e,t,r=!1)=>{if(r&&e===void 0)throw new H(`"${t}" claim is missing`,t,"missing");if(e!==void 0&&typeof e!="number")throw new H(`"${t}" claim must be a JSON numeric value`,t,"invalid")},ql=(e,t,r=!1)=>{if(r&&e===void 0)throw new H(`"${t}" claim is missing`,t,"missing");if(e!==void 0&&mo(e)&&_i(e))throw new H(`"${t}" claim must be a string or array of strings`,t,"invalid")},_i=e=>!Array.isArray(e)||e.length===0||e.some(mo),Bb=e=>e.toLowerCase().replace(/^application\//,""),W5=({algorithms:e,audience:t,clockTolerance:r,complete:n=!1,crit:i,ignoreExp:s=!1,ignoreIat:o=!1,ignoreNbf:c=!1,issuer:a,jti:l,maxAuthAge:f,maxTokenAge:u,nonce:d,now:p=new Date,profile:m,subject:y,typ:_})=>{if(tr(m,"options.profile"),typeof n!="boolean")throw new TypeError("options.complete must be a boolean");if(typeof s!="boolean")throw new TypeError("options.ignoreExp must be a boolean");if(typeof c!="boolean")throw new TypeError("options.ignoreNbf must be a boolean");if(typeof o!="boolean")throw new TypeError("options.ignoreIat must be a boolean");if(tr(u,"options.maxTokenAge"),tr(y,"options.subject"),tr(f,"options.maxAuthAge"),tr(l,"options.jti"),tr(r,"options.clockTolerance"),tr(_,"options.typ"),a!==void 0&&mo(a)&&_i(a))throw new TypeError("options.issuer must be a string or an array of strings");if(t!==void 0&&mo(t)&&_i(t))throw new TypeError("options.audience must be a string or an array of strings");if(e!==void 0&&_i(e))throw new TypeError("options.algorithms must be an array of strings");if(tr(d,"options.nonce"),!(p instanceof Date)||!p.getTime())throw new TypeError("options.now must be a valid Date object");if(o&&u!==void 0)throw new TypeError("options.ignoreIat and options.maxTokenAge cannot used together");if(i!==void 0&&_i(i))throw new TypeError("options.crit must be an array of strings");switch(m){case yn:if(!a)throw new TypeError('"issuer" option is required to validate an ID Token');if(!t)throw new TypeError('"audience" option is required to validate an ID Token');break;case Sr:if(!a)throw new TypeError('"issuer" option is required to validate a JWT Access Token');if(!t)throw new TypeError('"audience" option is required to validate a JWT Access Token');_=Sr;break;case yo:if(!a)throw new TypeError('"issuer" option is required to validate a Logout Token');if(!t)throw new TypeError('"audience" option is required to validate a Logout Token');break;case void 0:break;default:throw new TypeError(`unsupported options.profile value "${m}"`)}return{algorithms:e,audience:t,clockTolerance:r,complete:n,crit:i,ignoreExp:s,ignoreIat:o,ignoreNbf:c,issuer:a,jti:l,maxAuthAge:f,maxTokenAge:u,nonce:d,now:p,profile:m,subject:y,typ:_}},H5=({header:e,payload:t},r,n)=>{if(Ct(e.alg,'"alg" header parameter',"alg",!0),po(t.iat,"iat",r===yn||r===yo||r===Sr||!!n.maxTokenAge),po(t.exp,"exp",r===yn||r===Sr),po(t.auth_time,"auth_time",!!n.maxAuthAge),po(t.nbf,"nbf"),Ct(t.jti,'"jti" claim',"jti",r===yo||r===Sr||!!n.jti),Ct(t.acr,'"acr" claim',"acr"),Ct(t.nonce,'"nonce" claim',"nonce",!!n.nonce),ql(t.iss,"iss",!!n.issuer),Ct(t.sub,'"sub" claim',"sub",r===yn||r===Sr||!!n.subject),ql(t.aud,"aud",!!n.audience),Ct(t.azp,'"azp" claim',"azp",r===yn&&Array.isArray(t.aud)&&t.aud.length>1),ql(t.amr,"amr"),Ct(e.typ,'"typ" header parameter',"typ",!!n.typ),r===Sr&&Ct(t.client_id,'"client_id" claim',"client_id",!0),r===yo){if(Ct(t.sid,'"sid" claim',"sid"),!("sid"in t)&&!("sub"in t))throw new H('either "sid" or "sub" (or both) claims must be present');if("nonce"in t)throw new H('"nonce" claim is prohibited',"nonce","prohibited");if(!("events"in t))throw new H('"events" claim is missing',"events","missing");if(!Ol(t.events))throw new H('"events" claim must be an object',"events","invalid");if(!("http://schemas.openid.net/event/backchannel-logout"in t.events))throw new H('"http://schemas.openid.net/event/backchannel-logout" member is missing in the "events" claim',"events","invalid");if(!Ol(t.events["http://schemas.openid.net/event/backchannel-logout"]))throw new H('"http://schemas.openid.net/event/backchannel-logout" member in the "events" claim must be an object',"events","invalid")}},F5=(e,t,r)=>typeof e=="string"?t.includes(e):(e=new Set(e),t.some(Set.prototype.has.bind(e)));jb.exports=(e,t,r={})=>{if(!Ol(r))throw new TypeError("options must be an object");let{algorithms:n,audience:i,clockTolerance:s,complete:o,crit:c,ignoreExp:a,ignoreIat:l,ignoreNbf:f,issuer:u,jti:d,maxAuthAge:p,maxTokenAge:m,nonce:y,now:_,profile:b,subject:w,typ:v}=r=W5(r),S=U5(e,{complete:!0});t=$5(t,!0),o?({key:t}=Kb(!0,"preparsed",{decoded:S,token:e},t,{crit:c,algorithms:n,complete:!0}),S.key=t):Kb(!0,"preparsed",{decoded:S,token:e},t,{crit:c,algorithms:n});let E=L5(_);if(H5(S,b,r),u&&(typeof S.payload.iss!="string"||!(typeof u=="string"?[u]:u).includes(S.payload.iss)))throw new H('unexpected "iss" claim value',"iss","check_failed");if(y&&S.payload.nonce!==y)throw new H('unexpected "nonce" claim value',"nonce","check_failed");if(w&&S.payload.sub!==w)throw new H('unexpected "sub" claim value',"sub","check_failed");if(d&&S.payload.jti!==d)throw new H('unexpected "jti" claim value',"jti","check_failed");if(i&&!F5(S.payload.aud,typeof i=="string"?[i]:i,b))throw new H('unexpected "aud" claim value',"aud","check_failed");if(v&&Bb(S.header.typ)!==Bb(v))throw new H('unexpected "typ" JWT header value',"typ","check_failed");let x=s?Al(s):0;if(p){let q=Al(p);if(S.payload.auth_time+q<E-x)throw new H('"auth_time" claim timestamp check failed (too much time has elapsed since the last End-User authentication)',"auth_time","check_failed")}if(!l&&!("exp"in S.payload)&&"iat"in S.payload&&S.payload.iat>E+x)throw new H('"iat" claim timestamp check failed (it should be in the past)',"iat","check_failed");if(!f&&"nbf"in S.payload&&S.payload.nbf>E+x)throw new H('"nbf" claim timestamp check failed',"nbf","check_failed");if(!a&&"exp"in S.payload&&S.payload.exp<=E-x)throw new Ib('"exp" claim timestamp check failed',"exp","check_failed");if(m){let q=E-S.payload.iat,T=Al(m);if(q-x>T)throw new Ib('"iat" claim timestamp check failed (too far in the past)',"iat","check_failed");if(q<0-x)throw new H('"iat" claim timestamp check failed (it should be in the past)',"iat","check_failed")}if(b===yn&&Array.isArray(S.payload.aud)&&S.payload.aud.length>1&&S.payload.azp!==i)throw new H('unexpected "azp" claim value',"azp","check_failed");return o?S:S.payload}});var Db=h((jY,Mb)=>{var Cl=kl();Mb.exports={IdToken:{verify:(e,t,r)=>Cl(e,t,{...r,profile:"id_token"})},LogoutToken:{verify:(e,t,r)=>Cl(e,t,{...r,profile:"logout_token"})},AccessToken:{verify:(e,t,r)=>Cl(e,t,{...r,profile:"at+JWT"})}}});var Lb=h((MY,Jb)=>{var G5=bl(),z5=Rb(),Y5=kl(),V5=Db();Jb.exports={decode:G5,sign:z5,verify:Y5,...V5}});var go=h((DY,$b)=>{$b.exports={JWE:db(),JWK:ui(),JWKS:uo(),JWS:wl(),JWT:Lb(),errors:L()}});var Wb=h((JY,Ub)=>{"use strict";Ub.exports=(e,t=1,r)=>{if(r={indent:" ",includeEmptyLines:!1,...r},typeof e!="string")throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof e}\``);if(typeof t!="number")throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof t}\``);if(typeof r.indent!="string")throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof r.indent}\``);if(t===0)return e;let n=r.includeEmptyLines?/^/gm:/^(?!\s*$)/gm;return e.replace(n,r.indent.repeat(t))}});var zb=h((LY,Gb)=>{"use strict";var Hb=g("os"),Fb=/\s+at.*(?:\(|\s)(.*)\)?/,X5=/^(?:(?:(?:node|(?:internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)\.js:\d+:\d+)|native)/,Q5=typeof Hb.homedir>"u"?"":Hb.homedir();Gb.exports=(e,t)=>(t=Object.assign({pretty:!1},t),e.replace(/\\/g,"/").split(`
`).filter(r=>{let n=r.match(Fb);if(n===null||!n[1])return!0;let i=n[1];return i.includes(".app/Contents/Resources/electron.asar")||i.includes(".app/Contents/Resources/default_app.asar")?!1:!X5.test(i)}).filter(r=>r.trim()!=="").map(r=>t.pretty?r.replace(Fb,(n,i)=>n.replace(i,i.replace(Q5,"~"))):r).join(`
`))});var Vb=h(($Y,Yb)=>{"use strict";var Z5=Wb(),eN=zb(),tN=e=>e.replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,""),Pl=class extends Error{constructor(t){if(!Array.isArray(t))throw new TypeError(`Expected input to be an Array, got ${typeof t}`);t=[...t].map(n=>n instanceof Error?n:n!==null&&typeof n=="object"?Object.assign(new Error(n.message),n):new Error(n));let r=t.map(n=>typeof n.stack=="string"?tN(eN(n.stack)):String(n)).join(`
`);r=`
`+Z5(r,4),super(r),this.name="AggregateError",Object.defineProperty(this,"_errors",{value:t})}*[Symbol.iterator](){for(let t of this._errors)yield t}};Yb.exports=Pl});var Kl=h((UY,Rl)=>{"use strict";var _o=class extends Error{constructor(t){super(t||"Promise was canceled"),this.name="CancelError"}get isCanceled(){return!0}},mn=class{static fn(t){return(...r)=>new mn((n,i,s)=>{r.push(s),t(...r).then(n,i)})}constructor(t){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise((r,n)=>{this._reject=n;let i=c=>{(!this._isCanceled||!o.shouldReject)&&(this._isPending=!1,r(c))},s=c=>{this._isPending=!1,n(c)},o=c=>{if(!this._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");this._cancelHandlers.push(c)};return Object.defineProperties(o,{shouldReject:{get:()=>this._rejectOnCancel,set:c=>{this._rejectOnCancel=c}}}),t(i,s,o)})}then(t,r){return this._promise.then(t,r)}catch(t){return this._promise.catch(t)}finally(t){return this._promise.finally(t)}cancel(t){if(!(!this._isPending||this._isCanceled)){if(this._isCanceled=!0,this._cancelHandlers.length>0)try{for(let r of this._cancelHandlers)r()}catch(r){this._reject(r);return}this._rejectOnCancel&&this._reject(new _o(t))}}get isCanceled(){return this._isCanceled}};Object.setPrototypeOf(mn.prototype,Promise.prototype);Rl.exports=mn;Rl.exports.CancelError=_o});var Qb=h((WY,bo)=>{"use strict";var Xb=Vb(),rN=Kl(),wo=class extends Error{},nN=(e,t)=>new rN((r,n,i)=>{let{count:s,filter:o=()=>!0}=t;if(!Number.isFinite(s)){n(new TypeError(`Expected a finite number, got ${typeof t.count}`));return}let c=[],a=[],l=0,f=!1,u=new Set,d=()=>(c.length===s&&(r(c),f=!0),l-a.length<s&&(n(new Xb(a)),f=!0),f),p=()=>{for(let m of e)!u.has(m)&&typeof m.cancel=="function"&&m.cancel()};i(p);for(let m of e)l++,(async()=>{try{let y=await m;if(f)return;if(!o(y))throw new wo("Value does not satisfy filter");c.push(y)}catch(y){a.push(y)}finally{u.add(m),!f&&d()&&p()}})();s>l&&(n(new RangeError(`Expected input to contain at least ${t.count} items, but contains ${l} items`)),p())});bo.exports=nN;bo.exports.AggregateError=Xb;bo.exports.FilterError=wo});var eE=h((HY,Il)=>{"use strict";var Zb=Qb(),iN=Kl();Il.exports=(e,t)=>{let r=Zb(e,{...t,count:1});return iN.fn(async n=>{n(()=>{r.cancel()});let[i]=await r;return i})()};Il.exports.AggregateError=Zb.AggregateError});var rE=h((FY,tE)=>{"use strict";tE.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}}});var iE=h((GY,nE)=>{"use strict";nE.exports=j;j.Node=xr;j.create=j;function j(e){var t=this;if(t instanceof j||(t=new j),t.tail=null,t.head=null,t.length=0,e&&typeof e.forEach=="function")e.forEach(function(i){t.push(i)});else if(arguments.length>0)for(var r=0,n=arguments.length;r<n;r++)t.push(arguments[r]);return t}j.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,r=e.prev;return t&&(t.prev=r),r&&(r.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=r),e.list.length--,e.next=null,e.prev=null,e.list=null,t};j.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}};j.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}};j.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)oN(this,arguments[e]);return this.length};j.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)cN(this,arguments[e]);return this.length};j.prototype.pop=function(){if(!!this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}};j.prototype.shift=function(){if(!!this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}};j.prototype.forEach=function(e,t){t=t||this;for(var r=this.head,n=0;r!==null;n++)e.call(t,r.value,n,this),r=r.next};j.prototype.forEachReverse=function(e,t){t=t||this;for(var r=this.tail,n=this.length-1;r!==null;n--)e.call(t,r.value,n,this),r=r.prev};j.prototype.get=function(e){for(var t=0,r=this.head;r!==null&&t<e;t++)r=r.next;if(t===e&&r!==null)return r.value};j.prototype.getReverse=function(e){for(var t=0,r=this.tail;r!==null&&t<e;t++)r=r.prev;if(t===e&&r!==null)return r.value};j.prototype.map=function(e,t){t=t||this;for(var r=new j,n=this.head;n!==null;)r.push(e.call(t,n.value,this)),n=n.next;return r};j.prototype.mapReverse=function(e,t){t=t||this;for(var r=new j,n=this.tail;n!==null;)r.push(e.call(t,n.value,this)),n=n.prev;return r};j.prototype.reduce=function(e,t){var r,n=this.head;if(arguments.length>1)r=t;else if(this.head)n=this.head.next,r=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=0;n!==null;i++)r=e(r,n.value,i),n=n.next;return r};j.prototype.reduceReverse=function(e,t){var r,n=this.tail;if(arguments.length>1)r=t;else if(this.tail)n=this.tail.prev,r=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=this.length-1;n!==null;i--)r=e(r,n.value,i),n=n.prev;return r};j.prototype.toArray=function(){for(var e=new Array(this.length),t=0,r=this.head;r!==null;t++)e[t]=r.value,r=r.next;return e};j.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,r=this.tail;r!==null;t++)e[t]=r.value,r=r.prev;return e};j.prototype.slice=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var r=new j;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var n=0,i=this.head;i!==null&&n<e;n++)i=i.next;for(;i!==null&&n<t;n++,i=i.next)r.push(i.value);return r};j.prototype.sliceReverse=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var r=new j;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var n=this.length,i=this.tail;i!==null&&n>t;n--)i=i.prev;for(;i!==null&&n>e;n--,i=i.prev)r.push(i.value);return r};j.prototype.splice=function(e,t,...r){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,i=this.head;i!==null&&n<e;n++)i=i.next;for(var s=[],n=0;i&&n<t;n++)s.push(i.value),i=this.removeNode(i);i===null&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var n=0;n<r.length;n++)i=sN(this,i,r[n]);return s};j.prototype.reverse=function(){for(var e=this.head,t=this.tail,r=e;r!==null;r=r.prev){var n=r.prev;r.prev=r.next,r.next=n}return this.head=t,this.tail=e,this};function sN(e,t,r){var n=t===e.head?new xr(r,null,t,e):new xr(r,t,t.next,e);return n.next===null&&(e.tail=n),n.prev===null&&(e.head=n),e.length++,n}function oN(e,t){e.tail=new xr(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function cN(e,t){e.head=new xr(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function xr(e,t,r,n){if(!(this instanceof xr))return new xr(e,t,r,n);this.list=n,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}try{rE()(j)}catch{}});var uE=h((zY,aE)=>{"use strict";var aN=iE(),Tr=Symbol("max"),Rt=Symbol("length"),gn=Symbol("lengthCalculator"),bi=Symbol("allowStale"),Ar=Symbol("maxAge"),Pt=Symbol("dispose"),sE=Symbol("noDisposeOnSet"),ce=Symbol("lruList"),Qe=Symbol("cache"),cE=Symbol("updateAgeOnGet"),Bl=()=>1,jl=class{constructor(t){if(typeof t=="number"&&(t={max:t}),t||(t={}),t.max&&(typeof t.max!="number"||t.max<0))throw new TypeError("max must be a non-negative number");let r=this[Tr]=t.max||1/0,n=t.length||Bl;if(this[gn]=typeof n!="function"?Bl:n,this[bi]=t.stale||!1,t.maxAge&&typeof t.maxAge!="number")throw new TypeError("maxAge must be a number");this[Ar]=t.maxAge||0,this[Pt]=t.dispose,this[sE]=t.noDisposeOnSet||!1,this[cE]=t.updateAgeOnGet||!1,this.reset()}set max(t){if(typeof t!="number"||t<0)throw new TypeError("max must be a non-negative number");this[Tr]=t||1/0,wi(this)}get max(){return this[Tr]}set allowStale(t){this[bi]=!!t}get allowStale(){return this[bi]}set maxAge(t){if(typeof t!="number")throw new TypeError("maxAge must be a non-negative number");this[Ar]=t,wi(this)}get maxAge(){return this[Ar]}set lengthCalculator(t){typeof t!="function"&&(t=Bl),t!==this[gn]&&(this[gn]=t,this[Rt]=0,this[ce].forEach(r=>{r.length=this[gn](r.value,r.key),this[Rt]+=r.length})),wi(this)}get lengthCalculator(){return this[gn]}get length(){return this[Rt]}get itemCount(){return this[ce].length}rforEach(t,r){r=r||this;for(let n=this[ce].tail;n!==null;){let i=n.prev;oE(this,t,n,r),n=i}}forEach(t,r){r=r||this;for(let n=this[ce].head;n!==null;){let i=n.next;oE(this,t,n,r),n=i}}keys(){return this[ce].toArray().map(t=>t.key)}values(){return this[ce].toArray().map(t=>t.value)}reset(){this[Pt]&&this[ce]&&this[ce].length&&this[ce].forEach(t=>this[Pt](t.key,t.value)),this[Qe]=new Map,this[ce]=new aN,this[Rt]=0}dump(){return this[ce].map(t=>Eo(this,t)?!1:{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[ce]}set(t,r,n){if(n=n||this[Ar],n&&typeof n!="number")throw new TypeError("maxAge must be a number");let i=n?Date.now():0,s=this[gn](r,t);if(this[Qe].has(t)){if(s>this[Tr])return _n(this,this[Qe].get(t)),!1;let a=this[Qe].get(t).value;return this[Pt]&&(this[sE]||this[Pt](t,a.value)),a.now=i,a.maxAge=n,a.value=r,this[Rt]+=s-a.length,a.length=s,this.get(t),wi(this),!0}let o=new Ml(t,r,s,i,n);return o.length>this[Tr]?(this[Pt]&&this[Pt](t,r),!1):(this[Rt]+=o.length,this[ce].unshift(o),this[Qe].set(t,this[ce].head),wi(this),!0)}has(t){if(!this[Qe].has(t))return!1;let r=this[Qe].get(t).value;return!Eo(this,r)}get(t){return Nl(this,t,!0)}peek(t){return Nl(this,t,!1)}pop(){let t=this[ce].tail;return t?(_n(this,t),t.value):null}del(t){_n(this,this[Qe].get(t))}load(t){this.reset();let r=Date.now();for(let n=t.length-1;n>=0;n--){let i=t[n],s=i.e||0;if(s===0)this.set(i.k,i.v);else{let o=s-r;o>0&&this.set(i.k,i.v,o)}}}prune(){this[Qe].forEach((t,r)=>Nl(this,r,!1))}},Nl=(e,t,r)=>{let n=e[Qe].get(t);if(n){let i=n.value;if(Eo(e,i)){if(_n(e,n),!e[bi])return}else r&&(e[cE]&&(n.value.now=Date.now()),e[ce].unshiftNode(n));return i.value}},Eo=(e,t)=>{if(!t||!t.maxAge&&!e[Ar])return!1;let r=Date.now()-t.now;return t.maxAge?r>t.maxAge:e[Ar]&&r>e[Ar]},wi=e=>{if(e[Rt]>e[Tr])for(let t=e[ce].tail;e[Rt]>e[Tr]&&t!==null;){let r=t.prev;_n(e,t),t=r}},_n=(e,t)=>{if(t){let r=t.value;e[Pt]&&e[Pt](r.key,r.value),e[Rt]-=r.length,e[Qe].delete(r.key),e[ce].removeNode(t)}},Ml=class{constructor(t,r,n,i,s){this.key=t,this.value=r,this.length=n,this.now=i,this.maxAge=s||0}},oE=(e,t,r,n)=>{let i=r.value;Eo(e,i)&&(_n(e,r),e[bi]||(i=void 0)),i&&t.call(n,i.value,i.key,e)};aE.exports=jl});var yE=h((qr,pE)=>{"use strict";var Dl=g("crypto");qr=pE.exports=Ei;function Ei(e,t){return t=dE(e,t),uN(e,t)}qr.sha1=function(e){return Ei(e)};qr.keys=function(e){return Ei(e,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})};qr.MD5=function(e){return Ei(e,{algorithm:"md5",encoding:"hex"})};qr.keysMD5=function(e){return Ei(e,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var wn=Dl.getHashes?Dl.getHashes().slice():["sha1","md5"];wn.push("passthrough");var lE=["buffer","hex","binary","base64"];function dE(e,t){t=t||{};var r={};if(r.algorithm=t.algorithm||"sha1",r.encoding=t.encoding||"hex",r.excludeValues=!!t.excludeValues,r.algorithm=r.algorithm.toLowerCase(),r.encoding=r.encoding.toLowerCase(),r.ignoreUnknown=t.ignoreUnknown===!0,r.respectType=t.respectType!==!1,r.respectFunctionNames=t.respectFunctionNames!==!1,r.respectFunctionProperties=t.respectFunctionProperties!==!1,r.unorderedArrays=t.unorderedArrays===!0,r.unorderedSets=t.unorderedSets!==!1,r.unorderedObjects=t.unorderedObjects!==!1,r.replacer=t.replacer||void 0,r.excludeKeys=t.excludeKeys||void 0,typeof e>"u")throw new Error("Object argument required.");for(var n=0;n<wn.length;++n)wn[n].toLowerCase()===r.algorithm.toLowerCase()&&(r.algorithm=wn[n]);if(wn.indexOf(r.algorithm)===-1)throw new Error('Algorithm "'+r.algorithm+'"  not supported. supported values: '+wn.join(", "));if(lE.indexOf(r.encoding)===-1&&r.algorithm!=="passthrough")throw new Error('Encoding "'+r.encoding+'"  not supported. supported values: '+lE.join(", "));return r}function fE(e){if(typeof e!="function")return!1;var t=/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i;return t.exec(Function.prototype.toString.call(e))!=null}function uN(e,t){var r;t.algorithm!=="passthrough"?r=Dl.createHash(t.algorithm):r=new hE,typeof r.write>"u"&&(r.write=r.update,r.end=r.update);var n=Jl(t,r);if(n.dispatch(e),r.update||r.end(""),r.digest)return r.digest(t.encoding==="buffer"?void 0:t.encoding);var i=r.read();return t.encoding==="buffer"?i:i.toString(t.encoding)}qr.writeToStream=function(e,t,r){return typeof r>"u"&&(r=t,t={}),t=dE(e,t),Jl(t,r).dispatch(e)};function Jl(e,t,r){r=r||[];var n=function(i){return t.update?t.update(i,"utf8"):t.write(i,"utf8")};return{dispatch:function(i){e.replacer&&(i=e.replacer(i));var s=typeof i;return i===null&&(s="null"),this["_"+s](i)},_object:function(i){var s=/\[object (.*)\]/i,o=Object.prototype.toString.call(i),c=s.exec(o);c?c=c[1]:c="unknown:["+o+"]",c=c.toLowerCase();var a=null;if((a=r.indexOf(i))>=0)return this.dispatch("[CIRCULAR:"+a+"]");if(r.push(i),typeof Buffer<"u"&&Buffer.isBuffer&&Buffer.isBuffer(i))return n("buffer:"),n(i);if(c!=="object"&&c!=="function"&&c!=="asyncfunction")if(this["_"+c])this["_"+c](i);else{if(e.ignoreUnknown)return n("["+c+"]");throw new Error('Unknown object type "'+c+'"')}else{var l=Object.keys(i);e.unorderedObjects&&(l=l.sort()),e.respectType!==!1&&!fE(i)&&l.splice(0,0,"prototype","__proto__","constructor"),e.excludeKeys&&(l=l.filter(function(u){return!e.excludeKeys(u)})),n("object:"+l.length+":");var f=this;return l.forEach(function(u){f.dispatch(u),n(":"),e.excludeValues||f.dispatch(i[u]),n(",")})}},_array:function(i,s){s=typeof s<"u"?s:e.unorderedArrays!==!1;var o=this;if(n("array:"+i.length+":"),!s||i.length<=1)return i.forEach(function(l){return o.dispatch(l)});var c=[],a=i.map(function(l){var f=new hE,u=r.slice(),d=Jl(e,f,u);return d.dispatch(l),c=c.concat(u.slice(r.length)),f.read().toString()});return r=r.concat(c),a.sort(),this._array(a,!1)},_date:function(i){return n("date:"+i.toJSON())},_symbol:function(i){return n("symbol:"+i.toString())},_error:function(i){return n("error:"+i.toString())},_boolean:function(i){return n("bool:"+i.toString())},_string:function(i){n("string:"+i.length+":"),n(i.toString())},_function:function(i){n("fn:"),fE(i)?this.dispatch("[native]"):this.dispatch(i.toString()),e.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(i.name)),e.respectFunctionProperties&&this._object(i)},_number:function(i){return n("number:"+i.toString())},_xml:function(i){return n("xml:"+i.toString())},_null:function(){return n("Null")},_undefined:function(){return n("Undefined")},_regexp:function(i){return n("regex:"+i.toString())},_uint8array:function(i){return n("uint8array:"),this.dispatch(Array.prototype.slice.call(i))},_uint8clampedarray:function(i){return n("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(i))},_int8array:function(i){return n("uint8array:"),this.dispatch(Array.prototype.slice.call(i))},_uint16array:function(i){return n("uint16array:"),this.dispatch(Array.prototype.slice.call(i))},_int16array:function(i){return n("uint16array:"),this.dispatch(Array.prototype.slice.call(i))},_uint32array:function(i){return n("uint32array:"),this.dispatch(Array.prototype.slice.call(i))},_int32array:function(i){return n("uint32array:"),this.dispatch(Array.prototype.slice.call(i))},_float32array:function(i){return n("float32array:"),this.dispatch(Array.prototype.slice.call(i))},_float64array:function(i){return n("float64array:"),this.dispatch(Array.prototype.slice.call(i))},_arraybuffer:function(i){return n("arraybuffer:"),this.dispatch(new Uint8Array(i))},_url:function(i){return n("url:"+i.toString(),"utf8")},_map:function(i){n("map:");var s=Array.from(i);return this._array(s,e.unorderedSets!==!1)},_set:function(i){n("set:");var s=Array.from(i);return this._array(s,e.unorderedSets!==!1)},_file:function(i){return n("file:"),this.dispatch([i.name,i.size,i.type,i.lastModfied])},_blob:function(){if(e.ignoreUnknown)return n("[blob]");throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){return n("domwindow")},_bigint:function(i){return n("bigint:"+i.toString())},_process:function(){return n("process")},_timer:function(){return n("timer")},_pipe:function(){return n("pipe")},_tcp:function(){return n("tcp")},_udp:function(){return n("udp")},_tty:function(){return n("tty")},_statwatcher:function(){return n("statwatcher")},_securecontext:function(){return n("securecontext")},_connection:function(){return n("connection")},_zlib:function(){return n("zlib")},_context:function(){return n("context")},_nodescript:function(){return n("nodescript")},_httpparser:function(){return n("httpparser")},_dataview:function(){return n("dataview")},_signal:function(){return n("signal")},_fsevent:function(){return n("fsevent")},_tlswrap:function(){return n("tlswrap")}}}function hE(){return{buf:"",write:function(e){this.buf+=e},end:function(e){this.buf+=e},read:function(){return this.buf}}}});var wE=h(($l,_E)=>{"use strict";var mE=typeof Reflect<"u"?Reflect.construct:void 0,bn=Object.defineProperty,Ll=Error.captureStackTrace;Ll===void 0&&(Ll=function(t){var r=new Error;bn(t,"stack",{configurable:!0,get:function(){var i=r.stack;return bn(this,"stack",{configurable:!0,value:i,writable:!0}),i},set:function(i){bn(t,"stack",{configurable:!0,value:i,writable:!0})}})});function vo(e){e!==void 0&&bn(this,"message",{configurable:!0,value:e,writable:!0});var t=this.constructor.name;t!==void 0&&t!==this.name&&bn(this,"name",{configurable:!0,value:t,writable:!0}),Ll(this,this.constructor)}vo.prototype=Object.create(Error.prototype,{constructor:{configurable:!0,value:vo,writable:!0}});var gE=function(){function e(r,n){return bn(r,"name",{configurable:!0,value:n})}try{var t=function(){};if(e(t,"foo"),t.name==="foo")return e}catch{}}();function lN(e,t){if(t==null||t===Error)t=vo;else if(typeof t!="function")throw new TypeError("super_ should be a function");var r;if(typeof e=="string")r=e,e=mE!==void 0?function(){return mE(t,arguments,this.constructor)}:function(){t.apply(this,arguments)},gE!==void 0&&(gE(e,r),r=void 0);else if(typeof e!="function")throw new TypeError("constructor should be either a string or a function");e.super_=e.super=t;var n={constructor:{configurable:!0,value:e,writable:!0}};return r!==void 0&&(n.name={configurable:!0,value:r,writable:!0}),e.prototype=Object.create(t.prototype,n),e}$l=_E.exports=lN;$l.BaseError=vo});var Or=h((YY,vE)=>{var{format:bE}=g("util"),EE=wE();function Ul({error_description:e,error:t,error_uri:r,session_state:n,state:i,scope:s},o){Ul.super.call(this,e?`${t} (${e})`:t),Object.assign(this,{error:t},e&&{error_description:e},r&&{error_uri:r},i&&{state:i},s&&{scope:s},n&&{session_state:n}),o&&Object.defineProperty(this,"response",{value:o})}EE(Ul);function vi(...e){if(typeof e[0]=="string")vi.super.call(this,bE(...e));else{let{message:t,printf:r,response:n,...i}=e[0];r?vi.super.call(this,bE(...r)):vi.super.call(this,t),Object.assign(this,i),n&&Object.defineProperty(this,"response",{value:n})}}EE(vi);vE.exports={OPError:Ul,RPError:vi}});var SE=h((VY,fN)=>{fN.exports={name:"got",version:"9.6.0",description:"Simplified HTTP requests",license:"MIT",repository:"sindresorhus/got",main:"source",engines:{node:">=8.6"},scripts:{test:"xo && nyc ava",release:"np"},files:["source"],keywords:["http","https","get","got","url","uri","request","util","utility","simple","curl","wget","fetch","net","network","electron"],dependencies:{"@sindresorhus/is":"^0.14.0","@szmarczak/http-timer":"^1.1.2","cacheable-request":"^6.0.0","decompress-response":"^3.3.0",duplexer3:"^0.1.4","get-stream":"^4.1.0","lowercase-keys":"^1.0.1","mimic-response":"^1.0.1","p-cancelable":"^1.0.0","to-readable-stream":"^1.0.0","url-parse-lax":"^3.0.0"},devDependencies:{ava:"^1.1.0",coveralls:"^3.0.0",delay:"^4.1.0","form-data":"^2.3.3","get-port":"^4.0.0",np:"^3.1.0",nyc:"^13.1.0","p-event":"^2.1.0",pem:"^1.13.2",proxyquire:"^2.0.1",sinon:"^7.2.2","slow-stream":"0.0.4",tempfile:"^2.0.0",tempy:"^0.2.1","tough-cookie":"^3.0.0",xo:"^0.24.0"},ava:{concurrency:4},browser:{"decompress-response":!1,electron:!1}}});var Wl=h((XY,xo)=>{"use strict";var So=class extends Error{constructor(t){super(t||"Promise was canceled"),this.name="CancelError"}get isCanceled(){return!0}},kr=class{static fn(t){return(...r)=>new kr((n,i,s)=>{r.push(s),t(...r).then(n,i)})}constructor(t){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise((r,n)=>{this._reject=n;let i=c=>{this._isPending=!1,r(c)},s=c=>{this._isPending=!1,n(c)},o=c=>{this._cancelHandlers.push(c)};return Object.defineProperties(o,{shouldReject:{get:()=>this._rejectOnCancel,set:c=>{this._rejectOnCancel=c}}}),t(i,s,o)})}then(t,r){return this._promise.then(t,r)}catch(t){return this._promise.catch(t)}finally(t){return this._promise.finally(t)}cancel(t){if(!(!this._isPending||this._isCanceled)){if(this._cancelHandlers.length>0)try{for(let r of this._cancelHandlers)r()}catch(r){this._reject(r)}this._isCanceled=!0,this._rejectOnCancel&&this._reject(new So(t))}}get isCanceled(){return this._isCanceled}};Object.setPrototypeOf(kr.prototype,Promise.prototype);xo.exports=kr;xo.exports.default=kr;xo.exports.CancelError=So});var Ze=h((Hl,Fl)=>{"use strict";Object.defineProperty(Hl,"__esModule",{value:!0});var dN=typeof URL>"u"?g("url").URL:URL,hN=Object.prototype.toString,Si=e=>t=>typeof t===e,xE=e=>!Te.nullOrUndefined(e)&&!Te.nullOrUndefined(e.constructor)&&Te.function_(e.constructor.isBuffer)&&e.constructor.isBuffer(e),To=e=>{let t=hN.call(e).slice(8,-1);return t||null},U=e=>t=>To(t)===e;function Te(e){switch(e){case null:return"null";case!0:case!1:return"boolean";default:}switch(typeof e){case"undefined":return"undefined";case"string":return"string";case"number":return"number";case"symbol":return"symbol";default:}if(Te.function_(e))return"Function";if(Te.observable(e))return"Observable";if(Array.isArray(e))return"Array";if(xE(e))return"Buffer";let t=To(e);if(t)return t;if(e instanceof String||e instanceof Boolean||e instanceof Number)throw new TypeError("Please don't use object wrappers for primitive types");return"Object"}(function(e){let t=u=>typeof u=="object";e.undefined=Si("undefined"),e.string=Si("string"),e.number=Si("number"),e.function_=Si("function"),e.null_=u=>u===null,e.class_=u=>e.function_(u)&&u.toString().startsWith("class "),e.boolean=u=>u===!0||u===!1,e.symbol=Si("symbol"),e.numericString=u=>e.string(u)&&u.length>0&&!Number.isNaN(Number(u)),e.array=Array.isArray,e.buffer=xE,e.nullOrUndefined=u=>e.null_(u)||e.undefined(u),e.object=u=>!e.nullOrUndefined(u)&&(e.function_(u)||t(u)),e.iterable=u=>!e.nullOrUndefined(u)&&e.function_(u[Symbol.iterator]),e.asyncIterable=u=>!e.nullOrUndefined(u)&&e.function_(u[Symbol.asyncIterator]),e.generator=u=>e.iterable(u)&&e.function_(u.next)&&e.function_(u.throw),e.nativePromise=u=>U("Promise")(u);let r=u=>!e.null_(u)&&t(u)&&e.function_(u.then)&&e.function_(u.catch);e.promise=u=>e.nativePromise(u)||r(u),e.generatorFunction=U("GeneratorFunction"),e.asyncFunction=U("AsyncFunction"),e.boundFunction=u=>e.function_(u)&&!u.hasOwnProperty("prototype"),e.regExp=U("RegExp"),e.date=U("Date"),e.error=U("Error"),e.map=u=>U("Map")(u),e.set=u=>U("Set")(u),e.weakMap=u=>U("WeakMap")(u),e.weakSet=u=>U("WeakSet")(u),e.int8Array=U("Int8Array"),e.uint8Array=U("Uint8Array"),e.uint8ClampedArray=U("Uint8ClampedArray"),e.int16Array=U("Int16Array"),e.uint16Array=U("Uint16Array"),e.int32Array=U("Int32Array"),e.uint32Array=U("Uint32Array"),e.float32Array=U("Float32Array"),e.float64Array=U("Float64Array"),e.arrayBuffer=U("ArrayBuffer"),e.sharedArrayBuffer=U("SharedArrayBuffer"),e.dataView=U("DataView"),e.directInstanceOf=(u,d)=>Object.getPrototypeOf(u)===d.prototype,e.urlInstance=u=>U("URL")(u),e.urlString=u=>{if(!e.string(u))return!1;try{return new dN(u),!0}catch{return!1}},e.truthy=u=>Boolean(u),e.falsy=u=>!u,e.nan=u=>Number.isNaN(u);let n=new Set(["undefined","string","number","boolean","symbol"]);e.primitive=u=>e.null_(u)||n.has(typeof u),e.integer=u=>Number.isInteger(u),e.safeInteger=u=>Number.isSafeInteger(u),e.plainObject=u=>{let d;return To(u)==="Object"&&(d=Object.getPrototypeOf(u),d===null||d===Object.getPrototypeOf({}))};let i=new Set(["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"]);e.typedArray=u=>{let d=To(u);return d===null?!1:i.has(d)};let s=u=>e.safeInteger(u)&&u>-1;e.arrayLike=u=>!e.nullOrUndefined(u)&&!e.function_(u)&&s(u.length),e.inRange=(u,d)=>{if(e.number(d))return u>=Math.min(0,d)&&u<=Math.max(d,0);if(e.array(d)&&d.length===2)return u>=Math.min(...d)&&u<=Math.max(...d);throw new TypeError(`Invalid range: ${JSON.stringify(d)}`)};let o=1,c=["innerHTML","ownerDocument","style","attributes","nodeValue"];e.domElement=u=>e.object(u)&&u.nodeType===o&&e.string(u.nodeName)&&!e.plainObject(u)&&c.every(d=>d in u),e.observable=u=>u?!!(u[Symbol.observable]&&u===u[Symbol.observable]()||u["@@observable"]&&u===u["@@observable"]()):!1,e.nodeStream=u=>!e.nullOrUndefined(u)&&t(u)&&e.function_(u.pipe)&&!e.observable(u),e.infinite=u=>u===1/0||u===-1/0;let a=u=>d=>e.integer(d)&&Math.abs(d%2)===u;e.even=a(0),e.odd=a(1);let l=u=>e.string(u)&&/\S/.test(u)===!1;e.emptyArray=u=>e.array(u)&&u.length===0,e.nonEmptyArray=u=>e.array(u)&&u.length>0,e.emptyString=u=>e.string(u)&&u.length===0,e.nonEmptyString=u=>e.string(u)&&u.length>0,e.emptyStringOrWhitespace=u=>e.emptyString(u)||l(u),e.emptyObject=u=>e.object(u)&&!e.map(u)&&!e.set(u)&&Object.keys(u).length===0,e.nonEmptyObject=u=>e.object(u)&&!e.map(u)&&!e.set(u)&&Object.keys(u).length>0,e.emptySet=u=>e.set(u)&&u.size===0,e.nonEmptySet=u=>e.set(u)&&u.size>0,e.emptyMap=u=>e.map(u)&&u.size===0,e.nonEmptyMap=u=>e.map(u)&&u.size>0;let f=(u,d,p)=>{if(e.function_(d)===!1)throw new TypeError(`Invalid predicate: ${JSON.stringify(d)}`);if(p.length===0)throw new TypeError("Invalid number of values");return u.call(p,d)};e.any=(u,...d)=>f(Array.prototype.some,u,d),e.all=(u,...d)=>f(Array.prototype.every,u,d)})(Te||(Te={}));Object.defineProperties(Te,{class:{value:Te.class_},function:{value:Te.function_},null:{value:Te.null_}});Hl.default=Te;Fl.exports=Te;Fl.exports.default=Te});var xi=h((QY,tt)=>{"use strict";var pN=g("url"),Gl=g("http"),yN=Wl(),mN=Ze(),et=class extends Error{constructor(t,r,n){super(t),Error.captureStackTrace(this,this.constructor),this.name="GotError",mN.undefined(r.code)||(this.code=r.code),Object.assign(this,{host:n.host,hostname:n.hostname,method:n.method,path:n.path,socketPath:n.socketPath,protocol:n.protocol,url:n.href,gotOptions:n})}};tt.exports.GotError=et;tt.exports.CacheError=class extends et{constructor(e,t){super(e.message,e,t),this.name="CacheError"}};tt.exports.RequestError=class extends et{constructor(e,t){super(e.message,e,t),this.name="RequestError"}};tt.exports.ReadError=class extends et{constructor(e,t){super(e.message,e,t),this.name="ReadError"}};tt.exports.ParseError=class extends et{constructor(e,t,r,n){super(`${e.message} in "${pN.format(r)}": 
${n.slice(0,77)}...`,e,r),this.name="ParseError",this.statusCode=t,this.statusMessage=Gl.STATUS_CODES[this.statusCode]}};tt.exports.HTTPError=class extends et{constructor(e,t){let{statusCode:r}=e,{statusMessage:n}=e;n?n=n.replace(/\r?\n/g," ").trim():n=Gl.STATUS_CODES[r],super(`Response code ${r} (${n})`,{},t),this.name="HTTPError",this.statusCode=r,this.statusMessage=n,this.headers=e.headers,this.body=e.body}};tt.exports.MaxRedirectsError=class extends et{constructor(e,t,r){super("Redirected 10 times. Aborting.",{},r),this.name="MaxRedirectsError",this.statusCode=e,this.statusMessage=Gl.STATUS_CODES[this.statusCode],this.redirectUrls=t}};tt.exports.UnsupportedProtocolError=class extends et{constructor(e){super(`Unsupported protocol "${e.protocol}"`,{},e),this.name="UnsupportedProtocolError"}};tt.exports.TimeoutError=class extends et{constructor(e,t){super(e.message,{code:"ETIMEDOUT"},t),this.name="TimeoutError",this.event=e.event}};tt.exports.CancelError=yN.CancelError});var TE=h((cV,Yl)=>{"use strict";var zl=g("stream");function En(e,t,r){typeof r>"u"&&(r=t,t=e,e=null),zl.Duplex.call(this,e),typeof r.read!="function"&&(r=new zl.Readable(e).wrap(r)),this._writable=t,this._readable=r,this._waiting=!1;var n=this;t.once("finish",function(){n.end()}),this.once("finish",function(){t.end()}),r.on("readable",function(){n._waiting&&(n._waiting=!1,n._read())}),r.once("end",function(){n.push(null)}),(!e||typeof e.bubbleErrors>"u"||e.bubbleErrors)&&(t.on("error",function(i){n.emit("error",i)}),r.on("error",function(i){n.emit("error",i)}))}En.prototype=Object.create(zl.Duplex.prototype,{constructor:{value:En}});En.prototype._write=function(t,r,n){this._writable.write(t,r,n)};En.prototype._read=function(){for(var t,r=0;(t=this._readable.read())!==null;)this.push(t),r++;r===0&&(this._waiting=!0)};Yl.exports=function(t,r,n){return new En(t,r,n)};Yl.exports.DuplexWrapper=En});var OE=h((aV,Vl)=>{"use strict";var gN=typeof URL>"u"?g("url").URL:URL,_N="text/plain",wN="us-ascii",AE=(e,t)=>t.some(r=>r instanceof RegExp?r.test(e):r===e),bN=(e,{stripHash:t})=>{let r=e.match(/^data:([^,]*?),([^#]*?)(?:#(.*))?$/);if(!r)throw new Error(`Invalid URL: ${e}`);let n=r[1].split(";"),i=r[2],s=t?"":r[3],o=!1;n[n.length-1]==="base64"&&(n.pop(),o=!0);let c=(n.shift()||"").toLowerCase(),l=[...n.map(f=>{let[u,d=""]=f.split("=").map(p=>p.trim());return u==="charset"&&(d=d.toLowerCase(),d===wN)?"":`${u}${d?`=${d}`:""}`}).filter(Boolean)];return o&&l.push("base64"),(l.length!==0||c&&c!==_N)&&l.unshift(c),`data:${l.join(";")},${o?i.trim():i}${s?`#${s}`:""}`},qE=(e,t)=>{if(t={defaultProtocol:"http:",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeDirectoryIndex:!1,sortQueryParameters:!0,...t},Reflect.has(t,"normalizeHttps"))throw new Error("options.normalizeHttps is renamed to options.forceHttp");if(Reflect.has(t,"normalizeHttp"))throw new Error("options.normalizeHttp is renamed to options.forceHttps");if(Reflect.has(t,"stripFragment"))throw new Error("options.stripFragment is renamed to options.stripHash");if(e=e.trim(),/^data:/i.test(e))return bN(e,t);let r=e.startsWith("//");!r&&/^\.*\//.test(e)||(e=e.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,t.defaultProtocol));let i=new gN(e);if(t.forceHttp&&t.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(t.forceHttp&&i.protocol==="https:"&&(i.protocol="http:"),t.forceHttps&&i.protocol==="http:"&&(i.protocol="https:"),t.stripAuthentication&&(i.username="",i.password=""),t.stripHash&&(i.hash=""),i.pathname&&(i.pathname=i.pathname.replace(/((?!:).|^)\/{2,}/g,(s,o)=>/^(?!\/)/g.test(o)?`${o}/`:"/")),i.pathname&&(i.pathname=decodeURI(i.pathname)),t.removeDirectoryIndex===!0&&(t.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(t.removeDirectoryIndex)&&t.removeDirectoryIndex.length>0){let s=i.pathname.split("/"),o=s[s.length-1];AE(o,t.removeDirectoryIndex)&&(s=s.slice(0,s.length-1),i.pathname=s.slice(1).join("/")+"/")}if(i.hostname&&(i.hostname=i.hostname.replace(/\.$/,""),t.stripWWW&&/^www\.([a-z\-\d]{2,63})\.([a-z.]{2,5})$/.test(i.hostname)&&(i.hostname=i.hostname.replace(/^www\./,""))),Array.isArray(t.removeQueryParameters))for(let s of[...i.searchParams.keys()])AE(s,t.removeQueryParameters)&&i.searchParams.delete(s);return t.sortQueryParameters&&i.searchParams.sort(),t.removeTrailingSlash&&(i.pathname=i.pathname.replace(/\/$/,"")),e=i.toString(),(t.removeTrailingSlash||i.pathname==="/")&&i.hash===""&&(e=e.replace(/\/$/,"")),r&&!t.normalizeProtocol&&(e=e.replace(/^http:\/\//,"//")),t.stripProtocol&&(e=e.replace(/^(?:https?:)?\/\//,"")),e};Vl.exports=qE;Vl.exports.default=qE});var PE=h((uV,CE)=>{CE.exports=kE;function kE(e,t){if(e&&t)return kE(e)(t);if(typeof e!="function")throw new TypeError("need wrapper function");return Object.keys(e).forEach(function(n){r[n]=e[n]}),r;function r(){for(var n=new Array(arguments.length),i=0;i<n.length;i++)n[i]=arguments[i];var s=e.apply(this,n),o=n[n.length-1];return typeof s=="function"&&s!==o&&Object.keys(o).forEach(function(c){s[c]=o[c]}),s}}});var Ql=h((lV,Xl)=>{var RE=PE();Xl.exports=RE(Ao);Xl.exports.strict=RE(KE);Ao.proto=Ao(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return Ao(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return KE(this)},configurable:!0})});function Ao(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function KE(e){var t=function(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)},r=e.name||"Function wrapped with `once`";return t.onceError=r+" shouldn't be called more than once",t.called=!1,t}});var NE=h((fV,BE)=>{var EN=Ql(),vN=function(){},SN=function(e){return e.setHeader&&typeof e.abort=="function"},xN=function(e){return e.stdio&&Array.isArray(e.stdio)&&e.stdio.length===3},IE=function(e,t,r){if(typeof t=="function")return IE(e,null,t);t||(t={}),r=EN(r||vN);var n=e._writableState,i=e._readableState,s=t.readable||t.readable!==!1&&e.readable,o=t.writable||t.writable!==!1&&e.writable,c=!1,a=function(){e.writable||l()},l=function(){o=!1,s||r.call(e)},f=function(){s=!1,o||r.call(e)},u=function(_){r.call(e,_?new Error("exited with error code: "+_):null)},d=function(_){r.call(e,_)},p=function(){process.nextTick(m)},m=function(){if(!c){if(s&&!(i&&i.ended&&!i.destroyed))return r.call(e,new Error("premature close"));if(o&&!(n&&n.ended&&!n.destroyed))return r.call(e,new Error("premature close"))}},y=function(){e.req.on("finish",l)};return SN(e)?(e.on("complete",l),e.on("abort",p),e.req?y():e.on("request",y)):o&&!n&&(e.on("end",a),e.on("close",a)),xN(e)&&e.on("exit",u),e.on("end",f),e.on("finish",l),t.error!==!1&&e.on("error",d),e.on("close",p),function(){c=!0,e.removeListener("complete",l),e.removeListener("abort",p),e.removeListener("request",y),e.req&&e.req.removeListener("finish",l),e.removeListener("end",a),e.removeListener("close",a),e.removeListener("finish",l),e.removeListener("exit",u),e.removeListener("end",f),e.removeListener("error",d),e.removeListener("close",p)}};BE.exports=IE});var ef=h((dV,ME)=>{var TN=Ql(),AN=NE(),Zl=g("fs"),Ti=function(){},qN=/^v?\.0/.test(process.version),qo=function(e){return typeof e=="function"},ON=function(e){return!qN||!Zl?!1:(e instanceof(Zl.ReadStream||Ti)||e instanceof(Zl.WriteStream||Ti))&&qo(e.close)},kN=function(e){return e.setHeader&&qo(e.abort)},CN=function(e,t,r,n){n=TN(n);var i=!1;e.on("close",function(){i=!0}),AN(e,{readable:t,writable:r},function(o){if(o)return n(o);i=!0,n()});var s=!1;return function(o){if(!i&&!s){if(s=!0,ON(e))return e.close(Ti);if(kN(e))return e.abort();if(qo(e.destroy))return e.destroy();n(o||new Error("stream was destroyed"))}}},jE=function(e){e()},PN=function(e,t){return e.pipe(t)},RN=function(){var e=Array.prototype.slice.call(arguments),t=qo(e[e.length-1]||Ti)&&e.pop()||Ti;if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new Error("pump requires two streams per minimum");var r,n=e.map(function(i,s){var o=s<e.length-1,c=s>0;return CN(i,o,c,function(a){r||(r=a),a&&n.forEach(jE),!o&&(n.forEach(jE),t(r))})});return e.reduce(PN)};ME.exports=RN});var JE=h((hV,DE)=>{"use strict";var{PassThrough:KN}=g("stream");DE.exports=e=>{e={...e};let{array:t}=e,{encoding:r}=e,n=r==="buffer",i=!1;t?i=!(r||n):r=r||"utf8",n&&(r=null);let s=new KN({objectMode:i});r&&s.setEncoding(r);let o=0,c=[];return s.on("data",a=>{c.push(a),i?o=c.length:o+=a.length}),s.getBufferedValue=()=>t?c:n?Buffer.concat(c,o):c.join(""),s.getBufferedLength=()=>o,s}});var LE=h((pV,vn)=>{"use strict";var{constants:IN}=g("buffer"),BN=ef(),NN=JE(),Oo=class extends Error{constructor(){super("maxBuffer exceeded"),this.name="MaxBufferError"}};async function ko(e,t){if(!e)return Promise.reject(new Error("Expected a stream"));t={maxBuffer:1/0,...t};let{maxBuffer:r}=t,n;return await new Promise((i,s)=>{let o=c=>{c&&n.getBufferedLength()<=IN.MAX_LENGTH&&(c.bufferedData=n.getBufferedValue()),s(c)};n=BN(e,NN(t),c=>{if(c){o(c);return}i()}),n.on("data",()=>{n.getBufferedLength()>r&&o(new Oo)})}),n.getBufferedValue()}vn.exports=ko;vn.exports.default=ko;vn.exports.buffer=(e,t)=>ko(e,{...t,encoding:"buffer"});vn.exports.array=(e,t)=>ko(e,{...t,array:!0});vn.exports.MaxBufferError=Oo});var UE=h((mV,$E)=>{"use strict";var jN=new Set([200,203,204,206,300,301,308,404,405,410,414,501]),MN=new Set([200,203,204,300,301,302,303,307,308,404,405,410,414,501]),DN=new Set([500,502,503,504]),JN={date:!0,connection:!0,"keep-alive":!0,"proxy-authenticate":!0,"proxy-authorization":!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0},LN={"content-length":!0,"content-encoding":!0,"transfer-encoding":!0,"content-range":!0};function Cr(e){let t=parseInt(e,10);return isFinite(t)?t:0}function $N(e){return e?DN.has(e.status):!0}function tf(e){let t={};if(!e)return t;let r=e.trim().split(/,/);for(let n of r){let[i,s]=n.split(/=/,2);t[i.trim()]=s===void 0?!0:s.trim().replace(/^"|"$/g,"")}return t}function UN(e){let t=[];for(let r in e){let n=e[r];t.push(n===!0?r:r+"="+n)}if(!!t.length)return t.join(", ")}$E.exports=class{constructor(t,r,{shared:n,cacheHeuristic:i,immutableMinTimeToLive:s,ignoreCargoCult:o,_fromObject:c}={}){if(c){this._fromObject(c);return}if(!r||!r.headers)throw Error("Response headers missing");this._assertRequestHasHeaders(t),this._responseTime=this.now(),this._isShared=n!==!1,this._cacheHeuristic=i!==void 0?i:.1,this._immutableMinTtl=s!==void 0?s:24*3600*1e3,this._status="status"in r?r.status:200,this._resHeaders=r.headers,this._rescc=tf(r.headers["cache-control"]),this._method="method"in t?t.method:"GET",this._url=t.url,this._host=t.headers.host,this._noAuthorization=!t.headers.authorization,this._reqHeaders=r.headers.vary?t.headers:null,this._reqcc=tf(t.headers["cache-control"]),o&&"pre-check"in this._rescc&&"post-check"in this._rescc&&(delete this._rescc["pre-check"],delete this._rescc["post-check"],delete this._rescc["no-cache"],delete this._rescc["no-store"],delete this._rescc["must-revalidate"],this._resHeaders=Object.assign({},this._resHeaders,{"cache-control":UN(this._rescc)}),delete this._resHeaders.expires,delete this._resHeaders.pragma),r.headers["cache-control"]==null&&/no-cache/.test(r.headers.pragma)&&(this._rescc["no-cache"]=!0)}now(){return Date.now()}storable(){return!!(!this._reqcc["no-store"]&&(this._method==="GET"||this._method==="HEAD"||this._method==="POST"&&this._hasExplicitExpiration())&&MN.has(this._status)&&!this._rescc["no-store"]&&(!this._isShared||!this._rescc.private)&&(!this._isShared||this._noAuthorization||this._allowsStoringAuthenticated())&&(this._resHeaders.expires||this._rescc["max-age"]||this._isShared&&this._rescc["s-maxage"]||this._rescc.public||jN.has(this._status)))}_hasExplicitExpiration(){return this._isShared&&this._rescc["s-maxage"]||this._rescc["max-age"]||this._resHeaders.expires}_assertRequestHasHeaders(t){if(!t||!t.headers)throw Error("Request headers missing")}satisfiesWithoutRevalidation(t){this._assertRequestHasHeaders(t);let r=tf(t.headers["cache-control"]);return r["no-cache"]||/no-cache/.test(t.headers.pragma)||r["max-age"]&&this.age()>r["max-age"]||r["min-fresh"]&&this.timeToLive()<1e3*r["min-fresh"]||this.stale()&&!(r["max-stale"]&&!this._rescc["must-revalidate"]&&(r["max-stale"]===!0||r["max-stale"]>this.age()-this.maxAge()))?!1:this._requestMatches(t,!1)}_requestMatches(t,r){return(!this._url||this._url===t.url)&&this._host===t.headers.host&&(!t.method||this._method===t.method||r&&t.method==="HEAD")&&this._varyMatches(t)}_allowsStoringAuthenticated(){return this._rescc["must-revalidate"]||this._rescc.public||this._rescc["s-maxage"]}_varyMatches(t){if(!this._resHeaders.vary)return!0;if(this._resHeaders.vary==="*")return!1;let r=this._resHeaders.vary.trim().toLowerCase().split(/\s*,\s*/);for(let n of r)if(t.headers[n]!==this._reqHeaders[n])return!1;return!0}_copyWithoutHopByHopHeaders(t){let r={};for(let n in t)JN[n]||(r[n]=t[n]);if(t.connection){let n=t.connection.trim().split(/\s*,\s*/);for(let i of n)delete r[i]}if(r.warning){let n=r.warning.split(/,/).filter(i=>!/^\s*1[0-9][0-9]/.test(i));n.length?r.warning=n.join(",").trim():delete r.warning}return r}responseHeaders(){let t=this._copyWithoutHopByHopHeaders(this._resHeaders),r=this.age();return r>3600*24&&!this._hasExplicitExpiration()&&this.maxAge()>3600*24&&(t.warning=(t.warning?`${t.warning}, `:"")+'113 - "rfc7234 5.5.4"'),t.age=`${Math.round(r)}`,t.date=new Date(this.now()).toUTCString(),t}date(){let t=Date.parse(this._resHeaders.date);return isFinite(t)?t:this._responseTime}age(){let t=this._ageValue(),r=(this.now()-this._responseTime)/1e3;return t+r}_ageValue(){return Cr(this._resHeaders.age)}maxAge(){if(!this.storable()||this._rescc["no-cache"]||this._isShared&&this._resHeaders["set-cookie"]&&!this._rescc.public&&!this._rescc.immutable||this._resHeaders.vary==="*")return 0;if(this._isShared){if(this._rescc["proxy-revalidate"])return 0;if(this._rescc["s-maxage"])return Cr(this._rescc["s-maxage"])}if(this._rescc["max-age"])return Cr(this._rescc["max-age"]);let t=this._rescc.immutable?this._immutableMinTtl:0,r=this.date();if(this._resHeaders.expires){let n=Date.parse(this._resHeaders.expires);return Number.isNaN(n)||n<r?0:Math.max(t,(n-r)/1e3)}if(this._resHeaders["last-modified"]){let n=Date.parse(this._resHeaders["last-modified"]);if(isFinite(n)&&r>n)return Math.max(t,(r-n)/1e3*this._cacheHeuristic)}return t}timeToLive(){let t=this.maxAge()-this.age(),r=t+Cr(this._rescc["stale-if-error"]),n=t+Cr(this._rescc["stale-while-revalidate"]);return Math.max(0,t,r,n)*1e3}stale(){return this.maxAge()<=this.age()}_useStaleIfError(){return this.maxAge()+Cr(this._rescc["stale-if-error"])>this.age()}useStaleWhileRevalidate(){return this.maxAge()+Cr(this._rescc["stale-while-revalidate"])>this.age()}static fromObject(t){return new this(void 0,void 0,{_fromObject:t})}_fromObject(t){if(this._responseTime)throw Error("Reinitialized");if(!t||t.v!==1)throw Error("Invalid serialization");this._responseTime=t.t,this._isShared=t.sh,this._cacheHeuristic=t.ch,this._immutableMinTtl=t.imm!==void 0?t.imm:24*3600*1e3,this._status=t.st,this._resHeaders=t.resh,this._rescc=t.rescc,this._method=t.m,this._url=t.u,this._host=t.h,this._noAuthorization=t.a,this._reqHeaders=t.reqh,this._reqcc=t.reqcc}toObject(){return{v:1,t:this._responseTime,sh:this._isShared,ch:this._cacheHeuristic,imm:this._immutableMinTtl,st:this._status,resh:this._resHeaders,rescc:this._rescc,m:this._method,u:this._url,h:this._host,a:this._noAuthorization,reqh:this._reqHeaders,reqcc:this._reqcc}}revalidationHeaders(t){this._assertRequestHasHeaders(t);let r=this._copyWithoutHopByHopHeaders(t.headers);if(delete r["if-range"],!this._requestMatches(t,!0)||!this.storable())return delete r["if-none-match"],delete r["if-modified-since"],r;if(this._resHeaders.etag&&(r["if-none-match"]=r["if-none-match"]?`${r["if-none-match"]}, ${this._resHeaders.etag}`:this._resHeaders.etag),r["accept-ranges"]||r["if-match"]||r["if-unmodified-since"]||this._method&&this._method!="GET"){if(delete r["if-modified-since"],r["if-none-match"]){let i=r["if-none-match"].split(/,/).filter(s=>!/^\s*W\//.test(s));i.length?r["if-none-match"]=i.join(",").trim():delete r["if-none-match"]}}else this._resHeaders["last-modified"]&&!r["if-modified-since"]&&(r["if-modified-since"]=this._resHeaders["last-modified"]);return r}revalidatedPolicy(t,r){if(this._assertRequestHasHeaders(t),this._useStaleIfError()&&$N(r))return{modified:!1,matches:!1,policy:this};if(!r||!r.headers)throw Error("Response headers missing");let n=!1;if(r.status!==void 0&&r.status!=304?n=!1:r.headers.etag&&!/^\s*W\//.test(r.headers.etag)?n=this._resHeaders.etag&&this._resHeaders.etag.replace(/^\s*W\//,"")===r.headers.etag:this._resHeaders.etag&&r.headers.etag?n=this._resHeaders.etag.replace(/^\s*W\//,"")===r.headers.etag.replace(/^\s*W\//,""):this._resHeaders["last-modified"]?n=this._resHeaders["last-modified"]===r.headers["last-modified"]:!this._resHeaders.etag&&!this._resHeaders["last-modified"]&&!r.headers.etag&&!r.headers["last-modified"]&&(n=!0),!n)return{policy:new this.constructor(t,r),modified:r.status!=304,matches:!1};let i={};for(let o in this._resHeaders)i[o]=o in r.headers&&!LN[o]?r.headers[o]:this._resHeaders[o];let s=Object.assign({},r,{status:this._status,method:this._method,headers:i});return{policy:new this.constructor(t,s,{shared:this._isShared,cacheHeuristic:this._cacheHeuristic,immutableMinTimeToLive:this._immutableMinTtl}),modified:!1,matches:!0}}}});var rf=h((gV,WE)=>{"use strict";WE.exports=function(e){for(var t={},r=Object.keys(Object(e)),n=0;n<r.length;n++)t[r[n].toLowerCase()]=e[r[n]];return t}});var FE=h((_V,HE)=>{"use strict";var WN=g("stream").Readable,HN=rf(),nf=class extends WN{constructor(t,r,n,i){if(typeof t!="number")throw new TypeError("Argument `statusCode` should be a number");if(typeof r!="object")throw new TypeError("Argument `headers` should be an object");if(!(n instanceof Buffer))throw new TypeError("Argument `body` should be a buffer");if(typeof i!="string")throw new TypeError("Argument `url` should be a string");super(),this.statusCode=t,this.headers=HN(r),this.body=n,this.url=i}_read(){this.push(this.body),this.push(null)}};HE.exports=nf});var zE=h((wV,GE)=>{"use strict";GE.exports=e=>{let t={};for(let[r,n]of Object.entries(e))t[r.toLowerCase()]=n;return t}});var Co=h((bV,YE)=>{"use strict";var FN=["destroy","setTimeout","socket","headers","trailers","rawHeaders","statusCode","httpVersion","httpVersionMinor","httpVersionMajor","rawTrailers","statusMessage"];YE.exports=(e,t)=>{let r=new Set(Object.keys(e).concat(FN));for(let n of r)n in t||(t[n]=typeof e[n]=="function"?e[n].bind(e):e[n])}});var XE=h((EV,VE)=>{"use strict";var GN=g("stream").PassThrough,zN=Co(),YN=e=>{if(!(e&&e.pipe))throw new TypeError("Parameter `response` must be a response stream.");let t=new GN;return zN(e,t),e.pipe(t)};VE.exports=YN});var QE=h(sf=>{sf.stringify=function e(t){if(typeof t>"u")return t;if(t&&Buffer.isBuffer(t))return JSON.stringify(":base64:"+t.toString("base64"));if(t&&t.toJSON&&(t=t.toJSON()),t&&typeof t=="object"){var r="",n=Array.isArray(t);r=n?"[":"{";var i=!0;for(var s in t){var o=typeof t[s]=="function"||!n&&typeof t[s]>"u";Object.hasOwnProperty.call(t,s)&&!o&&(i||(r+=","),i=!1,n?t[s]==null?r+="null":r+=e(t[s]):t[s]!==void 0&&(r+=e(s)+":"+e(t[s])))}return r+=n?"]":"}",r}else return typeof t=="string"?JSON.stringify(/^:/.test(t)?":"+t:t):typeof t>"u"?"null":JSON.stringify(t)};sf.parse=function(e){return JSON.parse(e,function(t,r){return typeof r=="string"?/^:base64:/.test(r)?new Buffer(r.substring(8),"base64"):/^:/.test(r)?r.substring(1):r:r})}});var t0=h((SV,e0)=>{"use strict";var VN=g("events"),ZE=QE(),XN=e=>{let t={redis:"@keyv/redis",mongodb:"@keyv/mongo",mongo:"@keyv/mongo",sqlite:"@keyv/sqlite",postgresql:"@keyv/postgres",postgres:"@keyv/postgres",mysql:"@keyv/mysql"};if(e.adapter||e.uri){let r=e.adapter||/^[^:]*/.exec(e.uri)[0];return new(g(t[r]))(e)}return new Map},of=class extends VN{constructor(t,r){if(super(),this.opts=Object.assign({namespace:"keyv",serialize:ZE.stringify,deserialize:ZE.parse},typeof t=="string"?{uri:t}:t,r),!this.opts.store){let n=Object.assign({},this.opts);this.opts.store=XN(n)}typeof this.opts.store.on=="function"&&this.opts.store.on("error",n=>this.emit("error",n)),this.opts.store.namespace=this.opts.namespace}_getKeyPrefix(t){return`${this.opts.namespace}:${t}`}get(t){t=this._getKeyPrefix(t);let r=this.opts.store;return Promise.resolve().then(()=>r.get(t)).then(n=>{if(n=typeof n=="string"?this.opts.deserialize(n):n,n!==void 0){if(typeof n.expires=="number"&&Date.now()>n.expires){this.delete(t);return}return n.value}})}set(t,r,n){t=this._getKeyPrefix(t),typeof n>"u"&&(n=this.opts.ttl),n===0&&(n=void 0);let i=this.opts.store;return Promise.resolve().then(()=>{let s=typeof n=="number"?Date.now()+n:null;return r={value:r,expires:s},i.set(t,this.opts.serialize(r),n)}).then(()=>!0)}delete(t){t=this._getKeyPrefix(t);let r=this.opts.store;return Promise.resolve().then(()=>r.delete(t))}clear(){let t=this.opts.store;return Promise.resolve().then(()=>t.clear())}};e0.exports=of});var i0=h((TV,n0)=>{"use strict";var QN=g("events"),Po=g("url"),ZN=OE(),ej=LE(),cf=UE(),r0=FE(),tj=zE(),rj=XE(),nj=t0(),rt=class{constructor(t,r){if(typeof t!="function")throw new TypeError("Parameter `request` must be a function");return this.cache=new nj({uri:typeof r=="string"&&r,store:typeof r!="string"&&r,namespace:"cacheable-request"}),this.createCacheableRequest(t)}createCacheableRequest(t){return(r,n)=>{let i;if(typeof r=="string")i=af(Po.parse(r)),r={};else if(r instanceof Po.URL)i=af(Po.parse(r.toString())),r={};else{let[u,...d]=(r.path||"").split("?"),p=d.length>0?`?${d.join("?")}`:"";i=af({...r,pathname:u,search:p})}r={headers:{},method:"GET",cache:!0,strictTtl:!1,automaticFailover:!1,...r,...ij(i)},r.headers=tj(r.headers);let s=new QN,o=ZN(Po.format(i),{stripWWW:!1,removeTrailingSlash:!1,stripAuthentication:!1}),c=`${r.method}:${o}`,a=!1,l=!1,f=u=>{l=!0;let d=!1,p,m=new Promise(_=>{p=()=>{d||(d=!0,_())}}),y=_=>{if(a&&!u.forceRefresh){_.status=_.statusCode;let w=cf.fromObject(a.cachePolicy).revalidatedPolicy(u,_);if(!w.modified){let v=w.policy.responseHeaders();_=new r0(a.statusCode,v,a.body,a.url),_.cachePolicy=w.policy,_.fromCache=!0}}_.fromCache||(_.cachePolicy=new cf(u,_,u),_.fromCache=!1);let b;u.cache&&_.cachePolicy.storable()?(b=rj(_),(async()=>{try{let w=ej.buffer(_);if(await Promise.race([m,new Promise(x=>_.once("end",x))]),d)return;let v=await w,S={cachePolicy:_.cachePolicy.toObject(),url:_.url,statusCode:_.fromCache?a.statusCode:_.statusCode,body:v},E=u.strictTtl?_.cachePolicy.timeToLive():void 0;u.maxTtl&&(E=E?Math.min(E,u.maxTtl):u.maxTtl),await this.cache.set(c,S,E)}catch(w){s.emit("error",new rt.CacheError(w))}})()):u.cache&&a&&(async()=>{try{await this.cache.delete(c)}catch(w){s.emit("error",new rt.CacheError(w))}})(),s.emit("response",b||_),typeof n=="function"&&n(b||_)};try{let _=t(u,y);_.once("error",p),_.once("abort",p),s.emit("request",_)}catch(_){s.emit("error",new rt.RequestError(_))}};return(async()=>{let u=async p=>{await Promise.resolve();let m=p.cache?await this.cache.get(c):void 0;if(typeof m>"u")return f(p);let y=cf.fromObject(m.cachePolicy);if(y.satisfiesWithoutRevalidation(p)&&!p.forceRefresh){let _=y.responseHeaders(),b=new r0(m.statusCode,_,m.body,m.url);b.cachePolicy=y,b.fromCache=!0,s.emit("response",b),typeof n=="function"&&n(b)}else a=m,p.headers=y.revalidationHeaders(p),f(p)},d=p=>s.emit("error",new rt.CacheError(p));this.cache.once("error",d),s.on("response",()=>this.cache.removeListener("error",d));try{await u(r)}catch(p){r.automaticFailover&&!l&&f(r),s.emit("error",new rt.CacheError(p))}})(),s}}};function ij(e){let t={...e};return t.path=`${e.pathname||"/"}${e.search||""}`,delete t.pathname,delete t.search,t}function af(e){return{protocol:e.protocol,auth:e.auth,hostname:e.hostname||e.host||"localhost",port:e.port,pathname:e.pathname,search:e.search}}rt.RequestError=class extends Error{constructor(e){super(e.message),this.name="RequestError",Object.assign(this,e)}};rt.CacheError=class extends Error{constructor(e){super(e.message),this.name="CacheError",Object.assign(this,e)}};n0.exports=rt});var o0=h((OV,s0)=>{"use strict";var{Readable:sj}=g("stream");s0.exports=e=>new sj({read(){this.push(e),this.push(null)}})});var c0=h((lf,ff)=>{"use strict";Object.defineProperty(lf,"__esModule",{value:!0});var oj=g("tls"),uf=(e,t)=>{let r;typeof t=="function"?r={connect:t}:r=t;let n=typeof r.connect=="function",i=typeof r.secureConnect=="function",s=typeof r.close=="function",o=()=>{n&&r.connect(),e instanceof oj.TLSSocket&&i&&(e.authorized?r.secureConnect():e.authorizationError||e.once("secureConnect",r.secureConnect)),s&&e.once("close",r.close)};e.writable&&!e.connecting?o():e.connecting?e.once("connect",o):e.destroyed&&s&&r.close(e._hadError)};lf.default=uf;ff.exports=uf;ff.exports.default=uf});var u0=h((kV,a0)=>{"use strict";var cj=c0();a0.exports=e=>{let t={start:Date.now(),socket:null,lookup:null,connect:null,upload:null,response:null,end:null,error:null,phases:{wait:null,dns:null,tcp:null,request:null,firstByte:null,download:null,total:null}},r=s=>{let o=s.emit.bind(s);s.emit=(c,...a)=>(c==="error"&&(t.error=Date.now(),t.phases.total=t.error-t.start,s.emit=o),o(c,...a))},n=!1,i=()=>{t.upload=Date.now(),t.phases.request=t.upload-t.connect};return r(e),e.once("socket",s=>{t.socket=Date.now(),t.phases.wait=t.socket-t.start;let o=()=>{t.lookup=Date.now(),t.phases.dns=t.lookup-t.socket};s.once("lookup",o),cj(s,()=>{t.connect=Date.now(),t.lookup===null&&(s.removeListener("lookup",o),t.lookup=t.connect,t.phases.dns=t.lookup-t.socket),t.phases.tcp=t.connect-t.lookup,n&&!t.upload&&i()})}),e.once("finish",()=>{n=!0,t.connect&&i()}),e.once("response",s=>{t.response=Date.now(),t.phases.firstByte=t.response-t.upload,r(s),s.once("end",()=>{t.end=Date.now(),t.phases.download=t.end-t.response,t.phases.total=t.end-t.start})}),t}});var d0=h((CV,df)=>{"use strict";var l0=g("net"),Ro=class extends Error{constructor(t,r){super(`Timeout awaiting '${r}' for ${t}ms`),this.name="TimeoutError",this.code="ETIMEDOUT",this.event=r}},f0=Symbol("reentry"),aj=()=>{};df.exports=(e,t,r)=>{if(e[f0])return;e[f0]=!0;let n=!1,i=(f,u,...d)=>{if(n)return aj;let p,m=setTimeout(()=>{p=setImmediate(u,f,...d),p.unref&&p.unref()},f);m.unref&&m.unref();let y=()=>{clearTimeout(m),clearImmediate(p)};return a.push(y),y},{host:s,hostname:o}=r,c=(f,u)=>{e.emit("error",new Ro(f,u)),e.once("error",()=>{}),e.abort()},a=[],l=()=>{n=!0,a.forEach(f=>f())};if(e.once("error",l),e.once("response",f=>{f.once("end",l)}),t.request!==void 0&&i(t.request,c,"request"),t.socket!==void 0){let f=()=>{c(t.socket,"socket")};e.setTimeout(t.socket,f),a.push(()=>e.removeListener("timeout",f))}t.lookup!==void 0&&!e.socketPath&&!l0.isIP(o||s)&&e.once("socket",f=>{if(f.connecting){let u=i(t.lookup,c,"lookup");f.once("lookup",u)}}),t.connect!==void 0&&e.once("socket",f=>{if(f.connecting){let u=()=>i(t.connect,c,"connect");e.socketPath||l0.isIP(o||s)?f.once("connect",u()):f.once("lookup",d=>{d===null&&f.once("connect",u())})}}),t.secureConnect!==void 0&&r.protocol==="https:"&&e.once("socket",f=>{f.connecting&&f.once("connect",()=>{let u=i(t.secureConnect,c,"secureConnect");f.once("secureConnect",u)})}),t.send!==void 0&&e.once("socket",f=>{let u=()=>i(t.send,c,"send");f.connecting?f.once("connect",()=>{e.once("upload-complete",u())}):e.once("upload-complete",u())}),t.response!==void 0&&e.once("upload-complete",()=>{let f=i(t.response,c,"response");e.once("response",f)})};df.exports.TimeoutError=Ro});var hf=h((PV,p0)=>{"use strict";var h0=Ze();p0.exports=e=>h0.nodeStream(e)&&h0.function(e.getBoundary)});var _0=h((RV,g0)=>{"use strict";var y0=g("fs"),m0=g("util"),uj=Ze(),lj=hf();g0.exports=async e=>{let{body:t}=e;if(e.headers["content-length"])return Number(e.headers["content-length"]);if(!t&&!e.stream)return 0;if(uj.string(t))return Buffer.byteLength(t);if(lj(t))return m0.promisify(t.getLength.bind(t))();if(t instanceof y0.ReadStream){let{size:r}=await m0.promisify(y0.stat)(t.path);return r}return null}});var b0=h((KV,w0)=>{"use strict";var fj=g("stream").PassThrough,dj=g("zlib"),hj=Co();w0.exports=e=>{if(["gzip","deflate"].indexOf(e.headers["content-encoding"])===-1)return e;let t=dj.createUnzip(),r=new fj;return hj(e,r),t.on("error",n=>{if(n.code==="Z_BUF_ERROR"){r.end();return}r.emit("error",n)}),e.pipe(t).pipe(r),r}});var pf=h((IV,E0)=>{"use strict";var{Transform:pj}=g("stream");E0.exports={download(e,t,r){let n=0;return new pj({transform(i,s,o){n+=i.length;let c=r?n/r:0;c<1&&t.emit("downloadProgress",{percent:c,transferred:n,total:r}),o(null,i)},flush(i){t.emit("downloadProgress",{percent:1,transferred:n,total:r}),i()}})},upload(e,t,r){let i=0,s;t.emit("uploadProgress",{percent:0,transferred:0,total:r}),e.once("error",()=>{clearInterval(s)}),e.once("response",()=>{clearInterval(s),t.emit("uploadProgress",{percent:1,transferred:i,total:r})}),e.once("socket",o=>{let c=()=>{s=setInterval(()=>{let a=i,l=e._header?Buffer.byteLength(e._header):0;i=o.bytesWritten-l,!(i===a||i===r)&&t.emit("uploadProgress",{percent:r?i/r:0,transferred:i,total:r})},150)};o.connecting?o.once("connect",c):o.writable&&c()})}}});var x0=h((BV,S0)=>{"use strict";var v0=b0(),yj=Ze(),mj=Co(),gj=pf();S0.exports=(e,t,r)=>{let n=Number(e.headers["content-length"])||null,i=gj.download(e,r,n);mj(e,i);let s=t.decompress===!0&&yj.function(v0)&&t.method!=="HEAD"?v0(i):i;!t.decompress&&["gzip","deflate"].includes(e.headers["content-encoding"])&&(t.encoding=null),r.emit("response",s),r.emit("downloadProgress",{percent:0,transferred:0,total:n}),e.pipe(i)}});var yf=h((NV,A0)=>{"use strict";var T0=Ze();A0.exports=e=>{let t={protocol:e.protocol,hostname:e.hostname.startsWith("[")?e.hostname.slice(1,-1):e.hostname,hash:e.hash,search:e.search,pathname:e.pathname,href:e.href};return T0.string(e.port)&&e.port.length>0&&(t.port=Number(e.port)),(e.username||e.password)&&(t.auth=`${e.username}:${e.password}`),t.path=T0.null(e.search)?e.pathname:`${e.pathname}${e.search}`,t}});var mf=h((jV,P0)=>{"use strict";var{URL:q0}=g("url"),O0=g("util"),_j=g("events"),wj=g("http"),bj=g("https"),Ej=g("url"),k0=i0(),vj=o0(),Kt=Ze(),Sj=u0(),C0=d0(),xj=_0(),Tj=x0(),Aj=pf(),{CacheError:qj,UnsupportedProtocolError:Oj,MaxRedirectsError:kj,RequestError:Ko,TimeoutError:Cj}=xi(),Pj=yf(),Rj=new Set([300,301,302,303,304,305,307,308]),Kj=new Set([300,303,307,308]);P0.exports=(e,t)=>{let r=new _j,n=[],i,s,o,c,a=0,l=!1,f=e.cookieJar?O0.promisify(e.cookieJar.setCookie.bind(e.cookieJar)):null,u=e.cookieJar?O0.promisify(e.cookieJar.getCookieString.bind(e.cookieJar)):null,d=Kt.object(e.agent)?e.agent:null,p=async y=>{try{for(let _ of e.hooks.beforeError)y=await _(y);r.emit("error",y)}catch(_){r.emit("error",_)}},m=async y=>{let _=o||s;if(y.protocol!=="http:"&&y.protocol!=="https:")throw new Oj(y);decodeURI(_);let b;if(Kt.function(y.request)?b={request:y.request}:b=y.protocol==="https:"?bj:wj,d){let E=y.protocol==="https:"?"https":"http";y.agent=d[E]||y.agent}if(y.useElectronNet&&process.versions.electron){let E={x:g}["yx".slice(1)],x=E("electron");b=x.net||x.remote.net}if(y.cookieJar){let E=await u(_,{});Kt.nonEmptyString(E)&&(y.headers.cookie=E)}let w,v=async E=>{try{y.useElectronNet&&(E=new Proxy(E,{get:(T,R)=>{if(R==="trailers"||R==="rawTrailers")return[];let k=T[R];return Kt.function(k)?k.bind(T):k}}));let{statusCode:x}=E;E.url=_,E.requestUrl=s,E.retryCount=a,E.timings=w,E.redirectUrls=n,E.request={gotOptions:y};let q=E.headers["set-cookie"];if(y.cookieJar&&q&&await Promise.all(q.map(T=>f(T,E.url))),y.followRedirect&&"location"in E.headers&&(Kj.has(x)||Rj.has(x)&&(y.method==="GET"||y.method==="HEAD"))){if(E.resume(),x===303&&(y.method="GET"),n.length>=10)throw new kj(x,n,y);let T=Buffer.from(E.headers.location,"binary").toString(),R=new q0(T,_);o=R.toString(),n.push(o);let k={...y,...Pj(R)};for(let ee of y.hooks.beforeRedirect)await ee(k);r.emit("redirect",E,k),await m(k);return}Tj(E,y,r)}catch(x){p(x)}},S=E=>{if(l){E.once("error",()=>{}),E.abort();return}i=E,E.once("error",q=>{E.aborted||(q instanceof C0.TimeoutError?q=new Cj(q,y):q=new Ko(q,y),r.retry(q)===!1&&p(q))}),w=Sj(E),Aj.upload(E,r,c),y.gotTimeout&&C0(E,y.gotTimeout,y),r.emit("request",E);let x=()=>{E.emit("upload-complete")};try{Kt.nodeStream(y.body)?(y.body.once("end",x),y.body.pipe(E),y.body=void 0):y.body?E.end(y.body,x):t&&(y.method==="POST"||y.method==="PUT"||y.method==="PATCH")?(t.once("end",x),t.pipe(E)):E.end(x)}catch(q){p(new Ko(q,y))}};if(y.cache){let x=new k0(b.request,y.cache)(y,v);x.once("error",q=>{q instanceof k0.RequestError?p(new Ko(q,y)):p(new qj(q,y))}),x.once("request",S)}else try{S(b.request(y,v))}catch(E){p(new Ko(E,y))}};return r.retry=y=>{let _;try{_=e.retry.retries(++a,y)}catch(b){p(b);return}return _?(setTimeout(async w=>{try{for(let v of w.hooks.beforeRetry)await v(w,y,a);await m(w)}catch(v){p(v)}},_,{...e,forceRefresh:!0}),!0):!1},r.abort=()=>{i?(i.once("error",()=>{}),i.abort()):l=!0},setImmediate(async()=>{try{let{body:y}=e;Kt.buffer(y)?(e.body=vj(y),c=y.length):c=await xj(e),Kt.undefined(e.headers["content-length"])&&Kt.undefined(e.headers["transfer-encoding"])&&(c>0||e.method==="PUT")&&!Kt.null(c)&&(e.headers["content-length"]=c);for(let _ of e.hooks.beforeRequest)await _(e);s=e.href||new q0(e.path,Ej.format(e)).toString(),await m(e)}catch(y){p(y)}}),r}});var I0=h((DV,K0)=>{"use strict";var{PassThrough:R0}=g("stream"),Ij=TE(),Bj=mf(),{HTTPError:Nj,ReadError:jj}=xi();K0.exports=e=>{let t=new R0,r=new R0,n=Ij(t,r),i=new Set,s=!1;e.retry.retries=()=>0,e.body&&(n.write=()=>{throw new Error("Got's stream is not writable when the `body` option is used")});let o=Bj(e,t);n._destroy=o.abort,o.on("response",l=>{let{statusCode:f}=l;if(l.on("error",u=>{n.emit("error",new jj(u,e))}),e.throwHttpErrors&&f!==304&&(f<200||f>299)){n.emit("error",new Nj(l,e),null,l);return}s=!0,l.pipe(r);for(let u of i)if(!u.headersSent){for(let[d,p]of Object.entries(l.headers))(e.decompress?d!=="content-encoding":!0)&&u.setHeader(d,p);u.statusCode=l.statusCode}n.emit("response",l)}),["error","request","redirect","uploadProgress","downloadProgress"].forEach(l=>o.on(l,(...f)=>n.emit(l,...f)));let c=n.pipe.bind(n),a=n.unpipe.bind(n);return n.pipe=(l,f)=>{if(s)throw new Error("Failed to pipe. The response has been emitted already.");let u=c(l,f);return Reflect.has(l,"setHeader")&&i.add(l),u},n.unpipe=l=>(i.delete(l),a(l)),n}});var N0=h((JV,B0)=>{"use strict";var{PassThrough:Mj}=g("stream");B0.exports=e=>{e=Object.assign({},e);let{array:t}=e,{encoding:r}=e,n=r==="buffer",i=!1;t?i=!(r||n):r=r||"utf8",n&&(r=null);let s=0,o=[],c=new Mj({objectMode:i});return r&&c.setEncoding(r),c.on("data",a=>{o.push(a),i?s=o.length:s+=a.length}),c.getBufferedValue=()=>t?o:n?Buffer.concat(o,s):o.join(""),c.getBufferedLength=()=>s,c}});var j0=h((LV,Ai)=>{"use strict";var Dj=ef(),Jj=N0(),Io=class extends Error{constructor(){super("maxBuffer exceeded"),this.name="MaxBufferError"}};function gf(e,t){if(!e)return Promise.reject(new Error("Expected a stream"));t=Object.assign({maxBuffer:1/0},t);let{maxBuffer:r}=t,n;return new Promise((i,s)=>{let o=c=>{c&&(c.bufferedData=n.getBufferedValue()),s(c)};n=Dj(e,Jj(t),c=>{if(c){o(c);return}i()}),n.on("data",()=>{n.getBufferedLength()>r&&o(new Io)})}).then(()=>n.getBufferedValue())}Ai.exports=gf;Ai.exports.buffer=(e,t)=>gf(e,Object.assign({},t,{encoding:"buffer"}));Ai.exports.array=(e,t)=>gf(e,Object.assign({},t,{array:!0}));Ai.exports.MaxBufferError=Io});var _f=h(($V,M0)=>{"use strict";M0.exports=["beforeError","init","beforeRequest","beforeRedirect","beforeRetry","afterResponse"]});var No=h((UV,Bo)=>{"use strict";var{URL:Lj}=g("url"),Pr=Ze(),D0=_f(),qi=(e,...t)=>{for(let r of t)for(let[n,i]of Object.entries(r)){if(Pr.undefined(i))continue;let s=e[n];Pr.urlInstance(s)&&(Pr.urlInstance(i)||Pr.string(i))?e[n]=new Lj(i,s):Pr.plainObject(i)?Pr.plainObject(s)?e[n]=qi({},s,i):e[n]=qi({},i):Pr.array(i)?e[n]=qi([],i):e[n]=i}return e},J0=(...e)=>{e=e.map(n=>n||{});let t=qi({},...e),r={};for(let n of D0)r[n]=[];for(let n of e)if(n.hooks)for(let i of D0)r[i]=r[i].concat(n.hooks[i]);return t.hooks=r,t},$j=(e,t)=>{let r=e.map(i=>i.defaults.handler),n=e.length-1;return{methods:t,options:J0(...e.map(i=>i.defaults.options)),handler:(i,s)=>{let o=-1,c=a=>r[++o](a,o===n?s:c);return c(i)}}};Bo.exports=qi;Bo.exports.options=J0;Bo.exports.instances=$j});var $0=h((WV,L0)=>{"use strict";L0.exports=(e,t)=>{if(typeof e!="string")throw new TypeError(`Expected \`url\` to be of type \`string\`, got \`${typeof e}\``);return e=e.trim(),t=Object.assign({https:!1},t),/^\.*\/|^(?!localhost)\w+:/.test(e)?e:e.replace(/^(?!(?:\w+:)?\/\/)/,t.https?"https://":"http://")}});var W0=h((HV,U0)=>{"use strict";var Uj=g("url"),Wj=$0();U0.exports=(e,t)=>{if(typeof e!="string")throw new TypeError(`Expected \`url\` to be of type \`string\`, got \`${typeof e}\` instead.`);let r=Wj(e,Object.assign({https:!0},t));return Uj.parse(r)}});var vf=h((FV,jo)=>{"use strict";var{URL:Hj,URLSearchParams:wf}=g("url"),Fj=g("url"),K=Ze(),Gj=W0(),zj=rf(),H0=yf(),Yj=hf(),bf=No(),Vj=_f(),Xj=new Set([413,429,503]),Ef=(e,t)=>{if(K.nullOrUndefined(e.headers)?e.headers={}:e.headers=zj(e.headers),e.baseUrl&&!e.baseUrl.toString().endsWith("/")&&(e.baseUrl+="/"),e.stream&&(e.json=!1),K.nullOrUndefined(e.hooks))e.hooks={};else if(!K.object(e.hooks))throw new TypeError(`Parameter \`hooks\` must be an object, not ${K(e.hooks)}`);for(let n of Vj)K.nullOrUndefined(e.hooks[n])&&(t?e.hooks[n]=[...t.hooks[n]]:e.hooks[n]=[]);K.number(e.timeout)?e.gotTimeout={request:e.timeout}:K.object(e.timeout)&&(e.gotTimeout=e.timeout),delete e.timeout;let{retry:r}=e;return e.retry={retries:0,methods:[],statusCodes:[],errorCodes:[]},K.nonEmptyObject(t)&&r!==!1&&(e.retry={...t.retry}),r!==!1&&(K.number(r)?e.retry.retries=r:e.retry={...e.retry,...r}),e.gotTimeout&&(e.retry.maxRetryAfter=Math.min(...[e.gotTimeout.request,e.gotTimeout.connection].filter(n=>!K.nullOrUndefined(n)))),K.array(e.retry.methods)&&(e.retry.methods=new Set(e.retry.methods.map(n=>n.toUpperCase()))),K.array(e.retry.statusCodes)&&(e.retry.statusCodes=new Set(e.retry.statusCodes)),K.array(e.retry.errorCodes)&&(e.retry.errorCodes=new Set(e.retry.errorCodes)),e},F0=(e,t,r)=>{if(K.plainObject(e)&&(t={...e,...t},e=t.url||{},delete t.url),r?t=bf({},r.options,t?Ef(t,r.options):{}):t=bf({},Ef(t)),!K.string(e)&&!K.object(e))throw new TypeError(`Parameter \`url\` must be a string or object, not ${K(e)}`);K.string(e)?t.baseUrl?(e.toString().startsWith("/")&&(e=e.toString().slice(1)),e=H0(new Hj(e,t.baseUrl))):(e=e.replace(/^unix:/,"http://$&"),e=Gj(e)):K(e)==="URL"&&(e=H0(e)),t=bf({path:""},e,{protocol:e.protocol||"https:"},t);for(let c of t.hooks.init){let a=c(t);if(K.promise(a))throw new TypeError("The `init` hook must be a synchronous function")}let{baseUrl:n}=t;Object.defineProperty(t,"baseUrl",{set:()=>{throw new Error("Failed to set baseUrl. Options are normalized already.")},get:()=>n});let{query:i}=t;if((K.nonEmptyString(i)||K.nonEmptyObject(i)||i instanceof wf)&&(K.string(i)||(t.query=new wf(i).toString()),t.path=`${t.path.split("?")[0]}?${t.query}`,delete t.query),t.hostname==="unix"){let c=/(.+?):(.+)/.exec(t.path);if(c){let[,a,l]=c;t={...t,socketPath:a,path:l,host:null}}}let{headers:s}=t;for(let[c,a]of Object.entries(s))K.nullOrUndefined(a)&&delete s[c];t.json&&K.undefined(s.accept)&&(s.accept="application/json"),t.decompress&&K.undefined(s["accept-encoding"])&&(s["accept-encoding"]="gzip, deflate");let{body:o}=t;if(K.nullOrUndefined(o))t.method=t.method?t.method.toUpperCase():"GET";else{let c=K.object(o)&&!K.buffer(o)&&!K.nodeStream(o);if(!K.nodeStream(o)&&!K.string(o)&&!K.buffer(o)&&!(t.form||t.json))throw new TypeError("The `body` option must be a stream.Readable, string or Buffer");if(t.json&&!(c||K.array(o)))throw new TypeError("The `body` option must be an Object or Array when the `json` option is used");if(t.form&&!c)throw new TypeError("The `body` option must be an Object when the `form` option is used");Yj(o)?s["content-type"]=s["content-type"]||`multipart/form-data; boundary=${o.getBoundary()}`:t.form?(s["content-type"]=s["content-type"]||"application/x-www-form-urlencoded",t.body=new wf(o).toString()):t.json&&(s["content-type"]=s["content-type"]||"application/json",t.body=JSON.stringify(o)),t.method=t.method?t.method.toUpperCase():"POST"}if(!K.function(t.retry.retries)){let{retries:c}=t.retry;t.retry.retries=(a,l)=>{if(a>c||(!l||!t.retry.errorCodes.has(l.code))&&(!t.retry.methods.has(l.method)||!t.retry.statusCodes.has(l.statusCode)))return 0;if(Reflect.has(l,"headers")&&Reflect.has(l.headers,"retry-after")&&Xj.has(l.statusCode)){let u=Number(l.headers["retry-after"]);return K.nan(u)?u=Date.parse(l.headers["retry-after"])-Date.now():u*=1e3,u>t.retry.maxRetryAfter?0:u}if(l.statusCode===413)return 0;let f=Math.random()*100;return 2**(a-1)*1e3+f}}return t},Qj=e=>F0(Fj.format(e),e);jo.exports=F0;jo.exports.preNormalize=Ef;jo.exports.reNormalize=Qj});var V0=h((GV,Y0)=>{"use strict";var Zj=g("events"),G0=j0(),eM=Ze(),tM=Wl(),rM=mf(),{HTTPError:nM,ParseError:iM,ReadError:sM}=xi(),{options:oM}=No(),{reNormalize:cM}=vf(),z0=e=>{let t=new Zj,r=new tM((n,i,s)=>{let o=rM(e);s(o.abort),o.on("response",async c=>{t.emit("response",c);let a=eM.null(e.encoding)?G0.buffer(c):G0(c,e),l;try{l=await a}catch(d){i(new sM(d,e));return}let f=e.followRedirect?299:399;c.body=l;try{for(let[d,p]of Object.entries(e.hooks.afterResponse))c=await p(c,m=>(m=cM(oM(e,{...m,retry:0,throwHttpErrors:!1})),m.hooks.afterResponse=e.hooks.afterResponse.slice(0,d),z0(m)))}catch(d){i(d);return}let{statusCode:u}=c;if(e.json&&c.body)try{c.body=JSON.parse(c.body)}catch(d){if(u>=200&&u<300){let p=new iM(d,u,e,l);Object.defineProperty(p,"response",{value:c}),i(p);return}}if(u!==304&&(u<200||u>f)){let d=new nM(c,e);if(Object.defineProperty(d,"response",{value:c}),o.retry(d)===!1){if(e.throwHttpErrors){i(d);return}n(c)}return}n(c)}),o.once("error",i),["request","redirect","uploadProgress","downloadProgress"].forEach(c=>o.on(c,(...a)=>t.emit(c,...a)))});return r.on=(n,i)=>(t.on(n,i),r),r};Y0.exports=z0});var Z0=h((zV,Q0)=>{"use strict";var X0=Ze();Q0.exports=function e(t){for(let[r,n]of Object.entries(t))(X0.plainObject(n)||X0.array(n))&&e(t[r]);return Object.freeze(t)}});var rv=h((YV,tv)=>{"use strict";var aM=xi(),uM=I0(),lM=V0(),ev=vf(),Mo=No(),fM=Z0(),dM=e=>e.stream?uM(e):lM(e),hM=["get","post","put","patch","head","delete"],Do=e=>{e=Mo({},e),ev.preNormalize(e.options),e.handler||(e.handler=(r,n)=>n(r));function t(r,n){try{return e.handler(ev(r,n,e),dM)}catch(i){if(n&&n.stream)throw i;return Promise.reject(i)}}t.create=Do,t.extend=r=>{let n;return r&&Reflect.has(r,"mutableDefaults")?(n=r.mutableDefaults,delete r.mutableDefaults):n=e.mutableDefaults,Do({options:Mo.options(e.options,r),handler:e.handler,mutableDefaults:n})},t.mergeInstances=(...r)=>Do(Mo.instances(r)),t.stream=(r,n)=>t(r,{...n,stream:!0});for(let r of hM)t[r]=(n,i)=>t(n,{...i,method:r}),t.stream[r]=(n,i)=>t.stream(n,{...i,method:r});return Object.assign(t,{...aM,mergeOptions:Mo.options}),Object.defineProperty(t,"defaults",{value:e.mutableDefaults?e:fM(e),writable:e.mutableDefaults,configurable:e.mutableDefaults,enumerable:!0}),t};tv.exports=Do});var Sf=h((VV,iv)=>{"use strict";var nv=SE(),pM=rv(),yM={options:{retry:{retries:2,methods:["GET","PUT","HEAD","DELETE","OPTIONS","TRACE"],statusCodes:[408,413,429,500,502,503,504],errorCodes:["ETIMEDOUT","ECONNRESET","EADDRINUSE","ECONNREFUSED","EPIPE","ENOTFOUND","ENETUNREACH","EAI_AGAIN"]},headers:{"user-agent":`${nv.name}/${nv.version} (https://github.com/sindresorhus/got)`},hooks:{beforeRequest:[],beforeRedirect:[],beforeRetry:[],afterResponse:[]},decompress:!0,throwHttpErrors:!0,followRedirect:!0,stream:!1,form:!1,json:!1,cache:!1,useElectronNet:!1},mutableDefaults:!1},mM=pM(yM);iv.exports=mM});var sv=h(xf=>{"use strict";Object.defineProperty(xf,"__esModule",{value:!0});function gM(e){var t=4,r=e.length,n=r%t;if(!n)return e;var i=r,s=t-n,o=r+s,c=Buffer.alloc(o);for(c.write(e);s--;)c.write("=",i++);return c.toString()}xf.default=gM});var cv=h(qf=>{"use strict";Object.defineProperty(qf,"__esModule",{value:!0});var _M=sv();function ov(e,t){return t===void 0&&(t="utf8"),Buffer.isBuffer(e)?Tf(e.toString("base64")):Tf(Buffer.from(e,t).toString("base64"))}function wM(e,t){return t===void 0&&(t="utf8"),Buffer.from(Af(e),"base64").toString(t)}function Af(e){return e=e.toString(),_M.default(e).replace(/\-/g,"+").replace(/_/g,"/")}function Tf(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function bM(e){return Buffer.from(Af(e),"base64")}var Sn=ov;Sn.encode=ov;Sn.decode=wM;Sn.toBase64=Af;Sn.fromBase64=Tf;Sn.toBuffer=bM;qf.default=Sn});var Lo=h((ZV,Jo)=>{Jo.exports=cv().default;Jo.exports.default=Jo.exports});var lv=h((e7,uv)=>{var EM=g("crypto"),[av,vM]=process.version.substring(1).split(".").map(e=>parseInt(e,10)),SM=av>12||av===12&&vM>=8,xM=SM&&EM.getHashes().includes("shake256");uv.exports=xM});var pv=h((t7,hv)=>{var{strict:Of}=g("assert"),{createHash:Oi}=g("crypto"),{format:fv}=g("util"),TM=lv(),kf;if(Buffer.isEncoding("base64url"))kf=e=>e.toString("base64url");else{let e=t=>t.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_");kf=t=>e(t.toString("base64"))}function AM(e,t){switch(e){case"HS256":case"RS256":case"PS256":case"ES256":case"ES256K":return Oi("sha256");case"HS384":case"RS384":case"PS384":case"ES384":return Oi("sha384");case"HS512":case"RS512":case"PS512":case"ES512":return Oi("sha512");case"EdDSA":switch(t){case"Ed25519":return Oi("sha512");case"Ed448":if(!TM)throw new TypeError("Ed448 *_hash calculation is not supported in your Node.js runtime version");return Oi("shake256",{outputLength:114});default:throw new TypeError("unrecognized or invalid EdDSA curve provided")}default:throw new TypeError("unrecognized or invalid JWS algorithm provided")}}function dv(e,t,r){let n=AM(t,r).update(e).digest();return kf(n.slice(0,n.length/2))}function qM(e,t,r,n,i){if(typeof e.claim!="string"||!e.claim)throw new TypeError("names.claim must be a non-empty string");if(typeof e.source!="string"||!e.source)throw new TypeError("names.source must be a non-empty string");Of(typeof t=="string"&&t,`${e.claim} must be a non-empty string`),Of(typeof r=="string"&&r,`${e.source} must be a non-empty string`);let s,o;try{s=dv(r,n,i)}catch(c){o=fv("%s could not be validated (%s)",e.claim,c.message)}o=o||fv("%s mismatch, expected %s, got: %s",e.claim,s,t),Of.equal(s,t,o)}hv.exports={validate:qM,generate:dv}});var $o=h((r7,yv)=>{yv.exports=e=>!!e&&e.constructor===Object});var Kf=h((n7,Rf)=>{var Cf=$o();function Pf(e,t,...r){for(let n of r)if(!!Cf(n))for(let[i,s]of Object.entries(n))i==="__proto__"||i==="constructor"||(typeof t[i]>"u"&&typeof s<"u"&&(t[i]=s),e&&Cf(t[i])&&Cf(s)&&Pf(!0,t[i],s));return t}Rf.exports=Pf.bind(void 0,!1);Rf.exports.deep=Pf.bind(void 0,!0)});var Uo=h((i7,mv)=>{function OM(e,t,r){if(!t[`${e}_endpoint`])return;let n=`${e}_endpoint_auth_method`,i=`${e}_endpoint_auth_signing_alg`,s=`${e}_endpoint_auth_signing_alg_values_supported`;if(r[n]&&r[n].endsWith("_jwt")&&!r[i]&&!t[s])throw new TypeError(`${s} must be configured on the issuer if ${i} is not defined on a client`)}function kM(e,t){if(!e[t])throw new TypeError(`${t} must be configured on the issuer`)}mv.exports={assertSigningAlgValuesSupport:OM,assertIssuerConfiguration:kM}});var If=h((s7,gv)=>{gv.exports=function(t,...r){let n={};for(let i of r)t[i]&&(n[i]=t[i]);return n}});var Ho=h((o7,wv)=>{var{STATUS_CODES:Bf}=g("http"),{format:_v}=g("util"),{OPError:Wo}=Or(),CM=/(\w+)=("[^"]*")/g,PM=e=>{let t={};try{for(;CM.exec(e.headers["www-authenticate"])!==null;)RegExp.$1&&RegExp.$2&&(t[RegExp.$1]=RegExp.$2.slice(1,-1))}catch{}if(t.error)throw new Wo(t,e)},RM=e=>{let t=!1;try{let r;typeof e.body!="object"||Buffer.isBuffer(e.body)?r=JSON.parse(e.body):r=e.body,t=typeof r.error=="string"&&r.error.length,t&&(e.body=r)}catch{}return t};function KM(e,{statusCode:t=200,body:r=!0,bearer:n=!1}={}){if(e.statusCode!==t)throw n&&PM(e),RM(e)?new Wo(e.body,e):new Wo({error:_v("expected %i %s, got: %i %s",t,Bf[t],e.statusCode,Bf[e.statusCode])},e);if(r&&!e.body)throw new Wo({error:_v("expected %i %s with body but no body was returned",t,Bf[t])},e);return e.body}wv.exports=KM});var ki=h((c7,bv)=>{bv.exports=()=>Math.floor(Date.now()/1e3)});var Fo=h((a7,vv)=>{var IM=Lo(),Ev=ki(),Nf=class{constructor(t){Object.assign(this,t)}set expires_in(t){this.expires_at=Ev()+Number(t)}get expires_in(){return Math.max.apply(null,[this.expires_at-Ev(),0])}expired(){return this.expires_in===0}claims(){if(!this.id_token)throw new TypeError("id_token not present in TokenSet");return JSON.parse(IM.decode(this.id_token.split(".")[1]))}};vv.exports=Nf});var Ci=h((u7,xv)=>{var{createHash:BM,randomBytes:NM}=g("crypto"),{encode:Sv}=Lo(),Go=(e=32)=>Sv(NM(e));xv.exports={random:Go,state:Go,nonce:Go,codeVerifier:Go,codeChallenge:e=>Sv(BM("sha256").update(e).digest())}});var Tv=h((l7,jM)=>{jM.exports={name:"openid-client",version:"3.15.10",description:"OpenID Connect Relying Party (RP, Client) implementation for Node.js runtime, supports passportjs",keywords:["auth","authentication","basic","certified","client","connect","dynamic","electron","hybrid","identity","implicit","oauth","oauth2","oidc","openid","passport","relying party","strategy"],homepage:"https://github.com/panva/node-openid-client",repository:"panva/node-openid-client",license:"MIT",author:"Filip Skokan <panva.ip@gmail.com>",files:["lib","types/index.d.ts"],funding:{url:"https://github.com/sponsors/panva"},main:"lib/index.js",types:"types/index.d.ts",scripts:{coverage:"nyc mocha test/**/*.test.js",lint:"eslint lib test","lint-ts":"npx typescript@~3.6.0 --build types","lint-fix":"eslint lib test --fix",test:"mocha test/**/*.test.js"},dependencies:{"@types/got":"^9.6.9",base64url:"^3.0.1",got:"^9.6.0",jose:"^1.27.1","lru-cache":"^6.0.0","make-error":"^1.3.6","object-hash":"^2.0.1","oidc-token-hash":"^5.0.0","p-any":"^3.0.0"},devDependencies:{"@commitlint/cli":"^9.1.1","@commitlint/config-conventional":"^9.1.1","@types/passport":"^1.0.4",chai:"^4.2.0",eslint:"^7.4.0","eslint-config-airbnb-base":"^14.2.0","eslint-plugin-import":"^2.21.2",husky:"^4.0.0",mocha:"^8.0.1",nock:"^13.0.2",nyc:"^15.1.0","readable-mock-req":"^0.2.2",sinon:"^9.0.0",timekeeper:"^2.2.0"},engines:{node:"^10.13.0 || >=12.0.0"},commitlint:{extends:["@commitlint/config-conventional"]},husky:{hooks:{"commit-msg":"commitlint -E HUSKY_GIT_PARAMS"}},nyc:{reporter:["lcov","text-summary"]},"standard-version":{scripts:{postchangelog:"sed -i '' -e 's/### \\[/## [/g' CHANGELOG.md"}}}});var qv=h((f7,Av)=>{var MM=g("url"),{strict:DM}=g("assert");Av.exports=e=>{try{let{protocol:t}=new MM.URL(e);return DM(t.match(/^(https?:)$/)),!0}catch{throw new TypeError("only valid absolute URLs can be requested")}}});var Ri=h((d7,Ov)=>{var Pi="/.well-known/openid-configuration",JM="/.well-known/oauth-authorization-server",LM="/.well-known/webfinger",$M="http://openid.net/specs/connect/1.0/issuer",UM=[`https://login.microsoftonline.com/common${Pi}`,`https://login.microsoftonline.com/common/v2.0${Pi}`,`https://login.microsoftonline.com/organizations/v2.0${Pi}`,`https://login.microsoftonline.com/consumers/v2.0${Pi}`],WM={grant_types:["authorization_code"],id_token_signed_response_alg:"RS256",authorization_signed_response_alg:"RS256",response_types:["code"],token_endpoint_auth_method:"client_secret_basic"},HM={claim_types_supported:["normal"],claims_parameter_supported:!1,grant_types_supported:["authorization_code","implicit"],request_parameter_supported:!1,request_uri_parameter_supported:!0,require_request_uri_registration:!1,response_modes_supported:["query","fragment"],token_endpoint_auth_methods_supported:["client_secret_basic"]},FM=["access_token","code","error","error_description","error_uri","expires_in","id_token","state","token_type","session_state","response"],GM=/^application\/jwt/,zM=Symbol("openid-client.custom.http-options"),YM=Symbol("openid-client.custom.clock-tolerance");Ov.exports={AAD_MULTITENANT_DISCOVERY:UM,CALLBACK_PROPERTIES:FM,CLIENT_DEFAULTS:WM,CLOCK_TOLERANCE:YM,HTTP_OPTIONS:zM,ISSUER_DEFAULTS:HM,JWT_CONTENT:GM,OAUTH2_DISCOVERY:JM,OIDC_DISCOVERY:Pi,REL:$M,WEBFINGER:LM}});var Ki=h((h7,Mf)=>{var VM=Sf(),jf=Tv(),{deep:kv}=Kf(),XM=qv(),{HTTP_OPTIONS:QM}=Ri(),zo,Cv,Pv=e=>{zo=kv({},e,zo),Cv=VM.extend(zo)};Pv({followRedirect:!1,headers:{"User-Agent":`${jf.name}/${jf.version} (${jf.homepage})`},retry:0,timeout:2500,throwHttpErrors:!1});Mf.exports=function(t,{mTLS:r=!1}={}){let{url:n}=t;XM(n);let i=this[QM],s;if(i?s=i.call(this,kv({},t,zo)):s=t,r&&(!s.key||!s.cert))throw new TypeError("mutual-TLS certificate and key not set");return Cv(s)};Mf.exports.setDefaults=Pv});var Yo=h((p7,Rv)=>{var ZM=new Map;Rv.exports=ZM});var Ii=h((y7,Kv)=>{var Df=new WeakMap;Kv.exports=e=>(Df.has(e)||Df.set(e,new Map([["metadata",new Map]])),Df.get(e))});var Nv=h((m7,Bv)=>{var Jf=$o();function Iv(e,...t){for(let r of t)if(!!Jf(r))for(let[n,i]of Object.entries(r))n==="__proto__"||n==="constructor"||(Jf(e[n])&&Jf(i)?e[n]=Iv(e[n],i):typeof i<"u"&&(e[n]=i));return e}Bv.exports=Iv});var Vo=h((g7,Jv)=>{var jv=go(),{assertIssuerConfiguration:eD}=Uo(),{random:tD}=Ci(),rD=ki(),nD=Ki(),iD=Ii(),sD=Nv(),Mv=e=>encodeURIComponent(e).replace(/%20/g,"+");async function oD(e,t){let r=this[`${e}_endpoint_auth_signing_alg`];if(r||eD(this.issuer,`${e}_endpoint_auth_signing_alg_values_supported`),this[`${e}_endpoint_auth_method`]==="client_secret_jwt"){let s=await this.joseSecret();if(!r){let o=this.issuer[`${e}_endpoint_auth_signing_alg_values_supported`];r=Array.isArray(o)&&o.find(c=>s.algorithms("sign").has(c))}return jv.JWS.sign(t,s,{alg:r,typ:"JWT"})}let n=iD(this).get("keystore");if(!n)throw new TypeError("no client jwks provided for signing a client assertion with");if(!r){let s=new Set;n.all().forEach(c=>{c.algorithms("sign").forEach(Set.prototype.add.bind(s))});let o=this.issuer[`${e}_endpoint_auth_signing_alg_values_supported`];r=Array.isArray(o)&&o.find(c=>s.has(c))}let i=n.get({alg:r,use:"sig"});if(!i)throw new TypeError(`no key found in client jwks to sign a client assertion with using alg ${r}`);return jv.JWS.sign(t,i,{alg:r,typ:"JWT",kid:i.kid})}async function Dv(e,{clientAssertionPayload:t}={}){switch(this[`${e}_endpoint_auth_method`]){case"self_signed_tls_client_auth":case"tls_client_auth":case"none":return{body:{client_id:this.client_id}};case"client_secret_post":if(!this.client_secret)throw new TypeError("client_secret_post client authentication method requires a client_secret");return{body:{client_id:this.client_id,client_secret:this.client_secret}};case"private_key_jwt":case"client_secret_jwt":{let n=rD(),i=await oD.call(this,e,{iat:n,exp:n+60,jti:tD(),iss:this.client_id,sub:this.client_id,aud:this.issuer[`${e}_endpoint`],...t});return{body:{client_id:this.client_id,client_assertion:i,client_assertion_type:"urn:ietf:params:oauth:client-assertion-type:jwt-bearer"}}}default:{if(!this.client_secret)throw new TypeError("client_secret_basic client authentication method requires a client_secret");let n=`${Mv(this.client_id)}:${Mv(this.client_secret)}`;return{headers:{Authorization:`Basic ${Buffer.from(n).toString("base64")}`}}}}}function cD(){let{length:e,0:t}=this.response_types;if(e===1)return t}function aD(){let{length:e,0:t}=this.redirect_uris||[];if(e===1)return t}async function uD(e,t,{clientAssertionPayload:r,endpointAuthMethod:n=e}={}){let i=await Dv.call(this,n,{clientAssertionPayload:r}),s=sD(t,i,{form:!0}),o=this[`${n}_endpoint_auth_method`].includes("tls_client_auth")||e==="token"&&this.tls_client_certificate_bound_access_tokens,c;if(o&&this.issuer.mtls_endpoint_aliases&&(c=this.issuer.mtls_endpoint_aliases[`${e}_endpoint`]),c=c||this.issuer[`${e}_endpoint`],"body"in s)for(let[a,l]of Object.entries(s.body))typeof l>"u"&&delete s.body[a];return nD.call(this,{...s,method:"POST",url:c},{mTLS:o})}Jv.exports={resolveResponseType:cD,resolveRedirectUri:aD,authFor:Dv,authenticatedPost:uD}});var Wv=h((_7,Uv)=>{var{inspect:Lv}=g("util"),{RPError:Lf,OPError:lD}=Or(),z=Ii(),$v=ki(),{authenticatedPost:fD}=Vo(),dD=Ho(),hD=Fo(),$f=class{constructor({client:t,exchangeBody:r,clientAssertionPayload:n,response:i,maxAge:s}){if(["verification_uri","user_code","device_code"].forEach(o=>{if(typeof i[o]!="string"||!i[o])throw new Lf(`expected ${o} string to be returned by Device Authorization Response, got %j`,i[o])}),!Number.isSafeInteger(i.expires_in))throw new Lf("expected expires_in number to be returned by Device Authorization Response, got %j",i.expires_in);z(this).expires_at=$v()+i.expires_in,z(this).client=t,z(this).maxAge=s,z(this).exchangeBody=r,z(this).clientAssertionPayload=n,z(this).response=i,z(this).interval=i.interval*1e3||5e3}async poll(){if(this.expired())throw new Lf("the device code %j has expired and the device authorization session has concluded",this.device_code);await new Promise(i=>setTimeout(i,z(this).interval));let t=await fD.call(z(this).client,"token",{form:!0,body:{...z(this).exchangeBody,grant_type:"urn:ietf:params:oauth:grant-type:device_code",device_code:this.device_code},json:!0},{clientAssertionPayload:z(this).clientAssertionPayload}),r;try{r=dD(t)}catch(i){switch(i instanceof lD&&i.error){case"slow_down":z(this).interval+=5e3;case"authorization_pending":return this.poll();default:throw i}}let n=new hD(r);return"id_token"in n&&(await z(this).client.decryptIdToken(n),await z(this).client.validateIdToken(n,void 0,"token",z(this).maxAge)),n}get device_code(){return z(this).response.device_code}get user_code(){return z(this).response.user_code}get verification_uri(){return z(this).response.verification_uri}get verification_uri_complete(){return z(this).response.verification_uri_complete}get expires_in(){return Math.max.apply(null,[z(this).expires_at-$v(),0])}expired(){return this.expires_in===0}[Lv.custom](){return`${this.constructor.name} ${Lv(z(this).response,{depth:1/0,colors:process.stdout.isTTY,compact:!1,sorted:!0})}`}};Uv.exports=$f});var Yf=h((b7,zf)=>{var{inspect:Hv,deprecate:pD}=g("util"),yD=g("http"),mD=g("crypto"),{strict:Uf}=g("assert"),Fv=g("querystring"),It=g("url"),{ParseError:gD}=Sf(),st=go(),Bi=Lo(),Wf=pv(),Zv=Kf(),{assertSigningAlgValuesSupport:Gv,assertIssuerConfiguration:Bt}=Uo(),_D=If(),nt=$o(),rr=Ho(),ye=Fo(),{OPError:Gf,RPError:C}=Or(),Xo=ki(),{random:wD}=Ci(),Ni=Ki(),{CALLBACK_PROPERTIES:bD,CLIENT_DEFAULTS:ED,JWT_CONTENT:vD,CLOCK_TOLERANCE:it}=Ri(),zv=Yo(),Ae=Ii(),{authenticatedPost:Qo,resolveResponseType:SD,resolveRedirectUri:xD}=Vo(),TD=Wv(),{deep:Hf}=Zv;function nr(e){return _D(e,...bD)}function ji(e,t="Bearer"){return`${t} ${e}`}function Yv(e){Object.keys(e._claim_names).length===0&&delete e._claim_names,Object.keys(e._claim_sources).length===0&&delete e._claim_sources}function Vv(e,t,r,n=!0){return([i,s])=>{if(s===r){if(n&&t[i]===void 0)throw new C(`expected claim "${i}" in "${r}"`);t[i]!==void 0&&(e[i]=t[i]),delete e._claim_names[i]}}}function AD(e,t,r){if(e[r]===void 0)throw new C({message:`missing required JWT property ${r}`,jwt:t})}function Ff(e){let t={client_id:this.client_id,scope:"openid",response_type:SD.call(this),redirect_uri:xD.call(this),...e};return Object.entries(t).forEach(([r,n])=>{n==null?delete t[r]:r==="claims"&&typeof n=="object"?t[r]=JSON.stringify(n):r==="resource"&&Array.isArray(n)?t[r]=n:typeof n!="string"&&(t[r]=String(n))}),t}async function Xv(e,t){try{let{header:r,payload:n}=st.JWT.decode(t,{complete:!0}),{iss:i}=n;if(r.alg==="none")return n;let s;return!i||i===this.issuer.issuer?s=await this.issuer.queryKeyStore(r):zv.has(i)?s=await zv.get(i).queryKeyStore(r):s=await(await this.issuer.constructor.discover(i)).queryKeyStore(r),st.JWT.verify(t,s)}catch(r){throw r instanceof C||r instanceof Gf||r.name==="AggregateError"?r:new C({printf:["failed to validate the %s JWT (%s: %s)",e,r.name,r.message],jwt:t})}}function Qv(e){let t=st.JWKS.asKeyStore(e);if(t.all().some(r=>r.type!=="private"))throw new TypeError("jwks must only contain private keys");return t}function qD(e,t,r){try{let n=e.issuer.token_endpoint_auth_methods_supported;n.includes(r.token_endpoint_auth_method)||n.includes("client_secret_post")&&(r.token_endpoint_auth_method="client_secret_post")}catch{}}function OD(e,t,r){if(t.token_endpoint_auth_method||qD(e,t,r),t.redirect_uri){if(t.redirect_uris)throw new TypeError("provide a redirect_uri or redirect_uris, not both");r.redirect_uris=[t.redirect_uri],delete r.redirect_uri}if(t.response_type){if(t.response_types)throw new TypeError("provide a response_type or response_types, not both");r.response_types=[t.response_type],delete r.response_type}}function kD(e,t,r){if(!t[`${e}_endpoint`])return;let n=r.token_endpoint_auth_method,i=r.token_endpoint_auth_signing_alg,s=`${e}_endpoint_auth_method`,o=`${e}_endpoint_auth_signing_alg`;r[s]===void 0&&r[o]===void 0&&(n!==void 0&&(r[s]=n),i!==void 0&&(r[o]=i))}var Mi=class{};zf.exports=(e,t=!1)=>class extends Mi{constructor(n={},i,s){if(super(),typeof n.client_id!="string"||!n.client_id)throw new TypeError("client_id is required");let o={...ED,...n};if(OD(this,n,o),Gv("token",this.issuer,o),["introspection","revocation"].forEach(c=>{kD(c,this.issuer,o),Gv(c,this.issuer,o)}),Object.entries(o).forEach(([c,a])=>{Ae(this).get("metadata").set(c,a),this[c]||Object.defineProperty(this,c,{get(){return Ae(this).get("metadata").get(c)},enumerable:!0})}),i!==void 0){let c=Qv.call(this,i);Ae(this).set("keystore",c)}s!==void 0&&Ae(this).set("options",s),this[it]=0}authorizationUrl(n={}){if(!nt(n))throw new TypeError("params must be a plain object");Bt(this.issuer,"authorization_endpoint");let i=It.parse(this.issuer.authorization_endpoint,!0);return i.search=null,i.query={...i.query,...Ff.call(this,n)},It.format(i)}authorizationPost(n={}){if(!nt(n))throw new TypeError("params must be a plain object");let i=Ff.call(this,n),s=Object.keys(i).map(o=>`<input type="hidden" name="${o}" value="${i[o]}"/>`).join(`
`);return`<!DOCTYPE html>
<head>
  <title>Requesting Authorization</title>
</head>
<body onload="javascript:document.forms[0].submit()">
  <form method="post" action="${this.issuer.authorization_endpoint}">
    ${s}
  </form>
</body>
</html>`}endSessionUrl(n={}){Bt(this.issuer,"end_session_endpoint");let{0:i,length:s}=this.post_logout_redirect_uris||[],{post_logout_redirect_uri:o=s===1?i:void 0}=n,c=n.id_token_hint;if(c instanceof ye){if(!c.id_token)throw new TypeError("id_token not present in TokenSet");c=c.id_token}let a=It.parse(this.issuer.end_session_endpoint,!0);return a.search=null,a.query={...n,...a.query,post_logout_redirect_uri:o,id_token_hint:c},Object.entries(a.query).forEach(([l,f])=>{f==null&&delete a.query[l]}),It.format(a)}callbackParams(n){let i=n instanceof yD.IncomingMessage||n&&n.method&&n.url;if(!(typeof n=="string")&&!i)throw new TypeError("#callbackParams only accepts string urls, http.IncomingMessage or a lookalike");if(i)switch(n.method){case"GET":return nr(It.parse(n.url,!0).query);case"POST":if(n.body===void 0)throw new TypeError("incoming message body missing, include a body parser prior to this method call");switch(typeof n.body){case"object":case"string":return Buffer.isBuffer(n.body)?nr(Fv.parse(n.body.toString("utf-8"))):typeof n.body=="string"?nr(Fv.parse(n.body)):nr(n.body);default:throw new TypeError("invalid IncomingMessage body object")}default:throw new TypeError("invalid IncomingMessage method")}else return nr(It.parse(n,!0).query)}async callback(n,i,s={},{exchangeBody:o,clientAssertionPayload:c}={}){let a=nr(i);if(s.jarm&&!("response"in i))throw new C({message:"expected a JARM response",checks:s,params:a});if("response"in i){let f=await this.decryptJARM(a.response);a=await this.validateJARM(f)}if(this.default_max_age&&!s.max_age&&(s.max_age=this.default_max_age),a.state&&!s.state)throw new TypeError("checks.state argument is missing");if(!a.state&&s.state)throw new C({message:"state missing from the response",checks:s,params:a});if(s.state!==a.state)throw new C({printf:["state mismatch, expected %s, got: %s",s.state,a.state],checks:s,params:a});if(a.error)throw new Gf(a);let l={code:["code"],id_token:["id_token"],token:["access_token","token_type"]};if(s.response_type){for(let f of s.response_type.split(" "))if(f==="none"){if(a.code||a.id_token||a.access_token)throw new C({message:'unexpected params encountered for "none" response',checks:s,params:a})}else for(let u of l[f])if(!a[u])throw new C({message:`${u} missing from response`,checks:s,params:a})}if(a.id_token){let f=new ye(a);if(await this.decryptIdToken(f),await this.validateIdToken(f,s.nonce,"authorization",s.max_age,s.state),!a.code)return f}if(a.code){let f=await this.grant({...o,grant_type:"authorization_code",code:a.code,redirect_uri:n,code_verifier:s.code_verifier},{clientAssertionPayload:c});return await this.decryptIdToken(f),await this.validateIdToken(f,s.nonce,"token",s.max_age),a.session_state&&(f.session_state=a.session_state),f}return new ye(a)}async oauthCallback(n,i,s={},{exchangeBody:o,clientAssertionPayload:c}={}){let a=nr(i);if(s.jarm&&!("response"in i))throw new C({message:"expected a JARM response",checks:s,params:a});if("response"in i){let f=await this.decryptJARM(a.response);a=await this.validateJARM(f)}if(a.state&&!s.state)throw new TypeError("checks.state argument is missing");if(!a.state&&s.state)throw new C({message:"state missing from the response",checks:s,params:a});if(s.state!==a.state)throw new C({printf:["state mismatch, expected %s, got: %s",s.state,a.state],checks:s,params:a});if(a.error)throw new Gf(a);let l={code:["code"],token:["access_token","token_type"]};if(s.response_type)for(let f of s.response_type.split(" ")){if(f==="none"&&(a.code||a.id_token||a.access_token))throw new C({message:'unexpected params encountered for "none" response',checks:s,params:a});if(l[f]){for(let u of l[f])if(!a[u])throw new C({message:`${u} missing from response`,checks:s,params:a})}}return a.code?this.grant({...o,grant_type:"authorization_code",code:a.code,redirect_uri:n,code_verifier:s.code_verifier},{clientAssertionPayload:c}):new ye(a)}async decryptIdToken(n){if(!this.id_token_encrypted_response_alg)return n;let i=n;if(i instanceof ye){if(!i.id_token)throw new TypeError("id_token not present in TokenSet");i=i.id_token}let s=this.id_token_encrypted_response_alg,o=this.id_token_encrypted_response_enc,c=await this.decryptJWE(i,s,o);return n instanceof ye?(n.id_token=c,n):c}async validateJWTUserinfo(n){let i=this.userinfo_signed_response_alg;return this.validateJWT(n,i,[])}async decryptJARM(n){if(!this.authorization_encrypted_response_alg)return n;let i=this.authorization_encrypted_response_alg,s=this.authorization_encrypted_response_enc;return this.decryptJWE(n,i,s)}async validateJARM(n){let i=this.authorization_signed_response_alg,{payload:s}=await this.validateJWT(n,i,["iss","exp","aud"]);return nr(s)}async decryptJWTUserinfo(n){if(!this.userinfo_encrypted_response_alg)return n;let i=this.userinfo_encrypted_response_alg,s=this.userinfo_encrypted_response_enc;return this.decryptJWE(n,i,s)}async decryptJWE(n,i,s="A128CBC-HS256"){let o=JSON.parse(Bi.decode(n.split(".")[0]));if(o.alg!==i)throw new C({printf:["unexpected JWE alg received, expected %s, got: %s",i,o.alg],jwt:n});if(o.enc!==s)throw new C({printf:["unexpected JWE enc received, expected %s, got: %s",s,o.enc],jwt:n});let c;return i.match(/^(?:RSA|ECDH)/)?c=Ae(this).get("keystore"):c=await this.joseSecret(i==="dir"?s:i),st.JWE.decrypt(n,c).toString("utf8")}async validateIdToken(n,i,s,o,c){let a=n,l=this.id_token_signed_response_alg;if(a instanceof ye){if(!a.id_token)throw new TypeError("id_token not present in TokenSet");a=a.id_token}a=String(a);let u=Xo(),{protected:d,payload:p,key:m}=await this.validateJWT(a,l);if(o||o!==null&&this.require_auth_time){if(!p.auth_time)throw new C({message:"missing required JWT property auth_time",jwt:a});if(typeof p.auth_time!="number")throw new C({message:"JWT auth_time claim must be a JSON numeric value",jwt:a})}if(o&&p.auth_time+o<u-this[it])throw new C({printf:["too much time has elapsed since the last End-User authentication, max_age %i, auth_time: %i, now %i",o,p.auth_time,u-this[it]],now:u,tolerance:this[it],auth_time:p.auth_time,jwt:a});if(i!==null&&(p.nonce||i!==void 0)&&p.nonce!==i)throw new C({printf:["nonce mismatch, expected %s, got: %s",i,p.nonce],jwt:a});if(s==="authorization"){if(!p.at_hash&&n.access_token)throw new C({message:"missing required property at_hash",jwt:a});if(!p.c_hash&&n.code)throw new C({message:"missing required property c_hash",jwt:a});if(this.constructor.name==="FAPIClient"){if(p.iat<u-3600)throw new C({printf:["JWT issued too far in the past, now %i, iat %i",u,p.iat],now:u,tolerance:this[it],iat:p.iat,jwt:a});if(!p.s_hash&&(n.state||c))throw new C({message:"missing required property s_hash",jwt:a})}if(p.s_hash){if(!c)throw new TypeError('cannot verify s_hash, "checks.state" property not provided');try{Wf.validate({claim:"s_hash",source:"state"},p.s_hash,c,d.alg,m&&m.crv)}catch(_){throw new C({message:_.message,jwt:a})}}}if(n.access_token&&p.at_hash!==void 0)try{Wf.validate({claim:"at_hash",source:"access_token"},p.at_hash,n.access_token,d.alg,m&&m.crv)}catch(y){throw new C({message:y.message,jwt:a})}if(n.code&&p.c_hash!==void 0)try{Wf.validate({claim:"c_hash",source:"code"},p.c_hash,n.code,d.alg,m&&m.crv)}catch(y){throw new C({message:y.message,jwt:a})}return n}async validateJWT(n,i,s=["iss","sub","aud","exp","iat"]){let o=this.issuer.issuer==="https://self-issued.me",c=Xo(),a,l;try{({header:a,payload:l}=st.JWT.decode(n,{complete:!0}))}catch(u){throw new C({printf:["failed to decode JWT (%s: %s)",u.name,u.message],jwt:n})}if(a.alg!==i)throw new C({printf:["unexpected JWT alg received, expected %s, got: %s",i,a.alg],jwt:n});if(o&&(s=[...s,"sub_jwk"]),s.forEach(AD.bind(void 0,l,n)),l.iss!==void 0){let u=this.issuer.issuer;if(t&&(u=this.issuer.issuer.replace("{tenantid}",l.tid)),l.iss!==u)throw new C({printf:["unexpected iss value, expected %s, got: %s",u,l.iss],jwt:n})}if(l.iat!==void 0&&typeof l.iat!="number")throw new C({message:"JWT iat claim must be a JSON numeric value",jwt:n});if(l.nbf!==void 0){if(typeof l.nbf!="number")throw new C({message:"JWT nbf claim must be a JSON numeric value",jwt:n});if(l.nbf>c+this[it])throw new C({printf:["JWT not active yet, now %i, nbf %i",c+this[it],l.nbf],now:c,tolerance:this[it],nbf:l.nbf,jwt:n})}if(l.exp!==void 0){if(typeof l.exp!="number")throw new C({message:"JWT exp claim must be a JSON numeric value",jwt:n});if(c-this[it]>=l.exp)throw new C({printf:["JWT expired, now %i, exp %i",c-this[it],l.exp],now:c,tolerance:this[it],exp:l.exp,jwt:n})}if(l.aud!==void 0){if(Array.isArray(l.aud)){if(l.aud.length>1&&!l.azp)throw new C({message:"missing required JWT property azp",jwt:n});if(!l.aud.includes(this.client_id))throw new C({printf:["aud is missing the client_id, expected %s to be included in %j",this.client_id,l.aud],jwt:n})}else if(l.aud!==this.client_id)throw new C({printf:["aud mismatch, expected %s, got: %s",this.client_id,l.aud],jwt:n})}if(l.azp!==void 0){let{additionalAuthorizedParties:u}=Ae(this).get("options")||{};if(typeof u=="string"?u=[this.client_id,u]:Array.isArray(u)?u=[this.client_id,...u]:u=[this.client_id],!u.includes(l.azp))throw new C({printf:["azp mismatch, got: %s",l.azp],jwt:n})}let f;if(o){try{Uf(nt(l.sub_jwk)),f=st.JWK.asKey(l.sub_jwk),Uf.equal(f.type,"public")}catch{throw new C({message:"failed to use sub_jwk claim as an asymmetric JSON Web Key",jwt:n})}if(f.thumbprint!==l.sub)throw new C({message:"failed to match the subject with sub_jwk",jwt:n})}else a.alg.startsWith("HS")?f=await this.joseSecret():a.alg!=="none"&&(f=await this.issuer.queryKeyStore(a));if(!f&&a.alg==="none")return{protected:a,payload:l};try{return st.JWS.verify(n,f,{complete:!0})}catch{throw new C({message:"failed to validate JWT signature",jwt:n})}}async refresh(n,{exchangeBody:i,clientAssertionPayload:s}={}){let o=n;if(o instanceof ye){if(!o.refresh_token)throw new TypeError("refresh_token not present in TokenSet");o=o.refresh_token}let c=await this.grant({...i,grant_type:"refresh_token",refresh_token:String(o)},{clientAssertionPayload:s});if(c.id_token&&(await this.decryptIdToken(c),await this.validateIdToken(c,null,"token",null),n instanceof ye&&n.id_token)){let a=n.claims().sub,l=c.claims().sub;if(l!==a)throw new C({printf:["sub mismatch, expected %s, got: %s",a,l],jwt:c.id_token})}return c}async requestResource(n,i,{method:s,headers:o,body:c,tokenType:a=i instanceof ye?i.token_type:"Bearer"}={}){if(i instanceof ye){if(!i.access_token)throw new TypeError("access_token not present in TokenSet");i=i.access_token}let l={headers:{Authorization:ji(i,a),...o},body:c},f=!!this.tls_client_certificate_bound_access_tokens;return Ni.call(this,{...l,encoding:null,method:s,url:n},{mTLS:f})}async userinfo(n,{verb:i="GET",via:s="header",tokenType:o,params:c}={}){Bt(this.issuer,"userinfo_endpoint");let a={tokenType:o,method:String(i).toUpperCase()};if(a.method!=="GET"&&a.method!=="POST")throw new TypeError("#userinfo() verb can only be POST or a GET");if(s==="query"&&a.method!=="GET")throw new TypeError("userinfo endpoints will only parse query strings for GET requests");if(s==="body"&&a.method!=="POST")throw new TypeError("can only send body on POST");let l=!!(this.userinfo_signed_response_alg||this.userinfo_encrypted_response_alg);l?a.headers={Accept:"application/jwt"}:a.headers={Accept:"application/json"};let f=!!this.tls_client_certificate_bound_access_tokens,u;f&&this.issuer.mtls_endpoint_aliases&&(u=this.issuer.mtls_endpoint_aliases.userinfo_endpoint),u=new It.URL(u||this.issuer.userinfo_endpoint),s==="query"?(a.headers.Authorization=void 0,u.searchParams.append("access_token",n instanceof ye?n.access_token:n)):s==="body"&&(a.headers.Authorization=void 0,a.headers["Content-Type"]="application/x-www-form-urlencoded",a.body=new It.URLSearchParams,a.body.append("access_token",n instanceof ye?n.access_token:n)),c&&(a.method==="GET"?Object.entries(c).forEach(([m,y])=>{u.searchParams.append(m,y)}):a.body?Object.entries(c).forEach(([m,y])=>{a.body.append(m,y)}):(a.body=new It.URLSearchParams,a.headers["Content-Type"]="application/x-www-form-urlencoded",Object.entries(c).forEach(([m,y])=>{a.body.append(m,y)}))),a.body&&(a.body=a.body.toString());let d=await this.requestResource(u,n,a),p=rr(d,{bearer:!0});if(l){if(!vD.test(d.headers["content-type"]))throw new C({message:"expected application/jwt response from the userinfo_endpoint",response:d});let m=d.body.toString(),y=await this.decryptJWTUserinfo(m);if(this.userinfo_signed_response_alg)({payload:p}=await this.validateJWTUserinfo(y));else try{p=JSON.parse(y),Uf(nt(p))}catch{throw new C({message:"failed to parse userinfo JWE payload as JSON",jwt:y})}}else try{p=JSON.parse(d.body)}catch(m){let y=new gD(m,d.statusCode,d.request.gotOptions,d.body);throw Object.defineProperty(y,"response",{value:d}),y}if(n instanceof ye&&n.id_token){let m=n.claims().sub;if(p.sub!==m)throw new C({printf:["userinfo sub mismatch, expected %s, got: %s",m,p.sub],body:p,jwt:n.id_token})}return p}async derivedKey(n){let i=`${n}_key`;if(Ae(this).has(i))return Ae(this).get(i);let s=n<=256?"sha256":n<=384?"sha384":n<=512?"sha512":!1;if(!s)throw new Error("unsupported symmetric encryption key derivation");let o=mD.createHash(s).update(this.client_secret).digest().slice(0,n/8),c=st.JWK.asKey({k:Bi.encode(o),kty:"oct"});return Ae(this).set(i,c),c}async joseSecret(n){if(!this.client_secret)throw new TypeError("client_secret is required");if(/^A(\d{3})(?:GCM)?KW$/.test(n))return this.derivedKey(parseInt(RegExp.$1,10));if(/^A(\d{3})(?:GCM|CBC-HS(\d{3}))$/.test(n))return this.derivedKey(parseInt(RegExp.$2||RegExp.$1,10));if(Ae(this).has("jose_secret"))return Ae(this).get("jose_secret");let i=st.JWK.asKey({k:Bi.encode(this.client_secret),kty:"oct"});return Ae(this).set("jose_secret",i),i}async grant(n,{clientAssertionPayload:i}={}){Bt(this.issuer,"token_endpoint");let s=await Qo.call(this,"token",{form:!0,body:n,json:!0},{clientAssertionPayload:i}),o=rr(s);return new ye(o)}async deviceAuthorization(n={},{exchangeBody:i,clientAssertionPayload:s}={}){Bt(this.issuer,"device_authorization_endpoint"),Bt(this.issuer,"token_endpoint");let o=Ff.call(this,{client_id:this.client_id,redirect_uri:null,response_type:null,...n}),c=await Qo.call(this,"device_authorization",{form:!0,body:o,json:!0},{clientAssertionPayload:s,endpointAuthMethod:"token"}),a=rr(c);return new TD({client:this,exchangeBody:i,clientAssertionPayload:s,response:a,maxAge:n.max_age})}async revoke(n,i,{revokeBody:s,clientAssertionPayload:o}={}){if(Bt(this.issuer,"revocation_endpoint"),i!==void 0&&typeof i!="string")throw new TypeError("hint must be a string");let c={...s,token:n};i&&(c.token_type_hint=i);let a=await Qo.call(this,"revocation",{body:c,form:!0},{clientAssertionPayload:o});rr(a,{body:!1})}async introspect(n,i,{introspectBody:s,clientAssertionPayload:o}={}){if(Bt(this.issuer,"introspection_endpoint"),i!==void 0&&typeof i!="string")throw new TypeError("hint must be a string");let c={...s,token:n};i&&(c.token_type_hint=i);let a=await Qo.call(this,"introspection",{body:c,form:!0,json:!0},{clientAssertionPayload:o});return rr(a)}async fetchDistributedClaims(n,i={}){if(!nt(n))throw new TypeError("claims argument must be a plain object");if(!nt(n._claim_sources)||!nt(n._claim_names))return n;let s=Object.entries(n._claim_sources).filter(([,o])=>o&&o.endpoint);return await Promise.all(s.map(async([o,c])=>{try{let a={headers:{Accept:"application/jwt",Authorization:ji(c.access_token||i[o])}},l=await Ni.call(this,{...a,method:"GET",url:c.endpoint}),f=rr(l,{bearer:!0}),u=await Xv.call(this,"distributed",f);delete n._claim_sources[o],Object.entries(n._claim_names).forEach(Vv(n,u,o,!1))}catch(a){throw a.src=o,a}})),Yv(n),n}async unpackAggregatedClaims(n){if(!nt(n))throw new TypeError("claims argument must be a plain object");if(!nt(n._claim_sources)||!nt(n._claim_names))return n;let i=Object.entries(n._claim_sources).filter(([,s])=>s&&s.JWT);return await Promise.all(i.map(async([s,o])=>{try{let c=await Xv.call(this,"aggregated",o.JWT);delete n._claim_sources[s],Object.entries(n._claim_names).forEach(Vv(n,c,s))}catch(c){throw c.src=s,c}})),Yv(n),n}static async register(n,i={}){let{initialAccessToken:s,jwks:o,...c}=i;if(Bt(this.issuer,"registration_endpoint"),o!==void 0&&!(n.jwks||n.jwks_uri)){let f=Qv.call(this,o);n.jwks=f.toJWKS(!1)}let a=await Ni.call(this,{headers:s?{Authorization:ji(s)}:void 0,json:!0,body:n,url:this.issuer.registration_endpoint,method:"POST"}),l=rr(a,{statusCode:201,bearer:!0});return new this(l,o,c)}get metadata(){let n={};return Ae(this).get("metadata").forEach((i,s)=>{n[s]=i}),n}static async fromUri(n,i,s,o){let c=await Ni.call(this,{method:"GET",url:n,json:!0,headers:{Authorization:ji(i)}}),a=rr(c,{bearer:!0});return new this(a,s,o)}async requestObject(n={},{sign:i=this.request_object_signing_alg||"none",encrypt:{alg:s=this.request_object_encryption_alg,enc:o=this.request_object_encryption_enc||"A128CBC-HS256"}={}}={}){if(!nt(n))throw new TypeError("requestObject must be a plain object");let c,a,l={alg:i,typ:"JWT"},f=JSON.stringify(Zv({},n,{iss:this.client_id,aud:this.issuer.issuer,client_id:this.client_id,jti:wD(),iat:Xo(),exp:Xo()+300}));if(i==="none")c=[Bi.encode(JSON.stringify(l)),Bi.encode(f),""].join(".");else{let d=i.startsWith("HS");if(d)a=await this.joseSecret();else{let p=Ae(this).get("keystore");if(!p)throw new TypeError(`no keystore present for client, cannot sign using alg ${i}`);if(a=p.get({alg:i,use:"sig"}),!a)throw new TypeError(`no key to sign with found for alg ${i}`)}c=st.JWS.sign(f,a,{...l,kid:d?void 0:a.kid})}if(!s)return c;let u={alg:s,enc:o,cty:"JWT"};return u.alg.match(/^(RSA|ECDH)/)?[a]=await this.issuer.queryKeyStore({alg:u.alg,enc:u.enc,use:"enc"},{allowMulti:!0}):a=await this.joseSecret(u.alg==="dir"?u.enc:u.alg),st.JWE.encrypt(c,a,{...u,kid:a.kty==="oct"?void 0:a.kid})}static get issuer(){return e}get issuer(){return e}[Hv.custom](){return`${this.constructor.name} ${Hv(this.metadata,{depth:1/0,colors:process.stdout.isTTY,compact:!1,sorted:!0})}`}};Mi.prototype.resource=pD(async function(t,r,n){let i=r,s={verb:"GET",via:"header",...n};if(i instanceof ye){if(!i.access_token)throw new TypeError("access_token not present in TokenSet");s.tokenType=s.tokenType||i.token_type,i=i.access_token}let o=String(s.verb).toUpperCase(),c;switch(s.via){case"query":if(o!=="GET")throw new TypeError("resource servers should only parse query strings for GET requests");c={query:{access_token:i}};break;case"body":if(o!=="POST")throw new TypeError("can only send body on POST");c={form:!0,body:{access_token:i}};break;default:c={headers:{Authorization:ji(i,s.tokenType)}}}s.params&&(o==="POST"?Hf(c,{body:s.params}):Hf(c,{query:s.params})),s.headers&&Hf(c,{headers:s.headers});let a=!!this.tls_client_certificate_bound_access_tokens;return Ni.call(this,{...c,encoding:null,method:o,url:t},{mTLS:a})},"client.resource() is deprecated, use client.requestResource() instead, see docs for API details");zf.exports.BaseClient=Mi});var tS=h((E7,eS)=>{var CD=/^\d+$/;function PD(e){if(e.includes("://"))return!0;let t=e.replace(/(\/|\?)/g,"#").split("#")[0];if(t.includes(":")){let r=t.indexOf(":"),n=t.slice(r+1);if(!CD.test(n))return!0}return!1}function RD(e){if(!e.includes("@"))return!1;let t=e.split("@"),r=t[t.length-1];return!(r.includes(":")||r.includes("/")||r.includes("?"))}function KD(e){if(typeof e!="string")throw new TypeError("input must be a string");let t;return PD(e)?t=e:RD(e)?t=`acct:${e}`:t=`https://${e}`,t.split("#")[0]}eS.exports=KD});var fS=h((S7,lS)=>{var{inspect:rS,deprecate:ID}=g("util"),Vf=g("url"),nS=go(),BD=eE(),ND=uE(),uS=yE(),{RPError:Rr}=Or(),jD=Yf(),Zo=Yo(),ec=Ho(),MD=tS(),Nt=Ii(),tc=Ki(),{assertIssuerConfiguration:DD}=Uo(),{ISSUER_DEFAULTS:iS,OIDC_DISCOVERY:sS,OAUTH2_DISCOVERY:oS,WEBFINGER:JD,REL:cS,AAD_MULTITENANT_DISCOVERY:aS}=Ri(),rc=Symbol("AAD_MULTITENANT"),Kr=class{constructor(t={}){let r=t[rc];delete t[rc],["introspection","revocation"].forEach(n=>{t[`${n}_endpoint`]&&t[`${n}_endpoint_auth_methods_supported`]===void 0&&t[`${n}_endpoint_auth_signing_alg_values_supported`]===void 0&&(t.token_endpoint_auth_methods_supported&&(t[`${n}_endpoint_auth_methods_supported`]=t.token_endpoint_auth_methods_supported),t.token_endpoint_auth_signing_alg_values_supported&&(t[`${n}_endpoint_auth_signing_alg_values_supported`]=t.token_endpoint_auth_signing_alg_values_supported))}),Object.entries(t).forEach(([n,i])=>{Nt(this).get("metadata").set(n,i),this[n]||Object.defineProperty(this,n,{get(){return Nt(this).get("metadata").get(n)},enumerable:!0})}),Nt(this).set("cache",new ND({max:100})),Zo.set(this.issuer,this),Object.defineProperty(this,"Client",{value:jD(this,r)}),Object.defineProperty(this,"FAPIClient",{value:class extends this.Client{}})}async keystore(t=!1){DD(this,"jwks_uri");let r=Nt(this).get("keystore"),n=Nt(this).get("cache");if(t||!r){n.reset();let i=await tc.call(this,{method:"GET",json:!0,url:this.jwks_uri}),s=ec(i),o=nS.JWKS.asKeyStore(s,{ignoreErrors:!0});return n.set("throttle",!0,60*1e3),Nt(this).set("keystore",o),o}return r}async queryKeyStore({kid:t,kty:r,alg:n,use:i,key_ops:s},{allowMulti:o=!1}={}){let c=Nt(this).get("cache"),a={kid:t,kty:r,alg:n,use:i,key_ops:s},l=uS(a,{algorithm:"sha256",ignoreUnknown:!0,unorderedArrays:!0,unorderedSets:!0}),f=c.get(l)||c.get("throttle"),u=await this.keystore(!f),d=u.all(a);if(d.length===0)throw new Rr({printf:["no valid key found in issuer's jwks_uri for key parameters %j",a],jwks:u});if(!o&&d.length>1&&!t)throw new Rr({printf:["multiple matching keys found in issuer's jwks_uri for key parameters %j, kid must be provided in this case",a],jwks:u});return c.set(l,!0),new nS.JWKS.KeyStore(d)}get metadata(){let t={};return Nt(this).get("metadata").forEach((r,n)=>{t[n]=r}),t}static async webfinger(t){let r=MD(t),{host:n}=Vf.parse(r),i=`https://${n}${JD}`,s=await tc.call(this,{method:"GET",url:i,json:!0,query:{resource:r,rel:cS},followRedirect:!0}),o=ec(s),c=Array.isArray(o.links)&&o.links.find(f=>typeof f=="object"&&f.rel===cS&&f.href);if(!c)throw new Rr({message:"no issuer found in webfinger response",body:o});if(typeof c.href!="string"||!c.href.startsWith("https://"))throw new Rr({printf:["invalid issuer location %s",c.href],body:o});let a=c.href;if(Zo.has(a))return Zo.get(a);let l=await this.discover(a);if(l.issuer!==a)throw Zo.delete(l.issuer),new Rr("discovered issuer mismatch, expected %s, got: %s",a,l.issuer);return l}static async discover(t){let r=Vf.parse(t);if(r.pathname.includes("/.well-known/")){let i=await tc.call(this,{method:"GET",json:!0,url:t}),s=ec(i);return new Kr({...iS,...s,[rc]:!!aS.find(o=>t.startsWith(o))})}let n=[];return r.pathname==="/"?n.push(`${oS}`):n.push(`${oS}${r.pathname}`),r.pathname.endsWith("/")?n.push(`${r.pathname}${sS.substring(1)}`):n.push(`${r.pathname}${sS}`),BD(n.map(async i=>{let s=Vf.format({...r,pathname:i}),o=await tc.call(this,{method:"GET",json:!0,url:s}),c=ec(o);return new Kr({...iS,...c,[rc]:!!aS.find(a=>s.startsWith(a))})}))}[rS.custom](){return`${this.constructor.name} ${rS(this.metadata,{depth:1/0,colors:process.stdout.isTTY,compact:!1,sorted:!0})}`}};Kr.prototype.key=ID(async function({kid:t,kty:r,alg:n,use:i,key_ops:s},o=!1){let c=Nt(this).get("cache"),a={kid:t,kty:r,alg:n,use:i,key_ops:s},l=uS(a,{algorithm:"sha256",ignoreUnknown:!0,unorderedArrays:!0,unorderedSets:!0}),f=c.get(l)||c.get("throttle"),u=await this.keystore(!f),d=u.all(a);if(d.length===0)throw new Rr({printf:["no valid key found in issuer's jwks_uri for key parameters %j",a],jwks:u});if(!o){if(d.length!==1)throw new Rr({printf:["multiple matching keys found in issuer's jwks_uri for key parameters %j, kid must be provided in this case",a],jwks:u});c.set(l,!0)}return d[0]},"issuer.key is not only a private API, it is also deprecated");lS.exports=Kr});var hS=h((x7,dS)=>{dS.exports=e=>JSON.parse(JSON.stringify(e))});var _S=h((T7,gS)=>{var pS=g("url"),{format:LD}=g("util"),$D=hS(),{RPError:yS,OPError:UD}=Or(),{BaseClient:WD}=Yf(),{random:Xf,codeChallenge:HD}=Ci(),FD=If(),{resolveResponseType:GD,resolveRedirectUri:zD}=Vo();function YD(e,t,r={}){e?this.error(e):t?this.success(t,r):this.fail(r)}function mS({client:e,params:t={},passReqToCallback:r=!1,sessionKey:n,usePKCE:i=!1}={},s){if(!(e instanceof WD))throw new TypeError("client must be an instance of openid-client Client");if(typeof s!="function")throw new TypeError("verify callback must be a function");if(!e.issuer||!e.issuer.issuer)throw new TypeError("client must have an issuer with an identifier");if(this._client=e,this._issuer=e.issuer,this._verify=s,this._passReqToCallback=r,this._usePKCE=i,this._key=n||`oidc:${pS.parse(this._issuer.issuer).hostname}`,this._params=$D(t),this._usePKCE===!0){let o=this._issuer.code_challenge_methods_supported;if(!Array.isArray(o))throw new TypeError("code_challenge_methods_supported is not properly set on issuer");if(o.includes("S256"))this._usePKCE="S256";else if(o.includes("plain"))this._usePKCE="plain";else throw new TypeError("neither supported code_challenge_method is supported by the issuer")}else if(typeof this._usePKCE=="string"&&!["plain","S256"].includes(this._usePKCE))throw new TypeError(`${this._usePKCE} is not valid/implemented PKCE code_challenge_method`);this.name=pS.parse(e.issuer.issuer).hostname,this._params.response_type||(this._params.response_type=GD.call(e)),this._params.redirect_uri||(this._params.redirect_uri=zD.call(e)),this._params.scope||(this._params.scope="openid")}mS.prototype.authenticate=function(t,r){(async()=>{let n=this._client;if(!t.session)throw new TypeError("authentication requires session support");let i=n.callbackParams(t),s=this._key;if(Object.keys(i).length===0){let w={state:Xf(),...this._params,...r};if(!w.nonce&&w.response_type.includes("id_token")&&(w.nonce=Xf()),t.session[s]=FD(w,"nonce","state","max_age","response_type"),this._usePKCE){let v=Xf();switch(t.session[s].code_verifier=v,this._usePKCE){case"S256":w.code_challenge=HD(v),w.code_challenge_method="S256";break;case"plain":w.code_challenge=v;break}}this.redirect(n.authorizationUrl(w));return}let o=t.session[s];if(Object.keys(o||{}).length===0)throw new Error(LD('did not find expected authorization request details in session, req.session["%s"] is %j',s,o));let{state:c,nonce:a,max_age:l,code_verifier:f,response_type:u}=o;try{delete t.session[s]}catch{}let d={redirect_uri:this._params.redirect_uri,...r},p={state:c,nonce:a,max_age:l,code_verifier:f,response_type:u},m=await n.callback(d.redirect_uri,i,p),y=this._passReqToCallback,_=this._verify.length>(y?3:2)&&n.issuer.userinfo_endpoint,b=[m,YD.bind(this)];if(_){if(!m.access_token)throw new yS({message:"expected access_token to be returned when asking for userinfo in verify callback",tokenset:m});let w=await n.userinfo(m);b.splice(1,0,w)}y&&b.unshift(t),this._verify(...b)})().catch(n=>{n instanceof UD&&n.error!=="server_error"&&!n.error.startsWith("invalid")||n instanceof yS?this.fail(n):this.error(n)})};gS.exports=mS});var bS=h((A7,wS)=>{var VD=fS(),{OPError:XD,RPError:QD}=Or(),ZD=Yo(),e6=_S(),t6=Fo(),{CLOCK_TOLERANCE:r6,HTTP_OPTIONS:n6}=Ri(),i6=Ci(),{setDefaults:s6}=Ki();wS.exports={Issuer:VD,Registry:ZD,Strategy:e6,TokenSet:t6,errors:{OPError:XD,RPError:QD},custom:{setHttpOptionsDefaults:s6,http_options:n6,clock_tolerance:r6},generators:i6}});var Q=h((q7,ot)=>{ot.exports.KEYOBJECT=Symbol("KEYOBJECT");ot.exports.PRIVATE_MEMBERS=Symbol("PRIVATE_MEMBERS");ot.exports.PUBLIC_MEMBERS=Symbol("PUBLIC_MEMBERS");ot.exports.THUMBPRINT_MATERIAL=Symbol("THUMBPRINT_MATERIAL");ot.exports.JWK_MEMBERS=Symbol("JWK_MEMBERS");ot.exports.KEY_MANAGEMENT_ENCRYPT=Symbol("KEY_MANAGEMENT_ENCRYPT");ot.exports.KEY_MANAGEMENT_DECRYPT=Symbol("KEY_MANAGEMENT_DECRYPT");var nc={sig:new Set(["sign","verify"]),enc:new Set(["encrypt","decrypt","wrapKey","unwrapKey","deriveKey"])},o6=new Set([...nc.sig,...nc.enc]),c6=new Set(Object.keys(nc));ot.exports.USES_MAPPING=nc;ot.exports.OPS=o6;ot.exports.USES=c6});var Ir=h((O7,Qf)=>{var{deprecate:a6}=g("util"),u6=a6(()=>{},'"P-256K" EC curve name is deprecated');Qf.exports={name:"secp256k1",rename(e){e!=="secp256k1"&&u6(),Qf.exports.name=e}}});var vS=h((k7,ES)=>{var{getCurves:ic}=g("crypto"),{name:l6}=Ir(),Di=new Set;ic().includes("prime256v1")&&Di.add("P-256");ic().includes("secp256k1")&&Di.add(l6);ic().includes("secp384r1")&&Di.add("P-384");ic().includes("secp521r1")&&Di.add("P-521");ES.exports=Di});var xS=h((C7,SS)=>{SS.exports=new Map([["A128CBC-HS256",128],["A128GCM",96],["A128GCMKW",96],["A192CBC-HS384",128],["A192GCM",96],["A192GCMKW",96],["A256CBC-HS512",128],["A256GCM",96],["A256GCMKW",96]])});var AS=h((P7,TS)=>{TS.exports={sign:new Map,verify:new Map,keyManagementEncrypt:new Map,keyManagementDecrypt:new Map,encrypt:new Map,decrypt:new Map}});var OS=h((R7,qS)=>{qS.exports={oct:{decrypt:{},deriveKey:{},encrypt:{},sign:{},unwrapKey:{},verify:{},wrapKey:{}},EC:{decrypt:{},deriveKey:{},encrypt:{},sign:{},unwrapKey:{},verify:{},wrapKey:{}},RSA:{decrypt:{},deriveKey:{},encrypt:{},sign:{},unwrapKey:{},verify:{},wrapKey:{}},OKP:{decrypt:{},deriveKey:{},encrypt:{},sign:{},unwrapKey:{},verify:{},wrapKey:{}}}});var CS=h((K7,kS)=>{kS.exports=new Map([["A128CBC-HS256",256],["A128GCM",128],["A192CBC-HS384",384],["A192GCM",192],["A256CBC-HS512",512],["A256GCM",256]])});var RS=h((I7,PS)=>{var sc=new Set(["Ed25519"]);"electron"in process.versions||(sc.add("Ed448"),sc.add("X25519"),sc.add("X448"));PS.exports=sc});var IS=h((B7,KS)=>{KS.exports=new Map});var vt=h((N7,BS)=>{var f6=vS(),d6=xS(),h6=AS(),p6=OS(),y6=CS(),m6=RS(),g6=IS();BS.exports={EC_CURVES:f6,ECDH_DERIVE_LENGTHS:g6,IVLENGTHS:d6,JWA:h6,JWK:p6,KEYLENGTHS:y6,OKP_CURVES:m6}});var Zf=h((j7,NS)=>{var{randomBytes:_6}=g("crypto"),{IVLENGTHS:w6}=vt();NS.exports=e=>_6(w6.get(e)/8)});var ve=h((M7,Br)=>{var jS=e=>e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"),MS=(e,t="utf8")=>jS(Buffer.from(e,t).toString("base64")),DS=e=>jS(e.toString("base64")),JS=e=>Buffer.from(e,"base64"),td=(e,t="utf8")=>JS(e).toString(t),ed={encode:e=>MS(JSON.stringify(e)),decode:(e,t="utf8")=>JSON.parse(td(e,t))};ed.decode.try=(e,t="utf8")=>{try{return ed.decode(e,t)}catch{return td(e,t)}};var b6=e=>{let t=BigInt(e).toString(16);t.length%2&&(t=`0${t}`);let r=t.length/2,n=new Uint8Array(r),i=0,s=0;for(;i<r;)n[i]=parseInt(t.slice(s,s+2),16),i+=1,s+=2;return n},E6=e=>DS(Buffer.from(b6(e)));Br.exports.decode=td;Br.exports.decodeToBuffer=JS;Br.exports.encode=MS;Br.exports.encodeBuffer=DS;Br.exports.JSON=ed;Br.exports.encodeBigInt=E6});var $=h((Z7,ue)=>{var v6={JOSEAlgNotWhitelisted:"ERR_JOSE_ALG_NOT_WHITELISTED",JOSECritNotUnderstood:"ERR_JOSE_CRIT_NOT_UNDERSTOOD",JOSEInvalidEncoding:"ERR_JOSE_INVALID_ENCODING",JOSEMultiError:"ERR_JOSE_MULTIPLE_ERRORS",JOSENotSupported:"ERR_JOSE_NOT_SUPPORTED",JWEDecryptionFailed:"ERR_JWE_DECRYPTION_FAILED",JWEInvalid:"ERR_JWE_INVALID",JWKImportFailed:"ERR_JWK_IMPORT_FAILED",JWKInvalid:"ERR_JWK_INVALID",JWKKeySupport:"ERR_JWK_KEY_SUPPORT",JWKSNoMatchingKey:"ERR_JWKS_NO_MATCHING_KEY",JWSInvalid:"ERR_JWS_INVALID",JWSVerificationFailed:"ERR_JWS_VERIFICATION_FAILED",JWTClaimInvalid:"ERR_JWT_CLAIM_INVALID",JWTExpired:"ERR_JWT_EXPIRED",JWTMalformed:"ERR_JWT_MALFORMED"},S6={JWEDecryptionFailed:"decryption operation failed",JWEInvalid:"JWE invalid",JWKSNoMatchingKey:"no matching key found in the KeyStore",JWSInvalid:"JWS invalid",JWSVerificationFailed:"signature verification failed"},ae=class extends Error{constructor(t){super(t),t===void 0&&(this.message=S6[this.constructor.name]),this.name=this.constructor.name,this.code=v6[this.constructor.name],Error.captureStackTrace(this,this.constructor)}},x6=e=>e instanceof oc,oc=class extends ae{constructor(t){super();let r;for(;(r=t.findIndex(x6))&&r!==-1;)t.splice(r,1,...t[r]);Object.defineProperty(this,"errors",{value:t})}*[Symbol.iterator](){for(let t of this.errors)yield t}};ue.exports.JOSEError=ae;ue.exports.JOSEAlgNotWhitelisted=class extends ae{};ue.exports.JOSECritNotUnderstood=class extends ae{};ue.exports.JOSEInvalidEncoding=class extends ae{};ue.exports.JOSEMultiError=oc;ue.exports.JOSENotSupported=class extends ae{};ue.exports.JWEDecryptionFailed=class extends ae{};ue.exports.JWEInvalid=class extends ae{};ue.exports.JWKImportFailed=class extends ae{};ue.exports.JWKInvalid=class extends ae{};ue.exports.JWKKeySupport=class extends ae{};ue.exports.JWKSNoMatchingKey=class extends ae{};ue.exports.JWSInvalid=class extends ae{};ue.exports.JWSVerificationFailed=class extends ae{};var cc=class extends ae{constructor(t,r="unspecified",n="unspecified"){super(t),this.claim=r,this.reason=n}};ue.exports.JWTClaimInvalid=cc;ue.exports.JWTExpired=class extends cc{};ue.exports.JWTMalformed=class extends ae{}});var Ie=h((eX,LS)=>{var{diffieHellman:T6,KeyObject:A6,sign:q6,verify:O6}=g("crypto"),[xn,rd]=process.version.substr(1).split(".").map(e=>parseInt(e,10));LS.exports={oaepHashSupported:xn>12||xn===12&&rd>=9,keyObjectSupported:!!A6&&xn>=12,edDSASupported:!!q6&&!!O6,dsaEncodingSupported:xn>13||xn===13&&rd>=2||xn===12&&rd>=16,improvedDH:!!T6}});var Ue=h((tX,$S)=>{$S.exports=e=>!!e&&e.constructor===Object});var ac=h(US=>{var{inherits:k6}=g("util");function We(e){this._reporterState={obj:null,path:[],options:e||{},errors:[]}}We.prototype.isError=function(t){return t instanceof Tn};We.prototype.save=function(){let t=this._reporterState;return{obj:t.obj,pathLen:t.path.length}};We.prototype.restore=function(t){let r=this._reporterState;r.obj=t.obj,r.path=r.path.slice(0,t.pathLen)};We.prototype.enterKey=function(t){return this._reporterState.path.push(t)};We.prototype.exitKey=function(t){let r=this._reporterState;r.path=r.path.slice(0,t-1)};We.prototype.leaveKey=function(t,r,n){let i=this._reporterState;this.exitKey(t),i.obj!==null&&(i.obj[r]=n)};We.prototype.path=function(){return this._reporterState.path.join("/")};We.prototype.enterObject=function(){let t=this._reporterState,r=t.obj;return t.obj={},r};We.prototype.leaveObject=function(t){let r=this._reporterState,n=r.obj;return r.obj=t,n};We.prototype.error=function(t){let r,n=this._reporterState,i=t instanceof Tn;if(i?r=t:r=new Tn(n.path.map(function(s){return`[${JSON.stringify(s)}]`}).join(""),t.message||t,t.stack),!n.options.partial)throw r;return i||n.errors.push(r),r};We.prototype.wrapResult=function(t){let r=this._reporterState;return r.options.partial?{result:this.isError(t)?null:t,errors:r.errors}:t};function Tn(e,t){this.path=e,this.rethrow(t)}k6(Tn,Error);Tn.prototype.rethrow=function(t){if(this.message=`${t} at: ${this.path||"(shallow)"}`,Error.captureStackTrace&&Error.captureStackTrace(this,Tn),!this.stack)try{throw new Error(this.message)}catch(r){this.stack=r.stack}return this};US.Reporter=We});var lc=h((nX,WS)=>{var{inherits:C6}=g("util"),{Reporter:uc}=ac();function He(e,t){if(uc.call(this,t),!Buffer.isBuffer(e)){this.error("Input not Buffer");return}this.base=e,this.offset=0,this.length=e.length}C6(He,uc);He.isDecoderBuffer=function(t){return t instanceof He?!0:typeof t=="object"&&Buffer.isBuffer(t.base)&&t.constructor.name==="DecoderBuffer"&&typeof t.offset=="number"&&typeof t.length=="number"&&typeof t.save=="function"&&typeof t.restore=="function"&&typeof t.isEmpty=="function"&&typeof t.readUInt8=="function"&&typeof t.skip=="function"&&typeof t.raw=="function"};He.prototype.save=function(){return{offset:this.offset,reporter:uc.prototype.save.call(this)}};He.prototype.restore=function(t){let r=new He(this.base);return r.offset=t.offset,r.length=this.offset,this.offset=t.offset,uc.prototype.restore.call(this,t.reporter),r};He.prototype.isEmpty=function(){return this.offset===this.length};He.prototype.readUInt8=function(t){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(t||"DecoderBuffer overrun")};He.prototype.skip=function(t,r){if(!(this.offset+t<=this.length))return this.error(r||"DecoderBuffer overrun");let n=new He(this.base);return n._reporterState=this._reporterState,n.offset=this.offset,n.length=this.offset+t,this.offset+=t,n};He.prototype.raw=function(t){return this.base.slice(t?t.offset:this.offset,this.length)};function An(e,t){if(Array.isArray(e))this.length=0,this.value=e.map(function(r){return An.isEncoderBuffer(r)||(r=new An(r,t)),this.length+=r.length,r},this);else if(typeof e=="number"){if(!(e>=0&&e<=255))return t.error("non-byte EncoderBuffer value");this.value=e,this.length=1}else if(typeof e=="string")this.value=e,this.length=Buffer.byteLength(e);else if(Buffer.isBuffer(e))this.value=e,this.length=e.length;else return t.error(`Unsupported type: ${typeof e}`)}An.isEncoderBuffer=function(t){return t instanceof An?!0:typeof t=="object"&&t.constructor.name==="EncoderBuffer"&&typeof t.length=="number"&&typeof t.join=="function"};An.prototype.join=function(t,r){return t||(t=Buffer.alloc(this.length)),r||(r=0),this.length===0||(Array.isArray(this.value)?this.value.forEach(function(n){n.join(t,r),r+=n.length}):(typeof this.value=="number"?t[r]=this.value:typeof this.value=="string"?t.write(this.value,r):Buffer.isBuffer(this.value)&&this.value.copy(t,r),r+=this.length)),t};WS.exports={DecoderBuffer:He,EncoderBuffer:An}});var fc=h((iX,FS)=>{var{strict:Se}=g("assert"),{Reporter:P6}=ac(),{DecoderBuffer:R6,EncoderBuffer:K6}=lc(),HS=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],I6=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(HS),B6=["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"];function J(e,t,r){let n={};this._baseState=n,n.name=r,n.enc=e,n.parent=t||null,n.children=null,n.tag=null,n.args=null,n.reverseArgs=null,n.choice=null,n.optional=!1,n.any=!1,n.obj=!1,n.use=null,n.useDecoder=null,n.key=null,n.default=null,n.explicit=null,n.implicit=null,n.contains=null,n.parent||(n.children=[],this._wrap())}var N6=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];J.prototype.clone=function(){let t=this._baseState,r={};N6.forEach(function(i){r[i]=t[i]});let n=new this.constructor(r.parent);return n._baseState=r,n};J.prototype._wrap=function(){let t=this._baseState;I6.forEach(function(r){this[r]=function(){let i=new this.constructor(this);return t.children.push(i),i[r].apply(i,arguments)}},this)};J.prototype._init=function(t){let r=this._baseState;Se(r.parent===null),t.call(this),r.children=r.children.filter(function(n){return n._baseState.parent===this},this),Se.equal(r.children.length,1,"Root node can have only one child")};J.prototype._useArgs=function(t){let r=this._baseState,n=t.filter(function(i){return i instanceof this.constructor},this);t=t.filter(function(i){return!(i instanceof this.constructor)},this),n.length!==0&&(Se(r.children===null),r.children=n,n.forEach(function(i){i._baseState.parent=this},this)),t.length!==0&&(Se(r.args===null),r.args=t,r.reverseArgs=t.map(function(i){if(typeof i!="object"||i.constructor!==Object)return i;let s={};return Object.keys(i).forEach(function(o){o==(o|0)&&(o|=0);let c=i[o];s[c]=o}),s}))};B6.forEach(function(e){J.prototype[e]=function(){let r=this._baseState;throw new Error(`${e} not implemented for encoding: ${r.enc}`)}});HS.forEach(function(e){J.prototype[e]=function(){let r=this._baseState,n=Array.prototype.slice.call(arguments);return Se(r.tag===null),r.tag=e,this._useArgs(n),this}});J.prototype.use=function(t){Se(t);let r=this._baseState;return Se(r.use===null),r.use=t,this};J.prototype.optional=function(){let t=this._baseState;return t.optional=!0,this};J.prototype.def=function(t){let r=this._baseState;return Se(r.default===null),r.default=t,r.optional=!0,this};J.prototype.explicit=function(t){let r=this._baseState;return Se(r.explicit===null&&r.implicit===null),r.explicit=t,this};J.prototype.implicit=function(t){let r=this._baseState;return Se(r.explicit===null&&r.implicit===null),r.implicit=t,this};J.prototype.obj=function(){let t=this._baseState,r=Array.prototype.slice.call(arguments);return t.obj=!0,r.length!==0&&this._useArgs(r),this};J.prototype.key=function(t){let r=this._baseState;return Se(r.key===null),r.key=t,this};J.prototype.any=function(){let t=this._baseState;return t.any=!0,this};J.prototype.choice=function(t){let r=this._baseState;return Se(r.choice===null),r.choice=t,this._useArgs(Object.keys(t).map(function(n){return t[n]})),this};J.prototype.contains=function(t){let r=this._baseState;return Se(r.use===null),r.contains=t,this};J.prototype._decode=function(t,r){let n=this._baseState;if(n.parent===null)return t.wrapResult(n.children[0]._decode(t,r));let i=n.default,s=!0,o=null;if(n.key!==null&&(o=t.enterKey(n.key)),n.optional){let a=null;if(n.explicit!==null?a=n.explicit:n.implicit!==null?a=n.implicit:n.tag!==null&&(a=n.tag),a===null&&!n.any){let l=t.save();try{n.choice===null?this._decodeGeneric(n.tag,t,r):this._decodeChoice(t,r),s=!0}catch{s=!1}t.restore(l)}else if(s=this._peekTag(t,a,n.any),t.isError(s))return s}let c;if(n.obj&&s&&(c=t.enterObject()),s){if(n.explicit!==null){let l=this._decodeTag(t,n.explicit);if(t.isError(l))return l;t=l}let a=t.offset;if(n.use===null&&n.choice===null){let l;n.any&&(l=t.save());let f=this._decodeTag(t,n.implicit!==null?n.implicit:n.tag,n.any);if(t.isError(f))return f;n.any?i=t.raw(l):t=f}if(r&&r.track&&n.tag!==null&&r.track(t.path(),a,t.length,"tagged"),r&&r.track&&n.tag!==null&&r.track(t.path(),t.offset,t.length,"content"),n.any||(n.choice===null?i=this._decodeGeneric(n.tag,t,r):i=this._decodeChoice(t,r)),t.isError(i))return i;if(!n.any&&n.choice===null&&n.children!==null&&n.children.forEach(function(f){f._decode(t,r)}),n.contains&&(n.tag==="octstr"||n.tag==="bitstr")){let l=new R6(i);i=this._getUse(n.contains,t._reporterState.obj)._decode(l,r)}}return n.obj&&s&&(i=t.leaveObject(c)),n.key!==null&&(i!==null||s===!0)?t.leaveKey(o,n.key,i):o!==null&&t.exitKey(o),i};J.prototype._decodeGeneric=function(t,r,n){let i=this._baseState;return t==="seq"||t==="set"?null:t==="seqof"||t==="setof"?this._decodeList(r,t,i.args[0],n):/str$/.test(t)?this._decodeStr(r,t,n):t==="objid"&&i.args?this._decodeObjid(r,i.args[0],i.args[1],n):t==="objid"?this._decodeObjid(r,null,null,n):t==="gentime"||t==="utctime"?this._decodeTime(r,t,n):t==="null_"?this._decodeNull(r,n):t==="bool"?this._decodeBool(r,n):t==="objDesc"?this._decodeStr(r,t,n):t==="int"||t==="enum"?this._decodeInt(r,i.args&&i.args[0],n):i.use!==null?this._getUse(i.use,r._reporterState.obj)._decode(r,n):r.error(`unknown tag: ${t}`)};J.prototype._getUse=function(t,r){let n=this._baseState;return n.useDecoder=this._use(t,r),Se(n.useDecoder._baseState.parent===null),n.useDecoder=n.useDecoder._baseState.children[0],n.implicit!==n.useDecoder._baseState.implicit&&(n.useDecoder=n.useDecoder.clone(),n.useDecoder._baseState.implicit=n.implicit),n.useDecoder};J.prototype._decodeChoice=function(t,r){let n=this._baseState,i=null,s=!1;return Object.keys(n.choice).some(function(o){let c=t.save(),a=n.choice[o];try{let l=a._decode(t,r);if(t.isError(l))return!1;i={type:o,value:l},s=!0}catch{return t.restore(c),!1}return!0},this),s?i:t.error("Choice not matched")};J.prototype._createEncoderBuffer=function(t){return new K6(t,this.reporter)};J.prototype._encode=function(t,r,n){let i=this._baseState;if(i.default!==null&&i.default===t)return;let s=this._encodeValue(t,r,n);if(s!==void 0&&!this._skipDefault(s,r,n))return s};J.prototype._encodeValue=function(t,r,n){let i=this._baseState;if(i.parent===null)return i.children[0]._encode(t,r||new P6);let s=null;if(this.reporter=r,i.optional&&t===void 0)if(i.default!==null)t=i.default;else return;let o=null,c=!1;if(i.any)s=this._createEncoderBuffer(t);else if(i.choice)s=this._encodeChoice(t,r);else if(i.contains)o=this._getUse(i.contains,n)._encode(t,r),c=!0;else if(i.children)o=i.children.map(function(a){if(a._baseState.tag==="null_")return a._encode(null,r,t);if(a._baseState.key===null)return r.error("Child should have a key");let l=r.enterKey(a._baseState.key);if(typeof t!="object")return r.error("Child expected, but input is not object");let f=a._encode(t[a._baseState.key],r,t);return r.leaveKey(l),f},this).filter(function(a){return a}),o=this._createEncoderBuffer(o);else if(i.tag==="seqof"||i.tag==="setof"){if(!(i.args&&i.args.length===1))return r.error(`Too many args for: ${i.tag}`);if(!Array.isArray(t))return r.error("seqof/setof, but data is not Array");let a=this.clone();a._baseState.implicit=null,o=this._createEncoderBuffer(t.map(function(l){let f=this._baseState;return this._getUse(f.args[0],t)._encode(l,r)},a))}else i.use!==null?s=this._getUse(i.use,n)._encode(t,r):(o=this._encodePrimitive(i.tag,t),c=!0);if(!i.any&&i.choice===null){let a=i.implicit!==null?i.implicit:i.tag,l=i.implicit===null?"universal":"context";a===null?i.use===null&&r.error("Tag could be omitted only for .use()"):i.use===null&&(s=this._encodeComposite(a,c,l,o))}return i.explicit!==null&&(s=this._encodeComposite(i.explicit,!1,"context",s)),s};J.prototype._encodeChoice=function(t,r){let n=this._baseState,i=n.choice[t.type];return i||Se(!1,`${t.type} not found in ${JSON.stringify(Object.keys(n.choice))}`),i._encode(t.value,r)};J.prototype._encodePrimitive=function(t,r){let n=this._baseState;if(/str$/.test(t))return this._encodeStr(r,t);if(t==="objid"&&n.args)return this._encodeObjid(r,n.reverseArgs[0],n.args[1]);if(t==="objid")return this._encodeObjid(r,null,null);if(t==="gentime"||t==="utctime")return this._encodeTime(r,t);if(t==="null_")return this._encodeNull();if(t==="int"||t==="enum")return this._encodeInt(r,n.args&&n.reverseArgs[0]);if(t==="bool")return this._encodeBool(r);if(t==="objDesc")return this._encodeStr(r,t);throw new Error(`Unsupported tag: ${t}`)};J.prototype._isNumstr=function(t){return/^[0-9 ]*$/.test(t)};J.prototype._isPrintstr=function(t){return/^[A-Za-z0-9 '()+,-./:=?]*$/.test(t)};FS.exports=J});var dc=h(Nr=>{function GS(e){let t={};return Object.keys(e).forEach(function(r){(r|0)==r&&(r=r|0);let n=e[r];t[n]=r}),t}Nr.tagClass={0:"universal",1:"application",2:"context",3:"private"};Nr.tagClassByName=GS(Nr.tagClass);Nr.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"};Nr.tagByName=GS(Nr.tag)});var id=h((oX,VS)=>{var{inherits:j6}=g("util"),zS=fc(),nd=dc();function YS(e){this.enc="der",this.name=e.name,this.entity=e,this.tree=new ct,this.tree._init(e.body)}YS.prototype.encode=function(t,r){return this.tree._encode(t,r).join()};function ct(e){zS.call(this,"der",e)}j6(ct,zS);ct.prototype._encodeComposite=function(t,r,n,i){let s=D6(t,r,n,this.reporter);if(i.length<128){let a=Buffer.alloc(2);return a[0]=s,a[1]=i.length,this._createEncoderBuffer([a,i])}let o=1;for(let a=i.length;a>=256;a>>=8)o++;let c=Buffer.alloc(1+1+o);c[0]=s,c[1]=128|o;for(let a=1+o,l=i.length;l>0;a--,l>>=8)c[a]=l&255;return this._createEncoderBuffer([c,i])};ct.prototype._encodeStr=function(t,r){if(r==="bitstr")return this._createEncoderBuffer([t.unused|0,t.data]);if(r==="bmpstr"){let n=Buffer.alloc(t.length*2);for(let i=0;i<t.length;i++)n.writeUInt16BE(t.charCodeAt(i),i*2);return this._createEncoderBuffer(n)}else return r==="numstr"?this._isNumstr(t)?this._createEncoderBuffer(t):this.reporter.error("Encoding of string type: numstr supports only digits and space"):r==="printstr"?this._isPrintstr(t)?this._createEncoderBuffer(t):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(r)?this._createEncoderBuffer(t):r==="objDesc"?this._createEncoderBuffer(t):this.reporter.error(`Encoding of string type: ${r} unsupported`)};ct.prototype._encodeObjid=function(t,r,n){if(typeof t=="string"){if(!r)return this.reporter.error("string objid given, but no values map found");if(!Object.prototype.hasOwnProperty.call(r,t))return this.reporter.error("objid not found in values map");t=r[t].split(/[\s.]+/g);for(let c=0;c<t.length;c++)t[c]|=0}else if(Array.isArray(t)){t=t.slice();for(let c=0;c<t.length;c++)t[c]|=0}if(!Array.isArray(t))return this.reporter.error(`objid() should be either array or string, got: ${JSON.stringify(t)}`);if(!n){if(t[1]>=40)return this.reporter.error("Second objid identifier OOB");t.splice(0,2,t[0]*40+t[1])}let i=0;for(let c=0;c<t.length;c++){let a=t[c];for(i++;a>=128;a>>=7)i++}let s=Buffer.alloc(i),o=s.length-1;for(let c=t.length-1;c>=0;c--){let a=t[c];for(s[o--]=a&127;(a>>=7)>0;)s[o--]=128|a&127}return this._createEncoderBuffer(s)};function Fe(e){return e<10?`0${e}`:e}ct.prototype._encodeTime=function(t,r){let n,i=new Date(t);return r==="gentime"?n=[Fe(i.getUTCFullYear()),Fe(i.getUTCMonth()+1),Fe(i.getUTCDate()),Fe(i.getUTCHours()),Fe(i.getUTCMinutes()),Fe(i.getUTCSeconds()),"Z"].join(""):r==="utctime"?n=[Fe(i.getUTCFullYear()%100),Fe(i.getUTCMonth()+1),Fe(i.getUTCDate()),Fe(i.getUTCHours()),Fe(i.getUTCMinutes()),Fe(i.getUTCSeconds()),"Z"].join(""):this.reporter.error(`Encoding ${r} time is not supported yet`),this._encodeStr(n,"octstr")};ct.prototype._encodeNull=function(){return this._createEncoderBuffer("")};function M6(e){var t=BigInt(e).toString(16);t.length%2&&(t="0"+t);for(var r=t.length/2,n=new Uint8Array(r),i=0,s=0;i<r;)n[i]=parseInt(t.slice(s,s+2),16),i+=1,s+=2;return n}ct.prototype._encodeInt=function(t,r){if(typeof t=="string"){if(!r)return this.reporter.error("String int or enum given, but no values map");if(!Object.prototype.hasOwnProperty.call(r,t))return this.reporter.error(`Values map doesn't contain: ${JSON.stringify(t)}`);t=r[t]}if(typeof t=="bigint"){let s=[...M6(t)];s[0]&128&&s.unshift(0),t=Buffer.from(s)}if(Buffer.isBuffer(t)){let s=t.length;t.length===0&&s++;let o=Buffer.alloc(s);return t.copy(o),t.length===0&&(o[0]=0),this._createEncoderBuffer(o)}if(t<128)return this._createEncoderBuffer(t);if(t<256)return this._createEncoderBuffer([0,t]);let n=1;for(let s=t;s>=256;s>>=8)n++;let i=new Array(n);for(let s=i.length-1;s>=0;s--)i[s]=t&255,t>>=8;return i[0]&128&&i.unshift(0),this._createEncoderBuffer(Buffer.from(i))};ct.prototype._encodeBool=function(t){return this._createEncoderBuffer(t?255:0)};ct.prototype._use=function(t,r){return typeof t=="function"&&(t=t(r)),t._getEncoder("der").tree};ct.prototype._skipDefault=function(t,r,n){let i=this._baseState,s;if(i.default===null)return!1;let o=t.join();if(i.defaultBuffer===void 0&&(i.defaultBuffer=this._encodeValue(i.default,r,n).join()),o.length!==i.defaultBuffer.length)return!1;for(s=0;s<o.length;s++)if(o[s]!==i.defaultBuffer[s])return!1;return!0};function D6(e,t,r,n){let i;if(e==="seqof"?e="seq":e==="setof"&&(e="set"),Object.prototype.hasOwnProperty.call(nd.tagByName,e))i=nd.tagByName[e];else if(typeof e=="number"&&(e|0)===e)i=e;else return n.error(`Unknown tag: ${e}`);return i>=31?n.error("Multi-octet tag encoding unsupported"):(t||(i|=32),i|=nd.tagClassByName[r||"universal"]<<6,i)}VS.exports=YS});var QS=h((cX,XS)=>{var{inherits:J6}=g("util"),sd=id();function od(e){sd.call(this,e),this.enc="pem"}J6(od,sd);od.prototype.encode=function(t,r){let i=sd.prototype.encode.call(this,t).toString("base64"),s=[`-----BEGIN ${r.label}-----`];for(let o=0;o<i.length;o+=64)s.push(i.slice(o,o+64));return s.push(`-----END ${r.label}-----`),s.join(`
`)};XS.exports=od});var cd=h((aX,ZS)=>{ZS.exports={der:id(),pem:QS()}});var ud=h((uX,sx)=>{var{inherits:L6}=g("util"),{DecoderBuffer:ex}=lc(),rx=fc(),tx=dc();function nx(e){this.enc="der",this.name=e.name,this.entity=e,this.tree=new Be,this.tree._init(e.body)}nx.prototype.decode=function(t,r){return ex.isDecoderBuffer(t)||(t=new ex(t,r)),this.tree._decode(t,r)};function Be(e){rx.call(this,"der",e)}L6(Be,rx);Be.prototype._peekTag=function(t,r,n){if(t.isEmpty())return!1;let i=t.save(),s=ad(t,`Failed to peek tag: "${r}"`);return t.isError(s)?s:(t.restore(i),s.tag===r||s.tagStr===r||s.tagStr+"of"===r||n)};Be.prototype._decodeTag=function(t,r,n){let i=ad(t,`Failed to decode tag of "${r}"`);if(t.isError(i))return i;let s=ix(t,i.primitive,`Failed to get length of "${r}"`);if(t.isError(s))return s;if(!n&&i.tag!==r&&i.tagStr!==r&&i.tagStr+"of"!==r)return t.error(`Failed to match tag: "${r}"`);if(i.primitive||s!==null)return t.skip(s,`Failed to match body of: "${r}"`);let o=t.save(),c=this._skipUntilEnd(t,`Failed to skip indefinite length body: "${this.tag}"`);return t.isError(c)?c:(s=t.offset-o.offset,t.restore(o),t.skip(s,`Failed to match body of: "${r}"`))};Be.prototype._skipUntilEnd=function(t,r){for(;;){let n=ad(t,r);if(t.isError(n))return n;let i=ix(t,n.primitive,r);if(t.isError(i))return i;let s;if(n.primitive||i!==null?s=t.skip(i):s=this._skipUntilEnd(t,r),t.isError(s))return s;if(n.tagStr==="end")break}};Be.prototype._decodeList=function(t,r,n,i){let s=[];for(;!t.isEmpty();){let o=this._peekTag(t,"end");if(t.isError(o))return o;let c=n.decode(t,"der",i);if(t.isError(c)&&o)break;s.push(c)}return s};Be.prototype._decodeStr=function(t,r){if(r==="bitstr"){let n=t.readUInt8();return t.isError(n)?n:{unused:n,data:t.raw()}}else if(r==="bmpstr"){let n=t.raw();if(n.length%2===1)return t.error("Decoding of string type: bmpstr length mismatch");let i="";for(let s=0;s<n.length/2;s++)i+=String.fromCharCode(n.readUInt16BE(s*2));return i}else if(r==="numstr"){let n=t.raw().toString("ascii");return this._isNumstr(n)?n:t.error("Decoding of string type: numstr unsupported characters")}else{if(r==="octstr")return t.raw();if(r==="objDesc")return t.raw();if(r==="printstr"){let n=t.raw().toString("ascii");return this._isPrintstr(n)?n:t.error("Decoding of string type: printstr unsupported characters")}else return/str$/.test(r)?t.raw().toString():t.error(`Decoding of string type: ${r} unsupported`)}};Be.prototype._decodeObjid=function(t,r,n){let i,s=[],o=0,c=0;for(;!t.isEmpty();)c=t.readUInt8(),o<<=7,o|=c&127,(c&128)===0&&(s.push(o),o=0);c&128&&s.push(o);let a=s[0]/40|0,l=s[0]%40;if(n?i=s:i=[a,l].concat(s.slice(1)),r){let f=r[i.join(" ")];f===void 0&&(f=r[i.join(".")]),f!==void 0&&(i=f)}return i};Be.prototype._decodeTime=function(t,r){let n=t.raw().toString(),i,s,o,c,a,l;if(r==="gentime")i=n.slice(0,4)|0,s=n.slice(4,6)|0,o=n.slice(6,8)|0,c=n.slice(8,10)|0,a=n.slice(10,12)|0,l=n.slice(12,14)|0;else if(r==="utctime")i=n.slice(0,2)|0,s=n.slice(2,4)|0,o=n.slice(4,6)|0,c=n.slice(6,8)|0,a=n.slice(8,10)|0,l=n.slice(10,12)|0,i<70?i=2e3+i:i=1900+i;else return t.error(`Decoding ${r} time is not supported yet`);return Date.UTC(i,s-1,o,c,a,l,0)};Be.prototype._decodeNull=function(){return null};Be.prototype._decodeBool=function(t){let r=t.readUInt8();return t.isError(r)?r:r!==0};Be.prototype._decodeInt=function(t,r){let n=t.raw(),i=BigInt(`0x${n.toString("hex")}`);return r&&(i=r[i.toString(10)]||i),i};Be.prototype._use=function(t,r){return typeof t=="function"&&(t=t(r)),t._getDecoder("der").tree};function ad(e,t){let r=e.readUInt8(t);if(e.isError(r))return r;let n=tx.tagClass[r>>6],i=(r&32)===0;if((r&31)===31){let o=r;for(r=0;(o&128)===128;){if(o=e.readUInt8(t),e.isError(o))return o;r<<=7,r|=o&127}}else r&=31;let s=tx.tag[r];return{cls:n,primitive:i,tag:r,tagStr:s}}function ix(e,t,r){let n=e.readUInt8(r);if(e.isError(n))return n;if(!t&&n===128)return null;if((n&128)===0)return n;let i=n&127;if(i>4)return e.error("length octect is too long");n=0;for(let s=0;s<i;s++){n<<=8;let o=e.readUInt8(r);if(e.isError(o))return o;n|=o}return n}sx.exports=nx});var cx=h((lX,ox)=>{var{inherits:$6}=g("util"),ld=ud();function fd(e){ld.call(this,e),this.enc="pem"}$6(fd,ld);fd.prototype.decode=function(t,r){let n=t.toString().split(/[\r\n]+/g),i=r.label.toUpperCase(),s=/^-----(BEGIN|END) ([^-]+)-----$/,o=-1,c=-1;for(let f=0;f<n.length;f++){let u=n[f].match(s);if(u!==null&&u[2]===i)if(o===-1){if(u[1]!=="BEGIN")break;o=f}else{if(u[1]!=="END")break;c=f;break}}if(o===-1||c===-1)throw new Error(`PEM section not found for: ${i}`);let a=n.slice(o+1,c).join("");a.replace(/[^a-z0-9+/=]+/gi,"");let l=Buffer.from(a,"base64");return ld.prototype.decode.call(this,l,r)};ox.exports=fd});var dd=h((fX,ax)=>{ax.exports={der:ud(),pem:cx()}});var lx=h((dX,ux)=>{var{inherits:U6}=g("util"),W6=cd(),H6=dd();ux.exports.define=function(t,r){return new qn(t,r)};function qn(e,t){this.name=e,this.body=t,this.decoders={},this.encoders={}}qn.prototype._createNamed=function(t){let r=this.name;function n(i){this._initNamed(i,r)}return U6(n,t),n.prototype._initNamed=function(s,o){t.call(this,s,o)},new n(this)};qn.prototype._getDecoder=function(t){return t=t||"der",Object.prototype.hasOwnProperty.call(this.decoders,t)||(this.decoders[t]=this._createNamed(H6[t])),this.decoders[t]};qn.prototype.decode=function(t,r,n){return this._getDecoder(r).decode(t,n)};qn.prototype._getEncoder=function(t){return t=t||"der",Object.prototype.hasOwnProperty.call(this.encoders,t)||(this.encoders[t]=this._createNamed(W6[t])),this.encoders[t]};qn.prototype.encode=function(t,r,n){return this._getEncoder(r).encode(t,n)}});var dx=h((hX,fx)=>{var{Reporter:F6}=ac(),{DecoderBuffer:G6,EncoderBuffer:z6}=lc(),Y6=fc();fx.exports={DecoderBuffer:G6,EncoderBuffer:z6,Node:Y6,Reporter:F6}});var px=h((pX,hx)=>{hx.exports={der:dc()}});var mx=h((yX,yx)=>{var{define:V6}=lx(),X6=dx(),Q6=px(),Z6=dd(),eJ=cd();yx.exports={base:X6,constants:Q6,decoders:Z6,define:V6,encoders:eJ}});var hd=h((mX,gx)=>{var{name:tJ}=Ir(),rJ={"1 2 840 10045 3 1 7":"P-256","1 3 132 0 10":tJ,"1 3 132 0 34":"P-384","1 3 132 0 35":"P-521","1 2 840 10045 2 1":"ecPublicKey","1 2 840 113549 1 1 1":"rsaEncryption","1 3 101 110":"X25519","1 3 101 111":"X448","1 3 101 112":"Ed25519","1 3 101 113":"Ed448"};gx.exports=rJ});var bx=h((gX,wx)=>{var _x=hd();wx.exports=function(){this.seq().obj(this.key("algorithm").objid(_x),this.key("parameters").optional().choice({namedCurve:this.objid(_x),null:this.null_()}))}});var vx=h((_X,Ex)=>{var nJ=hd();Ex.exports=function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").explicit(0).optional().choice({namedCurve:this.objid(nJ)}),this.key("publicKey").explicit(1).optional().bitstr())}});var xx=h((wX,Sx)=>{Sx.exports=e=>function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(e),this.key("privateKey").octstr())}});var Ax=h((bX,Tx)=>{Tx.exports=e=>function(){this.seq().obj(this.key("algorithm").use(e),this.key("publicKey").bitstr())}});var Ox=h((EX,qx)=>{qx.exports=function(){this.octstr().contains().obj(this.key("privateKey").octstr())}});var Cx=h((vX,kx)=>{kx.exports=(e,t)=>function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(e),this.key("privateKey").use(t))}});var Rx=h((SX,Px)=>{Px.exports=function(){this.seq().obj(this.key("version").int({0:"two-prime",1:"multi"}),this.key("n").int(),this.key("e").int(),this.key("d").int(),this.key("p").int(),this.key("q").int(),this.key("dp").int(),this.key("dq").int(),this.key("qi").int())}});var Ix=h((xX,Kx)=>{Kx.exports=function(){this.seq().obj(this.key("n").int(),this.key("e").int())}});var pd=h((TX,Nx)=>{var ir=mx(),jt=new Map,hc=ir.define("AlgorithmIdentifier",bx());jt.set("AlgorithmIdentifier",hc);var iJ=ir.define("ECPrivateKey",vx());jt.set("ECPrivateKey",iJ);var sJ=ir.define("PrivateKeyInfo",xx()(hc));jt.set("PrivateKeyInfo",sJ);var oJ=ir.define("PublicKeyInfo",Ax()(hc));jt.set("PublicKeyInfo",oJ);var Bx=ir.define("PrivateKey",Ox());jt.set("PrivateKey",Bx);var cJ=ir.define("OneAsymmetricKey",Cx()(hc,Bx));jt.set("OneAsymmetricKey",cJ);var aJ=ir.define("RSAPrivateKey",Rx());jt.set("RSAPrivateKey",aJ);var uJ=ir.define("RSAPublicKey",Ix());jt.set("RSAPublicKey",uJ);Nx.exports=jt});var le=h((qX,jx)=>{var{keyObjectSupported:lJ}=Ie(),St,sr,pc,xt,yd;if(lJ)({createPublicKey:St,createPrivateKey:sr,createSecretKey:pc,KeyObject:xt}=g("crypto")),yd=e=>e;else{let{EOL:e}=g("os"),t=$(),r=Ue(),n=pd(),i=Symbol("toInput"),s=Symbol("namedCurve");yd=(l,f)=>l instanceof xt?l[i](f):pc(l)[i](f);let o=l=>Buffer.from(l.replace(/(?:-----(?:BEGIN|END)(?: (?:RSA|EC))? (?:PRIVATE|PUBLIC) KEY-----|\s)/g,""),"base64"),c=(l,f)=>`-----BEGIN ${f}-----${e}${(l.toString("base64").match(/.{1,64}/g)||[]).join(e)}${e}-----END ${f}-----`,a=l=>{let f=typeof l=="string"?l:`OID ${l.join(".")}`;throw new t.JOSENotSupported(`${f} is not supported in your Node.js runtime version`)};xt=class{export({cipher:f,passphrase:u,type:d,format:p}={}){if(this._type==="secret")return this._buffer;if(this._type==="public"){if(this.asymmetricKeyType==="rsa")switch(d){case"pkcs1":return p==="pem"?this._pem:o(this._pem);case"spki":{let y=n.get("PublicKeyInfo").encode({algorithm:{algorithm:"rsaEncryption",parameters:{type:"null"}},publicKey:{unused:0,data:o(this._pem)}},"pem",{label:"PUBLIC KEY"});return p==="pem"?y:o(y)}default:throw new TypeError(`The value ${d} is invalid for option "type"`)}if(this.asymmetricKeyType==="ec"){if(d!=="spki")throw new TypeError(`The value ${d} is invalid for option "type"`);return p==="pem"?this._pem:o(this._pem)}}if(this._type==="private"){if(u!==void 0||f!==void 0)throw new t.JOSENotSupported("encrypted private keys are not supported in your Node.js runtime version");if(d==="pkcs8"){if(this._pkcs8)return p==="der"&&typeof this._pkcs8=="string"?o(this._pkcs8):p==="pem"&&Buffer.isBuffer(this._pkcs8)?c(this._pkcs8,"PRIVATE KEY"):this._pkcs8;if(this.asymmetricKeyType==="rsa"){let m=this._asn1,_=n.get("RSAPrivateKey").encode(m),w=n.get("PrivateKeyInfo").encode({version:0,privateKey:_,algorithm:{algorithm:"rsaEncryption",parameters:{type:"null"}}});return this._pkcs8=w,this.export({type:d,format:p})}if(this.asymmetricKeyType==="ec"){let m=this._asn1,_=n.get("ECPrivateKey").encode({version:m.version,privateKey:m.privateKey,publicKey:m.publicKey}),w=n.get("PrivateKeyInfo").encode({version:0,privateKey:_,algorithm:{algorithm:"ecPublicKey",parameters:this._asn1.parameters}});return this._pkcs8=w,this.export({type:d,format:p})}}if(this.asymmetricKeyType==="rsa"&&d==="pkcs1")return p==="pem"?this._pem:o(this._pem);if(this.asymmetricKeyType==="ec"&&d==="sec1")return p==="pem"?this._pem:o(this._pem);throw new TypeError(`The value ${d} is invalid for option "type"`)}}get type(){return this._type}get asymmetricKeyType(){return this._asymmetricKeyType}get symmetricKeySize(){return this._symmetricKeySize}[i](f){switch(this._type){case"secret":return this._buffer;case"public":return this._pem;default:return f?("_pub"in this||(this._pub=St(this)),this._pub[i](!1)):this._pem}}},pc=l=>{if(!Buffer.isBuffer(l)||!l.length)throw new TypeError("input must be a non-empty Buffer instance");let f=new xt;return f._buffer=Buffer.from(l),f._symmetricKeySize=l.length,f._type="secret",f},St=l=>{if(l instanceof xt){if(l.type!=="private")throw new TypeError(`Invalid key object type ${l.type}, expected private.`);switch(l.asymmetricKeyType){case"ec":{let _=n.get("PublicKeyInfo").encode({algorithm:{algorithm:"ecPublicKey",parameters:l._asn1.parameters},publicKey:l._asn1.publicKey});return St({key:_,format:"der",type:"spki"})}case"rsa":{let _=n.get("RSAPublicKey").encode(l._asn1);return St({key:_,format:"der",type:"pkcs1"})}}}if((typeof l=="string"||Buffer.isBuffer(l))&&(l={key:l,format:"pem"}),!r(l))throw new TypeError("input must be a string, Buffer or an object");let{format:f,passphrase:u}=l,{key:d,type:p}=l;if(typeof d!="string"&&!Buffer.isBuffer(d))throw new TypeError("key must be a string or Buffer");if(f!=="pem"&&f!=="der")throw new TypeError('format must be one of "pem" or "der"');let m;if(f==="pem")switch(d=d.toString(),d.split(/\r?\n/g)[0].toString()){case"-----BEGIN PUBLIC KEY-----":p="spki",m="PUBLIC KEY";break;case"-----BEGIN RSA PUBLIC KEY-----":p="pkcs1",m="RSA PUBLIC KEY";break;case"-----BEGIN CERTIFICATE-----":throw new t.JOSENotSupported("X.509 certificates are not supported in your Node.js runtime version");case"-----BEGIN PRIVATE KEY-----":case"-----BEGIN EC PRIVATE KEY-----":case"-----BEGIN RSA PRIVATE KEY-----":return St(sr(d));default:throw new TypeError("unknown/unsupported PEM type")}switch(p){case"spki":{let y=n.get("PublicKeyInfo"),_=y.decode(d,f,{label:m}),b,w;switch(_.algorithm.algorithm){case"ecPublicKey":{w=new xt,w._asn1=_,w._asymmetricKeyType="ec",w._type="public",w._pem=y.encode(_,"pem",{label:"PUBLIC KEY"});break}case"rsaEncryption":{b="pkcs1",w=St({type:b,key:_.publicKey.data,format:"der"});break}default:a(_.algorithm.algorithm)}return w}case"pkcs1":{let y=n.get("RSAPublicKey"),_=y.decode(d,f,{label:m});if(_.n===BigInt(0))return St(sr({key:d,format:f,type:p,passphrase:u}));let b=new xt;return b._asn1=_,b._asymmetricKeyType="rsa",b._type="public",b._pem=y.encode(_,"pem",{label:"RSA PUBLIC KEY"}),b}case"pkcs8":case"sec1":return St(sr({format:f,key:d,type:p,passphrase:u}));default:throw new TypeError(`The value ${p} is invalid for option "type"`)}},sr=(l,f)=>{if((typeof l=="string"||Buffer.isBuffer(l))&&(l={key:l,format:"pem"}),!r(l))throw new TypeError("input must be a string, Buffer or an object");let{format:u,passphrase:d}=l,{key:p,type:m}=l;if(typeof p!="string"&&!Buffer.isBuffer(p))throw new TypeError("key must be a string or Buffer");if(d!==void 0)throw new t.JOSENotSupported("encrypted private keys are not supported in your Node.js runtime version");if(u!=="pem"&&u!=="der")throw new TypeError('format must be one of "pem" or "der"');let y;if(u==="pem")switch(p=p.toString(),p.split(/\r?\n/g)[0].toString()){case"-----BEGIN PRIVATE KEY-----":m="pkcs8",y="PRIVATE KEY";break;case"-----BEGIN EC PRIVATE KEY-----":m="sec1",y="EC PRIVATE KEY";break;case"-----BEGIN RSA PRIVATE KEY-----":m="pkcs1",y="RSA PRIVATE KEY";break;default:throw new TypeError("unknown/unsupported PEM type")}switch(m){case"pkcs8":{let b=n.get("PrivateKeyInfo").decode(p,u,{label:y}),w,v;switch(b.algorithm.algorithm){case"ecPublicKey":{w="sec1",v=sr({type:w,key:b.privateKey,format:"der"},{[s]:b.algorithm.parameters.value});break}case"rsaEncryption":{w="pkcs1",v=sr({type:w,key:b.privateKey,format:"der"});break}default:a(b.algorithm.algorithm)}return v._pkcs8=p,v}case"pkcs1":{let _=n.get("RSAPrivateKey"),b=_.decode(p,u,{label:y}),w=new xt;return w._asn1=b,w._asymmetricKeyType="rsa",w._type="private",w._pem=_.encode(b,"pem",{label:"RSA PRIVATE KEY"}),w}case"sec1":{let _=n.get("ECPrivateKey"),b=_.decode(p,u,{label:y});if(!("parameters"in b)&&!f[s])throw new Error("invalid sec1");"parameters"in b||(b={...b,parameters:{type:"namedCurve",value:f[s]}});let w=new xt;return w._asn1=b,w._asymmetricKeyType="ec",w._type="private",w._pem=_.encode(b,"pem",{label:"EC PRIVATE KEY"}),w}default:throw new TypeError(`The value ${m} is invalid for option "type"`)}}}jx.exports={createPublicKey:St,createPrivateKey:sr,createSecretKey:pc,KeyObject:xt,asInput:yd}});var Dx=h((OX,Mx)=>{var{randomBytes:fJ}=g("crypto"),yc=ve(),md=$(),On=BigInt(0),pe=BigInt(1),Li=BigInt(2),Ji=e=>{let t=e.toString(16);return yc.encodeBuffer(Buffer.from(t.length%2?`0${t}`:t,"hex"))},mc=e=>BigInt(`0x${e.toString("hex")}`),dJ=e=>e.toString(2).length,hJ=(e,t)=>{let r=On,n=pe,i=pe,s=On;for(;e!==On;){let o=t/e,c=t%e,a=r-i*o,l=n-s*o;t=e,e=c,r=i,n=s,i=a,s=l}return r},pJ=(e,t)=>{let r=On;for(;!((e|t)&pe);)e>>=pe,t>>=pe,r++;for(;!(e&pe);)e>>=pe;do{for(;!(t&pe);)t>>=pe;if(e>t){let n=e;e=t,t=n}t-=e}while(t);return e<<r},yJ=(e,t,r)=>{e=gd(e,r);let n=pe,i=e;for(;t>0;){var s=t%Li;t=t/Li,s===pe&&(n=n*i,n=n%r),i=i*i,i=i%r}return n},mJ=(e,t)=>{let r=t-e,n=dJ(r),i;do i=mc(gJ(n));while(i>r);return i+e},gJ=e=>{let t=Math.ceil(e/8),r=fJ(t);return r[0]=r[0]&2**(e%8)-1,r},gd=(e,t)=>(e=e%t,e<0?e+t:e),_J=e=>{let t=e;for(;t%Li===On;)t=t/Li;return t},wJ=30,bJ=22,EJ=(e,t,r)=>{let n=_J(e*t-pe),i=0,s;do{if(i++,i===wJ)throw new md.JWKImportFailed("failed to calculate missing primes");let a=0,l=yJ(mJ(Li,r),n,r),f=On;for(;l!==pe;){if(a++,a===bJ)throw new md.JWKImportFailed("failed to calculate missing primes");f=l,l=l*l%r}f!==r-pe&&(s=f)}while(!s);let o=pJ(s-pe,r),c=r/o;return o>c?{p:o,q:c}:{p:c,q:o}};Mx.exports=e=>{let t=mc(yc.decodeToBuffer(e.e)),r=mc(yc.decodeToBuffer(e.d)),n=mc(yc.decodeToBuffer(e.n));if(r>=n)throw new md.JWKInvalid("invalid RSA private exponent");let{p:i,q:s}=EJ(t,r,n),o=r%(i-pe),c=r%(s-pe),a=gd(hJ(gd(s,i),i),i);return{...e,p:Ji(i),q:Ji(s),dp:Ji(o),dq:Ji(c),qi:Ji(a)}}});var Ed=h((kX,bd)=>{var{EOL:_d}=g("os"),or=$(),{keyObjectSupported:vJ}=Ie(),{createPublicKey:$x}=le(),N=ve(),xe=pd(),SJ=Dx(),{OKP_CURVES:xJ,EC_CURVES:TJ}=vt(),AJ=(e,t)=>`-----BEGIN ${t} KEY-----${_d}${(e.match(/.{1,64}/g)||[]).join(_d)}${_d}-----END ${t} KEY-----`,Mt={private(e,t){let r=t.export({type:"pkcs8",format:"der"}),n=xe.get("OneAsymmetricKey"),{privateKey:{privateKey:i}}=n.decode(r);return{...Mt.public(e,$x(t)),d:N.encodeBuffer(i)}},public(e,t){let r=t.export({type:"spki",format:"der"}),n=xe.get("PublicKeyInfo"),{publicKey:{data:i}}=n.decode(r);return{kty:"OKP",crv:e,x:N.encodeBuffer(i)}}},wd={rsa:{private(e){let t=e.export({type:"pkcs8",format:"der"}),r=xe.get("PrivateKeyInfo"),n=xe.get("RSAPrivateKey"),{privateKey:i}=r.decode(t),{version:s,n:o,e:c,d:a,p:l,q:f,dp:u,dq:d,qi:p}=n.decode(i);if(s!=="two-prime")throw new or.JOSENotSupported("Private RSA keys with more than two primes are not supported");return{kty:"RSA",n:N.encodeBigInt(o),e:N.encodeBigInt(c),d:N.encodeBigInt(a),p:N.encodeBigInt(l),q:N.encodeBigInt(f),dp:N.encodeBigInt(u),dq:N.encodeBigInt(d),qi:N.encodeBigInt(p)}},public(e){let t=e.export({type:"spki",format:"der"}),r=xe.get("PublicKeyInfo"),n=xe.get("RSAPublicKey"),{publicKey:{data:i}}=r.decode(t),{n:s,e:o}=n.decode(i);return{kty:"RSA",n:N.encodeBigInt(s),e:N.encodeBigInt(o)}}},ec:{private(e){let t=e.export({type:"pkcs8",format:"der"}),r=xe.get("PrivateKeyInfo"),n=xe.get("ECPrivateKey"),{privateKey:i,algorithm:{parameters:{value:s}}}=r.decode(t),{privateKey:o,publicKey:c}=n.decode(i);if(typeof c>"u"){if(vJ)return{...wd.ec.public($x(e)),d:N.encodeBuffer(o)};throw new or.JOSENotSupported("Private EC keys without the public key embedded are not supported in your Node.js runtime version")}let a=c.data.slice(1,(c.data.length-1)/2+1),l=c.data.slice((c.data.length-1)/2+1);return{kty:"EC",crv:s,d:N.encodeBuffer(o),x:N.encodeBuffer(a),y:N.encodeBuffer(l)}},public(e){let t=e.export({type:"spki",format:"der"}),r=xe.get("PublicKeyInfo"),{publicKey:{data:n},algorithm:{parameters:{value:i}}}=r.decode(t),s=n.slice(1,(n.length-1)/2+1),o=n.slice((n.length-1)/2+1);return{kty:"EC",crv:i,x:N.encodeBuffer(s),y:N.encodeBuffer(o)}}},ed25519:{private(e){return Mt.private("Ed25519",e)},public(e){return Mt.public("Ed25519",e)}},ed448:{private(e){return Mt.private("Ed448",e)},public(e){return Mt.public("Ed448",e)}},x25519:{private(e){return Mt.private("X25519",e)},public(e){return Mt.public("X25519",e)}},x448:{private(e){return Mt.private("X448",e)},public(e){return Mt.public("X448",e)}}};bd.exports.keyObjectToJWK=e=>e.type==="private"?wd[e.asymmetricKeyType].private(e):wd[e.asymmetricKeyType].public(e);var Jx=(e,t)=>({unused:0,data:Buffer.concat([Buffer.alloc(1,4),N.decodeToBuffer(e),N.decodeToBuffer(t)])}),Lx={RSA:{private(e,{calculateMissingRSAPrimes:t}){let r=xe.get("RSAPrivateKey");if("oth"in e)throw new or.JOSENotSupported("Private RSA keys with more than two primes are not supported");if(e.p||e.q||e.dp||e.dq||e.qi){if(!(e.p&&e.q&&e.dp&&e.dq&&e.qi))throw new or.JWKInvalid("all other private key parameters must be present when any one of them is present")}else if(t)e=SJ(e);else if(!t)throw new or.JOSENotSupported("importing private RSA keys without all other private key parameters is not enabled, see documentation and its advisory on how and when its ok to enable it");return r.encode({version:0,n:BigInt(`0x${N.decodeToBuffer(e.n).toString("hex")}`),e:BigInt(`0x${N.decodeToBuffer(e.e).toString("hex")}`),d:BigInt(`0x${N.decodeToBuffer(e.d).toString("hex")}`),p:BigInt(`0x${N.decodeToBuffer(e.p).toString("hex")}`),q:BigInt(`0x${N.decodeToBuffer(e.q).toString("hex")}`),dp:BigInt(`0x${N.decodeToBuffer(e.dp).toString("hex")}`),dq:BigInt(`0x${N.decodeToBuffer(e.dq).toString("hex")}`),qi:BigInt(`0x${N.decodeToBuffer(e.qi).toString("hex")}`)},"pem",{label:"RSA PRIVATE KEY"})},public(e){return xe.get("RSAPublicKey").encode({version:0,n:BigInt(`0x${N.decodeToBuffer(e.n).toString("hex")}`),e:BigInt(`0x${N.decodeToBuffer(e.e).toString("hex")}`)},"pem",{label:"RSA PUBLIC KEY"})}},EC:{private(e){return xe.get("ECPrivateKey").encode({version:1,privateKey:N.decodeToBuffer(e.d),parameters:{type:"namedCurve",value:e.crv},publicKey:Jx(e.x,e.y)},"pem",{label:"EC PRIVATE KEY"})},public(e){return xe.get("PublicKeyInfo").encode({algorithm:{algorithm:"ecPublicKey",parameters:{type:"namedCurve",value:e.crv}},publicKey:Jx(e.x,e.y)},"pem",{label:"PUBLIC KEY"})}},OKP:{private(e){let r=xe.get("OneAsymmetricKey").encode({version:0,privateKey:{privateKey:N.decodeToBuffer(e.d)},algorithm:{algorithm:e.crv}},"der");return r.write("04",12,1,"hex"),AJ(r.toString("base64"),"PRIVATE")},public(e){return xe.get("PublicKeyInfo").encode({algorithm:{algorithm:e.crv},publicKey:{unused:0,data:N.decodeToBuffer(e.x)}},"pem",{label:"PUBLIC KEY"})}}};bd.exports.jwkToPem=(e,{calculateMissingRSAPrimes:t=!1}={})=>{switch(e.kty){case"EC":if(!TJ.has(e.crv))throw new or.JOSENotSupported(`unsupported EC key curve: ${e.crv}`);break;case"OKP":if(!xJ.has(e.crv))throw new or.JOSENotSupported(`unsupported OKP key curve: ${e.crv}`);break;case"RSA":break;default:throw new or.JOSENotSupported(`unsupported key type: ${e.kty}`)}return e.d?Lx[e.kty].private(e,{calculateMissingRSAPrimes:t}):Lx[e.kty].public(e)}});var Fx=h((CX,gc)=>{var{createHash:Ux}=g("crypto"),Wx=ve(),Hx=(e,t)=>Wx.encodeBuffer(Ux(e).update(Buffer.from(t,"base64")).digest());gc.exports.kid=e=>Wx.encodeBuffer(Ux("sha256").update(JSON.stringify(e)).digest());gc.exports.x5t=Hx.bind(void 0,"sha1");gc.exports["x5t#S256"]=Hx.bind(void 0,"sha256")});var Tt=h((PX,Qx)=>{var{strict:qJ}=g("assert"),{inspect:Gx}=g("util"),{EOL:vd}=g("os"),{keyObjectSupported:zx}=Ie(),{createPublicKey:Sd}=le(),{keyObjectToJWK:OJ}=Ed(),{THUMBPRINT_MATERIAL:Yx,PUBLIC_MEMBERS:$i,PRIVATE_MEMBERS:xd,JWK_MEMBERS:kJ,KEYOBJECT:Ui,USES_MAPPING:Vx,OPS:CJ,USES:PJ}=Q(),RJ=Ue(),Td=Fx(),_c=$(),Xx=Symbol("privateApi"),{JWK:KJ}=vt(),Ad=class{constructor(t,{alg:r,use:n,kid:i,key_ops:s,x5c:o,x5t:c,"x5t#S256":a}={}){if(n!==void 0&&(typeof n!="string"||!PJ.has(n)))throw new TypeError('`use` must be either "sig" or "enc" string when provided');if(r!==void 0&&(typeof r!="string"||!r))throw new TypeError("`alg` must be a non-empty string when provided");if(i!==void 0&&(typeof i!="string"||!i))throw new TypeError("`kid` must be a non-empty string when provided");if(s!==void 0){if(!Array.isArray(s)||!s.length||s.some(l=>typeof l!="string"))throw new TypeError("`key_ops` must be a non-empty array of strings when provided");s=Array.from(new Set(s)).filter(l=>CJ.has(l))}if(s&&n&&(n==="enc"&&s.some(l=>Vx.sig.has(l))||n==="sig"&&s.some(l=>Vx.enc.has(l))))throw new _c.JWKInvalid('inconsistent JWK "use" and "key_ops"');if(zx&&o!==void 0){if(!Array.isArray(o)||!o.length||o.some(l=>typeof l!="string"))throw new TypeError("`x5c` must be an array of one or more PKIX certificates when provided");o.forEach((l,f)=>{let u;try{u=Sd({key:`-----BEGIN CERTIFICATE-----${vd}${(l.match(/.{1,64}/g)||[]).join(vd)}${vd}-----END CERTIFICATE-----`,format:"pem"})}catch{throw new _c.JWKInvalid(`\`x5c\` member at index ${f} is not a valid base64-encoded DER PKIX certificate`)}if(f===0)try{qJ.deepEqual(u.export({type:"spki",format:"der"}),(t.type==="public"?t:Sd(t)).export({type:"spki",format:"der"}))}catch{throw new _c.JWKInvalid("The key in the first `x5c` certificate MUST match the public key represented by the JWK")}})}Object.defineProperties(this,{[Ui]:{value:RJ(t)?void 0:t},keyObject:{get(){if(!zx)throw new _c.JOSENotSupported("KeyObject class is not supported in your Node.js runtime version");return this[Ui]}},type:{value:t.type},private:{value:t.type==="private"},public:{value:t.type==="public"},secret:{value:t.type==="secret"},alg:{value:r,enumerable:r!==void 0},use:{value:n,enumerable:n!==void 0},x5c:{enumerable:o!==void 0,...o?{get(){return[...o]}}:{value:void 0}},key_ops:{enumerable:s!==void 0,...s?{get(){return[...s]}}:{value:void 0}},kid:{enumerable:!0,...i?{value:i}:{get(){return Object.defineProperty(this,"kid",{value:this.thumbprint,configurable:!1}),this.kid},configurable:!0}},...o?{x5t:{enumerable:!0,...c?{value:c}:{get(){return Object.defineProperty(this,"x5t",{value:Td.x5t(this.x5c[0]),configurable:!1}),this.x5t},configurable:!0}}}:void 0,...o?{"x5t#S256":{enumerable:!0,...a?{value:a}:{get(){return Object.defineProperty(this,"x5t#S256",{value:Td["x5t#S256"](this.x5c[0]),configurable:!1}),this["x5t#S256"]},configurable:!0}}}:void 0,thumbprint:{get(){return Object.defineProperty(this,"thumbprint",{value:Td.kid(this[Yx]()),configurable:!1}),this.thumbprint},configurable:!0}})}toPEM(t=!1,r={}){if(this.secret)throw new TypeError("symmetric keys cannot be exported as PEM");if(t&&this.public===!0)throw new TypeError("public key cannot be exported as private");let{type:n=t?"pkcs8":"spki",cipher:i,passphrase:s}=r,o=this[Ui];if(!t&&(this.private&&(o=Sd(o)),i||s))throw new TypeError("cipher and passphrase can only be applied when exporting private keys");return t?o.export({format:"pem",type:n,cipher:i,passphrase:s}):o.export({format:"pem",type:n})}toJWK(t=!1){if(t&&this.public===!0)throw new TypeError("public key cannot be exported as private");let r=[...this.constructor[t?xd:$i]].map(i=>[i,this[i]]),n={};return Object.keys(r).forEach(i=>{let[s,o]=r[i];n[s]=o}),n.kty=this.kty,n.kid=this.kid,this.alg&&(n.alg=this.alg),this.key_ops&&this.key_ops.length&&(n.key_ops=this.key_ops),this.use&&(n.use=this.use),this.x5c&&(n.x5c=this.x5c),this.x5t&&(n.x5t=this.x5t),this["x5t#S256"]&&(n["x5t#S256"]=this["x5t#S256"]),n}[kJ](){let t=this[Ui].type==="private"?this.constructor[xd]:this.constructor[$i];Object.defineProperties(this,[...t].reduce((r,n)=>(r[n]={get(){let i=OJ(this[Ui]);return Object.defineProperties(this,Object.entries(i).filter(([s])=>t.has(s)).reduce((s,[o,c])=>(s[o]={value:c,enumerable:this.constructor[$i].has(o),configurable:!1},s),{})),this[n]},enumerable:this.constructor[$i].has(n),configurable:!0},r),{}))}[Gx.custom](){return`${this.constructor.name} ${Gx(this.toJWK(!1),{depth:1/0,colors:process.stdout.isTTY,compact:!1,sorted:!0})}`}[Yx](){throw new Error(`"[THUMBPRINT_MATERIAL]()" is not implemented on ${this.constructor.name}`)}algorithms(t,r,n){let{use:i=this.use,alg:s=this.alg,key_ops:o=this.key_ops}=r===Xx?n:{};if(s)return new Set(this.algorithms(t,Xx,{alg:null,use:i,key_ops:o}).has(s)?[s]:void 0);if(typeof t=="symbol")try{return this[t]()}catch{return new Set}if(t&&o&&!o.includes(t))return new Set;switch(t){case"decrypt":case"deriveKey":case"encrypt":case"sign":case"unwrapKey":case"verify":case"wrapKey":return new Set(Object.entries(KJ[this.kty][t]).map(([c,a])=>a(this)?c:void 0).filter(Boolean));case void 0:return new Set([...this.algorithms("sign"),...this.algorithms("verify"),...this.algorithms("decrypt"),...this.algorithms("encrypt"),...this.algorithms("unwrapKey"),...this.algorithms("wrapKey"),...this.algorithms("deriveKey")]);default:throw new TypeError("invalid key operation")}}static async generate(){throw new Error(`"static async generate()" is not implemented on ${this.name}`)}static generateSync(){throw new Error(`"static generateSync()" is not implemented on ${this.name}`)}static get[$i](){throw new Error(`"static get [PUBLIC_MEMBERS]()" is not implemented on ${this.name}`)}static get[xd](){throw new Error(`"static get [PRIVATE_MEMBERS]()" is not implemented on ${this.name}`)}};Qx.exports=Ad});var kd=h((RX,sT)=>{var{generateKeyPairSync:Zx,generateKeyPair:IJ}=g("crypto"),{promisify:BJ}=g("util"),{THUMBPRINT_MATERIAL:NJ,JWK_MEMBERS:jJ,PUBLIC_MEMBERS:MJ,PRIVATE_MEMBERS:DJ,KEY_MANAGEMENT_DECRYPT:JJ,KEY_MANAGEMENT_ENCRYPT:LJ}=Q(),{keyObjectSupported:eT}=Ie(),{createPublicKey:tT,createPrivateKey:rT}=le(),$J=Tt(),nT=BJ(IJ),Od=new Set(["e","n"]);Object.freeze(Od);var iT=new Set([...Od,"d","p","q","dp","dq","qi"]);Object.freeze(iT);var qd=class extends $J{constructor(...t){super(...t),this[jJ](),Object.defineProperties(this,{kty:{value:"RSA",enumerable:!0},length:{get(){return Object.defineProperty(this,"length",{value:Buffer.byteLength(this.n,"base64")*8,configurable:!1}),this.length},configurable:!0}})}static get[MJ](){return Od}static get[DJ](){return iT}[NJ](){return{e:this.e,kty:"RSA",n:this.n}}[LJ](){return this.algorithms("wrapKey")}[JJ](){return this.algorithms("unwrapKey")}static async generate(t=2048,r=!0){if(!Number.isSafeInteger(t)||t<512||t%8!==0||"electron"in process.versions&&t%128!==0)throw new TypeError("invalid bit length");let n,i;return eT?({privateKey:n,publicKey:i}=await nT("rsa",{modulusLength:t}),r?n:i):({privateKey:n,publicKey:i}=await nT("rsa",{modulusLength:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}}),r?rT(n):tT(i))}static generateSync(t=2048,r=!0){if(!Number.isSafeInteger(t)||t<512||t%8!==0||"electron"in process.versions&&t%128!==0)throw new TypeError("invalid bit length");let n,i;return eT?({privateKey:n,publicKey:i}=Zx("rsa",{modulusLength:t}),r?n:i):({privateKey:n,publicKey:i}=Zx("rsa",{modulusLength:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}}),r?rT(n):tT(i))}};sT.exports=qd});var Id=h((KX,hT)=>{var{generateKeyPairSync:oT,generateKeyPair:UJ}=g("crypto"),{promisify:WJ}=g("util"),{THUMBPRINT_MATERIAL:HJ,JWK_MEMBERS:FJ,PUBLIC_MEMBERS:GJ,PRIVATE_MEMBERS:zJ,KEY_MANAGEMENT_DECRYPT:YJ,KEY_MANAGEMENT_ENCRYPT:VJ}=Q(),{EC_CURVES:Cd}=vt(),{keyObjectSupported:cT}=Ie(),{createPublicKey:aT,createPrivateKey:uT}=le(),Pd=$(),{name:lT}=Ir(),XJ=Tt(),fT=WJ(UJ),Kd=new Set(["crv","x","y"]);Object.freeze(Kd);var dT=new Set([...Kd,"d"]);Object.freeze(dT);var Rd=class extends XJ{constructor(...t){if(super(...t),this[FJ](),Object.defineProperty(this,"kty",{value:"EC",enumerable:!0}),!Cd.has(this.crv))throw new Pd.JOSENotSupported("unsupported EC key curve")}static get[GJ](){return Kd}static get[zJ](){return dT}[HJ](){return{crv:this.crv,kty:"EC",x:this.x,y:this.y}}[VJ](){return this.algorithms("deriveKey")}[YJ](){return this.public?new Set:this.algorithms("deriveKey")}static async generate(t="P-256",r=!0){if(!Cd.has(t))throw new Pd.JOSENotSupported(`unsupported EC key curve: ${t}`);t===lT&&t!=="secp256k1"&&(t="secp256k1");let n,i;return cT?({privateKey:n,publicKey:i}=await fT("ec",{namedCurve:t}),r?n:i):({privateKey:n,publicKey:i}=await fT("ec",{namedCurve:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}}),r?uT(n):aT(i))}static generateSync(t="P-256",r=!0){if(!Cd.has(t))throw new Pd.JOSENotSupported(`unsupported EC key curve: ${t}`);t===lT&&t!=="secp256k1"&&(t="secp256k1");let n,i;return cT?({privateKey:n,publicKey:i}=oT("ec",{namedCurve:t}),r?n:i):({privateKey:n,publicKey:i}=oT("ec",{namedCurve:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}}),r?uT(n):aT(i))}};hT.exports=Rd});var Md=h((IX,mT)=>{var{generateKeyPairSync:QJ,generateKeyPair:ZJ}=g("crypto"),{promisify:eL}=g("util"),{THUMBPRINT_MATERIAL:tL,JWK_MEMBERS:rL,PUBLIC_MEMBERS:nL,PRIVATE_MEMBERS:iL,KEY_MANAGEMENT_DECRYPT:sL,KEY_MANAGEMENT_ENCRYPT:oL}=Q(),{OKP_CURVES:Bd}=vt(),{edDSASupported:pT}=Ie(),Wi=$(),cL=Tt(),aL=eL(ZJ),jd=new Set(["crv","x"]);Object.freeze(jd);var yT=new Set([...jd,"d"]);Object.freeze(yT);var Nd=class extends cL{constructor(...t){if(super(...t),this[rL](),Object.defineProperty(this,"kty",{value:"OKP",enumerable:!0}),!Bd.has(this.crv))throw new Wi.JOSENotSupported("unsupported OKP key curve")}static get[nL](){return jd}static get[iL](){return yT}[tL](){return{crv:this.crv,kty:"OKP",x:this.x}}[oL](){return this.algorithms("deriveKey")}[sL](){return this.public?new Set:this.algorithms("deriveKey")}static async generate(t="Ed25519",r=!0){if(!pT)throw new Wi.JOSENotSupported("OKP keys are not supported in your Node.js runtime version");if(!Bd.has(t))throw new Wi.JOSENotSupported(`unsupported OKP key curve: ${t}`);let{privateKey:n,publicKey:i}=await aL(t.toLowerCase());return r?n:i}static generateSync(t="Ed25519",r=!0){if(!pT)throw new Wi.JOSENotSupported("OKP keys are not supported in your Node.js runtime version");if(!Bd.has(t))throw new Wi.JOSENotSupported(`unsupported OKP key curve: ${t}`);let{privateKey:n,publicKey:i}=QJ(t.toLowerCase());return r?n:i}};mT.exports=Nd});var wc=h((BX,ET)=>{var{randomBytes:uL}=g("crypto"),{createSecretKey:lL}=le(),fL=ve(),{THUMBPRINT_MATERIAL:dL,PUBLIC_MEMBERS:hL,PRIVATE_MEMBERS:pL,KEY_MANAGEMENT_DECRYPT:yL,KEY_MANAGEMENT_ENCRYPT:gT,KEYOBJECT:kn}=Q(),_T=Tt(),wT=new Set;Object.freeze(wT);var bT=new Set(["k"]);Object.freeze(bT);var Dd=class extends _T{constructor(...t){super(...t),Object.defineProperties(this,{kty:{value:"oct",enumerable:!0},length:{value:this[kn]?this[kn].symmetricKeySize*8:void 0},k:{enumerable:!1,get(){return this[kn]?Object.defineProperty(this,"k",{value:fL.encodeBuffer(this[kn].export()),configurable:!1}):Object.defineProperty(this,"k",{value:void 0,configurable:!1}),this.k},configurable:!0}})}static get[hL](){return wT}static get[pL](){return bT}[dL](){if(!this[kn])throw new TypeError('reference "oct" keys without "k" cannot have their thumbprint calculated');return{k:this.k,kty:"oct"}}[gT](){return new Set([...this.algorithms("wrapKey"),...this.algorithms("deriveKey")])}[yL](){return this[gT]()}algorithms(...t){return this[kn]?_T.prototype.algorithms.call(this,...t):new Set}static async generate(...t){return this.generateSync(...t)}static generateSync(t=256,r=!0){if(!r)throw new TypeError('"oct" keys cannot be generated as public');if(!Number.isSafeInteger(t)||!t||t%8!==0)throw new TypeError("invalid bit length");return lL(uL(t/8))}};ET.exports=Dd});var Cn=h((NX,TT)=>{var{deprecate:mL}=g("util"),{createPublicKey:vT,createPrivateKey:ST,createSecretKey:xT,KeyObject:gL}=le(),_L=ve(),wL=Ue(),{jwkToPem:bL}=Ed(),Hi=$(),EL=kd(),vL=Id(),SL=Md(),xL=wc(),TL=new Set(["string","buffer","object"]),Jd=(e={},t={})=>({alg:t.alg,key_ops:t.key_ops,kid:t.kid,use:t.use,x5c:t.x5c,x5t:t.x5t,"x5t#S256":t["x5t#S256"],...e}),AL=/^[a-zA-Z0-9-]+ AAAA(?:[0-9A-Za-z+/])+(?:==|=)?(?: .*)?$/,Ld=(e,t,{calculateMissingRSAPrimes:r=!1}={})=>{let n,i,s;if(!TL.has(typeof e))throw new TypeError("key argument must be a string, buffer or an object");if(t!==void 0&&!wL(t))throw new TypeError("parameters argument must be a plain object when provided");if(e instanceof gL)switch(e.type){case"private":n=e;break;case"public":i=e;break;case"secret":s=e;break}else if(typeof e=="object"&&e&&"kty"in e&&e.kty==="oct"){try{s=xT(_L.decodeToBuffer(e.k))}catch{"k"in e||(s={type:"secret"})}t=Jd(t,e)}else if(typeof e=="object"&&e&&"kty"in e){({calculateMissingRSAPrimes:r=!1}=t||{calculateMissingRSAPrimes:r});let c;try{c=bL(e,{calculateMissingRSAPrimes:r})}catch(a){if(a instanceof Hi.JOSEError)throw a}c&&e.d?n=ST(c):c&&(i=vT(c)),t=Jd({},e)}else if(e&&(typeof e=="object"||typeof e=="string")){try{n=ST(e)}catch(c){if(c instanceof Hi.JOSEError)throw c}try{i=vT(e),e.startsWith("-----BEGIN CERTIFICATE-----")&&(!t||!("x5c"in t))&&(t=Jd(t,{x5c:[e.replace(/(?:-----(?:BEGIN|END) CERTIFICATE-----|\s)/g,"")]}))}catch(c){if(c instanceof Hi.JOSEError)throw c}try{!e.includes("-----BEGIN")&&!AL.test(e.toString("ascii").replace(/[\r\n]/g,""))&&(s=xT(Buffer.isBuffer(e)?e:Buffer.from(e)))}catch{}}let o=n||i||s;if(n||i)switch(o.asymmetricKeyType){case"rsa":return new EL(o,t);case"ec":return new vL(o,t);case"ed25519":case"ed448":case"x25519":case"x448":return new SL(o,t);default:throw new Hi.JOSENotSupported("only RSA, EC and OKP asymmetric keys are supported")}else if(s)return new xL(o,t);throw new Hi.JWKImportFailed("key import failed")};TT.exports=Ld;Object.defineProperty(Ld,"deprecated",{value:mL((e,t)=>Ld(e,t,{calculateMissingRSAPrimes:!0}),"JWK.importKey() is deprecated, use JWK.asKey() instead"),enumerable:!1})});var Fi=h((jX,$d)=>{var AT=$(),cr=Cn(),qT=kd(),OT=Id(),kT=Md(),CT=wc(),qL=async(e,t,r,n=!0)=>{switch(e){case"RSA":return cr(await qT.generate(t,n),r);case"EC":return cr(await OT.generate(t,n),r);case"OKP":return cr(await kT.generate(t,n),r);case"oct":return cr(await CT.generate(t,n),r);default:throw new AT.JOSENotSupported(`unsupported key type: ${e}`)}},OL=(e,t,r,n=!0)=>{switch(e){case"RSA":return cr(qT.generateSync(t,n),r);case"EC":return cr(OT.generateSync(t,n),r);case"OKP":return cr(kT.generateSync(t,n),r);case"oct":return cr(CT.generateSync(t,n),r);default:throw new AT.JOSENotSupported(`unsupported key type: ${e}`)}};$d.exports.generate=qL;$d.exports.generateSync=OL});var RT=h((MX,PT)=>{var{inspect:kL}=g("util"),CL=Tt(),Ud=class extends CL{constructor(){super({type:"unsecured"},{alg:"none"}),Object.defineProperties(this,{kid:{value:void 0},kty:{value:void 0},thumbprint:{value:void 0},toJWK:{value:void 0},toPEM:{value:void 0}})}[kL.custom](){return"None {}"}algorithms(t){switch(t){case"sign":case"verify":case void 0:return new Set(["none"]);default:return new Set}}};PT.exports=new Ud});var IT=h((DX,KT)=>{var{inspect:PL}=g("util"),RL=Tt(),Wd=class extends RL{constructor(){super({type:"embedded"}),Object.defineProperties(this,{kid:{value:void 0},kty:{value:void 0},thumbprint:{value:void 0},toJWK:{value:void 0},toPEM:{value:void 0}})}[PL.custom](){return"Embedded.JWK {}"}algorithms(){return new Set}};KT.exports=new Wd});var NT=h((JX,BT)=>{var{inspect:KL}=g("util"),IL=Tt(),Hd=class extends IL{constructor(){super({type:"embedded"}),Object.defineProperties(this,{kid:{value:void 0},kty:{value:void 0},thumbprint:{value:void 0},toJWK:{value:void 0},toPEM:{value:void 0}})}[KL.custom](){return"Embedded.X5C {}"}algorithms(){return new Set}};BT.exports=new Hd});var Gi=h((LX,Fd)=>{var BL=Tt(),NL=RT(),jL=IT(),ML=NT(),jT=Cn(),DL=Fi();Fd.exports={...DL,asKey:jT,isKey:e=>e instanceof BL,None:NL,EmbeddedJWK:jL,EmbeddedX5C:ML};Object.defineProperty(Fd.exports,"importKey",{value:jT.deprecated,enumerable:!1})});var zd=h(($X,$T)=>{var{deprecate:JL,inspect:MT}=g("util"),DT=Ue(),{generate:LL,generateSync:$L}=Fi(),{USES_MAPPING:UL}=Q(),{isKey:Gd,asKey:WL}=Gi(),JT=(e,{alg:t,use:r,ops:n})=>{let i=0;return t&&e.alg&&i++,r&&e.use&&i++,n&&e.key_ops&&i++,i},zi=class{constructor(...t){for(;t.some(Array.isArray);)t=t.flat?t.flat():t.reduce((r,n)=>Array.isArray(n)?[...r,...n]:(r.push(n),r),[]);if(t.some(r=>!Gd(r)||!r.kty))throw new TypeError("all keys must be instances of a key instantiated by JWK.asKey");this._keys=new Set(t)}all({alg:t,kid:r,thumbprint:n,use:i,kty:s,key_ops:o,x5t:c,"x5t#S256":a,crv:l}={}){if(o!==void 0&&(!Array.isArray(o)||!o.length||o.some(u=>typeof u!="string")))throw new TypeError("`key_ops` must be a non-empty array of strings");let f={alg:t,use:i,ops:o};return[...this._keys].filter(u=>{let d=!0;if(d&&r!==void 0&&u.kid!==r&&(d=!1),d&&n!==void 0&&u.thumbprint!==n&&(d=!1),d&&c!==void 0&&u.x5t!==c&&(d=!1),d&&a!==void 0&&u["x5t#S256"]!==a&&(d=!1),d&&s!==void 0&&u.kty!==s&&(d=!1),d&&l!==void 0&&u.crv!==l&&(d=!1),t!==void 0&&!u.algorithms().has(t)&&(d=!1),d&&i!==void 0&&u.use!==void 0&&u.use!==i&&(d=!1),d&&o!==void 0&&(u.key_ops!==void 0||u.use!==void 0)){let p;u.key_ops?p=new Set(u.key_ops):p=UL[u.use],o.some(m=>!p.has(m))&&(d=!1)}return d}).sort((u,d)=>JT(d,f)-JT(u,f))}get(...t){return this.all(...t)[0]}add(t){if(!Gd(t)||!t.kty)throw new TypeError("key must be an instance of a key instantiated by JWK.asKey");this._keys.add(t)}remove(t){if(!Gd(t))throw new TypeError("key must be an instance of a key instantiated by JWK.asKey");this._keys.delete(t)}toJWKS(t=!1){return{keys:[...this._keys.values()].map(r=>r.toJWK(t&&(r.private||r.secret&&r.k)))}}async generate(...t){this._keys.add(await LL(...t))}generateSync(...t){this._keys.add($L(...t))}get size(){return this._keys.size}[MT.custom](){return`${this.constructor.name} ${MT(this.toJWKS(!1),{depth:1/0,colors:process.stdout.isTTY,compact:!1,sorted:!0})}`}*[Symbol.iterator](){for(let t of this._keys)yield t}};function LT(e,{ignoreErrors:t=!1,calculateMissingRSAPrimes:r=!1}={}){if(!DT(e)||!Array.isArray(e.keys)||e.keys.some(i=>!DT(i)||!("kty"in i)))throw new TypeError("jwks must be a JSON Web Key Set formatted object");let n=e.keys.map(i=>{try{return WL(i,{calculateMissingRSAPrimes:r})}catch(s){if(!t)throw s}}).filter(Boolean);return new zi(...n)}Object.defineProperty(zi,"fromJWKS",{value:JL(e=>LT(e,{calculateMissingRSAPrimes:!0}),"JWKS.KeyStore.fromJWKS() is deprecated, use JWKS.asKeyStore() instead"),enumerable:!1});$T.exports={KeyStore:zi,asKeyStore:LT}});var jr=h((UX,WT)=>{var UT=$(),HL=Tt(),FL=Cn(),{KeyStore:GL}=zd();WT.exports=(e,t=!1)=>{if(e instanceof HL)return e;if(e instanceof GL){if(!t)throw new TypeError("key argument for this operation must not be a JWKS.KeyStore instance");return e}try{return FL(e)}catch(r){if(r instanceof UT.JOSEError&&!(r instanceof UT.JWKImportFailed))throw r;let n;throw t?n="key must be an instance of a key instantiated by JWK.asKey, a valid JWK.asKey input, or a JWKS.KeyStore instance":n="key must be an instance of a key instantiated by JWK.asKey, or a valid JWK.asKey input",new TypeError(n)}}});var Yd=h((WX,HT)=>{HT.exports=e=>JSON.parse(JSON.stringify(e))});var Vd=h((HX,GT)=>{var{timingSafeEqual:zL}=g("crypto"),FT=(e,t)=>{if(e.length===t)return e;let r=Buffer.alloc(t);return e.copy(r),r},YL=(e,t)=>{let r=Math.max(e.length,t.length);return zL(FT(e,r),FT(t,r))};GT.exports=YL});var Yi=h((FX,zT)=>{zT.exports=e=>`sha${e.substr(2,3)}`});var XT=h((GX,VT)=>{var{createHmac:VL}=g("crypto"),{KEYOBJECT:XL}=Q(),QL=Vd(),ZL=Yi(),{asInput:e$}=le(),YT=(e,t,{[XL]:r},n)=>{let i=VL(t,e$(r,!1));return i.update(n),i.digest()},t$=(e,t,r,n,i)=>{let s=YT(e,t,r,n);return QL(i,s)};VT.exports=(e,t)=>{["HS256","HS384","HS512"].forEach(r=>{let n=ZL(r);e.sign.set(r,YT.bind(void 0,r,n)),e.verify.set(r,t$.bind(void 0,r,n)),t.oct.sign[r]=t.oct.verify[r]=i=>i.use==="sig"||i.use===void 0})}});var ZT=h((zX,Xd)=>{var bc=e=>(e/8|0)+(e%8===0?0:1),Ec={ES256:bc(256),ES256K:bc(256),ES384:bc(384),ES512:bc(521)},QT=(e,t,r)=>{let n=0;for(;t+n<r&&e[t+n]===0;)++n;return e[t+n]>=128&&--n,n};Xd.exports.derToJose=(e,t)=>{if(!Buffer.isBuffer(e))throw new TypeError("ECDSA signature must be a Buffer");if(!Ec[t])throw new Error(`Unknown algorithm "${t}"`);let r=Ec[t],n=r+1,i=e.length,s=0;if(e[s++]!==48)throw new Error('Could not find expected "seq"');let o=e[s++];if(o===129&&(o=e[s++]),i-s<o)throw new Error(`"seq" specified length of ${o}", only ${i-s}" remaining`);if(e[s++]!==2)throw new Error('Could not find expected "int" for "r"');let c=e[s++];if(i-s-2<c)throw new Error(`"r" specified length of "${c}", only "${i-s-2}" available`);if(n<c)throw new Error(`"r" specified length of "${c}", max of "${n}" is acceptable`);let a=s;if(s+=c,e[s++]!==2)throw new Error('Could not find expected "int" for "s"');let l=e[s++];if(i-s!==l)throw new Error(`"s" specified length of "${l}", expected "${i-s}"`);if(n<l)throw new Error(`"s" specified length of "${l}", max of "${n}" is acceptable`);let f=s;if(s+=l,s!==i)throw new Error(`Expected to consume entire buffer, but "${i-s}" bytes remain`);let u=r-c,d=r-l,p=Buffer.allocUnsafe(u+c+d+l);for(s=0;s<u;++s)p[s]=0;e.copy(p,s,a+Math.max(-u,0),a+c),s=r;for(let m=s;s<m+d;++s)p[s]=0;return e.copy(p,s,f+Math.max(-d,0),f+l),p};Xd.exports.joseToDer=(e,t)=>{if(!Buffer.isBuffer(e))throw new TypeError("ECDSA signature must be a Buffer");if(!Ec[t])throw new TypeError(`Unknown algorithm "${t}"`);let r=Ec[t],n=e.length;if(n!==r*2)throw new Error(`"${t}" signatures must be "${r*2}" bytes, saw "${n}"`);let i=QT(e,0,r),s=QT(e,r,e.length),o=r-i,c=r-s,a=1+1+o+1+1+c,l=a<128,f=Buffer.allocUnsafe((l?2:3)+a),u=0;return f[u++]=48,l?f[u++]=a:(f[u++]=129,f[u++]=a&255),f[u++]=2,f[u++]=o,i<0?(f[u++]=0,u+=e.copy(f,u,0,r)):u+=e.copy(f,u,i,r),f[u++]=2,f[u++]=c,s<0?(f[u++]=0,e.copy(f,u,r)):e.copy(f,u,r+s),f}});var t1=h((YX,e1)=>{var{sign:r$,verify:n$,createSign:i$,createVerify:s$,getCurves:vc}=g("crypto"),{derToJose:o$,joseToDer:c$}=ZT(),{KEYOBJECT:Sc}=Q(),a$=Yi(),{asInput:xc}=le(),{dsaEncodingSupported:u$}=Ie(),{name:l$}=Ir(),Qd,Zd;u$?(Qd=(e,t,{[Sc]:r},n)=>(typeof n=="string"&&(n=Buffer.from(n)),r$(t,n,{key:xc(r,!1),dsaEncoding:"ieee-p1363"})),Zd=(e,t,{[Sc]:r},n,i)=>{try{return n$(t,n,{key:xc(r,!0),dsaEncoding:"ieee-p1363"},i)}catch{return!1}}):(Qd=(e,t,{[Sc]:r},n)=>o$(i$(t).update(n).sign(xc(r,!1)),e),Zd=(e,t,{[Sc]:r},n,i)=>{try{return s$(t).update(n).verify(xc(r,!0),c$(i,e))}catch{return!1}});var f$=e=>{switch(e){case"P-256":return"ES256";case l$:return"ES256K";case"P-384":return"ES384";case"P-521":return"ES512"}};e1.exports=(e,t)=>{let r=[];vc().includes("prime256v1")&&r.push("ES256"),vc().includes("secp256k1")&&r.push("ES256K"),vc().includes("secp384r1")&&r.push("ES384"),vc().includes("secp521r1")&&r.push("ES512"),r.forEach(n=>{let i=a$(n);e.sign.set(n,Qd.bind(void 0,n,i)),e.verify.set(n,Zd.bind(void 0,n,i)),t.EC.sign[n]=s=>s.private&&t.EC.verify[n](s),t.EC.verify[n]=s=>(s.use==="sig"||s.use===void 0)&&f$(s.crv)===n})}});var i1=h((VX,n1)=>{var{sign:d$,verify:h$}=g("crypto"),{KEYOBJECT:r1}=Q(),{edDSASupported:p$}=Ie(),y$=({[r1]:e},t)=>(typeof t=="string"&&(t=Buffer.from(t)),d$(void 0,t,e)),m$=({[r1]:e},t,r)=>h$(void 0,t,e,r);n1.exports=(e,t)=>{p$&&(e.sign.set("EdDSA",y$),e.verify.set("EdDSA",m$),t.OKP.sign.EdDSA=r=>r.private&&t.OKP.verify.EdDSA(r),t.OKP.verify.EdDSA=r=>(r.use==="sig"||r.use===void 0)&&r.keyObject.asymmetricKeyType.startsWith("ed"))}});var a1=h((XX,c1)=>{var{createSign:g$,createVerify:_$,constants:Tc}=g("crypto"),{KEYOBJECT:s1}=Q(),w$=Yi(),{asInput:o1}=le(),b$=(e,{[s1]:t},r)=>{let n=o1(t,!1);return g$(e).update(r).sign({key:n,padding:Tc.RSA_PKCS1_PSS_PADDING,saltLength:Tc.RSA_PSS_SALTLEN_DIGEST})},E$=(e,{[s1]:t},r,n)=>{let i=o1(t,!0);return _$(e).update(r).verify({key:i,padding:Tc.RSA_PKCS1_PSS_PADDING,saltLength:Tc.RSA_PSS_SALTLEN_DIGEST},n)},v$={PS256:528,PS384:784,PS512:1040};c1.exports=(e,t)=>{["PS256","PS384","PS512"].forEach(r=>{let n=w$(r);e.sign.set(r,b$.bind(void 0,n)),e.verify.set(r,E$.bind(void 0,n)),t.RSA.sign[r]=i=>i.private&&t.RSA.verify[r](i),t.RSA.verify[r]=i=>(i.use==="sig"||i.use===void 0)&&i.length>=v$[r]})}});var d1=h((QX,f1)=>{var{createSign:S$,createVerify:x$}=g("crypto"),{KEYOBJECT:u1}=Q(),T$=Yi(),{asInput:l1}=le(),A$=(e,{[u1]:t},r)=>S$(e).update(r).sign(l1(t,!1)),q$=(e,{[u1]:t},r,n)=>x$(e).update(r).verify(l1(t,!0),n),O$={RS256:0,RS384:624,RS512:752};f1.exports=(e,t)=>{["RS256","RS384","RS512"].forEach(r=>{let n=T$(r);e.sign.set(r,A$.bind(void 0,n)),e.verify.set(r,q$.bind(void 0,n)),t.RSA.sign[r]=i=>i.private&&t.RSA.verify[r](i),t.RSA.verify[r]=i=>(i.use==="sig"||i.use===void 0)&&i.length>=O$[r]})}});var p1=h((ZX,h1)=>{var k$=()=>Buffer.from(""),C$=(e,t,r)=>!r.length;h1.exports=(e,t)=>{e.sign.set("none",k$),e.verify.set("none",C$)}});var g1=h((eQ,m1)=>{var y1=Math.pow(2,32);m1.exports=(e,t=Buffer.allocUnsafe(8))=>{let r=Math.floor(e/y1),n=e%y1;return t.writeUInt32BE(r,0),t.writeUInt32BE(n,4),t}});var S1=h((tQ,v1)=>{var{createCipheriv:P$,createDecipheriv:R$,getCiphers:K$}=g("crypto"),b1=g1(),I$=Vd(),{KEYOBJECT:Ac}=Q(),{JWEInvalid:_1,JWEDecryptionFailed:w1}=$(),E1=function(e,t,r){if(t.length!==16)throw new _1("invalid iv");if(arguments.length===3&&r.length!==e/8)throw new _1("invalid tag")},B$=(e,t,{[Ac]:r},n,{iv:i,aad:s=Buffer.alloc(0)})=>{let o=r.export();E1(e,i);let c=e/8,a=o.slice(c),l=P$(`aes-${e}-cbc`,a,i),f=Buffer.concat([l.update(n),l.final()]),u=Buffer.concat([s,i,f,b1(s.length*8)]),d=o.slice(0,c),p=t({[Ac]:d},u).slice(0,c);return{ciphertext:f,tag:p}},N$=(e,t,{[Ac]:r},n,{iv:i,tag:s=Buffer.alloc(0),aad:o=Buffer.alloc(0)})=>{E1(e,i,s);let c=e/8,a=r.export(),l=a.slice(c),f=a.slice(0,c),u=Buffer.concat([o,i,n,b1(o.length*8)]),d=t({[Ac]:f},u,s).slice(0,c);if(!I$(s,d))throw new w1;let m;try{let y=R$(`aes-${e}-cbc`,l,i);m=Buffer.concat([y.update(n),y.final()])}catch{}if(!m)throw new w1;return m};v1.exports=(e,t)=>{["A128CBC-HS256","A192CBC-HS384","A256CBC-HS512"].forEach(r=>{let n=parseInt(r.substr(1,3),10),i=e.sign.get(`HS${n*2}`);K$().includes(`aes-${n}-cbc`)&&(e.encrypt.set(r,B$.bind(void 0,n,i)),e.decrypt.set(r,N$.bind(void 0,n,i)),t.oct.encrypt[r]=t.oct.decrypt[r]=s=>(s.use==="enc"||s.use===void 0)&&s.length/2===n)})}});var k1=h((rQ,O1)=>{var{createCipheriv:j$,createDecipheriv:M$,getCiphers:D$}=g("crypto"),{KEYOBJECT:T1}=Q(),{JWEInvalid:x1,JWEDecryptionFailed:J$}=$(),{asInput:A1}=le(),q1=function(e,t,r){if(t.length!==12)throw new x1("invalid iv");if(arguments.length===3&&r.length!==16)throw new x1("invalid tag")},L$=(e,{[T1]:t},r,{iv:n,aad:i=Buffer.alloc(0)})=>{let s=A1(t,!1);q1(e,n);let o=j$(`aes-${e}-gcm`,s,n,{authTagLength:16});o.setAAD(i);let c=Buffer.concat([o.update(r),o.final()]),a=o.getAuthTag();return{ciphertext:c,tag:a}},$$=(e,{[T1]:t},r,{iv:n,tag:i=Buffer.alloc(0),aad:s=Buffer.alloc(0)})=>{let o=A1(t,!1);q1(e,n,i);try{let c=M$(`aes-${e}-gcm`,o,n,{authTagLength:16});return c.setAuthTag(i),c.setAAD(s),Buffer.concat([c.update(r),c.final()])}catch{throw new J$}};O1.exports=(e,t)=>{["A128GCM","A192GCM","A256GCM"].forEach(r=>{let n=parseInt(r.substr(1,3),10);D$().includes(`aes-${n}-gcm`)&&(e.encrypt.set(r,L$.bind(void 0,n)),e.decrypt.set(r,$$.bind(void 0,n)),t.oct.encrypt[r]=t.oct.decrypt[r]=i=>(i.use==="enc"||i.use===void 0)&&i.length===n)})}});var B1=h((nQ,I1)=>{var{publicEncrypt:U$,privateDecrypt:W$,constants:C1}=g("crypto"),{oaepHashSupported:H$}=Ie(),{KEYOBJECT:R1}=Q(),{asInput:K1}=le(),F$=e=>{switch(e){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return C1.RSA_PKCS1_OAEP_PADDING;case"RSA1_5":return C1.RSA_PKCS1_PADDING}},G$=e=>{switch(e){case"RSA-OAEP":return"sha1";case"RSA-OAEP-256":return"sha256";case"RSA-OAEP-384":return"sha384";case"RSA-OAEP-512":return"sha512";default:return}},z$=(e,t,{[R1]:r},n)=>{let i=K1(r,!0);return{wrapped:U$({key:i,oaepHash:t,padding:e},n)}},Y$=(e,t,{[R1]:r},n)=>{let i=K1(r,!1);return W$({key:i,oaepHash:t,padding:e},n)},P1={RSA1_5:0,"RSA-OAEP":592,"RSA-OAEP-256":784,"RSA-OAEP-384":1040,"RSA-OAEP-512":1296};I1.exports=(e,t)=>{let r=["RSA-OAEP","RSA1_5"];H$&&r.splice(1,0,"RSA-OAEP-256","RSA-OAEP-384","RSA-OAEP-512"),r.forEach(n=>{let i=F$(n),s=G$(n);e.keyManagementEncrypt.set(n,z$.bind(void 0,i,s)),e.keyManagementDecrypt.set(n,Y$.bind(void 0,i,s)),t.RSA.wrapKey[n]=o=>(o.use==="enc"||o.use===void 0)&&o.length>=P1[n],t.RSA.unwrapKey[n]=o=>o.private&&(o.use==="enc"||o.use===void 0)&&o.length>=P1[n]})}});var D1=h((iQ,M1)=>{var{createCipheriv:V$,createDecipheriv:X$,getCiphers:Q$}=g("crypto"),{KEYOBJECT:N1}=Q(),{asInput:j1}=le(),Z$=e=>{if(e!==void 0&&e.length%8!==0)throw new Error("invalid data length")},eU=(e,{[N1]:t},r)=>{let n=j1(t,!1),i=V$(e,n,Buffer.alloc(8,"a6","hex"));return{wrapped:Buffer.concat([i.update(r),i.final()])}},tU=(e,{[N1]:t},r)=>{let n=j1(t,!1);Z$(r);let i=X$(e,n,Buffer.alloc(8,"a6","hex"));return Buffer.concat([i.update(r),i.final()])};M1.exports=(e,t)=>{["A128KW","A192KW","A256KW"].forEach(r=>{let n=parseInt(r.substr(1,3),10),i=`aes${n}-wrap`;Q$().includes(i)&&(e.keyManagementEncrypt.set(r,eU.bind(void 0,i)),e.keyManagementDecrypt.set(r,tU.bind(void 0,i)),t.oct.wrapKey[r]=t.oct.unwrapKey[r]=s=>(s.use==="enc"||s.use===void 0)&&s.length===n)})}});var $1=h((sQ,L1)=>{var rU=Zf(),J1=ve();L1.exports=(e,t)=>{["A128GCMKW","A192GCMKW","A256GCMKW"].forEach(r=>{let n=r.substr(0,7),i=parseInt(r.substr(1,3),10),s=e.encrypt.get(n),o=e.decrypt.get(n);s&&o&&(e.keyManagementEncrypt.set(r,(c,a)=>{let l=rU(r),{ciphertext:f,tag:u}=s(c,a,{iv:l});return{wrapped:f,header:{tag:J1.encodeBuffer(u),iv:J1.encodeBuffer(l)}}}),e.keyManagementDecrypt.set(r,o),t.oct.wrapKey[r]=t.oct.unwrapKey[r]=c=>(c.use==="enc"||c.use===void 0)&&c.length===i)})}});var F1=h((oQ,H1)=>{var{pbkdf2Sync:W1,randomBytes:nU}=g("crypto"),{KEYOBJECT:qc}=Q(),iU=ve(),sU=16,oU=Buffer.alloc(1,0),U1=(e,t)=>Buffer.concat([Buffer.from(e,"utf8"),oU,t]),cU=(e,t,r,n,{[qc]:i},s)=>{let o=Math.floor(Math.random()*2049+2048),c=nU(sU),a=r(c),l=W1(i.export(),a,o,e,t),f=n({[qc]:l},s);return f.header=f.header||{},Object.assign(f.header,{p2c:o,p2s:iU.encodeBuffer(c)}),f},aU=(e,t,r,n,{[qc]:i},s,o)=>{let{p2s:c,p2c:a}=o,l=r(c),f=W1(i.export(),l,a,e,t);return n({[qc]:f},s,o)};H1.exports=(e,t)=>{["PBES2-HS256+A128KW","PBES2-HS384+A192KW","PBES2-HS512+A256KW"].forEach(r=>{let n=r.substr(-6),i=e.keyManagementEncrypt.get(n),s=e.keyManagementDecrypt.get(n),o=parseInt(r.substr(13,3),10)/8,c=`sha${r.substr(8,3)}`;i&&s&&(e.keyManagementEncrypt.set(r,cU.bind(void 0,o,c,U1.bind(void 0,r),i)),e.keyManagementDecrypt.set(r,aU.bind(void 0,o,c,U1.bind(void 0,r),s)),t.oct.deriveKey[r]=a=>a.use==="enc"||a.use===void 0)})}});var G1=h((cQ,eh)=>{var{improvedDH:uU}=Ie();if(uU){let{diffieHellman:e}=g("crypto"),{KeyObject:t}=le(),r=Cn();eh.exports=({keyObject:n},i)=>(i instanceof t||({keyObject:i}=r(i)),e({privateKey:n,publicKey:i}))}else{let{createECDH:e,constants:{POINT_CONVERSION_UNCOMPRESSED:t}}=g("crypto"),r=ve(),n=o=>{switch(o){case"P-256":return"prime256v1";case"P-384":return"secp384r1";case"P-521":return"secp521r1"}},i=Buffer.alloc(1,t),s=(o,c)=>Buffer.concat([i,r.decodeToBuffer(o),r.decodeToBuffer(c)]);eh.exports=({crv:o,d:c},{x:a,y:l})=>{let f=n(o),u=e(f);return u.setPrivateKey(r.decodeToBuffer(c)),u.computeSecret(s(a,l))}}});var rh=h((aQ,V1)=>{var{createHash:z1}=g("crypto"),lU=G1(),fU=(e,t,r)=>{let n=Math.ceil(t/32),i;for(let s=1;s<=n;s++){let o=Buffer.allocUnsafe(4+e.length+r.length);o.writeUInt32BE(s,0),e.copy(o,4),r.copy(o,4+e.length),i?i=Buffer.concat([i,z1("sha256").update(o).digest()]):i=z1("sha256").update(o).digest()}return i.slice(0,t)},Y1=(e,t=Buffer.allocUnsafe(4))=>(t.writeUInt32BE(e),t),th=e=>Buffer.concat([Y1(e.length),e]);V1.exports=(e,t,r,n,{apu:i=Buffer.alloc(0),apv:s=Buffer.alloc(0)}={},o=lU)=>{let c=Buffer.concat([th(Buffer.from(e)),th(i),th(s),Y1(t)]),a=o(r,n);return fU(a,t/8,c)}});var eA=h((uQ,Z1)=>{var{improvedDH:dU}=Ie(),{KEYLENGTHS:X1}=vt(),{generateSync:hU}=Fi(),{name:pU}=Ir(),Q1=rh(),yU=(e,t,{enc:r})=>{let n=hU(e.kty,e.crv);return{wrapped:Q1(r,X1.get(r),n,e),header:{epk:{kty:e.kty,crv:e.crv,x:n.x,y:n.y}}}},mU=(e,t,r)=>{let{enc:n,epk:i}=r;return Q1(n,X1.get(n),e,i,r)};Z1.exports=(e,t)=>{e.keyManagementEncrypt.set("ECDH-ES",yU),e.keyManagementDecrypt.set("ECDH-ES",mU),t.EC.deriveKey["ECDH-ES"]=r=>(r.use==="enc"||r.use===void 0)&&r.crv!==pU,dU&&(t.OKP.deriveKey["ECDH-ES"]=r=>(r.use==="enc"||r.use===void 0)&&r.keyObject.asymmetricKeyType.startsWith("x"))}});var sA=h((lQ,Oc)=>{var{improvedDH:gU}=Ie(),{KEYOBJECT:rA}=Q(),{generateSync:_U}=Fi(),{name:wU}=Ir(),{ECDH_DERIVE_LENGTHS:bU}=vt(),tA=rh(),nA=(e,t,r,n)=>{let i=_U(r.kty,r.crv),s=t(i,r,n),o=e({[rA]:s},n);return o.header=o.header||{},Object.assign(o.header,{epk:{kty:r.kty,crv:r.crv,x:i.x,y:i.y}}),o},iA=(e,t,r,n,i)=>{let{epk:s}=i,o=t(r,s,i);return e({[rA]:o},n,i)};Oc.exports=(e,t)=>{["ECDH-ES+A128KW","ECDH-ES+A192KW","ECDH-ES+A256KW"].forEach(r=>{let n=r.substr(-6),i=e.keyManagementEncrypt.get(n),s=e.keyManagementDecrypt.get(n),o=parseInt(r.substr(9,3),10);bU.set(r,o),i&&s&&(e.keyManagementEncrypt.set(r,nA.bind(void 0,i,tA.bind(void 0,r,o))),e.keyManagementDecrypt.set(r,iA.bind(void 0,s,tA.bind(void 0,r,o))),t.EC.deriveKey[r]=c=>(c.use==="enc"||c.use===void 0)&&c.crv!==wU,gU&&(t.OKP.deriveKey[r]=c=>(c.use==="enc"||c.use===void 0)&&c.keyObject.asymmetricKeyType.startsWith("x")))})};Oc.exports.wrapKey=nA;Oc.exports.unwrapKey=iA});var Vi=h((fQ,oA)=>{var{JWKKeySupport:EU,JOSENotSupported:vU}=$(),{KEY_MANAGEMENT_ENCRYPT:SU,KEY_MANAGEMENT_DECRYPT:xU}=Q(),{JWA:Y,JWK:Ne}=vt();XT()(Y,Ne);t1()(Y,Ne);i1()(Y,Ne);a1()(Y,Ne);d1()(Y,Ne);p1()(Y);S1()(Y,Ne);k1()(Y,Ne);B1()(Y,Ne);D1()(Y,Ne);$1()(Y,Ne);F1()(Y,Ne);eA()(Y,Ne);sA()(Y,Ne);var ar=(e,t,r)=>{let n=`_${t}_${r}`,i,s;if(t==="keyManagementEncrypt"?(i="key management (encryption)",s=SU):t==="keyManagementDecrypt"&&(i="key management (decryption)",s=xU),n in e){if(e[n])return;throw new EU(`the key does not support ${r} ${i||t} algorithm`)}let o=!0;if(Y[t].has(r))e.algorithms(s).has(r)||(o=!1);else throw new vU(`unsupported ${i||t} alg: ${r}`);if(Object.defineProperty(e,n,{value:o,enumerable:!1}),!o)return ar(e,t,r)};oA.exports={check:ar,sign:(e,t,r)=>(ar(t,"sign",e),Y.sign.get(e)(t,r)),verify:(e,t,r,n)=>(ar(t,"verify",e),Y.verify.get(e)(t,r,n)),keyManagementEncrypt:(e,t,r,n)=>(ar(t,"keyManagementEncrypt",e),Y.keyManagementEncrypt.get(e)(t,r,n)),keyManagementDecrypt:(e,t,r,n)=>(ar(t,"keyManagementDecrypt",e),Y.keyManagementDecrypt.get(e)(t,r,n)),encrypt:(e,t,r,n)=>(ar(t,"encrypt",e),Y.encrypt.get(e)(t,r,n)),decrypt:(e,t,r,n)=>(ar(t,"decrypt",e),Y.decrypt.get(e)(t,r,n))}});var Xi=h((dQ,aA)=>{var{JOSECritNotUnderstood:TU,JWSInvalid:cA}=$(),AU=new Set(["alg","jku","jwk","kid","x5u","x5c","x5t","x5t#S256","typ","cty","crit","enc","zip","epk","apu","apv","iv","tag","p2s","p2c"]);aA.exports=function(t,r,n,i){if(r&&"crit"in r){if(!Array.isArray(r.crit)||r.crit.length===0||r.crit.some(c=>typeof c!="string"||!c))throw new t('"crit" Header Parameter MUST be an array of non-empty strings when present');let s=new Set(i),o={...r,...n};r.crit.forEach(c=>{if(AU.has(c))throw new t(`The critical list contains a non-extension Header Parameter ${c}`);if(!s.has(c))throw new TU(`critical "${c}" is not understood`);if(c==="b64"){if(!("b64"in r))throw new cA('"b64" critical parameter must be integrity protected');if(typeof r.b64!="boolean")throw new cA('"b64" critical parameter must be a boolean')}else if(!(c in o))throw new t(`critical parameter "${c}" is missing`)})}if(n&&"crit"in n)throw new t('"crit" Header Parameter MUST be integrity protected when present')}});var nh=h((hQ,dA)=>{var Qi=Ue(),Zi=Xi(),{JWEInvalid:kc}=$();Zi=Zi.bind(void 0,kc);var uA=(e,[t])=>`${e.protected}.${t.encrypted_key}.${e.iv}.${e.ciphertext}.${e.tag}`;uA.validate=(e,t,r,{0:{header:n},length:i})=>{if(i!==1||r||t||n)throw new kc("JWE Compact Serialization doesn't support multiple recipients, JWE unprotected headers or AAD");Zi(e,t,e?e.crit:void 0)};var lA=(e,[t])=>{let{header:r,encrypted_key:n}=t;return{...e.protected?{protected:e.protected}:void 0,...e.unprotected?{unprotected:e.unprotected}:void 0,...r?{header:r}:void 0,...n?{encrypted_key:n}:void 0,...e.aad?{aad:e.aad}:void 0,iv:e.iv,ciphertext:e.ciphertext,tag:e.tag}};lA.validate=(e,t,r,{0:{header:n},length:i})=>{if(i!==1)throw new kc("Flattened JWE JSON Serialization doesn't support multiple recipients");Zi(e,{...t,...n},e?e.crit:void 0)};var fA=(e,t)=>{let r={...e.protected?{protected:e.protected}:void 0,...e.unprotected?{unprotected:e.unprotected}:void 0,recipients:t.map(({header:n,encrypted_key:i,generatedHeader:s})=>!n&&!i&&!s?!1:{...n||s?{header:{...n,...s}}:void 0,...i?{encrypted_key:i}:void 0}).filter(Boolean),...e.aad?{aad:e.aad}:void 0,iv:e.iv,ciphertext:e.ciphertext,tag:e.tag};return r.recipients.length||delete r.recipients,r};fA.validate=(e,t,r,n)=>{n.forEach(({header:i})=>{Zi(e,{...i,...t},e?e.crit:void 0)})};var qU=e=>Qi(e)&&typeof e.ciphertext=="string"&&typeof e.iv=="string"&&typeof e.tag=="string"&&(e.unprotected===void 0||Qi(e.unprotected))&&(e.protected===void 0||typeof e.protected=="string")&&(e.aad===void 0||typeof e.aad=="string"),OU=e=>(e.encrypted_key===void 0||typeof e.encrypted_key=="string")&&(e.header===void 0||Qi(e.header)),kU=e=>Qi(e)&&typeof e.encrypted_key=="string"&&(e.header===void 0||Qi(e.header)),CU=e=>!!(Array.isArray(e.recipients)&&e.recipients.every(kU)),PU=e=>{if(typeof e=="string"&&e.split(".").length===5)return"compact";if(qU(e)){if(CU(e))return"general";if(OU(e))return"flattened"}throw new kc("JWE malformed or invalid serialization")};dA.exports={compact:uA,flattened:lA,general:fA,detect:PU}});var ih=h((pQ,pA)=>{var{randomBytes:RU}=g("crypto"),{createSecretKey:KU}=le(),{KEYLENGTHS:IU}=vt(),hA=wc();pA.exports=e=>{let t=IU.get(e);return t?new hA(KU(RU(t/8)),{use:"enc",alg:e}):new hA({type:"secret"})}});var Cc=h((yQ,yA)=>{yA.exports=(e={},t={})=>{let r=Object.keys(e),n=new Set(Object.keys(t));return!r.some(i=>n.has(i))}});var ch=h((mQ,mA)=>{var sh=Cc(),BU=ve(),oh=Xi(),{JWEInvalid:Dt,JOSENotSupported:NU}=$();oh=oh.bind(void 0,Dt);mA.exports=(e,t,r,n,i)=>{if(typeof e=="string")try{e=BU.JSON.decode(e)}catch{throw new Dt("could not parse JWE protected header")}let s=[],o=new Set;if(!sh(e,t)||!r.every(({header:c})=>{typeof c=="object"&&(s.push(c.alg),o.add(c.enc));let a={...t,...c};if(oh(e,a,i),"zip"in a)throw new Dt('"zip" Header Parameter MUST be integrity protected');if(e&&"zip"in e&&e.zip!=="DEF")throw new NU('only "DEF" compression algorithm is supported');return sh(c,e)&&sh(c,t)}))throw new Dt("JWE Shared Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");if(typeof e=="object"&&(s.push(e.alg),o.add(e.enc)),typeof t=="object"&&(s.push(t.alg),o.add(t.enc)),s=s.filter(Boolean),o.delete(void 0),r.length!==1&&(s.includes("dir")||s.includes("ECDH-ES")))throw new Dt("dir and ECDH-ES alg may only be used with a single recipient");if(n){if(s.length!==r.length)throw new Dt("missing Key Management algorithm");if(o.size===0)throw new Dt("missing Content Encryption algorithm");if(o.size!==1)throw new Dt("there must only be one Content Encryption algorithm")}else if(o.size>1)throw new Dt("there must only be one Content Encryption algorithm");return[...o][0]}});var vA=h((gQ,EA)=>{var{deflateRawSync:jU}=g("zlib"),{KEYOBJECT:gA}=Q(),MU=Zf(),Pn=ve(),DU=jr(),ah=Ue(),{createSecretKey:JU}=le(),uh=Yd(),_A=Cn(),{JWEInvalid:wA}=$(),{check:lh,keyManagementEncrypt:LU,encrypt:$U}=Vi(),UU=nh(),WU=ih(),HU=ch(),bA=Symbol("PROCESS_RECIPIENT"),fh=class{constructor(t,r,n,i){if(!Buffer.isBuffer(t)&&typeof t!="string")throw new TypeError("cleartext argument must be a Buffer or a string");if(t=Buffer.from(t),i!==void 0&&!Buffer.isBuffer(i)&&typeof i!="string")throw new TypeError("aad argument must be a Buffer or a string when provided");if(i=i?Buffer.from(i):void 0,r!==void 0&&!ah(r))throw new TypeError("protectedHeader argument must be a plain object when provided");if(n!==void 0&&!ah(n))throw new TypeError("unprotectedHeader argument must be a plain object when provided");this._recipients=[],this._cleartext=t,this._aad=i,this._unprotected=n?uh(n):void 0,this._protected=r?uh(r):void 0}recipient(t,r){if(t=DU(t),r!==void 0&&!ah(r))throw new TypeError("header argument must be a plain object when provided");return this._recipients.push({key:t,header:r?uh(r):void 0}),this}[bA](t){let r=this._unprotected,n=this._protected,{length:i}=this._recipients,s={...n,...r,...t.header},{key:o}=t,c=s.enc,a=s.alg;if(o.use==="sig")throw new TypeError('a key with "use":"sig" is not usable for encryption');if(a==="dir")lh(o,"encrypt",c);else if(a)lh(o,"keyManagementEncrypt",a);else{if(a=o.alg||[...o.algorithms("wrapKey")][0]||[...o.algorithms("deriveKey")][0],a==="ECDH-ES"&&i!==1&&(a=[...o.algorithms("deriveKey")][1]),!a)throw new wA('could not resolve a usable "alg" for a recipient');i===1?n?n.alg=a:this._protected={alg:a}:t.header?t.header.alg=a:t.header={alg:a}}let l,f;o.kty==="oct"&&a==="dir"?this._cek=_A(o[gA],{use:"enc",alg:c}):(lh(this._cek,"encrypt",c),{wrapped:l,header:f}=LU(a,o,this._cek[gA].export(),{enc:c,alg:a}),a==="ECDH-ES"&&(this._cek=_A(JU(l),{use:"enc",alg:c}))),a==="dir"||a==="ECDH-ES"?t.encrypted_key="":t.encrypted_key=Pn.encodeBuffer(l),f&&(t.generatedHeader=f)}encrypt(t){let r=UU[t];if(!r)throw new TypeError('serialization must be one of "compact", "flattened", "general"');if(!this._recipients.length)throw new wA("missing recipients");r.validate(this._protected,this._unprotected,this._aad,this._recipients);let n=HU(this._protected,this._unprotected,this._recipients,!1,this._protected?this._protected.crit:void 0);n||(n="A128CBC-HS256",this._protected?this._protected.enc=n:this._protected={enc:n});let i={};this._cek=WU(n);for(let f of this._recipients)this[bA](f);let s=MU(n);if(i.iv=Pn.encodeBuffer(s),this._recipients.length===1&&this._recipients[0].generatedHeader){let[{generatedHeader:f}]=this._recipients;delete this._recipients[0].generatedHeader,this._protected={...this._protected,...f}}this._protected&&(i.protected=Pn.JSON.encode(this._protected)),i.unprotected=this._unprotected;let o;this._aad?(i.aad=Pn.encode(this._aad),o=Buffer.concat([Buffer.from(i.protected||""),Buffer.from("."),Buffer.from(i.aad)])):o=Buffer.from(i.protected||"");let c=this._cleartext;this._protected&&"zip"in this._protected&&(c=jU(c));let{ciphertext:a,tag:l}=$U(n,this._cek,c,{iv:s,aad:o});return i.tag=Pn.encodeBuffer(l),i.ciphertext=Pn.encodeBuffer(a),r(i,this._recipients)}};EA.exports=fh});var Pc=h((_Q,SA)=>{var FU=zd();SA.exports=FU});var OA=h((wQ,qA)=>{var{inflateRawSync:GU}=g("zlib"),ut=ve(),zU=jr(),{KeyStore:YU}=Pc(),at=$(),{check:VU,decrypt:XU,keyManagementDecrypt:xA}=Vi(),dh=Gi(),{createSecretKey:TA}=le(),QU=ih(),AA=ch(),{detect:ZU}=nh(),e4=new Set(["compact","flattened"]),t4=(e={},t={},r={})=>{typeof e=="string"&&(e=ut.JSON.decode(e));let n=e.p2s||t.p2s||r.p2s,i=e.apu||t.apu||r.apu,s=e.apv||t.apv||r.apv,o=e.iv||t.iv||r.iv,c=e.tag||t.tag||r.tag;return{...e,...t,...r,...typeof n=="string"?{p2s:ut.decodeToBuffer(n)}:void 0,...typeof i=="string"?{apu:ut.decodeToBuffer(i)}:void 0,...typeof s=="string"?{apv:ut.decodeToBuffer(s)}:void 0,...typeof o=="string"?{iv:ut.decodeToBuffer(o)}:void 0,...typeof c=="string"?{tag:ut.decodeToBuffer(c)}:void 0}},hh=(e,t,r,n,{crit:i=[],complete:s=!1,algorithms:o,maxPBES2Count:c=1e4}={})=>{if(n=zU(n,!0),o!==void 0&&(!Array.isArray(o)||o.some(T=>typeof T!="string"||!T)))throw new TypeError('"algorithms" option must be an array of non-empty strings');if(o&&(o=new Set(o)),!Array.isArray(i)||i.some(T=>typeof T!="string"||!T))throw new TypeError('"crit" option must be an array of non-empty strings');t||(t=ZU(r));let a,l,f,u,d,p,m,y,_,b,w,v;if(t==="general"&&r.recipients.length===1){t="flattened";let{recipients:T,...R}=r;r={...R,...T[0]}}if(e4.has(t)){if(t==="compact"?[m,u,d,l,y]=r.split("."):{protected:m,encrypted_key:u,iv:d,ciphertext:l,tag:y,unprotected:_,aad:w,header:v}=r,e||AA(m,_,[{header:v}],!0,i),p=t4(m,_,v),{alg:a,enc:f}=p,o&&!o.has(a==="dir"?f:a))throw new at.JOSEAlgNotWhitelisted("alg not whitelisted");if(n instanceof YU){let k=n,ee;switch(p.alg==="dir"?ee=k.all({kid:p.kid,alg:p.enc,key_ops:["decrypt"]}):ee=k.all({kid:p.kid,alg:p.alg,key_ops:["unwrapKey"]}),ee.length){case 0:throw new at.JWKSNoMatchingKey;case 1:n=ee[0];break;default:{let Vn=[];for(let mr of ee)try{return hh(!0,t,r,mr,{crit:i,complete:s,algorithms:o?[...o]:void 0})}catch(Na){Vn.push(Na);continue}let Xn=new at.JOSEMultiError(Vn);throw[...Xn].some(mr=>mr instanceof at.JWEDecryptionFailed)?new at.JWEDecryptionFailed:Xn}}}if(VU(n,...a==="dir"?["decrypt",f]:["keyManagementDecrypt",a]),a.startsWith("PBES2")&&p&&p.p2c>c)throw new at.JWEInvalid('JOSE Header "p2c" (PBES2 Count) out is of acceptable bounds');try{if(a==="dir")b=dh.asKey(n,{alg:f,use:"enc"});else if(a==="ECDH-ES"){let k=xA(a,n,void 0,p);b=dh.asKey(TA(k),{alg:f,use:"enc"})}else{let k=xA(a,n,ut.decodeToBuffer(u),p);b=dh.asKey(TA(k),{alg:f,use:"enc"})}}catch{b=QU(f)}let T;w?T=Buffer.concat([Buffer.from(m||""),Buffer.from("."),Buffer.from(w)]):T=Buffer.from(m||"");try{d=ut.decodeToBuffer(d)}catch{}try{y=ut.decodeToBuffer(y)}catch{}let R=XU(f,b,ut.decodeToBuffer(l),{iv:d,tag:y,aad:T});if(p.zip&&(R=GU(R)),s){let k={cleartext:R,key:n,cek:b};return w&&(k.aad=w),v&&(k.header=v),_&&(k.unprotected=_),m&&(k.protected=ut.JSON.decode(m)),k}return R}AA(r.protected,r.unprotected,r.recipients.map(({header:T})=>({header:T})),!0,i);let{recipients:S,...E}=r,x=[];for(let T of S)try{return hh(!0,"flattened",{...E,...T},n,{crit:i,complete:s,algorithms:o?[...o]:void 0})}catch(R){x.push(R);continue}let q=new at.JOSEMultiError(x);throw[...q].some(T=>T instanceof at.JWEDecryptionFailed)?new at.JWEDecryptionFailed:[...q].every(T=>T instanceof at.JWKSNoMatchingKey)?new at.JWKSNoMatchingKey:q};qA.exports=hh.bind(void 0,!1,void 0)});var CA=h((bQ,Rn)=>{var kA=vA(),r4=OA(),ph=(e,t,r,n,i,s)=>new kA(t,n,i,s).recipient(r).encrypt(e);Rn.exports.Encrypt=kA;Rn.exports.encrypt=ph.bind(void 0,"compact");Rn.exports.encrypt.flattened=ph.bind(void 0,"flattened");Rn.exports.encrypt.general=ph.bind(void 0,"general");Rn.exports.decrypt=r4});var mh=h((EQ,BA)=>{var yh=Ue(),es=Xi(),{JWSInvalid:ts}=$();es=es.bind(void 0,ts);var PA=(e,[t])=>`${t.protected}.${e}.${t.signature}`;PA.validate=(e,{0:{unprotectedHeader:t,protectedHeader:r},length:n})=>{if(n!==1||t)throw new ts("JWS Compact Serialization doesn't support multiple recipients or JWS unprotected headers");es(r,t,r?r.crit:void 0)};var RA=(e,[t])=>{let{header:r,signature:n,protected:i}=t;return{payload:e,...i?{protected:i}:void 0,...r?{header:r}:void 0,signature:n}};RA.validate=(e,{0:{unprotectedHeader:t,protectedHeader:r},length:n})=>{if(n!==1)throw new ts("Flattened JWS JSON Serialization doesn't support multiple recipients");es(r,t,r?r.crit:void 0)};var KA=(e,t)=>({payload:e,signatures:t.map(({header:r,signature:n,protected:i})=>({...i?{protected:i}:void 0,...r?{header:r}:void 0,signature:n}))});KA.validate=(e,t)=>{let r=!1;if(t.forEach(({protectedHeader:n,unprotectedHeader:i})=>{n&&!r&&"b64"in n&&(r=!0),es(n,i,n?n.crit:void 0)}),r&&!t.map(({protectedHeader:i})=>i&&i.b64).every((i,s,[o])=>i===o))throw new ts('the "b64" Header Parameter value MUST be the same for all recipients')};var n4=e=>yh(e)&&(typeof e.payload=="string"||Buffer.isBuffer(e.payload)),IA=e=>yh(e)&&typeof e.signature=="string"&&(e.header===void 0||yh(e.header))&&(e.protected===void 0||typeof e.protected=="string"),i4=e=>!!(Array.isArray(e.signatures)&&e.signatures.every(IA)),s4=e=>{if(typeof e=="string"&&e.split(".").length===3)return"compact";if(n4(e)){if(i4(e))return"general";if(IA(e))return"flattened"}throw new ts("JWS malformed or invalid serialization")};BA.exports={compact:PA,flattened:RA,general:KA,detect:s4}});var DA=h((vQ,MA)=>{var Mr=ve(),o4=Cc(),gh=Ue(),NA=Yd(),{JWSInvalid:_h}=$(),{sign:c4}=Vi(),a4=jr(),u4=mh(),jA=Symbol("PROCESS_RECIPIENT"),wh=class{constructor(t){if(typeof t=="string")t=Mr.encode(t);else if(Buffer.isBuffer(t))t=Mr.encodeBuffer(t),this._binary=!0;else if(gh(t))t=Mr.JSON.encode(t);else throw new TypeError("payload argument must be a Buffer, string or an object");this._payload=t,this._recipients=[]}recipient(t,r,n){if(t=a4(t),r!==void 0&&!gh(r))throw new TypeError("protectedHeader argument must be a plain object when provided");if(n!==void 0&&!gh(n))throw new TypeError("unprotectedHeader argument must be a plain object when provided");if(!o4(r,n))throw new _h("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");return this._recipients.push({key:t,protectedHeader:r?NA(r):void 0,unprotectedHeader:n?NA(n):void 0}),this}[jA](t,r){let{key:n,protectedHeader:i,unprotectedHeader:s}=t;if(n.use==="enc")throw new TypeError('a key with "use":"enc" is not usable for signing');let o={protected:i||{},unprotected:s||{}},c=o.protected.alg||o.unprotected.alg;if(c||(c=n.alg||[...n.algorithms("sign")][0],t.protectedHeader?o.protected.alg=t.protectedHeader.alg=c:o.protected=t.protectedHeader={alg:c}),!c)throw new _h('could not resolve a usable "alg" for a recipient');t.header=s,t.protected=Object.keys(o.protected).length?Mr.JSON.encode(o.protected):"",r&&o.protected.crit&&o.protected.crit.includes("b64")&&o.protected.b64===!1&&(this._binary?this._payload=Mr.decodeToBuffer(this._payload):this._payload=Mr.decode(this._payload));let a=Buffer.concat([Buffer.from(t.protected||""),Buffer.from("."),Buffer.from(this._payload)]);t.signature=Mr.encodeBuffer(c4(c,n,a))}sign(t){let r=u4[t];if(!r)throw new TypeError('serialization must be one of "compact", "flattened", "general"');if(!this._recipients.length)throw new _h("missing recipients");return r.validate(this,this._recipients),this._recipients.forEach((n,i)=>{this[jA](n,i===0)}),r(this._payload,this._recipients)}};MA.exports=wh});var vh=h((SQ,JA)=>{var{EOL:bh}=g("os"),Rc=ve(),l4=Cc(),f4=Ue(),Eh=Xi(),d4=jr(),{KeyStore:h4}=Pc(),fe=$(),{check:p4,verify:y4}=Vi(),Kc=Gi(),{detect:m4}=mh();Eh=Eh.bind(void 0,fe.JWSInvalid);var g4=new Set(["compact","flattened","preparsed"]),Ic=(e,t,r,n,{crit:i=[],complete:s=!1,algorithms:o,parse:c=!0,encoding:a="utf8"}={})=>{if(n=d4(n,!0),o!==void 0&&(!Array.isArray(o)||o.some(v=>typeof v!="string"||!v)))throw new TypeError('"algorithms" option must be an array of non-empty strings');if(o&&(o=new Set(o)),!Array.isArray(i)||i.some(v=>typeof v!="string"||!v))throw new TypeError('"crit" option must be an array of non-empty strings');t||(t=m4(r));let l,f,u,d,p;if(t==="general"&&r.signatures.length===1){t="flattened";let{signatures:v,...S}=r;r={...S,...v[0]}}let m;if(g4.has(t)){let v={};switch(t){case"compact":[l,u,d]=r.split(".");break;case"flattened":({protected:l,payload:u,signature:d,header:f}=r);break;case"preparsed":{({decoded:m}=r),[l,u,d]=r.token.split(".");break}}if(f||(e=!0),m)v=m.header;else if(l)try{v=Rc.JSON.decode(l)}catch{throw new fe.JWSInvalid("could not parse JWS protected header")}else e=e||!0;if(!e&&!l4(v,f))throw new fe.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let S={...v,...f};if(Eh(v,f,i),p=v.alg||f&&f.alg,p){if(o&&!o.has(p))throw new fe.JOSEAlgNotWhitelisted("alg not whitelisted")}else throw new fe.JWSInvalid("missing JWS signature algorithm");if(n instanceof h4){let q=n.all({kid:S.kid,alg:S.alg,key_ops:["verify"]});switch(q.length){case 0:throw new fe.JWKSNoMatchingKey;case 1:n=q[0];break;default:{let T=[];for(let k of q)try{return Ic(!0,t,r,k,{crit:i,complete:s,encoding:a,parse:c,algorithms:o?[...o]:void 0})}catch(ee){T.push(ee);continue}let R=new fe.JOSEMultiError(T);throw[...R].some(k=>k instanceof fe.JWSVerificationFailed)?new fe.JWSVerificationFailed:R}}}if(n===Kc.EmbeddedJWK){if(!f4(S.jwk))throw new fe.JWSInvalid('JWS Header Parameter "jwk" must be a JSON object');if(n=Kc.asKey(S.jwk),n.type!=="public")throw new fe.JWSInvalid('JWS Header Parameter "jwk" must be a public key')}else if(n===Kc.EmbeddedX5C){if(!Array.isArray(S.x5c)||!S.x5c.length||S.x5c.some(x=>typeof x!="string"||!x))throw new fe.JWSInvalid('JWS Header Parameter "x5c" must be a JSON array of certificate value strings');n=Kc.asKey(`-----BEGIN CERTIFICATE-----${bh}${(S.x5c[0].match(/.{1,64}/g)||[]).join(bh)}${bh}-----END CERTIFICATE-----`,{x5c:S.x5c})}p4(n,"verify",p);let E=Buffer.concat([Buffer.from(l||""),Buffer.from("."),Buffer.isBuffer(u)?u:Buffer.from(u)]);if(!y4(p,n,E,Rc.decodeToBuffer(d)))throw new fe.JWSVerificationFailed;if((!S.crit||!S.crit.includes("b64")||S.b64)&&(c?u=m?m.payload:Rc.JSON.decode.try(u,a):u=Rc.decodeToBuffer(u)),s){let x={payload:u,key:n};return l&&(x.protected=v),f&&(x.header=f),x}return u}let{signatures:y,..._}=r,b=[];for(let v of y)try{return Ic(!1,"flattened",{..._,...v},n,{crit:i,complete:s,encoding:a,parse:c,algorithms:o?[...o]:void 0})}catch(S){b.push(S);continue}let w=new fe.JOSEMultiError(b);throw[...w].some(v=>v instanceof fe.JWSVerificationFailed)?new fe.JWSVerificationFailed:[...w].every(v=>v instanceof fe.JWKSNoMatchingKey)?new fe.JWKSNoMatchingKey:w};JA.exports={bare:Ic,verify:Ic.bind(void 0,!1,void 0)}});var xh=h((xQ,Kn)=>{var LA=DA(),{verify:_4}=vh(),Sh=(e,t,r,n,i)=>new LA(t).recipient(r,n,i).sign(e);Kn.exports.Sign=LA;Kn.exports.sign=Sh.bind(void 0,"compact");Kn.exports.sign.flattened=Sh.bind(void 0,"flattened");Kn.exports.sign.general=Sh.bind(void 0,"general");Kn.exports.verify=_4});var Th=h((TQ,WA)=>{var $A=ve(),UA=$();WA.exports=(e,{complete:t=!1}={})=>{if(typeof e!="string"||!e)throw new TypeError("JWT must be a string");let{0:r,1:n,2:i,length:s}=e.split(".");if(s===5)throw new TypeError("JWTs must be decrypted first");if(s!==3)throw new UA.JWTMalformed("JWTs must have three components");try{let o={header:$A.JSON.decode(r),payload:$A.JSON.decode(n),signature:i};return t?o:o.payload}catch{throw new UA.JWTMalformed("JWT is malformed")}}});var Ah=h((AQ,HA)=>{var w4=/^(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)$/i;HA.exports=e=>{let t=w4.exec(e);if(!t)throw new TypeError(`invalid time period format ("${e}")`);let r=parseFloat(t[1]);switch(t[2].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":return Math.round(r);case"minute":case"minutes":case"min":case"mins":case"m":return Math.round(r*60);case"hour":case"hours":case"hr":case"hrs":case"h":return Math.round(r*3600);case"day":case"days":case"d":return Math.round(r*86400);case"week":case"weeks":case"w":return Math.round(r*604800);case"year":case"years":case"yr":case"yrs":case"y":return Math.round(r*31557600)}}});var qh=h((qQ,FA)=>{FA.exports=e=>Math.floor(e.getTime()/1e3)});var kh=h((OQ,Oh)=>{var GA=e=>typeof e!="string"||e.length===0;Oh.exports.isNotString=GA;Oh.exports.isString=function(t,r,n,i,s=!1){if(s&&r===void 0)throw new t(`${n} is missing`,i,"missing");if(r!==void 0&&GA(r))throw new t(`${n} must be a string`,i,"invalid")}});var VA=h((kQ,YA)=>{var Ch=Ue(),zA=Ah(),b4=qh(),E4=jr(),v4=xh(),Dr=kh().isString.bind(void 0,TypeError),S4=e=>{if(typeof e.iat!="boolean")throw new TypeError("options.iat must be a boolean");if(typeof e.kid!="boolean")throw new TypeError("options.kid must be a boolean");if(Dr(e.subject,"options.subject"),Dr(e.issuer,"options.issuer"),e.audience!==void 0&&(typeof e.audience!="string"||!e.audience)&&(!Array.isArray(e.audience)||e.audience.length===0||e.audience.some(t=>!t||typeof t!="string")))throw new TypeError("options.audience must be a string or an array of strings");if(!Ch(e.header))throw new TypeError("options.header must be an object");if(Dr(e.algorithm,"options.algorithm"),Dr(e.expiresIn,"options.expiresIn"),Dr(e.notBefore,"options.notBefore"),Dr(e.jti,"options.jti"),Dr(e.nonce,"options.nonce"),e.now!==void 0&&(!(e.now instanceof Date)||!e.now.getTime()))throw new TypeError("options.now must be a valid Date object")};YA.exports=(e,t,r={})=>{if(!Ch(r))throw new TypeError("options must be an object");let{algorithm:n,audience:i,expiresIn:s,header:o={},iat:c=!0,issuer:a,jti:l,kid:f=!0,nonce:u,notBefore:d,subject:p,now:m}=r;if(S4({algorithm:n,audience:i,expiresIn:s,header:o,iat:c,issuer:a,jti:l,kid:f,nonce:u,notBefore:d,now:m,subject:p}),!Ch(e))throw new TypeError("payload must be an object");let y;(s||d||c)&&(y=b4(m||new Date)),e={...e,sub:p||e.sub,aud:i||e.aud,iss:a||e.iss,jti:l||e.jti,iat:c?y:e.iat,nonce:u||e.nonce,exp:s?y+zA(s):e.exp,nbf:d?y+zA(d):e.nbf},t=E4(t);let _;return typeof r.kid=="boolean"?_=f:_=!t.secret,v4.sign(JSON.stringify(e),t,{...o,alg:n||o.alg,kid:_?t.kid:o.kid})}});var Ih=h((CQ,tq)=>{var Kh=Ue(),x4=qh(),Ph=Ah(),T4=jr(),{bare:XA}=vh(),{JWTClaimInvalid:F,JWTExpired:QA}=$(),{isString:eq,isNotString:jc}=kh(),A4=Th(),Jt=eq.bind(void 0,F),ur=eq.bind(void 0,TypeError),In="id_token",Nc="logout_token",Jr="at+JWT",Bc=(e,t,r=!1)=>{if(r&&e===void 0)throw new F(`"${t}" claim is missing`,t,"missing");if(e!==void 0&&typeof e!="number")throw new F(`"${t}" claim must be a JSON numeric value`,t,"invalid")},Rh=(e,t,r=!1)=>{if(r&&e===void 0)throw new F(`"${t}" claim is missing`,t,"missing");if(e!==void 0&&jc(e)&&rs(e))throw new F(`"${t}" claim must be a string or array of strings`,t,"invalid")},rs=e=>!Array.isArray(e)||e.length===0||e.some(jc),ZA=e=>e.toLowerCase().replace(/^application\//,""),q4=({algorithms:e,audience:t,clockTolerance:r,complete:n=!1,crit:i,ignoreExp:s=!1,ignoreIat:o=!1,ignoreNbf:c=!1,issuer:a,jti:l,maxAuthAge:f,maxTokenAge:u,nonce:d,now:p=new Date,profile:m,subject:y,typ:_})=>{if(ur(m,"options.profile"),typeof n!="boolean")throw new TypeError("options.complete must be a boolean");if(typeof s!="boolean")throw new TypeError("options.ignoreExp must be a boolean");if(typeof c!="boolean")throw new TypeError("options.ignoreNbf must be a boolean");if(typeof o!="boolean")throw new TypeError("options.ignoreIat must be a boolean");if(ur(u,"options.maxTokenAge"),ur(y,"options.subject"),ur(f,"options.maxAuthAge"),ur(l,"options.jti"),ur(r,"options.clockTolerance"),ur(_,"options.typ"),a!==void 0&&jc(a)&&rs(a))throw new TypeError("options.issuer must be a string or an array of strings");if(t!==void 0&&jc(t)&&rs(t))throw new TypeError("options.audience must be a string or an array of strings");if(e!==void 0&&rs(e))throw new TypeError("options.algorithms must be an array of strings");if(ur(d,"options.nonce"),!(p instanceof Date)||!p.getTime())throw new TypeError("options.now must be a valid Date object");if(o&&u!==void 0)throw new TypeError("options.ignoreIat and options.maxTokenAge cannot used together");if(i!==void 0&&rs(i))throw new TypeError("options.crit must be an array of strings");switch(m){case In:if(!a)throw new TypeError('"issuer" option is required to validate an ID Token');if(!t)throw new TypeError('"audience" option is required to validate an ID Token');break;case Jr:if(!a)throw new TypeError('"issuer" option is required to validate a JWT Access Token');if(!t)throw new TypeError('"audience" option is required to validate a JWT Access Token');_=Jr;break;case Nc:if(!a)throw new TypeError('"issuer" option is required to validate a Logout Token');if(!t)throw new TypeError('"audience" option is required to validate a Logout Token');break;case void 0:break;default:throw new TypeError(`unsupported options.profile value "${m}"`)}return{algorithms:e,audience:t,clockTolerance:r,complete:n,crit:i,ignoreExp:s,ignoreIat:o,ignoreNbf:c,issuer:a,jti:l,maxAuthAge:f,maxTokenAge:u,nonce:d,now:p,profile:m,subject:y,typ:_}},O4=({header:e,payload:t},r,n)=>{if(Jt(e.alg,'"alg" header parameter',"alg",!0),Bc(t.iat,"iat",r===In||r===Nc||r===Jr||!!n.maxTokenAge),Bc(t.exp,"exp",r===In||r===Jr),Bc(t.auth_time,"auth_time",!!n.maxAuthAge),Bc(t.nbf,"nbf"),Jt(t.jti,'"jti" claim',"jti",r===Nc||r===Jr||!!n.jti),Jt(t.acr,'"acr" claim',"acr"),Jt(t.nonce,'"nonce" claim',"nonce",!!n.nonce),Rh(t.iss,"iss",!!n.issuer),Jt(t.sub,'"sub" claim',"sub",r===In||r===Jr||!!n.subject),Rh(t.aud,"aud",!!n.audience),Jt(t.azp,'"azp" claim',"azp",r===In&&Array.isArray(t.aud)&&t.aud.length>1),Rh(t.amr,"amr"),Jt(e.typ,'"typ" header parameter',"typ",!!n.typ),r===Jr&&Jt(t.client_id,'"client_id" claim',"client_id",!0),r===Nc){if(Jt(t.sid,'"sid" claim',"sid"),!("sid"in t)&&!("sub"in t))throw new F('either "sid" or "sub" (or both) claims must be present');if("nonce"in t)throw new F('"nonce" claim is prohibited',"nonce","prohibited");if(!("events"in t))throw new F('"events" claim is missing',"events","missing");if(!Kh(t.events))throw new F('"events" claim must be an object',"events","invalid");if(!("http://schemas.openid.net/event/backchannel-logout"in t.events))throw new F('"http://schemas.openid.net/event/backchannel-logout" member is missing in the "events" claim',"events","invalid");if(!Kh(t.events["http://schemas.openid.net/event/backchannel-logout"]))throw new F('"http://schemas.openid.net/event/backchannel-logout" member in the "events" claim must be an object',"events","invalid")}},k4=(e,t,r)=>typeof e=="string"?t.includes(e):(e=new Set(e),t.some(Set.prototype.has.bind(e)));tq.exports=(e,t,r={})=>{if(!Kh(r))throw new TypeError("options must be an object");let{algorithms:n,audience:i,clockTolerance:s,complete:o,crit:c,ignoreExp:a,ignoreIat:l,ignoreNbf:f,issuer:u,jti:d,maxAuthAge:p,maxTokenAge:m,nonce:y,now:_,profile:b,subject:w,typ:v}=r=q4(r),S=A4(e,{complete:!0});t=T4(t,!0),o?({key:t}=XA(!0,"preparsed",{decoded:S,token:e},t,{crit:c,algorithms:n,complete:!0}),S.key=t):XA(!0,"preparsed",{decoded:S,token:e},t,{crit:c,algorithms:n});let E=x4(_);if(O4(S,b,r),u&&(typeof S.payload.iss!="string"||!(typeof u=="string"?[u]:u).includes(S.payload.iss)))throw new F('unexpected "iss" claim value',"iss","check_failed");if(y&&S.payload.nonce!==y)throw new F('unexpected "nonce" claim value',"nonce","check_failed");if(w&&S.payload.sub!==w)throw new F('unexpected "sub" claim value',"sub","check_failed");if(d&&S.payload.jti!==d)throw new F('unexpected "jti" claim value',"jti","check_failed");if(i&&!k4(S.payload.aud,typeof i=="string"?[i]:i,b))throw new F('unexpected "aud" claim value',"aud","check_failed");if(v&&ZA(S.header.typ)!==ZA(v))throw new F('unexpected "typ" JWT header value',"typ","check_failed");let x=s?Ph(s):0;if(p){let q=Ph(p);if(S.payload.auth_time+q<E-x)throw new F('"auth_time" claim timestamp check failed (too much time has elapsed since the last End-User authentication)',"auth_time","check_failed")}if(!l&&!("exp"in S.payload)&&"iat"in S.payload&&S.payload.iat>E+x)throw new F('"iat" claim timestamp check failed (it should be in the past)',"iat","check_failed");if(!f&&"nbf"in S.payload&&S.payload.nbf>E+x)throw new F('"nbf" claim timestamp check failed',"nbf","check_failed");if(!a&&"exp"in S.payload&&S.payload.exp<=E-x)throw new QA('"exp" claim timestamp check failed',"exp","check_failed");if(m){let q=E-S.payload.iat,T=Ph(m);if(q-x>T)throw new QA('"iat" claim timestamp check failed (too far in the past)',"iat","check_failed");if(q<0-x)throw new F('"iat" claim timestamp check failed (it should be in the past)',"iat","check_failed")}if(b===In&&Array.isArray(S.payload.aud)&&S.payload.aud.length>1&&S.payload.azp!==i)throw new F('unexpected "azp" claim value',"azp","check_failed");return o?S:S.payload}});var nq=h((PQ,rq)=>{var Bh=Ih();rq.exports={IdToken:{verify:(e,t,r)=>Bh(e,t,{...r,profile:"id_token"})},LogoutToken:{verify:(e,t,r)=>Bh(e,t,{...r,profile:"logout_token"})},AccessToken:{verify:(e,t,r)=>Bh(e,t,{...r,profile:"at+JWT"})}}});var sq=h((RQ,iq)=>{var C4=Th(),P4=VA(),R4=Ih(),K4=nq();iq.exports={decode:C4,sign:P4,verify:R4,...K4}});var Mc=h((KQ,oq)=>{oq.exports={JWE:CA(),JWK:Gi(),JWKS:Pc(),JWS:xh(),JWT:sq(),errors:$()}});var aq=h((IQ,cq)=>{"use strict";cq.exports=(e,t=1,r)=>{if(r={indent:" ",includeEmptyLines:!1,...r},typeof e!="string")throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof e}\``);if(typeof t!="number")throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof t}\``);if(typeof r.indent!="string")throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof r.indent}\``);if(t===0)return e;let n=r.includeEmptyLines?/^/gm:/^(?!\s*$)/gm;return e.replace(n,r.indent.repeat(t))}});var dq=h((BQ,fq)=>{"use strict";var uq=g("os"),lq=/\s+at.*(?:\(|\s)(.*)\)?/,I4=/^(?:(?:(?:node|(?:internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)\.js:\d+:\d+)|native)/,B4=typeof uq.homedir>"u"?"":uq.homedir();fq.exports=(e,t)=>(t=Object.assign({pretty:!1},t),e.replace(/\\/g,"/").split(`
`).filter(r=>{let n=r.match(lq);if(n===null||!n[1])return!0;let i=n[1];return i.includes(".app/Contents/Resources/electron.asar")||i.includes(".app/Contents/Resources/default_app.asar")?!1:!I4.test(i)}).filter(r=>r.trim()!=="").map(r=>t.pretty?r.replace(lq,(n,i)=>n.replace(i,i.replace(B4,"~"))):r).join(`
`))});var pq=h((NQ,hq)=>{"use strict";var N4=aq(),j4=dq(),M4=e=>e.replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,""),Nh=class extends Error{constructor(t){if(!Array.isArray(t))throw new TypeError(`Expected input to be an Array, got ${typeof t}`);t=[...t].map(n=>n instanceof Error?n:n!==null&&typeof n=="object"?Object.assign(new Error(n.message),n):new Error(n));let r=t.map(n=>typeof n.stack=="string"?M4(j4(n.stack)):String(n)).join(`
`);r=`
`+N4(r,4),super(r),this.name="AggregateError",Object.defineProperty(this,"_errors",{value:t})}*[Symbol.iterator](){for(let t of this._errors)yield t}};hq.exports=Nh});var yq=h((jQ,jh)=>{"use strict";var Dc=class extends Error{constructor(t){super(t||"Promise was canceled"),this.name="CancelError"}get isCanceled(){return!0}},Bn=class{static fn(t){return(...r)=>new Bn((n,i,s)=>{r.push(s),t(...r).then(n,i)})}constructor(t){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise((r,n)=>{this._reject=n;let i=c=>{(!this._isCanceled||!o.shouldReject)&&(this._isPending=!1,r(c))},s=c=>{this._isPending=!1,n(c)},o=c=>{if(!this._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");this._cancelHandlers.push(c)};return Object.defineProperties(o,{shouldReject:{get:()=>this._rejectOnCancel,set:c=>{this._rejectOnCancel=c}}}),t(i,s,o)})}then(t,r){return this._promise.then(t,r)}catch(t){return this._promise.catch(t)}finally(t){return this._promise.finally(t)}cancel(t){if(!(!this._isPending||this._isCanceled)){if(this._isCanceled=!0,this._cancelHandlers.length>0)try{for(let r of this._cancelHandlers)r()}catch(r){this._reject(r);return}this._rejectOnCancel&&this._reject(new Dc(t))}}get isCanceled(){return this._isCanceled}};Object.setPrototypeOf(Bn.prototype,Promise.prototype);jh.exports=Bn;jh.exports.CancelError=Dc});var gq=h((MQ,Lc)=>{"use strict";var mq=pq(),D4=yq(),Jc=class extends Error{},J4=(e,t)=>new D4((r,n,i)=>{let{count:s,filter:o=()=>!0}=t;if(!Number.isFinite(s)){n(new TypeError(`Expected a finite number, got ${typeof t.count}`));return}let c=[],a=[],l=0,f=!1,u=new Set,d=()=>(c.length===s&&(r(c),f=!0),l-a.length<s&&(n(new mq(a)),f=!0),f),p=()=>{for(let m of e)!u.has(m)&&typeof m.cancel=="function"&&m.cancel()};i(p);for(let m of e)l++,(async()=>{try{let y=await m;if(f)return;if(!o(y))throw new Jc("Value does not satisfy filter");c.push(y)}catch(y){a.push(y)}finally{u.add(m),!f&&d()&&p()}})();s>l&&(n(new RangeError(`Expected input to contain at least ${t.count} items, but contains ${l} items`)),p())});Lc.exports=J4;Lc.exports.AggregateError=mq;Lc.exports.FilterError=Jc});var _q=h((DQ,Mh)=>{"use strict";var $c=class extends Error{constructor(t){super(t||"Promise was canceled"),this.name="CancelError"}get isCanceled(){return!0}},Nn=class{static fn(t){return(...r)=>new Nn((n,i,s)=>{r.push(s),t(...r).then(n,i)})}constructor(t){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise((r,n)=>{this._reject=n;let i=c=>{(!this._isCanceled||!o.shouldReject)&&(this._isPending=!1,r(c))},s=c=>{this._isPending=!1,n(c)},o=c=>{if(!this._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");this._cancelHandlers.push(c)};return Object.defineProperties(o,{shouldReject:{get:()=>this._rejectOnCancel,set:c=>{this._rejectOnCancel=c}}}),t(i,s,o)})}then(t,r){return this._promise.then(t,r)}catch(t){return this._promise.catch(t)}finally(t){return this._promise.finally(t)}cancel(t){if(!(!this._isPending||this._isCanceled)){if(this._isCanceled=!0,this._cancelHandlers.length>0)try{for(let r of this._cancelHandlers)r()}catch(r){this._reject(r);return}this._rejectOnCancel&&this._reject(new $c(t))}}get isCanceled(){return this._isCanceled}};Object.setPrototypeOf(Nn.prototype,Promise.prototype);Mh.exports=Nn;Mh.exports.CancelError=$c});var bq=h((JQ,Dh)=>{"use strict";var wq=gq(),L4=_q();Dh.exports=(e,t)=>{let r=wq(e,{...t,count:1});return L4.fn(async n=>{n(()=>{r.cancel()});let[i]=await r;return i})()};Dh.exports.AggregateError=wq.AggregateError});var vq=h((LQ,Eq)=>{"use strict";Eq.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}}});var xq=h(($Q,Sq)=>{"use strict";Sq.exports=M;M.Node=Lr;M.create=M;function M(e){var t=this;if(t instanceof M||(t=new M),t.tail=null,t.head=null,t.length=0,e&&typeof e.forEach=="function")e.forEach(function(i){t.push(i)});else if(arguments.length>0)for(var r=0,n=arguments.length;r<n;r++)t.push(arguments[r]);return t}M.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,r=e.prev;return t&&(t.prev=r),r&&(r.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=r),e.list.length--,e.next=null,e.prev=null,e.list=null,t};M.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}};M.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}};M.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)U4(this,arguments[e]);return this.length};M.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)W4(this,arguments[e]);return this.length};M.prototype.pop=function(){if(!!this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}};M.prototype.shift=function(){if(!!this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}};M.prototype.forEach=function(e,t){t=t||this;for(var r=this.head,n=0;r!==null;n++)e.call(t,r.value,n,this),r=r.next};M.prototype.forEachReverse=function(e,t){t=t||this;for(var r=this.tail,n=this.length-1;r!==null;n--)e.call(t,r.value,n,this),r=r.prev};M.prototype.get=function(e){for(var t=0,r=this.head;r!==null&&t<e;t++)r=r.next;if(t===e&&r!==null)return r.value};M.prototype.getReverse=function(e){for(var t=0,r=this.tail;r!==null&&t<e;t++)r=r.prev;if(t===e&&r!==null)return r.value};M.prototype.map=function(e,t){t=t||this;for(var r=new M,n=this.head;n!==null;)r.push(e.call(t,n.value,this)),n=n.next;return r};M.prototype.mapReverse=function(e,t){t=t||this;for(var r=new M,n=this.tail;n!==null;)r.push(e.call(t,n.value,this)),n=n.prev;return r};M.prototype.reduce=function(e,t){var r,n=this.head;if(arguments.length>1)r=t;else if(this.head)n=this.head.next,r=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=0;n!==null;i++)r=e(r,n.value,i),n=n.next;return r};M.prototype.reduceReverse=function(e,t){var r,n=this.tail;if(arguments.length>1)r=t;else if(this.tail)n=this.tail.prev,r=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=this.length-1;n!==null;i--)r=e(r,n.value,i),n=n.prev;return r};M.prototype.toArray=function(){for(var e=new Array(this.length),t=0,r=this.head;r!==null;t++)e[t]=r.value,r=r.next;return e};M.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,r=this.tail;r!==null;t++)e[t]=r.value,r=r.prev;return e};M.prototype.slice=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var r=new M;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var n=0,i=this.head;i!==null&&n<e;n++)i=i.next;for(;i!==null&&n<t;n++,i=i.next)r.push(i.value);return r};M.prototype.sliceReverse=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var r=new M;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var n=this.length,i=this.tail;i!==null&&n>t;n--)i=i.prev;for(;i!==null&&n>e;n--,i=i.prev)r.push(i.value);return r};M.prototype.splice=function(e,t,...r){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,i=this.head;i!==null&&n<e;n++)i=i.next;for(var s=[],n=0;i&&n<t;n++)s.push(i.value),i=this.removeNode(i);i===null&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var n=0;n<r.length;n++)i=$4(this,i,r[n]);return s};M.prototype.reverse=function(){for(var e=this.head,t=this.tail,r=e;r!==null;r=r.prev){var n=r.prev;r.prev=r.next,r.next=n}return this.head=t,this.tail=e,this};function $4(e,t,r){var n=t===e.head?new Lr(r,null,t,e):new Lr(r,t,t.next,e);return n.next===null&&(e.tail=n),n.prev===null&&(e.head=n),e.length++,n}function U4(e,t){e.tail=new Lr(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function W4(e,t){e.head=new Lr(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function Lr(e,t,r,n){if(!(this instanceof Lr))return new Lr(e,t,r,n);this.list=n,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}try{vq()(M)}catch{}});var kq=h((UQ,Oq)=>{"use strict";var H4=xq(),$r=Symbol("max"),$t=Symbol("length"),jn=Symbol("lengthCalculator"),is=Symbol("allowStale"),Ur=Symbol("maxAge"),Lt=Symbol("dispose"),Tq=Symbol("noDisposeOnSet"),de=Symbol("lruList"),lt=Symbol("cache"),qq=Symbol("updateAgeOnGet"),Jh=()=>1,$h=class{constructor(t){if(typeof t=="number"&&(t={max:t}),t||(t={}),t.max&&(typeof t.max!="number"||t.max<0))throw new TypeError("max must be a non-negative number");let r=this[$r]=t.max||1/0,n=t.length||Jh;if(this[jn]=typeof n!="function"?Jh:n,this[is]=t.stale||!1,t.maxAge&&typeof t.maxAge!="number")throw new TypeError("maxAge must be a number");this[Ur]=t.maxAge||0,this[Lt]=t.dispose,this[Tq]=t.noDisposeOnSet||!1,this[qq]=t.updateAgeOnGet||!1,this.reset()}set max(t){if(typeof t!="number"||t<0)throw new TypeError("max must be a non-negative number");this[$r]=t||1/0,ns(this)}get max(){return this[$r]}set allowStale(t){this[is]=!!t}get allowStale(){return this[is]}set maxAge(t){if(typeof t!="number")throw new TypeError("maxAge must be a non-negative number");this[Ur]=t,ns(this)}get maxAge(){return this[Ur]}set lengthCalculator(t){typeof t!="function"&&(t=Jh),t!==this[jn]&&(this[jn]=t,this[$t]=0,this[de].forEach(r=>{r.length=this[jn](r.value,r.key),this[$t]+=r.length})),ns(this)}get lengthCalculator(){return this[jn]}get length(){return this[$t]}get itemCount(){return this[de].length}rforEach(t,r){r=r||this;for(let n=this[de].tail;n!==null;){let i=n.prev;Aq(this,t,n,r),n=i}}forEach(t,r){r=r||this;for(let n=this[de].head;n!==null;){let i=n.next;Aq(this,t,n,r),n=i}}keys(){return this[de].toArray().map(t=>t.key)}values(){return this[de].toArray().map(t=>t.value)}reset(){this[Lt]&&this[de]&&this[de].length&&this[de].forEach(t=>this[Lt](t.key,t.value)),this[lt]=new Map,this[de]=new H4,this[$t]=0}dump(){return this[de].map(t=>Uc(this,t)?!1:{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[de]}set(t,r,n){if(n=n||this[Ur],n&&typeof n!="number")throw new TypeError("maxAge must be a number");let i=n?Date.now():0,s=this[jn](r,t);if(this[lt].has(t)){if(s>this[$r])return Mn(this,this[lt].get(t)),!1;let a=this[lt].get(t).value;return this[Lt]&&(this[Tq]||this[Lt](t,a.value)),a.now=i,a.maxAge=n,a.value=r,this[$t]+=s-a.length,a.length=s,this.get(t),ns(this),!0}let o=new Uh(t,r,s,i,n);return o.length>this[$r]?(this[Lt]&&this[Lt](t,r),!1):(this[$t]+=o.length,this[de].unshift(o),this[lt].set(t,this[de].head),ns(this),!0)}has(t){if(!this[lt].has(t))return!1;let r=this[lt].get(t).value;return!Uc(this,r)}get(t){return Lh(this,t,!0)}peek(t){return Lh(this,t,!1)}pop(){let t=this[de].tail;return t?(Mn(this,t),t.value):null}del(t){Mn(this,this[lt].get(t))}load(t){this.reset();let r=Date.now();for(let n=t.length-1;n>=0;n--){let i=t[n],s=i.e||0;if(s===0)this.set(i.k,i.v);else{let o=s-r;o>0&&this.set(i.k,i.v,o)}}}prune(){this[lt].forEach((t,r)=>Lh(this,r,!1))}},Lh=(e,t,r)=>{let n=e[lt].get(t);if(n){let i=n.value;if(Uc(e,i)){if(Mn(e,n),!e[is])return}else r&&(e[qq]&&(n.value.now=Date.now()),e[de].unshiftNode(n));return i.value}},Uc=(e,t)=>{if(!t||!t.maxAge&&!e[Ur])return!1;let r=Date.now()-t.now;return t.maxAge?r>t.maxAge:e[Ur]&&r>e[Ur]},ns=e=>{if(e[$t]>e[$r])for(let t=e[de].tail;e[$t]>e[$r]&&t!==null;){let r=t.prev;Mn(e,t),t=r}},Mn=(e,t)=>{if(t){let r=t.value;e[Lt]&&e[Lt](r.key,r.value),e[$t]-=r.length,e[lt].delete(r.key),e[de].removeNode(t)}},Uh=class{constructor(t,r,n,i,s){this.key=t,this.value=r,this.length=n,this.now=i,this.maxAge=s||0}},Aq=(e,t,r,n)=>{let i=r.value;Uc(e,i)&&(Mn(e,r),e[is]||(i=void 0)),i&&t.call(n,i.value,i.key,e)};Oq.exports=$h});var Bq=h((Wr,Iq)=>{"use strict";var Wh=g("crypto");Wr=Iq.exports=ss;function ss(e,t){return t=Rq(e,t),F4(e,t)}Wr.sha1=function(e){return ss(e)};Wr.keys=function(e){return ss(e,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})};Wr.MD5=function(e){return ss(e,{algorithm:"md5",encoding:"hex"})};Wr.keysMD5=function(e){return ss(e,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var Dn=Wh.getHashes?Wh.getHashes().slice():["sha1","md5"];Dn.push("passthrough");var Cq=["buffer","hex","binary","base64"];function Rq(e,t){t=t||{};var r={};if(r.algorithm=t.algorithm||"sha1",r.encoding=t.encoding||"hex",r.excludeValues=!!t.excludeValues,r.algorithm=r.algorithm.toLowerCase(),r.encoding=r.encoding.toLowerCase(),r.ignoreUnknown=t.ignoreUnknown===!0,r.respectType=t.respectType!==!1,r.respectFunctionNames=t.respectFunctionNames!==!1,r.respectFunctionProperties=t.respectFunctionProperties!==!1,r.unorderedArrays=t.unorderedArrays===!0,r.unorderedSets=t.unorderedSets!==!1,r.unorderedObjects=t.unorderedObjects!==!1,r.replacer=t.replacer||void 0,r.excludeKeys=t.excludeKeys||void 0,typeof e>"u")throw new Error("Object argument required.");for(var n=0;n<Dn.length;++n)Dn[n].toLowerCase()===r.algorithm.toLowerCase()&&(r.algorithm=Dn[n]);if(Dn.indexOf(r.algorithm)===-1)throw new Error('Algorithm "'+r.algorithm+'"  not supported. supported values: '+Dn.join(", "));if(Cq.indexOf(r.encoding)===-1&&r.algorithm!=="passthrough")throw new Error('Encoding "'+r.encoding+'"  not supported. supported values: '+Cq.join(", "));return r}function Pq(e){if(typeof e!="function")return!1;var t=/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i;return t.exec(Function.prototype.toString.call(e))!=null}function F4(e,t){var r;t.algorithm!=="passthrough"?r=Wh.createHash(t.algorithm):r=new Kq,typeof r.write>"u"&&(r.write=r.update,r.end=r.update);var n=Hh(t,r);if(n.dispatch(e),r.update||r.end(""),r.digest)return r.digest(t.encoding==="buffer"?void 0:t.encoding);var i=r.read();return t.encoding==="buffer"?i:i.toString(t.encoding)}Wr.writeToStream=function(e,t,r){return typeof r>"u"&&(r=t,t={}),t=Rq(e,t),Hh(t,r).dispatch(e)};function Hh(e,t,r){r=r||[];var n=function(i){return t.update?t.update(i,"utf8"):t.write(i,"utf8")};return{dispatch:function(i){e.replacer&&(i=e.replacer(i));var s=typeof i;return i===null&&(s="null"),this["_"+s](i)},_object:function(i){var s=/\[object (.*)\]/i,o=Object.prototype.toString.call(i),c=s.exec(o);c?c=c[1]:c="unknown:["+o+"]",c=c.toLowerCase();var a=null;if((a=r.indexOf(i))>=0)return this.dispatch("[CIRCULAR:"+a+"]");if(r.push(i),typeof Buffer<"u"&&Buffer.isBuffer&&Buffer.isBuffer(i))return n("buffer:"),n(i);if(c!=="object"&&c!=="function"&&c!=="asyncfunction")if(this["_"+c])this["_"+c](i);else{if(e.ignoreUnknown)return n("["+c+"]");throw new Error('Unknown object type "'+c+'"')}else{var l=Object.keys(i);e.unorderedObjects&&(l=l.sort()),e.respectType!==!1&&!Pq(i)&&l.splice(0,0,"prototype","__proto__","constructor"),e.excludeKeys&&(l=l.filter(function(u){return!e.excludeKeys(u)})),n("object:"+l.length+":");var f=this;return l.forEach(function(u){f.dispatch(u),n(":"),e.excludeValues||f.dispatch(i[u]),n(",")})}},_array:function(i,s){s=typeof s<"u"?s:e.unorderedArrays!==!1;var o=this;if(n("array:"+i.length+":"),!s||i.length<=1)return i.forEach(function(l){return o.dispatch(l)});var c=[],a=i.map(function(l){var f=new Kq,u=r.slice(),d=Hh(e,f,u);return d.dispatch(l),c=c.concat(u.slice(r.length)),f.read().toString()});return r=r.concat(c),a.sort(),this._array(a,!1)},_date:function(i){return n("date:"+i.toJSON())},_symbol:function(i){return n("symbol:"+i.toString())},_error:function(i){return n("error:"+i.toString())},_boolean:function(i){return n("bool:"+i.toString())},_string:function(i){n("string:"+i.length+":"),n(i.toString())},_function:function(i){n("fn:"),Pq(i)?this.dispatch("[native]"):this.dispatch(i.toString()),e.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(i.name)),e.respectFunctionProperties&&this._object(i)},_number:function(i){return n("number:"+i.toString())},_xml:function(i){return n("xml:"+i.toString())},_null:function(){return n("Null")},_undefined:function(){return n("Undefined")},_regexp:function(i){return n("regex:"+i.toString())},_uint8array:function(i){return n("uint8array:"),this.dispatch(Array.prototype.slice.call(i))},_uint8clampedarray:function(i){return n("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(i))},_int8array:function(i){return n("uint8array:"),this.dispatch(Array.prototype.slice.call(i))},_uint16array:function(i){return n("uint16array:"),this.dispatch(Array.prototype.slice.call(i))},_int16array:function(i){return n("uint16array:"),this.dispatch(Array.prototype.slice.call(i))},_uint32array:function(i){return n("uint32array:"),this.dispatch(Array.prototype.slice.call(i))},_int32array:function(i){return n("uint32array:"),this.dispatch(Array.prototype.slice.call(i))},_float32array:function(i){return n("float32array:"),this.dispatch(Array.prototype.slice.call(i))},_float64array:function(i){return n("float64array:"),this.dispatch(Array.prototype.slice.call(i))},_arraybuffer:function(i){return n("arraybuffer:"),this.dispatch(new Uint8Array(i))},_url:function(i){return n("url:"+i.toString(),"utf8")},_map:function(i){n("map:");var s=Array.from(i);return this._array(s,e.unorderedSets!==!1)},_set:function(i){n("set:");var s=Array.from(i);return this._array(s,e.unorderedSets!==!1)},_file:function(i){return n("file:"),this.dispatch([i.name,i.size,i.type,i.lastModfied])},_blob:function(){if(e.ignoreUnknown)return n("[blob]");throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){return n("domwindow")},_bigint:function(i){return n("bigint:"+i.toString())},_process:function(){return n("process")},_timer:function(){return n("timer")},_pipe:function(){return n("pipe")},_tcp:function(){return n("tcp")},_udp:function(){return n("udp")},_tty:function(){return n("tty")},_statwatcher:function(){return n("statwatcher")},_securecontext:function(){return n("securecontext")},_connection:function(){return n("connection")},_zlib:function(){return n("zlib")},_context:function(){return n("context")},_nodescript:function(){return n("nodescript")},_httpparser:function(){return n("httpparser")},_dataview:function(){return n("dataview")},_signal:function(){return n("signal")},_fsevent:function(){return n("fsevent")},_tlswrap:function(){return n("tlswrap")}}}function Kq(){return{buf:"",write:function(e){this.buf+=e},end:function(e){this.buf+=e},read:function(){return this.buf}}}});var Dq=h((Gh,Mq)=>{"use strict";var Nq=typeof Reflect<"u"?Reflect.construct:void 0,Jn=Object.defineProperty,Fh=Error.captureStackTrace;Fh===void 0&&(Fh=function(t){var r=new Error;Jn(t,"stack",{configurable:!0,get:function(){var i=r.stack;return Jn(this,"stack",{configurable:!0,value:i,writable:!0}),i},set:function(i){Jn(t,"stack",{configurable:!0,value:i,writable:!0})}})});function Wc(e){e!==void 0&&Jn(this,"message",{configurable:!0,value:e,writable:!0});var t=this.constructor.name;t!==void 0&&t!==this.name&&Jn(this,"name",{configurable:!0,value:t,writable:!0}),Fh(this,this.constructor)}Wc.prototype=Object.create(Error.prototype,{constructor:{configurable:!0,value:Wc,writable:!0}});var jq=function(){function e(r,n){return Jn(r,"name",{configurable:!0,value:n})}try{var t=function(){};if(e(t,"foo"),t.name==="foo")return e}catch{}}();function G4(e,t){if(t==null||t===Error)t=Wc;else if(typeof t!="function")throw new TypeError("super_ should be a function");var r;if(typeof e=="string")r=e,e=Nq!==void 0?function(){return Nq(t,arguments,this.constructor)}:function(){t.apply(this,arguments)},jq!==void 0&&(jq(e,r),r=void 0);else if(typeof e!="function")throw new TypeError("constructor should be either a string or a function");e.super_=e.super=t;var n={constructor:{configurable:!0,value:e,writable:!0}};return r!==void 0&&(n.name={configurable:!0,value:r,writable:!0}),e.prototype=Object.create(t.prototype,n),e}Gh=Mq.exports=G4;Gh.BaseError=Wc});var Hr=h((WQ,$q)=>{var{format:Jq}=g("util"),Lq=Dq();function zh({error_description:e,error:t,error_uri:r,session_state:n,state:i,scope:s},o){zh.super.call(this,e?`${t} (${e})`:t),Object.assign(this,{error:t},e&&{error_description:e},r&&{error_uri:r},i&&{state:i},s&&{scope:s},n&&{session_state:n}),o&&Object.defineProperty(this,"response",{value:o})}Lq(zh);function os(...e){if(typeof e[0]=="string")os.super.call(this,Jq(...e));else{let{message:t,printf:r,response:n,...i}=e[0];r?os.super.call(this,Jq(...r)):os.super.call(this,t),Object.assign(this,i),n&&Object.defineProperty(this,"response",{value:n})}}Lq(os);$q.exports={OPError:zh,RPError:os}});var Uq=h((HQ,z4)=>{z4.exports={name:"got",version:"9.6.0",description:"Simplified HTTP requests",license:"MIT",repository:"sindresorhus/got",main:"source",engines:{node:">=8.6"},scripts:{test:"xo && nyc ava",release:"np"},files:["source"],keywords:["http","https","get","got","url","uri","request","util","utility","simple","curl","wget","fetch","net","network","electron"],dependencies:{"@sindresorhus/is":"^0.14.0","@szmarczak/http-timer":"^1.1.2","cacheable-request":"^6.0.0","decompress-response":"^3.3.0",duplexer3:"^0.1.4","get-stream":"^4.1.0","lowercase-keys":"^1.0.1","mimic-response":"^1.0.1","p-cancelable":"^1.0.0","to-readable-stream":"^1.0.0","url-parse-lax":"^3.0.0"},devDependencies:{ava:"^1.1.0",coveralls:"^3.0.0",delay:"^4.1.0","form-data":"^2.3.3","get-port":"^4.0.0",np:"^3.1.0",nyc:"^13.1.0","p-event":"^2.1.0",pem:"^1.13.2",proxyquire:"^2.0.1",sinon:"^7.2.2","slow-stream":"0.0.4",tempfile:"^2.0.0",tempy:"^0.2.1","tough-cookie":"^3.0.0",xo:"^0.24.0"},ava:{concurrency:4},browser:{"decompress-response":!1,electron:!1}}});var Yh=h((FQ,Fc)=>{"use strict";var Hc=class extends Error{constructor(t){super(t||"Promise was canceled"),this.name="CancelError"}get isCanceled(){return!0}},Fr=class{static fn(t){return(...r)=>new Fr((n,i,s)=>{r.push(s),t(...r).then(n,i)})}constructor(t){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise((r,n)=>{this._reject=n;let i=c=>{this._isPending=!1,r(c)},s=c=>{this._isPending=!1,n(c)},o=c=>{this._cancelHandlers.push(c)};return Object.defineProperties(o,{shouldReject:{get:()=>this._rejectOnCancel,set:c=>{this._rejectOnCancel=c}}}),t(i,s,o)})}then(t,r){return this._promise.then(t,r)}catch(t){return this._promise.catch(t)}finally(t){return this._promise.finally(t)}cancel(t){if(!(!this._isPending||this._isCanceled)){if(this._cancelHandlers.length>0)try{for(let r of this._cancelHandlers)r()}catch(r){this._reject(r)}this._isCanceled=!0,this._rejectOnCancel&&this._reject(new Hc(t))}}get isCanceled(){return this._isCanceled}};Object.setPrototypeOf(Fr.prototype,Promise.prototype);Fc.exports=Fr;Fc.exports.default=Fr;Fc.exports.CancelError=Hc});var ft=h((Vh,Xh)=>{"use strict";Object.defineProperty(Vh,"__esModule",{value:!0});var Y4=typeof URL>"u"?g("url").URL:URL,V4=Object.prototype.toString,cs=e=>t=>typeof t===e,Wq=e=>!qe.nullOrUndefined(e)&&!qe.nullOrUndefined(e.constructor)&&qe.function_(e.constructor.isBuffer)&&e.constructor.isBuffer(e),Gc=e=>{let t=V4.call(e).slice(8,-1);return t||null},W=e=>t=>Gc(t)===e;function qe(e){switch(e){case null:return"null";case!0:case!1:return"boolean";default:}switch(typeof e){case"undefined":return"undefined";case"string":return"string";case"number":return"number";case"symbol":return"symbol";default:}if(qe.function_(e))return"Function";if(qe.observable(e))return"Observable";if(Array.isArray(e))return"Array";if(Wq(e))return"Buffer";let t=Gc(e);if(t)return t;if(e instanceof String||e instanceof Boolean||e instanceof Number)throw new TypeError("Please don't use object wrappers for primitive types");return"Object"}(function(e){let t=u=>typeof u=="object";e.undefined=cs("undefined"),e.string=cs("string"),e.number=cs("number"),e.function_=cs("function"),e.null_=u=>u===null,e.class_=u=>e.function_(u)&&u.toString().startsWith("class "),e.boolean=u=>u===!0||u===!1,e.symbol=cs("symbol"),e.numericString=u=>e.string(u)&&u.length>0&&!Number.isNaN(Number(u)),e.array=Array.isArray,e.buffer=Wq,e.nullOrUndefined=u=>e.null_(u)||e.undefined(u),e.object=u=>!e.nullOrUndefined(u)&&(e.function_(u)||t(u)),e.iterable=u=>!e.nullOrUndefined(u)&&e.function_(u[Symbol.iterator]),e.asyncIterable=u=>!e.nullOrUndefined(u)&&e.function_(u[Symbol.asyncIterator]),e.generator=u=>e.iterable(u)&&e.function_(u.next)&&e.function_(u.throw),e.nativePromise=u=>W("Promise")(u);let r=u=>!e.null_(u)&&t(u)&&e.function_(u.then)&&e.function_(u.catch);e.promise=u=>e.nativePromise(u)||r(u),e.generatorFunction=W("GeneratorFunction"),e.asyncFunction=W("AsyncFunction"),e.boundFunction=u=>e.function_(u)&&!u.hasOwnProperty("prototype"),e.regExp=W("RegExp"),e.date=W("Date"),e.error=W("Error"),e.map=u=>W("Map")(u),e.set=u=>W("Set")(u),e.weakMap=u=>W("WeakMap")(u),e.weakSet=u=>W("WeakSet")(u),e.int8Array=W("Int8Array"),e.uint8Array=W("Uint8Array"),e.uint8ClampedArray=W("Uint8ClampedArray"),e.int16Array=W("Int16Array"),e.uint16Array=W("Uint16Array"),e.int32Array=W("Int32Array"),e.uint32Array=W("Uint32Array"),e.float32Array=W("Float32Array"),e.float64Array=W("Float64Array"),e.arrayBuffer=W("ArrayBuffer"),e.sharedArrayBuffer=W("SharedArrayBuffer"),e.dataView=W("DataView"),e.directInstanceOf=(u,d)=>Object.getPrototypeOf(u)===d.prototype,e.urlInstance=u=>W("URL")(u),e.urlString=u=>{if(!e.string(u))return!1;try{return new Y4(u),!0}catch{return!1}},e.truthy=u=>Boolean(u),e.falsy=u=>!u,e.nan=u=>Number.isNaN(u);let n=new Set(["undefined","string","number","boolean","symbol"]);e.primitive=u=>e.null_(u)||n.has(typeof u),e.integer=u=>Number.isInteger(u),e.safeInteger=u=>Number.isSafeInteger(u),e.plainObject=u=>{let d;return Gc(u)==="Object"&&(d=Object.getPrototypeOf(u),d===null||d===Object.getPrototypeOf({}))};let i=new Set(["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"]);e.typedArray=u=>{let d=Gc(u);return d===null?!1:i.has(d)};let s=u=>e.safeInteger(u)&&u>-1;e.arrayLike=u=>!e.nullOrUndefined(u)&&!e.function_(u)&&s(u.length),e.inRange=(u,d)=>{if(e.number(d))return u>=Math.min(0,d)&&u<=Math.max(d,0);if(e.array(d)&&d.length===2)return u>=Math.min(...d)&&u<=Math.max(...d);throw new TypeError(`Invalid range: ${JSON.stringify(d)}`)};let o=1,c=["innerHTML","ownerDocument","style","attributes","nodeValue"];e.domElement=u=>e.object(u)&&u.nodeType===o&&e.string(u.nodeName)&&!e.plainObject(u)&&c.every(d=>d in u),e.observable=u=>u?!!(u[Symbol.observable]&&u===u[Symbol.observable]()||u["@@observable"]&&u===u["@@observable"]()):!1,e.nodeStream=u=>!e.nullOrUndefined(u)&&t(u)&&e.function_(u.pipe)&&!e.observable(u),e.infinite=u=>u===1/0||u===-1/0;let a=u=>d=>e.integer(d)&&Math.abs(d%2)===u;e.even=a(0),e.odd=a(1);let l=u=>e.string(u)&&/\S/.test(u)===!1;e.emptyArray=u=>e.array(u)&&u.length===0,e.nonEmptyArray=u=>e.array(u)&&u.length>0,e.emptyString=u=>e.string(u)&&u.length===0,e.nonEmptyString=u=>e.string(u)&&u.length>0,e.emptyStringOrWhitespace=u=>e.emptyString(u)||l(u),e.emptyObject=u=>e.object(u)&&!e.map(u)&&!e.set(u)&&Object.keys(u).length===0,e.nonEmptyObject=u=>e.object(u)&&!e.map(u)&&!e.set(u)&&Object.keys(u).length>0,e.emptySet=u=>e.set(u)&&u.size===0,e.nonEmptySet=u=>e.set(u)&&u.size>0,e.emptyMap=u=>e.map(u)&&u.size===0,e.nonEmptyMap=u=>e.map(u)&&u.size>0;let f=(u,d,p)=>{if(e.function_(d)===!1)throw new TypeError(`Invalid predicate: ${JSON.stringify(d)}`);if(p.length===0)throw new TypeError("Invalid number of values");return u.call(p,d)};e.any=(u,...d)=>f(Array.prototype.some,u,d),e.all=(u,...d)=>f(Array.prototype.every,u,d)})(qe||(qe={}));Object.defineProperties(qe,{class:{value:qe.class_},function:{value:qe.function_},null:{value:qe.null_}});Vh.default=qe;Xh.exports=qe;Xh.exports.default=qe});var as=h((GQ,ht)=>{"use strict";var X4=g("url"),Qh=g("http"),Q4=Yh(),Z4=ft(),dt=class extends Error{constructor(t,r,n){super(t),Error.captureStackTrace(this,this.constructor),this.name="GotError",Z4.undefined(r.code)||(this.code=r.code),Object.assign(this,{host:n.host,hostname:n.hostname,method:n.method,path:n.path,socketPath:n.socketPath,protocol:n.protocol,url:n.href,gotOptions:n})}};ht.exports.GotError=dt;ht.exports.CacheError=class extends dt{constructor(e,t){super(e.message,e,t),this.name="CacheError"}};ht.exports.RequestError=class extends dt{constructor(e,t){super(e.message,e,t),this.name="RequestError"}};ht.exports.ReadError=class extends dt{constructor(e,t){super(e.message,e,t),this.name="ReadError"}};ht.exports.ParseError=class extends dt{constructor(e,t,r,n){super(`${e.message} in "${X4.format(r)}": 
${n.slice(0,77)}...`,e,r),this.name="ParseError",this.statusCode=t,this.statusMessage=Qh.STATUS_CODES[this.statusCode]}};ht.exports.HTTPError=class extends dt{constructor(e,t){let{statusCode:r}=e,{statusMessage:n}=e;n?n=n.replace(/\r?\n/g," ").trim():n=Qh.STATUS_CODES[r],super(`Response code ${r} (${n})`,{},t),this.name="HTTPError",this.statusCode=r,this.statusMessage=n,this.headers=e.headers,this.body=e.body}};ht.exports.MaxRedirectsError=class extends dt{constructor(e,t,r){super("Redirected 10 times. Aborting.",{},r),this.name="MaxRedirectsError",this.statusCode=e,this.statusMessage=Qh.STATUS_CODES[this.statusCode],this.redirectUrls=t}};ht.exports.UnsupportedProtocolError=class extends dt{constructor(e){super(`Unsupported protocol "${e.protocol}"`,{},e),this.name="UnsupportedProtocolError"}};ht.exports.TimeoutError=class extends dt{constructor(e,t){super(e.message,{code:"ETIMEDOUT"},t),this.name="TimeoutError",this.event=e.event}};ht.exports.CancelError=Q4.CancelError});var Hq=h((rZ,ep)=>{"use strict";var Zh=g("stream");function Ln(e,t,r){typeof r>"u"&&(r=t,t=e,e=null),Zh.Duplex.call(this,e),typeof r.read!="function"&&(r=new Zh.Readable(e).wrap(r)),this._writable=t,this._readable=r,this._waiting=!1;var n=this;t.once("finish",function(){n.end()}),this.once("finish",function(){t.end()}),r.on("readable",function(){n._waiting&&(n._waiting=!1,n._read())}),r.once("end",function(){n.push(null)}),(!e||typeof e.bubbleErrors>"u"||e.bubbleErrors)&&(t.on("error",function(i){n.emit("error",i)}),r.on("error",function(i){n.emit("error",i)}))}Ln.prototype=Object.create(Zh.Duplex.prototype,{constructor:{value:Ln}});Ln.prototype._write=function(t,r,n){this._writable.write(t,r,n)};Ln.prototype._read=function(){for(var t,r=0;(t=this._readable.read())!==null;)this.push(t),r++;r===0&&(this._waiting=!0)};ep.exports=function(t,r,n){return new Ln(t,r,n)};ep.exports.DuplexWrapper=Ln});var zq=h((nZ,tp)=>{"use strict";var e3=typeof URL>"u"?g("url").URL:URL,t3="text/plain",r3="us-ascii",Fq=(e,t)=>t.some(r=>r instanceof RegExp?r.test(e):r===e),n3=(e,{stripHash:t})=>{let r=e.match(/^data:([^,]*?),([^#]*?)(?:#(.*))?$/);if(!r)throw new Error(`Invalid URL: ${e}`);let n=r[1].split(";"),i=r[2],s=t?"":r[3],o=!1;n[n.length-1]==="base64"&&(n.pop(),o=!0);let c=(n.shift()||"").toLowerCase(),l=[...n.map(f=>{let[u,d=""]=f.split("=").map(p=>p.trim());return u==="charset"&&(d=d.toLowerCase(),d===r3)?"":`${u}${d?`=${d}`:""}`}).filter(Boolean)];return o&&l.push("base64"),(l.length!==0||c&&c!==t3)&&l.unshift(c),`data:${l.join(";")},${o?i.trim():i}${s?`#${s}`:""}`},Gq=(e,t)=>{if(t={defaultProtocol:"http:",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeDirectoryIndex:!1,sortQueryParameters:!0,...t},Reflect.has(t,"normalizeHttps"))throw new Error("options.normalizeHttps is renamed to options.forceHttp");if(Reflect.has(t,"normalizeHttp"))throw new Error("options.normalizeHttp is renamed to options.forceHttps");if(Reflect.has(t,"stripFragment"))throw new Error("options.stripFragment is renamed to options.stripHash");if(e=e.trim(),/^data:/i.test(e))return n3(e,t);let r=e.startsWith("//");!r&&/^\.*\//.test(e)||(e=e.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,t.defaultProtocol));let i=new e3(e);if(t.forceHttp&&t.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(t.forceHttp&&i.protocol==="https:"&&(i.protocol="http:"),t.forceHttps&&i.protocol==="http:"&&(i.protocol="https:"),t.stripAuthentication&&(i.username="",i.password=""),t.stripHash&&(i.hash=""),i.pathname&&(i.pathname=i.pathname.replace(/((?!:).|^)\/{2,}/g,(s,o)=>/^(?!\/)/g.test(o)?`${o}/`:"/")),i.pathname&&(i.pathname=decodeURI(i.pathname)),t.removeDirectoryIndex===!0&&(t.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(t.removeDirectoryIndex)&&t.removeDirectoryIndex.length>0){let s=i.pathname.split("/"),o=s[s.length-1];Fq(o,t.removeDirectoryIndex)&&(s=s.slice(0,s.length-1),i.pathname=s.slice(1).join("/")+"/")}if(i.hostname&&(i.hostname=i.hostname.replace(/\.$/,""),t.stripWWW&&/^www\.([a-z\-\d]{2,63})\.([a-z.]{2,5})$/.test(i.hostname)&&(i.hostname=i.hostname.replace(/^www\./,""))),Array.isArray(t.removeQueryParameters))for(let s of[...i.searchParams.keys()])Fq(s,t.removeQueryParameters)&&i.searchParams.delete(s);return t.sortQueryParameters&&i.searchParams.sort(),t.removeTrailingSlash&&(i.pathname=i.pathname.replace(/\/$/,"")),e=i.toString(),(t.removeTrailingSlash||i.pathname==="/")&&i.hash===""&&(e=e.replace(/\/$/,"")),r&&!t.normalizeProtocol&&(e=e.replace(/^http:\/\//,"//")),t.stripProtocol&&(e=e.replace(/^(?:https?:)?\/\//,"")),e};tp.exports=Gq;tp.exports.default=Gq});var Xq=h((iZ,Vq)=>{Vq.exports=Yq;function Yq(e,t){if(e&&t)return Yq(e)(t);if(typeof e!="function")throw new TypeError("need wrapper function");return Object.keys(e).forEach(function(n){r[n]=e[n]}),r;function r(){for(var n=new Array(arguments.length),i=0;i<n.length;i++)n[i]=arguments[i];var s=e.apply(this,n),o=n[n.length-1];return typeof s=="function"&&s!==o&&Object.keys(o).forEach(function(c){s[c]=o[c]}),s}}});var np=h((sZ,rp)=>{var Qq=Xq();rp.exports=Qq(zc);rp.exports.strict=Qq(Zq);zc.proto=zc(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return zc(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return Zq(this)},configurable:!0})});function zc(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function Zq(e){var t=function(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)},r=e.name||"Function wrapped with `once`";return t.onceError=r+" shouldn't be called more than once",t.called=!1,t}});var r2=h((oZ,t2)=>{var i3=np(),s3=function(){},o3=function(e){return e.setHeader&&typeof e.abort=="function"},c3=function(e){return e.stdio&&Array.isArray(e.stdio)&&e.stdio.length===3},e2=function(e,t,r){if(typeof t=="function")return e2(e,null,t);t||(t={}),r=i3(r||s3);var n=e._writableState,i=e._readableState,s=t.readable||t.readable!==!1&&e.readable,o=t.writable||t.writable!==!1&&e.writable,c=!1,a=function(){e.writable||l()},l=function(){o=!1,s||r.call(e)},f=function(){s=!1,o||r.call(e)},u=function(_){r.call(e,_?new Error("exited with error code: "+_):null)},d=function(_){r.call(e,_)},p=function(){process.nextTick(m)},m=function(){if(!c){if(s&&!(i&&i.ended&&!i.destroyed))return r.call(e,new Error("premature close"));if(o&&!(n&&n.ended&&!n.destroyed))return r.call(e,new Error("premature close"))}},y=function(){e.req.on("finish",l)};return o3(e)?(e.on("complete",l),e.on("abort",p),e.req?y():e.on("request",y)):o&&!n&&(e.on("end",a),e.on("close",a)),c3(e)&&e.on("exit",u),e.on("end",f),e.on("finish",l),t.error!==!1&&e.on("error",d),e.on("close",p),function(){c=!0,e.removeListener("complete",l),e.removeListener("abort",p),e.removeListener("request",y),e.req&&e.req.removeListener("finish",l),e.removeListener("end",a),e.removeListener("close",a),e.removeListener("finish",l),e.removeListener("exit",u),e.removeListener("end",f),e.removeListener("error",d),e.removeListener("close",p)}};t2.exports=e2});var sp=h((cZ,i2)=>{var a3=np(),u3=r2(),ip=g("fs"),us=function(){},l3=/^v?\.0/.test(process.version),Yc=function(e){return typeof e=="function"},f3=function(e){return!l3||!ip?!1:(e instanceof(ip.ReadStream||us)||e instanceof(ip.WriteStream||us))&&Yc(e.close)},d3=function(e){return e.setHeader&&Yc(e.abort)},h3=function(e,t,r,n){n=a3(n);var i=!1;e.on("close",function(){i=!0}),u3(e,{readable:t,writable:r},function(o){if(o)return n(o);i=!0,n()});var s=!1;return function(o){if(!i&&!s){if(s=!0,f3(e))return e.close(us);if(d3(e))return e.abort();if(Yc(e.destroy))return e.destroy();n(o||new Error("stream was destroyed"))}}},n2=function(e){e()},p3=function(e,t){return e.pipe(t)},y3=function(){var e=Array.prototype.slice.call(arguments),t=Yc(e[e.length-1]||us)&&e.pop()||us;if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new Error("pump requires two streams per minimum");var r,n=e.map(function(i,s){var o=s<e.length-1,c=s>0;return h3(i,o,c,function(a){r||(r=a),a&&n.forEach(n2),!o&&(n.forEach(n2),t(r))})});return e.reduce(p3)};i2.exports=y3});var o2=h((aZ,s2)=>{"use strict";var{PassThrough:m3}=g("stream");s2.exports=e=>{e={...e};let{array:t}=e,{encoding:r}=e,n=r==="buffer",i=!1;t?i=!(r||n):r=r||"utf8",n&&(r=null);let s=new m3({objectMode:i});r&&s.setEncoding(r);let o=0,c=[];return s.on("data",a=>{c.push(a),i?o=c.length:o+=a.length}),s.getBufferedValue=()=>t?c:n?Buffer.concat(c,o):c.join(""),s.getBufferedLength=()=>o,s}});var c2=h((uZ,$n)=>{"use strict";var{constants:g3}=g("buffer"),_3=sp(),w3=o2(),Vc=class extends Error{constructor(){super("maxBuffer exceeded"),this.name="MaxBufferError"}};async function Xc(e,t){if(!e)return Promise.reject(new Error("Expected a stream"));t={maxBuffer:1/0,...t};let{maxBuffer:r}=t,n;return await new Promise((i,s)=>{let o=c=>{c&&n.getBufferedLength()<=g3.MAX_LENGTH&&(c.bufferedData=n.getBufferedValue()),s(c)};n=_3(e,w3(t),c=>{if(c){o(c);return}i()}),n.on("data",()=>{n.getBufferedLength()>r&&o(new Vc)})}),n.getBufferedValue()}$n.exports=Xc;$n.exports.default=Xc;$n.exports.buffer=(e,t)=>Xc(e,{...t,encoding:"buffer"});$n.exports.array=(e,t)=>Xc(e,{...t,array:!0});$n.exports.MaxBufferError=Vc});var u2=h((fZ,a2)=>{"use strict";var b3=new Set([200,203,204,206,300,301,308,404,405,410,414,501]),E3=new Set([200,203,204,300,301,302,303,307,308,404,405,410,414,501]),v3=new Set([500,502,503,504]),S3={date:!0,connection:!0,"keep-alive":!0,"proxy-authenticate":!0,"proxy-authorization":!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0},x3={"content-length":!0,"content-encoding":!0,"transfer-encoding":!0,"content-range":!0};function Gr(e){let t=parseInt(e,10);return isFinite(t)?t:0}function T3(e){return e?v3.has(e.status):!0}function op(e){let t={};if(!e)return t;let r=e.trim().split(/,/);for(let n of r){let[i,s]=n.split(/=/,2);t[i.trim()]=s===void 0?!0:s.trim().replace(/^"|"$/g,"")}return t}function A3(e){let t=[];for(let r in e){let n=e[r];t.push(n===!0?r:r+"="+n)}if(!!t.length)return t.join(", ")}a2.exports=class{constructor(t,r,{shared:n,cacheHeuristic:i,immutableMinTimeToLive:s,ignoreCargoCult:o,_fromObject:c}={}){if(c){this._fromObject(c);return}if(!r||!r.headers)throw Error("Response headers missing");this._assertRequestHasHeaders(t),this._responseTime=this.now(),this._isShared=n!==!1,this._cacheHeuristic=i!==void 0?i:.1,this._immutableMinTtl=s!==void 0?s:24*3600*1e3,this._status="status"in r?r.status:200,this._resHeaders=r.headers,this._rescc=op(r.headers["cache-control"]),this._method="method"in t?t.method:"GET",this._url=t.url,this._host=t.headers.host,this._noAuthorization=!t.headers.authorization,this._reqHeaders=r.headers.vary?t.headers:null,this._reqcc=op(t.headers["cache-control"]),o&&"pre-check"in this._rescc&&"post-check"in this._rescc&&(delete this._rescc["pre-check"],delete this._rescc["post-check"],delete this._rescc["no-cache"],delete this._rescc["no-store"],delete this._rescc["must-revalidate"],this._resHeaders=Object.assign({},this._resHeaders,{"cache-control":A3(this._rescc)}),delete this._resHeaders.expires,delete this._resHeaders.pragma),r.headers["cache-control"]==null&&/no-cache/.test(r.headers.pragma)&&(this._rescc["no-cache"]=!0)}now(){return Date.now()}storable(){return!!(!this._reqcc["no-store"]&&(this._method==="GET"||this._method==="HEAD"||this._method==="POST"&&this._hasExplicitExpiration())&&E3.has(this._status)&&!this._rescc["no-store"]&&(!this._isShared||!this._rescc.private)&&(!this._isShared||this._noAuthorization||this._allowsStoringAuthenticated())&&(this._resHeaders.expires||this._rescc["max-age"]||this._isShared&&this._rescc["s-maxage"]||this._rescc.public||b3.has(this._status)))}_hasExplicitExpiration(){return this._isShared&&this._rescc["s-maxage"]||this._rescc["max-age"]||this._resHeaders.expires}_assertRequestHasHeaders(t){if(!t||!t.headers)throw Error("Request headers missing")}satisfiesWithoutRevalidation(t){this._assertRequestHasHeaders(t);let r=op(t.headers["cache-control"]);return r["no-cache"]||/no-cache/.test(t.headers.pragma)||r["max-age"]&&this.age()>r["max-age"]||r["min-fresh"]&&this.timeToLive()<1e3*r["min-fresh"]||this.stale()&&!(r["max-stale"]&&!this._rescc["must-revalidate"]&&(r["max-stale"]===!0||r["max-stale"]>this.age()-this.maxAge()))?!1:this._requestMatches(t,!1)}_requestMatches(t,r){return(!this._url||this._url===t.url)&&this._host===t.headers.host&&(!t.method||this._method===t.method||r&&t.method==="HEAD")&&this._varyMatches(t)}_allowsStoringAuthenticated(){return this._rescc["must-revalidate"]||this._rescc.public||this._rescc["s-maxage"]}_varyMatches(t){if(!this._resHeaders.vary)return!0;if(this._resHeaders.vary==="*")return!1;let r=this._resHeaders.vary.trim().toLowerCase().split(/\s*,\s*/);for(let n of r)if(t.headers[n]!==this._reqHeaders[n])return!1;return!0}_copyWithoutHopByHopHeaders(t){let r={};for(let n in t)S3[n]||(r[n]=t[n]);if(t.connection){let n=t.connection.trim().split(/\s*,\s*/);for(let i of n)delete r[i]}if(r.warning){let n=r.warning.split(/,/).filter(i=>!/^\s*1[0-9][0-9]/.test(i));n.length?r.warning=n.join(",").trim():delete r.warning}return r}responseHeaders(){let t=this._copyWithoutHopByHopHeaders(this._resHeaders),r=this.age();return r>3600*24&&!this._hasExplicitExpiration()&&this.maxAge()>3600*24&&(t.warning=(t.warning?`${t.warning}, `:"")+'113 - "rfc7234 5.5.4"'),t.age=`${Math.round(r)}`,t.date=new Date(this.now()).toUTCString(),t}date(){let t=Date.parse(this._resHeaders.date);return isFinite(t)?t:this._responseTime}age(){let t=this._ageValue(),r=(this.now()-this._responseTime)/1e3;return t+r}_ageValue(){return Gr(this._resHeaders.age)}maxAge(){if(!this.storable()||this._rescc["no-cache"]||this._isShared&&this._resHeaders["set-cookie"]&&!this._rescc.public&&!this._rescc.immutable||this._resHeaders.vary==="*")return 0;if(this._isShared){if(this._rescc["proxy-revalidate"])return 0;if(this._rescc["s-maxage"])return Gr(this._rescc["s-maxage"])}if(this._rescc["max-age"])return Gr(this._rescc["max-age"]);let t=this._rescc.immutable?this._immutableMinTtl:0,r=this.date();if(this._resHeaders.expires){let n=Date.parse(this._resHeaders.expires);return Number.isNaN(n)||n<r?0:Math.max(t,(n-r)/1e3)}if(this._resHeaders["last-modified"]){let n=Date.parse(this._resHeaders["last-modified"]);if(isFinite(n)&&r>n)return Math.max(t,(r-n)/1e3*this._cacheHeuristic)}return t}timeToLive(){let t=this.maxAge()-this.age(),r=t+Gr(this._rescc["stale-if-error"]),n=t+Gr(this._rescc["stale-while-revalidate"]);return Math.max(0,t,r,n)*1e3}stale(){return this.maxAge()<=this.age()}_useStaleIfError(){return this.maxAge()+Gr(this._rescc["stale-if-error"])>this.age()}useStaleWhileRevalidate(){return this.maxAge()+Gr(this._rescc["stale-while-revalidate"])>this.age()}static fromObject(t){return new this(void 0,void 0,{_fromObject:t})}_fromObject(t){if(this._responseTime)throw Error("Reinitialized");if(!t||t.v!==1)throw Error("Invalid serialization");this._responseTime=t.t,this._isShared=t.sh,this._cacheHeuristic=t.ch,this._immutableMinTtl=t.imm!==void 0?t.imm:24*3600*1e3,this._status=t.st,this._resHeaders=t.resh,this._rescc=t.rescc,this._method=t.m,this._url=t.u,this._host=t.h,this._noAuthorization=t.a,this._reqHeaders=t.reqh,this._reqcc=t.reqcc}toObject(){return{v:1,t:this._responseTime,sh:this._isShared,ch:this._cacheHeuristic,imm:this._immutableMinTtl,st:this._status,resh:this._resHeaders,rescc:this._rescc,m:this._method,u:this._url,h:this._host,a:this._noAuthorization,reqh:this._reqHeaders,reqcc:this._reqcc}}revalidationHeaders(t){this._assertRequestHasHeaders(t);let r=this._copyWithoutHopByHopHeaders(t.headers);if(delete r["if-range"],!this._requestMatches(t,!0)||!this.storable())return delete r["if-none-match"],delete r["if-modified-since"],r;if(this._resHeaders.etag&&(r["if-none-match"]=r["if-none-match"]?`${r["if-none-match"]}, ${this._resHeaders.etag}`:this._resHeaders.etag),r["accept-ranges"]||r["if-match"]||r["if-unmodified-since"]||this._method&&this._method!="GET"){if(delete r["if-modified-since"],r["if-none-match"]){let i=r["if-none-match"].split(/,/).filter(s=>!/^\s*W\//.test(s));i.length?r["if-none-match"]=i.join(",").trim():delete r["if-none-match"]}}else this._resHeaders["last-modified"]&&!r["if-modified-since"]&&(r["if-modified-since"]=this._resHeaders["last-modified"]);return r}revalidatedPolicy(t,r){if(this._assertRequestHasHeaders(t),this._useStaleIfError()&&T3(r))return{modified:!1,matches:!1,policy:this};if(!r||!r.headers)throw Error("Response headers missing");let n=!1;if(r.status!==void 0&&r.status!=304?n=!1:r.headers.etag&&!/^\s*W\//.test(r.headers.etag)?n=this._resHeaders.etag&&this._resHeaders.etag.replace(/^\s*W\//,"")===r.headers.etag:this._resHeaders.etag&&r.headers.etag?n=this._resHeaders.etag.replace(/^\s*W\//,"")===r.headers.etag.replace(/^\s*W\//,""):this._resHeaders["last-modified"]?n=this._resHeaders["last-modified"]===r.headers["last-modified"]:!this._resHeaders.etag&&!this._resHeaders["last-modified"]&&!r.headers.etag&&!r.headers["last-modified"]&&(n=!0),!n)return{policy:new this.constructor(t,r),modified:r.status!=304,matches:!1};let i={};for(let o in this._resHeaders)i[o]=o in r.headers&&!x3[o]?r.headers[o]:this._resHeaders[o];let s=Object.assign({},r,{status:this._status,method:this._method,headers:i});return{policy:new this.constructor(t,s,{shared:this._isShared,cacheHeuristic:this._cacheHeuristic,immutableMinTimeToLive:this._immutableMinTtl}),modified:!1,matches:!0}}}});var cp=h((dZ,l2)=>{"use strict";l2.exports=function(e){for(var t={},r=Object.keys(Object(e)),n=0;n<r.length;n++)t[r[n].toLowerCase()]=e[r[n]];return t}});var d2=h((hZ,f2)=>{"use strict";var q3=g("stream").Readable,O3=cp(),ap=class extends q3{constructor(t,r,n,i){if(typeof t!="number")throw new TypeError("Argument `statusCode` should be a number");if(typeof r!="object")throw new TypeError("Argument `headers` should be an object");if(!(n instanceof Buffer))throw new TypeError("Argument `body` should be a buffer");if(typeof i!="string")throw new TypeError("Argument `url` should be a string");super(),this.statusCode=t,this.headers=O3(r),this.body=n,this.url=i}_read(){this.push(this.body),this.push(null)}};f2.exports=ap});var p2=h((pZ,h2)=>{"use strict";h2.exports=e=>{let t={};for(let[r,n]of Object.entries(e))t[r.toLowerCase()]=n;return t}});var Qc=h((yZ,y2)=>{"use strict";var k3=["destroy","setTimeout","socket","headers","trailers","rawHeaders","statusCode","httpVersion","httpVersionMinor","httpVersionMajor","rawTrailers","statusMessage"];y2.exports=(e,t)=>{let r=new Set(Object.keys(e).concat(k3));for(let n of r)n in t||(t[n]=typeof e[n]=="function"?e[n].bind(e):e[n])}});var g2=h((mZ,m2)=>{"use strict";var C3=g("stream").PassThrough,P3=Qc(),R3=e=>{if(!(e&&e.pipe))throw new TypeError("Parameter `response` must be a response stream.");let t=new C3;return P3(e,t),e.pipe(t)};m2.exports=R3});var _2=h(up=>{up.stringify=function e(t){if(typeof t>"u")return t;if(t&&Buffer.isBuffer(t))return JSON.stringify(":base64:"+t.toString("base64"));if(t&&t.toJSON&&(t=t.toJSON()),t&&typeof t=="object"){var r="",n=Array.isArray(t);r=n?"[":"{";var i=!0;for(var s in t){var o=typeof t[s]=="function"||!n&&typeof t[s]>"u";Object.hasOwnProperty.call(t,s)&&!o&&(i||(r+=","),i=!1,n?t[s]==null?r+="null":r+=e(t[s]):t[s]!==void 0&&(r+=e(s)+":"+e(t[s])))}return r+=n?"]":"}",r}else return typeof t=="string"?JSON.stringify(/^:/.test(t)?":"+t:t):typeof t>"u"?"null":JSON.stringify(t)};up.parse=function(e){return JSON.parse(e,function(t,r){return typeof r=="string"?/^:base64:/.test(r)?new Buffer(r.substring(8),"base64"):/^:/.test(r)?r.substring(1):r:r})}});var E2=h((_Z,b2)=>{"use strict";var K3=g("events"),w2=_2(),I3=e=>{let t={redis:"@keyv/redis",mongodb:"@keyv/mongo",mongo:"@keyv/mongo",sqlite:"@keyv/sqlite",postgresql:"@keyv/postgres",postgres:"@keyv/postgres",mysql:"@keyv/mysql"};if(e.adapter||e.uri){let r=e.adapter||/^[^:]*/.exec(e.uri)[0];return new(g(t[r]))(e)}return new Map},lp=class extends K3{constructor(t,r){if(super(),this.opts=Object.assign({namespace:"keyv",serialize:w2.stringify,deserialize:w2.parse},typeof t=="string"?{uri:t}:t,r),!this.opts.store){let n=Object.assign({},this.opts);this.opts.store=I3(n)}typeof this.opts.store.on=="function"&&this.opts.store.on("error",n=>this.emit("error",n)),this.opts.store.namespace=this.opts.namespace}_getKeyPrefix(t){return`${this.opts.namespace}:${t}`}get(t){t=this._getKeyPrefix(t);let r=this.opts.store;return Promise.resolve().then(()=>r.get(t)).then(n=>{if(n=typeof n=="string"?this.opts.deserialize(n):n,n!==void 0){if(typeof n.expires=="number"&&Date.now()>n.expires){this.delete(t);return}return n.value}})}set(t,r,n){t=this._getKeyPrefix(t),typeof n>"u"&&(n=this.opts.ttl),n===0&&(n=void 0);let i=this.opts.store;return Promise.resolve().then(()=>{let s=typeof n=="number"?Date.now()+n:null;return r={value:r,expires:s},i.set(t,this.opts.serialize(r),n)}).then(()=>!0)}delete(t){t=this._getKeyPrefix(t);let r=this.opts.store;return Promise.resolve().then(()=>r.delete(t))}clear(){let t=this.opts.store;return Promise.resolve().then(()=>t.clear())}};b2.exports=lp});var x2=h((bZ,S2)=>{"use strict";var B3=g("events"),Zc=g("url"),N3=zq(),j3=c2(),fp=u2(),v2=d2(),M3=p2(),D3=g2(),J3=E2(),pt=class{constructor(t,r){if(typeof t!="function")throw new TypeError("Parameter `request` must be a function");return this.cache=new J3({uri:typeof r=="string"&&r,store:typeof r!="string"&&r,namespace:"cacheable-request"}),this.createCacheableRequest(t)}createCacheableRequest(t){return(r,n)=>{let i;if(typeof r=="string")i=dp(Zc.parse(r)),r={};else if(r instanceof Zc.URL)i=dp(Zc.parse(r.toString())),r={};else{let[u,...d]=(r.path||"").split("?"),p=d.length>0?`?${d.join("?")}`:"";i=dp({...r,pathname:u,search:p})}r={headers:{},method:"GET",cache:!0,strictTtl:!1,automaticFailover:!1,...r,...L3(i)},r.headers=M3(r.headers);let s=new B3,o=N3(Zc.format(i),{stripWWW:!1,removeTrailingSlash:!1,stripAuthentication:!1}),c=`${r.method}:${o}`,a=!1,l=!1,f=u=>{l=!0;let d=!1,p,m=new Promise(_=>{p=()=>{d||(d=!0,_())}}),y=_=>{if(a&&!u.forceRefresh){_.status=_.statusCode;let w=fp.fromObject(a.cachePolicy).revalidatedPolicy(u,_);if(!w.modified){let v=w.policy.responseHeaders();_=new v2(a.statusCode,v,a.body,a.url),_.cachePolicy=w.policy,_.fromCache=!0}}_.fromCache||(_.cachePolicy=new fp(u,_,u),_.fromCache=!1);let b;u.cache&&_.cachePolicy.storable()?(b=D3(_),(async()=>{try{let w=j3.buffer(_);if(await Promise.race([m,new Promise(x=>_.once("end",x))]),d)return;let v=await w,S={cachePolicy:_.cachePolicy.toObject(),url:_.url,statusCode:_.fromCache?a.statusCode:_.statusCode,body:v},E=u.strictTtl?_.cachePolicy.timeToLive():void 0;u.maxTtl&&(E=E?Math.min(E,u.maxTtl):u.maxTtl),await this.cache.set(c,S,E)}catch(w){s.emit("error",new pt.CacheError(w))}})()):u.cache&&a&&(async()=>{try{await this.cache.delete(c)}catch(w){s.emit("error",new pt.CacheError(w))}})(),s.emit("response",b||_),typeof n=="function"&&n(b||_)};try{let _=t(u,y);_.once("error",p),_.once("abort",p),s.emit("request",_)}catch(_){s.emit("error",new pt.RequestError(_))}};return(async()=>{let u=async p=>{await Promise.resolve();let m=p.cache?await this.cache.get(c):void 0;if(typeof m>"u")return f(p);let y=fp.fromObject(m.cachePolicy);if(y.satisfiesWithoutRevalidation(p)&&!p.forceRefresh){let _=y.responseHeaders(),b=new v2(m.statusCode,_,m.body,m.url);b.cachePolicy=y,b.fromCache=!0,s.emit("response",b),typeof n=="function"&&n(b)}else a=m,p.headers=y.revalidationHeaders(p),f(p)},d=p=>s.emit("error",new pt.CacheError(p));this.cache.once("error",d),s.on("response",()=>this.cache.removeListener("error",d));try{await u(r)}catch(p){r.automaticFailover&&!l&&f(r),s.emit("error",new pt.CacheError(p))}})(),s}}};function L3(e){let t={...e};return t.path=`${e.pathname||"/"}${e.search||""}`,delete t.pathname,delete t.search,t}function dp(e){return{protocol:e.protocol,auth:e.auth,hostname:e.hostname||e.host||"localhost",port:e.port,pathname:e.pathname,search:e.search}}pt.RequestError=class extends Error{constructor(e){super(e.message),this.name="RequestError",Object.assign(this,e)}};pt.CacheError=class extends Error{constructor(e){super(e.message),this.name="CacheError",Object.assign(this,e)}};S2.exports=pt});var A2=h((SZ,T2)=>{"use strict";var{Readable:$3}=g("stream");T2.exports=e=>new $3({read(){this.push(e),this.push(null)}})});var q2=h((pp,yp)=>{"use strict";Object.defineProperty(pp,"__esModule",{value:!0});var U3=g("tls"),hp=(e,t)=>{let r;typeof t=="function"?r={connect:t}:r=t;let n=typeof r.connect=="function",i=typeof r.secureConnect=="function",s=typeof r.close=="function",o=()=>{n&&r.connect(),e instanceof U3.TLSSocket&&i&&(e.authorized?r.secureConnect():e.authorizationError||e.once("secureConnect",r.secureConnect)),s&&e.once("close",r.close)};e.writable&&!e.connecting?o():e.connecting?e.once("connect",o):e.destroyed&&s&&r.close(e._hadError)};pp.default=hp;yp.exports=hp;yp.exports.default=hp});var k2=h((xZ,O2)=>{"use strict";var W3=q2();O2.exports=e=>{let t={start:Date.now(),socket:null,lookup:null,connect:null,upload:null,response:null,end:null,error:null,phases:{wait:null,dns:null,tcp:null,request:null,firstByte:null,download:null,total:null}},r=s=>{let o=s.emit.bind(s);s.emit=(c,...a)=>(c==="error"&&(t.error=Date.now(),t.phases.total=t.error-t.start,s.emit=o),o(c,...a))},n=!1,i=()=>{t.upload=Date.now(),t.phases.request=t.upload-t.connect};return r(e),e.once("socket",s=>{t.socket=Date.now(),t.phases.wait=t.socket-t.start;let o=()=>{t.lookup=Date.now(),t.phases.dns=t.lookup-t.socket};s.once("lookup",o),W3(s,()=>{t.connect=Date.now(),t.lookup===null&&(s.removeListener("lookup",o),t.lookup=t.connect,t.phases.dns=t.lookup-t.socket),t.phases.tcp=t.connect-t.lookup,n&&!t.upload&&i()})}),e.once("finish",()=>{n=!0,t.connect&&i()}),e.once("response",s=>{t.response=Date.now(),t.phases.firstByte=t.response-t.upload,r(s),s.once("end",()=>{t.end=Date.now(),t.phases.download=t.end-t.response,t.phases.total=t.end-t.start})}),t}});var R2=h((TZ,mp)=>{"use strict";var C2=g("net"),ea=class extends Error{constructor(t,r){super(`Timeout awaiting '${r}' for ${t}ms`),this.name="TimeoutError",this.code="ETIMEDOUT",this.event=r}},P2=Symbol("reentry"),H3=()=>{};mp.exports=(e,t,r)=>{if(e[P2])return;e[P2]=!0;let n=!1,i=(f,u,...d)=>{if(n)return H3;let p,m=setTimeout(()=>{p=setImmediate(u,f,...d),p.unref&&p.unref()},f);m.unref&&m.unref();let y=()=>{clearTimeout(m),clearImmediate(p)};return a.push(y),y},{host:s,hostname:o}=r,c=(f,u)=>{e.emit("error",new ea(f,u)),e.once("error",()=>{}),e.abort()},a=[],l=()=>{n=!0,a.forEach(f=>f())};if(e.once("error",l),e.once("response",f=>{f.once("end",l)}),t.request!==void 0&&i(t.request,c,"request"),t.socket!==void 0){let f=()=>{c(t.socket,"socket")};e.setTimeout(t.socket,f),a.push(()=>e.removeListener("timeout",f))}t.lookup!==void 0&&!e.socketPath&&!C2.isIP(o||s)&&e.once("socket",f=>{if(f.connecting){let u=i(t.lookup,c,"lookup");f.once("lookup",u)}}),t.connect!==void 0&&e.once("socket",f=>{if(f.connecting){let u=()=>i(t.connect,c,"connect");e.socketPath||C2.isIP(o||s)?f.once("connect",u()):f.once("lookup",d=>{d===null&&f.once("connect",u())})}}),t.secureConnect!==void 0&&r.protocol==="https:"&&e.once("socket",f=>{f.connecting&&f.once("connect",()=>{let u=i(t.secureConnect,c,"secureConnect");f.once("secureConnect",u)})}),t.send!==void 0&&e.once("socket",f=>{let u=()=>i(t.send,c,"send");f.connecting?f.once("connect",()=>{e.once("upload-complete",u())}):e.once("upload-complete",u())}),t.response!==void 0&&e.once("upload-complete",()=>{let f=i(t.response,c,"response");e.once("response",f)})};mp.exports.TimeoutError=ea});var gp=h((AZ,I2)=>{"use strict";var K2=ft();I2.exports=e=>K2.nodeStream(e)&&K2.function(e.getBoundary)});var M2=h((qZ,j2)=>{"use strict";var B2=g("fs"),N2=g("util"),F3=ft(),G3=gp();j2.exports=async e=>{let{body:t}=e;if(e.headers["content-length"])return Number(e.headers["content-length"]);if(!t&&!e.stream)return 0;if(F3.string(t))return Buffer.byteLength(t);if(G3(t))return N2.promisify(t.getLength.bind(t))();if(t instanceof B2.ReadStream){let{size:r}=await N2.promisify(B2.stat)(t.path);return r}return null}});var J2=h((OZ,D2)=>{"use strict";var z3=g("stream").PassThrough,Y3=g("zlib"),V3=Qc();D2.exports=e=>{if(["gzip","deflate"].indexOf(e.headers["content-encoding"])===-1)return e;let t=Y3.createUnzip(),r=new z3;return V3(e,r),t.on("error",n=>{if(n.code==="Z_BUF_ERROR"){r.end();return}r.emit("error",n)}),e.pipe(t).pipe(r),r}});var _p=h((kZ,L2)=>{"use strict";var{Transform:X3}=g("stream");L2.exports={download(e,t,r){let n=0;return new X3({transform(i,s,o){n+=i.length;let c=r?n/r:0;c<1&&t.emit("downloadProgress",{percent:c,transferred:n,total:r}),o(null,i)},flush(i){t.emit("downloadProgress",{percent:1,transferred:n,total:r}),i()}})},upload(e,t,r){let i=0,s;t.emit("uploadProgress",{percent:0,transferred:0,total:r}),e.once("error",()=>{clearInterval(s)}),e.once("response",()=>{clearInterval(s),t.emit("uploadProgress",{percent:1,transferred:i,total:r})}),e.once("socket",o=>{let c=()=>{s=setInterval(()=>{let a=i,l=e._header?Buffer.byteLength(e._header):0;i=o.bytesWritten-l,!(i===a||i===r)&&t.emit("uploadProgress",{percent:r?i/r:0,transferred:i,total:r})},150)};o.connecting?o.once("connect",c):o.writable&&c()})}}});var W2=h((CZ,U2)=>{"use strict";var $2=J2(),Q3=ft(),Z3=Qc(),eW=_p();U2.exports=(e,t,r)=>{let n=Number(e.headers["content-length"])||null,i=eW.download(e,r,n);Z3(e,i);let s=t.decompress===!0&&Q3.function($2)&&t.method!=="HEAD"?$2(i):i;!t.decompress&&["gzip","deflate"].includes(e.headers["content-encoding"])&&(t.encoding=null),r.emit("response",s),r.emit("downloadProgress",{percent:0,transferred:0,total:n}),e.pipe(i)}});var wp=h((PZ,F2)=>{"use strict";var H2=ft();F2.exports=e=>{let t={protocol:e.protocol,hostname:e.hostname.startsWith("[")?e.hostname.slice(1,-1):e.hostname,hash:e.hash,search:e.search,pathname:e.pathname,href:e.href};return H2.string(e.port)&&e.port.length>0&&(t.port=Number(e.port)),(e.username||e.password)&&(t.auth=`${e.username}:${e.password}`),t.path=H2.null(e.search)?e.pathname:`${e.pathname}${e.search}`,t}});var bp=h((RZ,X2)=>{"use strict";var{URL:G2}=g("url"),z2=g("util"),tW=g("events"),rW=g("http"),nW=g("https"),iW=g("url"),Y2=x2(),sW=A2(),Ut=ft(),oW=k2(),V2=R2(),cW=M2(),aW=W2(),uW=_p(),{CacheError:lW,UnsupportedProtocolError:fW,MaxRedirectsError:dW,RequestError:ta,TimeoutError:hW}=as(),pW=wp(),yW=new Set([300,301,302,303,304,305,307,308]),mW=new Set([300,303,307,308]);X2.exports=(e,t)=>{let r=new tW,n=[],i,s,o,c,a=0,l=!1,f=e.cookieJar?z2.promisify(e.cookieJar.setCookie.bind(e.cookieJar)):null,u=e.cookieJar?z2.promisify(e.cookieJar.getCookieString.bind(e.cookieJar)):null,d=Ut.object(e.agent)?e.agent:null,p=async y=>{try{for(let _ of e.hooks.beforeError)y=await _(y);r.emit("error",y)}catch(_){r.emit("error",_)}},m=async y=>{let _=o||s;if(y.protocol!=="http:"&&y.protocol!=="https:")throw new fW(y);decodeURI(_);let b;if(Ut.function(y.request)?b={request:y.request}:b=y.protocol==="https:"?nW:rW,d){let E=y.protocol==="https:"?"https":"http";y.agent=d[E]||y.agent}if(y.useElectronNet&&process.versions.electron){let E={x:g}["yx".slice(1)],x=E("electron");b=x.net||x.remote.net}if(y.cookieJar){let E=await u(_,{});Ut.nonEmptyString(E)&&(y.headers.cookie=E)}let w,v=async E=>{try{y.useElectronNet&&(E=new Proxy(E,{get:(T,R)=>{if(R==="trailers"||R==="rawTrailers")return[];let k=T[R];return Ut.function(k)?k.bind(T):k}}));let{statusCode:x}=E;E.url=_,E.requestUrl=s,E.retryCount=a,E.timings=w,E.redirectUrls=n,E.request={gotOptions:y};let q=E.headers["set-cookie"];if(y.cookieJar&&q&&await Promise.all(q.map(T=>f(T,E.url))),y.followRedirect&&"location"in E.headers&&(mW.has(x)||yW.has(x)&&(y.method==="GET"||y.method==="HEAD"))){if(E.resume(),x===303&&(y.method="GET"),n.length>=10)throw new dW(x,n,y);let T=Buffer.from(E.headers.location,"binary").toString(),R=new G2(T,_);o=R.toString(),n.push(o);let k={...y,...pW(R)};for(let ee of y.hooks.beforeRedirect)await ee(k);r.emit("redirect",E,k),await m(k);return}aW(E,y,r)}catch(x){p(x)}},S=E=>{if(l){E.once("error",()=>{}),E.abort();return}i=E,E.once("error",q=>{E.aborted||(q instanceof V2.TimeoutError?q=new hW(q,y):q=new ta(q,y),r.retry(q)===!1&&p(q))}),w=oW(E),uW.upload(E,r,c),y.gotTimeout&&V2(E,y.gotTimeout,y),r.emit("request",E);let x=()=>{E.emit("upload-complete")};try{Ut.nodeStream(y.body)?(y.body.once("end",x),y.body.pipe(E),y.body=void 0):y.body?E.end(y.body,x):t&&(y.method==="POST"||y.method==="PUT"||y.method==="PATCH")?(t.once("end",x),t.pipe(E)):E.end(x)}catch(q){p(new ta(q,y))}};if(y.cache){let x=new Y2(b.request,y.cache)(y,v);x.once("error",q=>{q instanceof Y2.RequestError?p(new ta(q,y)):p(new lW(q,y))}),x.once("request",S)}else try{S(b.request(y,v))}catch(E){p(new ta(E,y))}};return r.retry=y=>{let _;try{_=e.retry.retries(++a,y)}catch(b){p(b);return}return _?(setTimeout(async w=>{try{for(let v of w.hooks.beforeRetry)await v(w,y,a);await m(w)}catch(v){p(v)}},_,{...e,forceRefresh:!0}),!0):!1},r.abort=()=>{i?(i.once("error",()=>{}),i.abort()):l=!0},setImmediate(async()=>{try{let{body:y}=e;Ut.buffer(y)?(e.body=sW(y),c=y.length):c=await cW(e),Ut.undefined(e.headers["content-length"])&&Ut.undefined(e.headers["transfer-encoding"])&&(c>0||e.method==="PUT")&&!Ut.null(c)&&(e.headers["content-length"]=c);for(let _ of e.hooks.beforeRequest)await _(e);s=e.href||new G2(e.path,iW.format(e)).toString(),await m(e)}catch(y){p(y)}}),r}});var eO=h((IZ,Z2)=>{"use strict";var{PassThrough:Q2}=g("stream"),gW=Hq(),_W=bp(),{HTTPError:wW,ReadError:bW}=as();Z2.exports=e=>{let t=new Q2,r=new Q2,n=gW(t,r),i=new Set,s=!1;e.retry.retries=()=>0,e.body&&(n.write=()=>{throw new Error("Got's stream is not writable when the `body` option is used")});let o=_W(e,t);n._destroy=o.abort,o.on("response",l=>{let{statusCode:f}=l;if(l.on("error",u=>{n.emit("error",new bW(u,e))}),e.throwHttpErrors&&f!==304&&(f<200||f>299)){n.emit("error",new wW(l,e),null,l);return}s=!0,l.pipe(r);for(let u of i)if(!u.headersSent){for(let[d,p]of Object.entries(l.headers))(e.decompress?d!=="content-encoding":!0)&&u.setHeader(d,p);u.statusCode=l.statusCode}n.emit("response",l)}),["error","request","redirect","uploadProgress","downloadProgress"].forEach(l=>o.on(l,(...f)=>n.emit(l,...f)));let c=n.pipe.bind(n),a=n.unpipe.bind(n);return n.pipe=(l,f)=>{if(s)throw new Error("Failed to pipe. The response has been emitted already.");let u=c(l,f);return Reflect.has(l,"setHeader")&&i.add(l),u},n.unpipe=l=>(i.delete(l),a(l)),n}});var rO=h((BZ,tO)=>{"use strict";var{PassThrough:EW}=g("stream");tO.exports=e=>{e=Object.assign({},e);let{array:t}=e,{encoding:r}=e,n=r==="buffer",i=!1;t?i=!(r||n):r=r||"utf8",n&&(r=null);let s=0,o=[],c=new EW({objectMode:i});return r&&c.setEncoding(r),c.on("data",a=>{o.push(a),i?s=o.length:s+=a.length}),c.getBufferedValue=()=>t?o:n?Buffer.concat(o,s):o.join(""),c.getBufferedLength=()=>s,c}});var nO=h((NZ,ls)=>{"use strict";var vW=sp(),SW=rO(),ra=class extends Error{constructor(){super("maxBuffer exceeded"),this.name="MaxBufferError"}};function Ep(e,t){if(!e)return Promise.reject(new Error("Expected a stream"));t=Object.assign({maxBuffer:1/0},t);let{maxBuffer:r}=t,n;return new Promise((i,s)=>{let o=c=>{c&&(c.bufferedData=n.getBufferedValue()),s(c)};n=vW(e,SW(t),c=>{if(c){o(c);return}i()}),n.on("data",()=>{n.getBufferedLength()>r&&o(new ra)})}).then(()=>n.getBufferedValue())}ls.exports=Ep;ls.exports.buffer=(e,t)=>Ep(e,Object.assign({},t,{encoding:"buffer"}));ls.exports.array=(e,t)=>Ep(e,Object.assign({},t,{array:!0}));ls.exports.MaxBufferError=ra});var vp=h((jZ,iO)=>{"use strict";iO.exports=["beforeError","init","beforeRequest","beforeRedirect","beforeRetry","afterResponse"]});var ia=h((MZ,na)=>{"use strict";var{URL:xW}=g("url"),zr=ft(),sO=vp(),fs=(e,...t)=>{for(let r of t)for(let[n,i]of Object.entries(r)){if(zr.undefined(i))continue;let s=e[n];zr.urlInstance(s)&&(zr.urlInstance(i)||zr.string(i))?e[n]=new xW(i,s):zr.plainObject(i)?zr.plainObject(s)?e[n]=fs({},s,i):e[n]=fs({},i):zr.array(i)?e[n]=fs([],i):e[n]=i}return e},oO=(...e)=>{e=e.map(n=>n||{});let t=fs({},...e),r={};for(let n of sO)r[n]=[];for(let n of e)if(n.hooks)for(let i of sO)r[i]=r[i].concat(n.hooks[i]);return t.hooks=r,t},TW=(e,t)=>{let r=e.map(i=>i.defaults.handler),n=e.length-1;return{methods:t,options:oO(...e.map(i=>i.defaults.options)),handler:(i,s)=>{let o=-1,c=a=>r[++o](a,o===n?s:c);return c(i)}}};na.exports=fs;na.exports.options=oO;na.exports.instances=TW});var aO=h((DZ,cO)=>{"use strict";cO.exports=(e,t)=>{if(typeof e!="string")throw new TypeError(`Expected \`url\` to be of type \`string\`, got \`${typeof e}\``);return e=e.trim(),t=Object.assign({https:!1},t),/^\.*\/|^(?!localhost)\w+:/.test(e)?e:e.replace(/^(?!(?:\w+:)?\/\/)/,t.https?"https://":"http://")}});var lO=h((JZ,uO)=>{"use strict";var AW=g("url"),qW=aO();uO.exports=(e,t)=>{if(typeof e!="string")throw new TypeError(`Expected \`url\` to be of type \`string\`, got \`${typeof e}\` instead.`);let r=qW(e,Object.assign({https:!0},t));return AW.parse(r)}});var Ap=h((LZ,sa)=>{"use strict";var{URL:OW,URLSearchParams:Sp}=g("url"),kW=g("url"),I=ft(),CW=lO(),PW=cp(),fO=wp(),RW=gp(),xp=ia(),KW=vp(),IW=new Set([413,429,503]),Tp=(e,t)=>{if(I.nullOrUndefined(e.headers)?e.headers={}:e.headers=PW(e.headers),e.baseUrl&&!e.baseUrl.toString().endsWith("/")&&(e.baseUrl+="/"),e.stream&&(e.json=!1),I.nullOrUndefined(e.hooks))e.hooks={};else if(!I.object(e.hooks))throw new TypeError(`Parameter \`hooks\` must be an object, not ${I(e.hooks)}`);for(let n of KW)I.nullOrUndefined(e.hooks[n])&&(t?e.hooks[n]=[...t.hooks[n]]:e.hooks[n]=[]);I.number(e.timeout)?e.gotTimeout={request:e.timeout}:I.object(e.timeout)&&(e.gotTimeout=e.timeout),delete e.timeout;let{retry:r}=e;return e.retry={retries:0,methods:[],statusCodes:[],errorCodes:[]},I.nonEmptyObject(t)&&r!==!1&&(e.retry={...t.retry}),r!==!1&&(I.number(r)?e.retry.retries=r:e.retry={...e.retry,...r}),e.gotTimeout&&(e.retry.maxRetryAfter=Math.min(...[e.gotTimeout.request,e.gotTimeout.connection].filter(n=>!I.nullOrUndefined(n)))),I.array(e.retry.methods)&&(e.retry.methods=new Set(e.retry.methods.map(n=>n.toUpperCase()))),I.array(e.retry.statusCodes)&&(e.retry.statusCodes=new Set(e.retry.statusCodes)),I.array(e.retry.errorCodes)&&(e.retry.errorCodes=new Set(e.retry.errorCodes)),e},dO=(e,t,r)=>{if(I.plainObject(e)&&(t={...e,...t},e=t.url||{},delete t.url),r?t=xp({},r.options,t?Tp(t,r.options):{}):t=xp({},Tp(t)),!I.string(e)&&!I.object(e))throw new TypeError(`Parameter \`url\` must be a string or object, not ${I(e)}`);I.string(e)?t.baseUrl?(e.toString().startsWith("/")&&(e=e.toString().slice(1)),e=fO(new OW(e,t.baseUrl))):(e=e.replace(/^unix:/,"http://$&"),e=CW(e)):I(e)==="URL"&&(e=fO(e)),t=xp({path:""},e,{protocol:e.protocol||"https:"},t);for(let c of t.hooks.init){let a=c(t);if(I.promise(a))throw new TypeError("The `init` hook must be a synchronous function")}let{baseUrl:n}=t;Object.defineProperty(t,"baseUrl",{set:()=>{throw new Error("Failed to set baseUrl. Options are normalized already.")},get:()=>n});let{query:i}=t;if((I.nonEmptyString(i)||I.nonEmptyObject(i)||i instanceof Sp)&&(I.string(i)||(t.query=new Sp(i).toString()),t.path=`${t.path.split("?")[0]}?${t.query}`,delete t.query),t.hostname==="unix"){let c=/(.+?):(.+)/.exec(t.path);if(c){let[,a,l]=c;t={...t,socketPath:a,path:l,host:null}}}let{headers:s}=t;for(let[c,a]of Object.entries(s))I.nullOrUndefined(a)&&delete s[c];t.json&&I.undefined(s.accept)&&(s.accept="application/json"),t.decompress&&I.undefined(s["accept-encoding"])&&(s["accept-encoding"]="gzip, deflate");let{body:o}=t;if(I.nullOrUndefined(o))t.method=t.method?t.method.toUpperCase():"GET";else{let c=I.object(o)&&!I.buffer(o)&&!I.nodeStream(o);if(!I.nodeStream(o)&&!I.string(o)&&!I.buffer(o)&&!(t.form||t.json))throw new TypeError("The `body` option must be a stream.Readable, string or Buffer");if(t.json&&!(c||I.array(o)))throw new TypeError("The `body` option must be an Object or Array when the `json` option is used");if(t.form&&!c)throw new TypeError("The `body` option must be an Object when the `form` option is used");RW(o)?s["content-type"]=s["content-type"]||`multipart/form-data; boundary=${o.getBoundary()}`:t.form?(s["content-type"]=s["content-type"]||"application/x-www-form-urlencoded",t.body=new Sp(o).toString()):t.json&&(s["content-type"]=s["content-type"]||"application/json",t.body=JSON.stringify(o)),t.method=t.method?t.method.toUpperCase():"POST"}if(!I.function(t.retry.retries)){let{retries:c}=t.retry;t.retry.retries=(a,l)=>{if(a>c||(!l||!t.retry.errorCodes.has(l.code))&&(!t.retry.methods.has(l.method)||!t.retry.statusCodes.has(l.statusCode)))return 0;if(Reflect.has(l,"headers")&&Reflect.has(l.headers,"retry-after")&&IW.has(l.statusCode)){let u=Number(l.headers["retry-after"]);return I.nan(u)?u=Date.parse(l.headers["retry-after"])-Date.now():u*=1e3,u>t.retry.maxRetryAfter?0:u}if(l.statusCode===413)return 0;let f=Math.random()*100;return 2**(a-1)*1e3+f}}return t},BW=e=>dO(kW.format(e),e);sa.exports=dO;sa.exports.preNormalize=Tp;sa.exports.reNormalize=BW});var mO=h(($Z,yO)=>{"use strict";var NW=g("events"),hO=nO(),jW=ft(),MW=Yh(),DW=bp(),{HTTPError:JW,ParseError:LW,ReadError:$W}=as(),{options:UW}=ia(),{reNormalize:WW}=Ap(),pO=e=>{let t=new NW,r=new MW((n,i,s)=>{let o=DW(e);s(o.abort),o.on("response",async c=>{t.emit("response",c);let a=jW.null(e.encoding)?hO.buffer(c):hO(c,e),l;try{l=await a}catch(d){i(new $W(d,e));return}let f=e.followRedirect?299:399;c.body=l;try{for(let[d,p]of Object.entries(e.hooks.afterResponse))c=await p(c,m=>(m=WW(UW(e,{...m,retry:0,throwHttpErrors:!1})),m.hooks.afterResponse=e.hooks.afterResponse.slice(0,d),pO(m)))}catch(d){i(d);return}let{statusCode:u}=c;if(e.json&&c.body)try{c.body=JSON.parse(c.body)}catch(d){if(u>=200&&u<300){let p=new LW(d,u,e,l);Object.defineProperty(p,"response",{value:c}),i(p);return}}if(u!==304&&(u<200||u>f)){let d=new JW(c,e);if(Object.defineProperty(d,"response",{value:c}),o.retry(d)===!1){if(e.throwHttpErrors){i(d);return}n(c)}return}n(c)}),o.once("error",i),["request","redirect","uploadProgress","downloadProgress"].forEach(c=>o.on(c,(...a)=>t.emit(c,...a)))});return r.on=(n,i)=>(t.on(n,i),r),r};yO.exports=pO});var wO=h((UZ,_O)=>{"use strict";var gO=ft();_O.exports=function e(t){for(let[r,n]of Object.entries(t))(gO.plainObject(n)||gO.array(n))&&e(t[r]);return Object.freeze(t)}});var vO=h((WZ,EO)=>{"use strict";var HW=as(),FW=eO(),GW=mO(),bO=Ap(),oa=ia(),zW=wO(),YW=e=>e.stream?FW(e):GW(e),VW=["get","post","put","patch","head","delete"],ca=e=>{e=oa({},e),bO.preNormalize(e.options),e.handler||(e.handler=(r,n)=>n(r));function t(r,n){try{return e.handler(bO(r,n,e),YW)}catch(i){if(n&&n.stream)throw i;return Promise.reject(i)}}t.create=ca,t.extend=r=>{let n;return r&&Reflect.has(r,"mutableDefaults")?(n=r.mutableDefaults,delete r.mutableDefaults):n=e.mutableDefaults,ca({options:oa.options(e.options,r),handler:e.handler,mutableDefaults:n})},t.mergeInstances=(...r)=>ca(oa.instances(r)),t.stream=(r,n)=>t(r,{...n,stream:!0});for(let r of VW)t[r]=(n,i)=>t(n,{...i,method:r}),t.stream[r]=(n,i)=>t.stream(n,{...i,method:r});return Object.assign(t,{...HW,mergeOptions:oa.options}),Object.defineProperty(t,"defaults",{value:e.mutableDefaults?e:zW(e),writable:e.mutableDefaults,configurable:e.mutableDefaults,enumerable:!0}),t};EO.exports=ca});var qp=h((HZ,xO)=>{"use strict";var SO=Uq(),XW=vO(),QW={options:{retry:{retries:2,methods:["GET","PUT","HEAD","DELETE","OPTIONS","TRACE"],statusCodes:[408,413,429,500,502,503,504],errorCodes:["ETIMEDOUT","ECONNRESET","EADDRINUSE","ECONNREFUSED","EPIPE","ENOTFOUND","ENETUNREACH","EAI_AGAIN"]},headers:{"user-agent":`${SO.name}/${SO.version} (https://github.com/sindresorhus/got)`},hooks:{beforeRequest:[],beforeRedirect:[],beforeRetry:[],afterResponse:[]},decompress:!0,throwHttpErrors:!0,followRedirect:!0,stream:!1,form:!1,json:!1,cache:!1,useElectronNet:!1},mutableDefaults:!1},ZW=XW(QW);xO.exports=ZW});var TO=h(Op=>{"use strict";Object.defineProperty(Op,"__esModule",{value:!0});function e8(e){var t=4,r=e.length,n=r%t;if(!n)return e;var i=r,s=t-n,o=r+s,c=Buffer.alloc(o);for(c.write(e);s--;)c.write("=",i++);return c.toString()}Op.default=e8});var qO=h(Pp=>{"use strict";Object.defineProperty(Pp,"__esModule",{value:!0});var t8=TO();function AO(e,t){return t===void 0&&(t="utf8"),Buffer.isBuffer(e)?kp(e.toString("base64")):kp(Buffer.from(e,t).toString("base64"))}function r8(e,t){return t===void 0&&(t="utf8"),Buffer.from(Cp(e),"base64").toString(t)}function Cp(e){return e=e.toString(),t8.default(e).replace(/\-/g,"+").replace(/_/g,"/")}function kp(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function n8(e){return Buffer.from(Cp(e),"base64")}var Un=AO;Un.encode=AO;Un.decode=r8;Un.toBase64=Cp;Un.fromBase64=kp;Un.toBuffer=n8;Pp.default=Un});var ua=h((zZ,aa)=>{aa.exports=qO().default;aa.exports.default=aa.exports});var CO=h((YZ,kO)=>{var i8=g("crypto"),[OO,s8]=process.version.substring(1).split(".").map(e=>parseInt(e,10)),o8=OO>12||OO===12&&s8>=8,c8=o8&&i8.getHashes().includes("shake256");kO.exports=c8});var IO=h((VZ,KO)=>{var{strict:Rp}=g("assert"),{createHash:ds}=g("crypto"),{format:PO}=g("util"),a8=CO(),Kp;if(Buffer.isEncoding("base64url"))Kp=e=>e.toString("base64url");else{let e=t=>t.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_");Kp=t=>e(t.toString("base64"))}function u8(e,t){switch(e){case"HS256":case"RS256":case"PS256":case"ES256":case"ES256K":return ds("sha256");case"HS384":case"RS384":case"PS384":case"ES384":return ds("sha384");case"HS512":case"RS512":case"PS512":case"ES512":return ds("sha512");case"EdDSA":switch(t){case"Ed25519":return ds("sha512");case"Ed448":if(!a8)throw new TypeError("Ed448 *_hash calculation is not supported in your Node.js runtime version");return ds("shake256",{outputLength:114});default:throw new TypeError("unrecognized or invalid EdDSA curve provided")}default:throw new TypeError("unrecognized or invalid JWS algorithm provided")}}function RO(e,t,r){let n=u8(t,r).update(e).digest();return Kp(n.slice(0,n.length/2))}function l8(e,t,r,n,i){if(typeof e.claim!="string"||!e.claim)throw new TypeError("names.claim must be a non-empty string");if(typeof e.source!="string"||!e.source)throw new TypeError("names.source must be a non-empty string");Rp(typeof t=="string"&&t,`${e.claim} must be a non-empty string`),Rp(typeof r=="string"&&r,`${e.source} must be a non-empty string`);let s,o;try{s=RO(r,n,i)}catch(c){o=PO("%s could not be validated (%s)",e.claim,c.message)}o=o||PO("%s mismatch, expected %s, got: %s",e.claim,s,t),Rp.equal(s,t,o)}KO.exports={validate:l8,generate:RO}});var la=h((XZ,BO)=>{BO.exports=e=>!!e&&e.constructor===Object});var jp=h((QZ,Np)=>{var Ip=la();function Bp(e,t,...r){for(let n of r)if(!!Ip(n))for(let[i,s]of Object.entries(n))i==="__proto__"||i==="constructor"||(typeof t[i]>"u"&&typeof s<"u"&&(t[i]=s),e&&Ip(t[i])&&Ip(s)&&Bp(!0,t[i],s));return t}Np.exports=Bp.bind(void 0,!1);Np.exports.deep=Bp.bind(void 0,!0)});var fa=h((ZZ,NO)=>{function f8(e,t,r){if(!t[`${e}_endpoint`])return;let n=`${e}_endpoint_auth_method`,i=`${e}_endpoint_auth_signing_alg`,s=`${e}_endpoint_auth_signing_alg_values_supported`;if(r[n]&&r[n].endsWith("_jwt")&&!r[i]&&!t[s])throw new TypeError(`${s} must be configured on the issuer if ${i} is not defined on a client`)}function d8(e,t){if(!e[t])throw new TypeError(`${t} must be configured on the issuer`)}NO.exports={assertSigningAlgValuesSupport:f8,assertIssuerConfiguration:d8}});var Mp=h((eee,jO)=>{jO.exports=function(t,...r){let n={};for(let i of r)t[i]&&(n[i]=t[i]);return n}});var ha=h((tee,DO)=>{var{STATUS_CODES:Dp}=g("http"),{format:MO}=g("util"),{OPError:da}=Hr(),h8=/(\w+)=("[^"]*")/g,p8=e=>{let t={};try{for(;h8.exec(e.headers["www-authenticate"])!==null;)RegExp.$1&&RegExp.$2&&(t[RegExp.$1]=RegExp.$2.slice(1,-1))}catch{}if(t.error)throw new da(t,e)},y8=e=>{let t=!1;try{let r;typeof e.body!="object"||Buffer.isBuffer(e.body)?r=JSON.parse(e.body):r=e.body,t=typeof r.error=="string"&&r.error.length,t&&(e.body=r)}catch{}return t};function m8(e,{statusCode:t=200,body:r=!0,bearer:n=!1}={}){if(e.statusCode!==t)throw n&&p8(e),y8(e)?new da(e.body,e):new da({error:MO("expected %i %s, got: %i %s",t,Dp[t],e.statusCode,Dp[e.statusCode])},e);if(r&&!e.body)throw new da({error:MO("expected %i %s with body but no body was returned",t,Dp[t])},e);return e.body}DO.exports=m8});var hs=h((ree,JO)=>{JO.exports=()=>Math.floor(Date.now()/1e3)});var pa=h((nee,$O)=>{var g8=ua(),LO=hs(),Jp=class{constructor(t){Object.assign(this,t)}set expires_in(t){this.expires_at=LO()+Number(t)}get expires_in(){return Math.max.apply(null,[this.expires_at-LO(),0])}expired(){return this.expires_in===0}claims(){if(!this.id_token)throw new TypeError("id_token not present in TokenSet");return JSON.parse(g8.decode(this.id_token.split(".")[1]))}};$O.exports=Jp});var ps=h((iee,WO)=>{var{createHash:_8,randomBytes:w8}=g("crypto"),{encode:UO}=ua(),ya=(e=32)=>UO(w8(e));WO.exports={random:ya,state:ya,nonce:ya,codeVerifier:ya,codeChallenge:e=>UO(_8("sha256").update(e).digest())}});var HO=h((see,b8)=>{b8.exports={name:"openid-client",version:"3.15.10",description:"OpenID Connect Relying Party (RP, Client) implementation for Node.js runtime, supports passportjs",keywords:["auth","authentication","basic","certified","client","connect","dynamic","electron","hybrid","identity","implicit","oauth","oauth2","oidc","openid","passport","relying party","strategy"],homepage:"https://github.com/panva/node-openid-client",repository:"panva/node-openid-client",license:"MIT",author:"Filip Skokan <panva.ip@gmail.com>",files:["lib","types/index.d.ts"],funding:{url:"https://github.com/sponsors/panva"},main:"lib/index.js",types:"types/index.d.ts",scripts:{coverage:"nyc mocha test/**/*.test.js",lint:"eslint lib test","lint-ts":"npx typescript@~3.6.0 --build types","lint-fix":"eslint lib test --fix",test:"mocha test/**/*.test.js"},dependencies:{"@types/got":"^9.6.9",base64url:"^3.0.1",got:"^9.6.0",jose:"^1.27.1","lru-cache":"^6.0.0","make-error":"^1.3.6","object-hash":"^2.0.1","oidc-token-hash":"^5.0.0","p-any":"^3.0.0"},devDependencies:{"@commitlint/cli":"^9.1.1","@commitlint/config-conventional":"^9.1.1","@types/passport":"^1.0.4",chai:"^4.2.0",eslint:"^7.4.0","eslint-config-airbnb-base":"^14.2.0","eslint-plugin-import":"^2.21.2",husky:"^4.0.0",mocha:"^8.0.1",nock:"^13.0.2",nyc:"^15.1.0","readable-mock-req":"^0.2.2",sinon:"^9.0.0",timekeeper:"^2.2.0"},engines:{node:"^10.13.0 || >=12.0.0"},commitlint:{extends:["@commitlint/config-conventional"]},husky:{hooks:{"commit-msg":"commitlint -E HUSKY_GIT_PARAMS"}},nyc:{reporter:["lcov","text-summary"]},"standard-version":{scripts:{postchangelog:"sed -i '' -e 's/### \\[/## [/g' CHANGELOG.md"}}}});var GO=h((oee,FO)=>{var E8=g("url"),{strict:v8}=g("assert");FO.exports=e=>{try{let{protocol:t}=new E8.URL(e);return v8(t.match(/^(https?:)$/)),!0}catch{throw new TypeError("only valid absolute URLs can be requested")}}});var ms=h((cee,zO)=>{var ys="/.well-known/openid-configuration",S8="/.well-known/oauth-authorization-server",x8="/.well-known/webfinger",T8="http://openid.net/specs/connect/1.0/issuer",A8=[`https://login.microsoftonline.com/common${ys}`,`https://login.microsoftonline.com/common/v2.0${ys}`,`https://login.microsoftonline.com/organizations/v2.0${ys}`,`https://login.microsoftonline.com/consumers/v2.0${ys}`],q8={grant_types:["authorization_code"],id_token_signed_response_alg:"RS256",authorization_signed_response_alg:"RS256",response_types:["code"],token_endpoint_auth_method:"client_secret_basic"},O8={claim_types_supported:["normal"],claims_parameter_supported:!1,grant_types_supported:["authorization_code","implicit"],request_parameter_supported:!1,request_uri_parameter_supported:!0,require_request_uri_registration:!1,response_modes_supported:["query","fragment"],token_endpoint_auth_methods_supported:["client_secret_basic"]},k8=["access_token","code","error","error_description","error_uri","expires_in","id_token","state","token_type","session_state","response"],C8=/^application\/jwt/,P8=Symbol("openid-client.custom.http-options"),R8=Symbol("openid-client.custom.clock-tolerance");zO.exports={AAD_MULTITENANT_DISCOVERY:A8,CALLBACK_PROPERTIES:k8,CLIENT_DEFAULTS:q8,CLOCK_TOLERANCE:R8,HTTP_OPTIONS:P8,ISSUER_DEFAULTS:O8,JWT_CONTENT:C8,OAUTH2_DISCOVERY:S8,OIDC_DISCOVERY:ys,REL:T8,WEBFINGER:x8}});var gs=h((aee,$p)=>{var K8=qp(),Lp=HO(),{deep:YO}=jp(),I8=GO(),{HTTP_OPTIONS:B8}=ms(),ma,VO,XO=e=>{ma=YO({},e,ma),VO=K8.extend(ma)};XO({followRedirect:!1,headers:{"User-Agent":`${Lp.name}/${Lp.version} (${Lp.homepage})`},retry:0,timeout:2500,throwHttpErrors:!1});$p.exports=function(t,{mTLS:r=!1}={}){let{url:n}=t;I8(n);let i=this[B8],s;if(i?s=i.call(this,YO({},t,ma)):s=t,r&&(!s.key||!s.cert))throw new TypeError("mutual-TLS certificate and key not set");return VO(s)};$p.exports.setDefaults=XO});var ga=h((uee,QO)=>{var N8=new Map;QO.exports=N8});var _s=h((lee,ZO)=>{var Up=new WeakMap;ZO.exports=e=>(Up.has(e)||Up.set(e,new Map([["metadata",new Map]])),Up.get(e))});var rk=h((fee,tk)=>{var Wp=la();function ek(e,...t){for(let r of t)if(!!Wp(r))for(let[n,i]of Object.entries(r))n==="__proto__"||n==="constructor"||(Wp(e[n])&&Wp(i)?e[n]=ek(e[n],i):typeof i<"u"&&(e[n]=i));return e}tk.exports=ek});var _a=h((dee,ok)=>{var nk=Mc(),{assertIssuerConfiguration:j8}=fa(),{random:M8}=ps(),D8=hs(),J8=gs(),L8=_s(),$8=rk(),ik=e=>encodeURIComponent(e).replace(/%20/g,"+");async function U8(e,t){let r=this[`${e}_endpoint_auth_signing_alg`];if(r||j8(this.issuer,`${e}_endpoint_auth_signing_alg_values_supported`),this[`${e}_endpoint_auth_method`]==="client_secret_jwt"){let s=await this.joseSecret();if(!r){let o=this.issuer[`${e}_endpoint_auth_signing_alg_values_supported`];r=Array.isArray(o)&&o.find(c=>s.algorithms("sign").has(c))}return nk.JWS.sign(t,s,{alg:r,typ:"JWT"})}let n=L8(this).get("keystore");if(!n)throw new TypeError("no client jwks provided for signing a client assertion with");if(!r){let s=new Set;n.all().forEach(c=>{c.algorithms("sign").forEach(Set.prototype.add.bind(s))});let o=this.issuer[`${e}_endpoint_auth_signing_alg_values_supported`];r=Array.isArray(o)&&o.find(c=>s.has(c))}let i=n.get({alg:r,use:"sig"});if(!i)throw new TypeError(`no key found in client jwks to sign a client assertion with using alg ${r}`);return nk.JWS.sign(t,i,{alg:r,typ:"JWT",kid:i.kid})}async function sk(e,{clientAssertionPayload:t}={}){switch(this[`${e}_endpoint_auth_method`]){case"self_signed_tls_client_auth":case"tls_client_auth":case"none":return{body:{client_id:this.client_id}};case"client_secret_post":if(!this.client_secret)throw new TypeError("client_secret_post client authentication method requires a client_secret");return{body:{client_id:this.client_id,client_secret:this.client_secret}};case"private_key_jwt":case"client_secret_jwt":{let n=D8(),i=await U8.call(this,e,{iat:n,exp:n+60,jti:M8(),iss:this.client_id,sub:this.client_id,aud:this.issuer[`${e}_endpoint`],...t});return{body:{client_id:this.client_id,client_assertion:i,client_assertion_type:"urn:ietf:params:oauth:client-assertion-type:jwt-bearer"}}}default:{if(!this.client_secret)throw new TypeError("client_secret_basic client authentication method requires a client_secret");let n=`${ik(this.client_id)}:${ik(this.client_secret)}`;return{headers:{Authorization:`Basic ${Buffer.from(n).toString("base64")}`}}}}}function W8(){let{length:e,0:t}=this.response_types;if(e===1)return t}function H8(){let{length:e,0:t}=this.redirect_uris||[];if(e===1)return t}async function F8(e,t,{clientAssertionPayload:r,endpointAuthMethod:n=e}={}){let i=await sk.call(this,n,{clientAssertionPayload:r}),s=$8(t,i,{form:!0}),o=this[`${n}_endpoint_auth_method`].includes("tls_client_auth")||e==="token"&&this.tls_client_certificate_bound_access_tokens,c;if(o&&this.issuer.mtls_endpoint_aliases&&(c=this.issuer.mtls_endpoint_aliases[`${e}_endpoint`]),c=c||this.issuer[`${e}_endpoint`],"body"in s)for(let[a,l]of Object.entries(s.body))typeof l>"u"&&delete s.body[a];return J8.call(this,{...s,method:"POST",url:c},{mTLS:o})}ok.exports={resolveResponseType:W8,resolveRedirectUri:H8,authFor:sk,authenticatedPost:F8}});var lk=h((hee,uk)=>{var{inspect:ck}=g("util"),{RPError:Hp,OPError:G8}=Hr(),V=_s(),ak=hs(),{authenticatedPost:z8}=_a(),Y8=ha(),V8=pa(),Fp=class{constructor({client:t,exchangeBody:r,clientAssertionPayload:n,response:i,maxAge:s}){if(["verification_uri","user_code","device_code"].forEach(o=>{if(typeof i[o]!="string"||!i[o])throw new Hp(`expected ${o} string to be returned by Device Authorization Response, got %j`,i[o])}),!Number.isSafeInteger(i.expires_in))throw new Hp("expected expires_in number to be returned by Device Authorization Response, got %j",i.expires_in);V(this).expires_at=ak()+i.expires_in,V(this).client=t,V(this).maxAge=s,V(this).exchangeBody=r,V(this).clientAssertionPayload=n,V(this).response=i,V(this).interval=i.interval*1e3||5e3}async poll(){if(this.expired())throw new Hp("the device code %j has expired and the device authorization session has concluded",this.device_code);await new Promise(i=>setTimeout(i,V(this).interval));let t=await z8.call(V(this).client,"token",{form:!0,body:{...V(this).exchangeBody,grant_type:"urn:ietf:params:oauth:grant-type:device_code",device_code:this.device_code},json:!0},{clientAssertionPayload:V(this).clientAssertionPayload}),r;try{r=Y8(t)}catch(i){switch(i instanceof G8&&i.error){case"slow_down":V(this).interval+=5e3;case"authorization_pending":return this.poll();default:throw i}}let n=new V8(r);return"id_token"in n&&(await V(this).client.decryptIdToken(n),await V(this).client.validateIdToken(n,void 0,"token",V(this).maxAge)),n}get device_code(){return V(this).response.device_code}get user_code(){return V(this).response.user_code}get verification_uri(){return V(this).response.verification_uri}get verification_uri_complete(){return V(this).response.verification_uri_complete}get expires_in(){return Math.max.apply(null,[V(this).expires_at-ak(),0])}expired(){return this.expires_in===0}[ck.custom](){return`${this.constructor.name} ${ck(V(this).response,{depth:1/0,colors:process.stdout.isTTY,compact:!1,sorted:!0})}`}};uk.exports=Fp});var Zp=h((yee,Qp)=>{var{inspect:fk,deprecate:X8}=g("util"),Q8=g("http"),Z8=g("crypto"),{strict:Gp}=g("assert"),dk=g("querystring"),Wt=g("url"),{ParseError:eH}=qp(),gt=Mc(),ws=ua(),zp=IO(),wk=jp(),{assertSigningAlgValuesSupport:hk,assertIssuerConfiguration:Ht}=fa(),tH=Mp(),yt=la(),lr=ha(),me=pa(),{OPError:Xp,RPError:P}=Hr(),wa=hs(),{random:rH}=ps(),bs=gs(),{CALLBACK_PROPERTIES:nH,CLIENT_DEFAULTS:iH,JWT_CONTENT:sH,CLOCK_TOLERANCE:mt}=ms(),pk=ga(),Oe=_s(),{authenticatedPost:ba,resolveResponseType:oH,resolveRedirectUri:cH}=_a(),aH=lk(),{deep:Yp}=wk;function fr(e){return tH(e,...nH)}function Es(e,t="Bearer"){return`${t} ${e}`}function yk(e){Object.keys(e._claim_names).length===0&&delete e._claim_names,Object.keys(e._claim_sources).length===0&&delete e._claim_sources}function mk(e,t,r,n=!0){return([i,s])=>{if(s===r){if(n&&t[i]===void 0)throw new P(`expected claim "${i}" in "${r}"`);t[i]!==void 0&&(e[i]=t[i]),delete e._claim_names[i]}}}function uH(e,t,r){if(e[r]===void 0)throw new P({message:`missing required JWT property ${r}`,jwt:t})}function Vp(e){let t={client_id:this.client_id,scope:"openid",response_type:oH.call(this),redirect_uri:cH.call(this),...e};return Object.entries(t).forEach(([r,n])=>{n==null?delete t[r]:r==="claims"&&typeof n=="object"?t[r]=JSON.stringify(n):r==="resource"&&Array.isArray(n)?t[r]=n:typeof n!="string"&&(t[r]=String(n))}),t}async function gk(e,t){try{let{header:r,payload:n}=gt.JWT.decode(t,{complete:!0}),{iss:i}=n;if(r.alg==="none")return n;let s;return!i||i===this.issuer.issuer?s=await this.issuer.queryKeyStore(r):pk.has(i)?s=await pk.get(i).queryKeyStore(r):s=await(await this.issuer.constructor.discover(i)).queryKeyStore(r),gt.JWT.verify(t,s)}catch(r){throw r instanceof P||r instanceof Xp||r.name==="AggregateError"?r:new P({printf:["failed to validate the %s JWT (%s: %s)",e,r.name,r.message],jwt:t})}}function _k(e){let t=gt.JWKS.asKeyStore(e);if(t.all().some(r=>r.type!=="private"))throw new TypeError("jwks must only contain private keys");return t}function lH(e,t,r){try{let n=e.issuer.token_endpoint_auth_methods_supported;n.includes(r.token_endpoint_auth_method)||n.includes("client_secret_post")&&(r.token_endpoint_auth_method="client_secret_post")}catch{}}function fH(e,t,r){if(t.token_endpoint_auth_method||lH(e,t,r),t.redirect_uri){if(t.redirect_uris)throw new TypeError("provide a redirect_uri or redirect_uris, not both");r.redirect_uris=[t.redirect_uri],delete r.redirect_uri}if(t.response_type){if(t.response_types)throw new TypeError("provide a response_type or response_types, not both");r.response_types=[t.response_type],delete r.response_type}}function dH(e,t,r){if(!t[`${e}_endpoint`])return;let n=r.token_endpoint_auth_method,i=r.token_endpoint_auth_signing_alg,s=`${e}_endpoint_auth_method`,o=`${e}_endpoint_auth_signing_alg`;r[s]===void 0&&r[o]===void 0&&(n!==void 0&&(r[s]=n),i!==void 0&&(r[o]=i))}var vs=class{};Qp.exports=(e,t=!1)=>class extends vs{constructor(n={},i,s){if(super(),typeof n.client_id!="string"||!n.client_id)throw new TypeError("client_id is required");let o={...iH,...n};if(fH(this,n,o),hk("token",this.issuer,o),["introspection","revocation"].forEach(c=>{dH(c,this.issuer,o),hk(c,this.issuer,o)}),Object.entries(o).forEach(([c,a])=>{Oe(this).get("metadata").set(c,a),this[c]||Object.defineProperty(this,c,{get(){return Oe(this).get("metadata").get(c)},enumerable:!0})}),i!==void 0){let c=_k.call(this,i);Oe(this).set("keystore",c)}s!==void 0&&Oe(this).set("options",s),this[mt]=0}authorizationUrl(n={}){if(!yt(n))throw new TypeError("params must be a plain object");Ht(this.issuer,"authorization_endpoint");let i=Wt.parse(this.issuer.authorization_endpoint,!0);return i.search=null,i.query={...i.query,...Vp.call(this,n)},Wt.format(i)}authorizationPost(n={}){if(!yt(n))throw new TypeError("params must be a plain object");let i=Vp.call(this,n),s=Object.keys(i).map(o=>`<input type="hidden" name="${o}" value="${i[o]}"/>`).join(`
`);return`<!DOCTYPE html>
<head>
  <title>Requesting Authorization</title>
</head>
<body onload="javascript:document.forms[0].submit()">
  <form method="post" action="${this.issuer.authorization_endpoint}">
    ${s}
  </form>
</body>
</html>`}endSessionUrl(n={}){Ht(this.issuer,"end_session_endpoint");let{0:i,length:s}=this.post_logout_redirect_uris||[],{post_logout_redirect_uri:o=s===1?i:void 0}=n,c=n.id_token_hint;if(c instanceof me){if(!c.id_token)throw new TypeError("id_token not present in TokenSet");c=c.id_token}let a=Wt.parse(this.issuer.end_session_endpoint,!0);return a.search=null,a.query={...n,...a.query,post_logout_redirect_uri:o,id_token_hint:c},Object.entries(a.query).forEach(([l,f])=>{f==null&&delete a.query[l]}),Wt.format(a)}callbackParams(n){let i=n instanceof Q8.IncomingMessage||n&&n.method&&n.url;if(!(typeof n=="string")&&!i)throw new TypeError("#callbackParams only accepts string urls, http.IncomingMessage or a lookalike");if(i)switch(n.method){case"GET":return fr(Wt.parse(n.url,!0).query);case"POST":if(n.body===void 0)throw new TypeError("incoming message body missing, include a body parser prior to this method call");switch(typeof n.body){case"object":case"string":return Buffer.isBuffer(n.body)?fr(dk.parse(n.body.toString("utf-8"))):typeof n.body=="string"?fr(dk.parse(n.body)):fr(n.body);default:throw new TypeError("invalid IncomingMessage body object")}default:throw new TypeError("invalid IncomingMessage method")}else return fr(Wt.parse(n,!0).query)}async callback(n,i,s={},{exchangeBody:o,clientAssertionPayload:c}={}){let a=fr(i);if(s.jarm&&!("response"in i))throw new P({message:"expected a JARM response",checks:s,params:a});if("response"in i){let f=await this.decryptJARM(a.response);a=await this.validateJARM(f)}if(this.default_max_age&&!s.max_age&&(s.max_age=this.default_max_age),a.state&&!s.state)throw new TypeError("checks.state argument is missing");if(!a.state&&s.state)throw new P({message:"state missing from the response",checks:s,params:a});if(s.state!==a.state)throw new P({printf:["state mismatch, expected %s, got: %s",s.state,a.state],checks:s,params:a});if(a.error)throw new Xp(a);let l={code:["code"],id_token:["id_token"],token:["access_token","token_type"]};if(s.response_type){for(let f of s.response_type.split(" "))if(f==="none"){if(a.code||a.id_token||a.access_token)throw new P({message:'unexpected params encountered for "none" response',checks:s,params:a})}else for(let u of l[f])if(!a[u])throw new P({message:`${u} missing from response`,checks:s,params:a})}if(a.id_token){let f=new me(a);if(await this.decryptIdToken(f),await this.validateIdToken(f,s.nonce,"authorization",s.max_age,s.state),!a.code)return f}if(a.code){let f=await this.grant({...o,grant_type:"authorization_code",code:a.code,redirect_uri:n,code_verifier:s.code_verifier},{clientAssertionPayload:c});return await this.decryptIdToken(f),await this.validateIdToken(f,s.nonce,"token",s.max_age),a.session_state&&(f.session_state=a.session_state),f}return new me(a)}async oauthCallback(n,i,s={},{exchangeBody:o,clientAssertionPayload:c}={}){let a=fr(i);if(s.jarm&&!("response"in i))throw new P({message:"expected a JARM response",checks:s,params:a});if("response"in i){let f=await this.decryptJARM(a.response);a=await this.validateJARM(f)}if(a.state&&!s.state)throw new TypeError("checks.state argument is missing");if(!a.state&&s.state)throw new P({message:"state missing from the response",checks:s,params:a});if(s.state!==a.state)throw new P({printf:["state mismatch, expected %s, got: %s",s.state,a.state],checks:s,params:a});if(a.error)throw new Xp(a);let l={code:["code"],token:["access_token","token_type"]};if(s.response_type)for(let f of s.response_type.split(" ")){if(f==="none"&&(a.code||a.id_token||a.access_token))throw new P({message:'unexpected params encountered for "none" response',checks:s,params:a});if(l[f]){for(let u of l[f])if(!a[u])throw new P({message:`${u} missing from response`,checks:s,params:a})}}return a.code?this.grant({...o,grant_type:"authorization_code",code:a.code,redirect_uri:n,code_verifier:s.code_verifier},{clientAssertionPayload:c}):new me(a)}async decryptIdToken(n){if(!this.id_token_encrypted_response_alg)return n;let i=n;if(i instanceof me){if(!i.id_token)throw new TypeError("id_token not present in TokenSet");i=i.id_token}let s=this.id_token_encrypted_response_alg,o=this.id_token_encrypted_response_enc,c=await this.decryptJWE(i,s,o);return n instanceof me?(n.id_token=c,n):c}async validateJWTUserinfo(n){let i=this.userinfo_signed_response_alg;return this.validateJWT(n,i,[])}async decryptJARM(n){if(!this.authorization_encrypted_response_alg)return n;let i=this.authorization_encrypted_response_alg,s=this.authorization_encrypted_response_enc;return this.decryptJWE(n,i,s)}async validateJARM(n){let i=this.authorization_signed_response_alg,{payload:s}=await this.validateJWT(n,i,["iss","exp","aud"]);return fr(s)}async decryptJWTUserinfo(n){if(!this.userinfo_encrypted_response_alg)return n;let i=this.userinfo_encrypted_response_alg,s=this.userinfo_encrypted_response_enc;return this.decryptJWE(n,i,s)}async decryptJWE(n,i,s="A128CBC-HS256"){let o=JSON.parse(ws.decode(n.split(".")[0]));if(o.alg!==i)throw new P({printf:["unexpected JWE alg received, expected %s, got: %s",i,o.alg],jwt:n});if(o.enc!==s)throw new P({printf:["unexpected JWE enc received, expected %s, got: %s",s,o.enc],jwt:n});let c;return i.match(/^(?:RSA|ECDH)/)?c=Oe(this).get("keystore"):c=await this.joseSecret(i==="dir"?s:i),gt.JWE.decrypt(n,c).toString("utf8")}async validateIdToken(n,i,s,o,c){let a=n,l=this.id_token_signed_response_alg;if(a instanceof me){if(!a.id_token)throw new TypeError("id_token not present in TokenSet");a=a.id_token}a=String(a);let u=wa(),{protected:d,payload:p,key:m}=await this.validateJWT(a,l);if(o||o!==null&&this.require_auth_time){if(!p.auth_time)throw new P({message:"missing required JWT property auth_time",jwt:a});if(typeof p.auth_time!="number")throw new P({message:"JWT auth_time claim must be a JSON numeric value",jwt:a})}if(o&&p.auth_time+o<u-this[mt])throw new P({printf:["too much time has elapsed since the last End-User authentication, max_age %i, auth_time: %i, now %i",o,p.auth_time,u-this[mt]],now:u,tolerance:this[mt],auth_time:p.auth_time,jwt:a});if(i!==null&&(p.nonce||i!==void 0)&&p.nonce!==i)throw new P({printf:["nonce mismatch, expected %s, got: %s",i,p.nonce],jwt:a});if(s==="authorization"){if(!p.at_hash&&n.access_token)throw new P({message:"missing required property at_hash",jwt:a});if(!p.c_hash&&n.code)throw new P({message:"missing required property c_hash",jwt:a});if(this.constructor.name==="FAPIClient"){if(p.iat<u-3600)throw new P({printf:["JWT issued too far in the past, now %i, iat %i",u,p.iat],now:u,tolerance:this[mt],iat:p.iat,jwt:a});if(!p.s_hash&&(n.state||c))throw new P({message:"missing required property s_hash",jwt:a})}if(p.s_hash){if(!c)throw new TypeError('cannot verify s_hash, "checks.state" property not provided');try{zp.validate({claim:"s_hash",source:"state"},p.s_hash,c,d.alg,m&&m.crv)}catch(_){throw new P({message:_.message,jwt:a})}}}if(n.access_token&&p.at_hash!==void 0)try{zp.validate({claim:"at_hash",source:"access_token"},p.at_hash,n.access_token,d.alg,m&&m.crv)}catch(y){throw new P({message:y.message,jwt:a})}if(n.code&&p.c_hash!==void 0)try{zp.validate({claim:"c_hash",source:"code"},p.c_hash,n.code,d.alg,m&&m.crv)}catch(y){throw new P({message:y.message,jwt:a})}return n}async validateJWT(n,i,s=["iss","sub","aud","exp","iat"]){let o=this.issuer.issuer==="https://self-issued.me",c=wa(),a,l;try{({header:a,payload:l}=gt.JWT.decode(n,{complete:!0}))}catch(u){throw new P({printf:["failed to decode JWT (%s: %s)",u.name,u.message],jwt:n})}if(a.alg!==i)throw new P({printf:["unexpected JWT alg received, expected %s, got: %s",i,a.alg],jwt:n});if(o&&(s=[...s,"sub_jwk"]),s.forEach(uH.bind(void 0,l,n)),l.iss!==void 0){let u=this.issuer.issuer;if(t&&(u=this.issuer.issuer.replace("{tenantid}",l.tid)),l.iss!==u)throw new P({printf:["unexpected iss value, expected %s, got: %s",u,l.iss],jwt:n})}if(l.iat!==void 0&&typeof l.iat!="number")throw new P({message:"JWT iat claim must be a JSON numeric value",jwt:n});if(l.nbf!==void 0){if(typeof l.nbf!="number")throw new P({message:"JWT nbf claim must be a JSON numeric value",jwt:n});if(l.nbf>c+this[mt])throw new P({printf:["JWT not active yet, now %i, nbf %i",c+this[mt],l.nbf],now:c,tolerance:this[mt],nbf:l.nbf,jwt:n})}if(l.exp!==void 0){if(typeof l.exp!="number")throw new P({message:"JWT exp claim must be a JSON numeric value",jwt:n});if(c-this[mt]>=l.exp)throw new P({printf:["JWT expired, now %i, exp %i",c-this[mt],l.exp],now:c,tolerance:this[mt],exp:l.exp,jwt:n})}if(l.aud!==void 0){if(Array.isArray(l.aud)){if(l.aud.length>1&&!l.azp)throw new P({message:"missing required JWT property azp",jwt:n});if(!l.aud.includes(this.client_id))throw new P({printf:["aud is missing the client_id, expected %s to be included in %j",this.client_id,l.aud],jwt:n})}else if(l.aud!==this.client_id)throw new P({printf:["aud mismatch, expected %s, got: %s",this.client_id,l.aud],jwt:n})}if(l.azp!==void 0){let{additionalAuthorizedParties:u}=Oe(this).get("options")||{};if(typeof u=="string"?u=[this.client_id,u]:Array.isArray(u)?u=[this.client_id,...u]:u=[this.client_id],!u.includes(l.azp))throw new P({printf:["azp mismatch, got: %s",l.azp],jwt:n})}let f;if(o){try{Gp(yt(l.sub_jwk)),f=gt.JWK.asKey(l.sub_jwk),Gp.equal(f.type,"public")}catch{throw new P({message:"failed to use sub_jwk claim as an asymmetric JSON Web Key",jwt:n})}if(f.thumbprint!==l.sub)throw new P({message:"failed to match the subject with sub_jwk",jwt:n})}else a.alg.startsWith("HS")?f=await this.joseSecret():a.alg!=="none"&&(f=await this.issuer.queryKeyStore(a));if(!f&&a.alg==="none")return{protected:a,payload:l};try{return gt.JWS.verify(n,f,{complete:!0})}catch{throw new P({message:"failed to validate JWT signature",jwt:n})}}async refresh(n,{exchangeBody:i,clientAssertionPayload:s}={}){let o=n;if(o instanceof me){if(!o.refresh_token)throw new TypeError("refresh_token not present in TokenSet");o=o.refresh_token}let c=await this.grant({...i,grant_type:"refresh_token",refresh_token:String(o)},{clientAssertionPayload:s});if(c.id_token&&(await this.decryptIdToken(c),await this.validateIdToken(c,null,"token",null),n instanceof me&&n.id_token)){let a=n.claims().sub,l=c.claims().sub;if(l!==a)throw new P({printf:["sub mismatch, expected %s, got: %s",a,l],jwt:c.id_token})}return c}async requestResource(n,i,{method:s,headers:o,body:c,tokenType:a=i instanceof me?i.token_type:"Bearer"}={}){if(i instanceof me){if(!i.access_token)throw new TypeError("access_token not present in TokenSet");i=i.access_token}let l={headers:{Authorization:Es(i,a),...o},body:c},f=!!this.tls_client_certificate_bound_access_tokens;return bs.call(this,{...l,encoding:null,method:s,url:n},{mTLS:f})}async userinfo(n,{verb:i="GET",via:s="header",tokenType:o,params:c}={}){Ht(this.issuer,"userinfo_endpoint");let a={tokenType:o,method:String(i).toUpperCase()};if(a.method!=="GET"&&a.method!=="POST")throw new TypeError("#userinfo() verb can only be POST or a GET");if(s==="query"&&a.method!=="GET")throw new TypeError("userinfo endpoints will only parse query strings for GET requests");if(s==="body"&&a.method!=="POST")throw new TypeError("can only send body on POST");let l=!!(this.userinfo_signed_response_alg||this.userinfo_encrypted_response_alg);l?a.headers={Accept:"application/jwt"}:a.headers={Accept:"application/json"};let f=!!this.tls_client_certificate_bound_access_tokens,u;f&&this.issuer.mtls_endpoint_aliases&&(u=this.issuer.mtls_endpoint_aliases.userinfo_endpoint),u=new Wt.URL(u||this.issuer.userinfo_endpoint),s==="query"?(a.headers.Authorization=void 0,u.searchParams.append("access_token",n instanceof me?n.access_token:n)):s==="body"&&(a.headers.Authorization=void 0,a.headers["Content-Type"]="application/x-www-form-urlencoded",a.body=new Wt.URLSearchParams,a.body.append("access_token",n instanceof me?n.access_token:n)),c&&(a.method==="GET"?Object.entries(c).forEach(([m,y])=>{u.searchParams.append(m,y)}):a.body?Object.entries(c).forEach(([m,y])=>{a.body.append(m,y)}):(a.body=new Wt.URLSearchParams,a.headers["Content-Type"]="application/x-www-form-urlencoded",Object.entries(c).forEach(([m,y])=>{a.body.append(m,y)}))),a.body&&(a.body=a.body.toString());let d=await this.requestResource(u,n,a),p=lr(d,{bearer:!0});if(l){if(!sH.test(d.headers["content-type"]))throw new P({message:"expected application/jwt response from the userinfo_endpoint",response:d});let m=d.body.toString(),y=await this.decryptJWTUserinfo(m);if(this.userinfo_signed_response_alg)({payload:p}=await this.validateJWTUserinfo(y));else try{p=JSON.parse(y),Gp(yt(p))}catch{throw new P({message:"failed to parse userinfo JWE payload as JSON",jwt:y})}}else try{p=JSON.parse(d.body)}catch(m){let y=new eH(m,d.statusCode,d.request.gotOptions,d.body);throw Object.defineProperty(y,"response",{value:d}),y}if(n instanceof me&&n.id_token){let m=n.claims().sub;if(p.sub!==m)throw new P({printf:["userinfo sub mismatch, expected %s, got: %s",m,p.sub],body:p,jwt:n.id_token})}return p}async derivedKey(n){let i=`${n}_key`;if(Oe(this).has(i))return Oe(this).get(i);let s=n<=256?"sha256":n<=384?"sha384":n<=512?"sha512":!1;if(!s)throw new Error("unsupported symmetric encryption key derivation");let o=Z8.createHash(s).update(this.client_secret).digest().slice(0,n/8),c=gt.JWK.asKey({k:ws.encode(o),kty:"oct"});return Oe(this).set(i,c),c}async joseSecret(n){if(!this.client_secret)throw new TypeError("client_secret is required");if(/^A(\d{3})(?:GCM)?KW$/.test(n))return this.derivedKey(parseInt(RegExp.$1,10));if(/^A(\d{3})(?:GCM|CBC-HS(\d{3}))$/.test(n))return this.derivedKey(parseInt(RegExp.$2||RegExp.$1,10));if(Oe(this).has("jose_secret"))return Oe(this).get("jose_secret");let i=gt.JWK.asKey({k:ws.encode(this.client_secret),kty:"oct"});return Oe(this).set("jose_secret",i),i}async grant(n,{clientAssertionPayload:i}={}){Ht(this.issuer,"token_endpoint");let s=await ba.call(this,"token",{form:!0,body:n,json:!0},{clientAssertionPayload:i}),o=lr(s);return new me(o)}async deviceAuthorization(n={},{exchangeBody:i,clientAssertionPayload:s}={}){Ht(this.issuer,"device_authorization_endpoint"),Ht(this.issuer,"token_endpoint");let o=Vp.call(this,{client_id:this.client_id,redirect_uri:null,response_type:null,...n}),c=await ba.call(this,"device_authorization",{form:!0,body:o,json:!0},{clientAssertionPayload:s,endpointAuthMethod:"token"}),a=lr(c);return new aH({client:this,exchangeBody:i,clientAssertionPayload:s,response:a,maxAge:n.max_age})}async revoke(n,i,{revokeBody:s,clientAssertionPayload:o}={}){if(Ht(this.issuer,"revocation_endpoint"),i!==void 0&&typeof i!="string")throw new TypeError("hint must be a string");let c={...s,token:n};i&&(c.token_type_hint=i);let a=await ba.call(this,"revocation",{body:c,form:!0},{clientAssertionPayload:o});lr(a,{body:!1})}async introspect(n,i,{introspectBody:s,clientAssertionPayload:o}={}){if(Ht(this.issuer,"introspection_endpoint"),i!==void 0&&typeof i!="string")throw new TypeError("hint must be a string");let c={...s,token:n};i&&(c.token_type_hint=i);let a=await ba.call(this,"introspection",{body:c,form:!0,json:!0},{clientAssertionPayload:o});return lr(a)}async fetchDistributedClaims(n,i={}){if(!yt(n))throw new TypeError("claims argument must be a plain object");if(!yt(n._claim_sources)||!yt(n._claim_names))return n;let s=Object.entries(n._claim_sources).filter(([,o])=>o&&o.endpoint);return await Promise.all(s.map(async([o,c])=>{try{let a={headers:{Accept:"application/jwt",Authorization:Es(c.access_token||i[o])}},l=await bs.call(this,{...a,method:"GET",url:c.endpoint}),f=lr(l,{bearer:!0}),u=await gk.call(this,"distributed",f);delete n._claim_sources[o],Object.entries(n._claim_names).forEach(mk(n,u,o,!1))}catch(a){throw a.src=o,a}})),yk(n),n}async unpackAggregatedClaims(n){if(!yt(n))throw new TypeError("claims argument must be a plain object");if(!yt(n._claim_sources)||!yt(n._claim_names))return n;let i=Object.entries(n._claim_sources).filter(([,s])=>s&&s.JWT);return await Promise.all(i.map(async([s,o])=>{try{let c=await gk.call(this,"aggregated",o.JWT);delete n._claim_sources[s],Object.entries(n._claim_names).forEach(mk(n,c,s))}catch(c){throw c.src=s,c}})),yk(n),n}static async register(n,i={}){let{initialAccessToken:s,jwks:o,...c}=i;if(Ht(this.issuer,"registration_endpoint"),o!==void 0&&!(n.jwks||n.jwks_uri)){let f=_k.call(this,o);n.jwks=f.toJWKS(!1)}let a=await bs.call(this,{headers:s?{Authorization:Es(s)}:void 0,json:!0,body:n,url:this.issuer.registration_endpoint,method:"POST"}),l=lr(a,{statusCode:201,bearer:!0});return new this(l,o,c)}get metadata(){let n={};return Oe(this).get("metadata").forEach((i,s)=>{n[s]=i}),n}static async fromUri(n,i,s,o){let c=await bs.call(this,{method:"GET",url:n,json:!0,headers:{Authorization:Es(i)}}),a=lr(c,{bearer:!0});return new this(a,s,o)}async requestObject(n={},{sign:i=this.request_object_signing_alg||"none",encrypt:{alg:s=this.request_object_encryption_alg,enc:o=this.request_object_encryption_enc||"A128CBC-HS256"}={}}={}){if(!yt(n))throw new TypeError("requestObject must be a plain object");let c,a,l={alg:i,typ:"JWT"},f=JSON.stringify(wk({},n,{iss:this.client_id,aud:this.issuer.issuer,client_id:this.client_id,jti:rH(),iat:wa(),exp:wa()+300}));if(i==="none")c=[ws.encode(JSON.stringify(l)),ws.encode(f),""].join(".");else{let d=i.startsWith("HS");if(d)a=await this.joseSecret();else{let p=Oe(this).get("keystore");if(!p)throw new TypeError(`no keystore present for client, cannot sign using alg ${i}`);if(a=p.get({alg:i,use:"sig"}),!a)throw new TypeError(`no key to sign with found for alg ${i}`)}c=gt.JWS.sign(f,a,{...l,kid:d?void 0:a.kid})}if(!s)return c;let u={alg:s,enc:o,cty:"JWT"};return u.alg.match(/^(RSA|ECDH)/)?[a]=await this.issuer.queryKeyStore({alg:u.alg,enc:u.enc,use:"enc"},{allowMulti:!0}):a=await this.joseSecret(u.alg==="dir"?u.enc:u.alg),gt.JWE.encrypt(c,a,{...u,kid:a.kty==="oct"?void 0:a.kid})}static get issuer(){return e}get issuer(){return e}[fk.custom](){return`${this.constructor.name} ${fk(this.metadata,{depth:1/0,colors:process.stdout.isTTY,compact:!1,sorted:!0})}`}};vs.prototype.resource=X8(async function(t,r,n){let i=r,s={verb:"GET",via:"header",...n};if(i instanceof me){if(!i.access_token)throw new TypeError("access_token not present in TokenSet");s.tokenType=s.tokenType||i.token_type,i=i.access_token}let o=String(s.verb).toUpperCase(),c;switch(s.via){case"query":if(o!=="GET")throw new TypeError("resource servers should only parse query strings for GET requests");c={query:{access_token:i}};break;case"body":if(o!=="POST")throw new TypeError("can only send body on POST");c={form:!0,body:{access_token:i}};break;default:c={headers:{Authorization:Es(i,s.tokenType)}}}s.params&&(o==="POST"?Yp(c,{body:s.params}):Yp(c,{query:s.params})),s.headers&&Yp(c,{headers:s.headers});let a=!!this.tls_client_certificate_bound_access_tokens;return bs.call(this,{...c,encoding:null,method:o,url:t},{mTLS:a})},"client.resource() is deprecated, use client.requestResource() instead, see docs for API details");Qp.exports.BaseClient=vs});var Ek=h((mee,bk)=>{var hH=/^\d+$/;function pH(e){if(e.includes("://"))return!0;let t=e.replace(/(\/|\?)/g,"#").split("#")[0];if(t.includes(":")){let r=t.indexOf(":"),n=t.slice(r+1);if(!hH.test(n))return!0}return!1}function yH(e){if(!e.includes("@"))return!1;let t=e.split("@"),r=t[t.length-1];return!(r.includes(":")||r.includes("/")||r.includes("?"))}function mH(e){if(typeof e!="string")throw new TypeError("input must be a string");let t;return pH(e)?t=e:yH(e)?t=`acct:${e}`:t=`https://${e}`,t.split("#")[0]}bk.exports=mH});var Pk=h((_ee,Ck)=>{var{inspect:vk,deprecate:gH}=g("util"),ey=g("url"),Sk=Mc(),_H=bq(),wH=kq(),kk=Bq(),{RPError:Yr}=Hr(),bH=Zp(),Ea=ga(),va=ha(),EH=Ek(),Ft=_s(),Sa=gs(),{assertIssuerConfiguration:vH}=fa(),{ISSUER_DEFAULTS:xk,OIDC_DISCOVERY:Tk,OAUTH2_DISCOVERY:Ak,WEBFINGER:SH,REL:qk,AAD_MULTITENANT_DISCOVERY:Ok}=ms(),xa=Symbol("AAD_MULTITENANT"),Vr=class{constructor(t={}){let r=t[xa];delete t[xa],["introspection","revocation"].forEach(n=>{t[`${n}_endpoint`]&&t[`${n}_endpoint_auth_methods_supported`]===void 0&&t[`${n}_endpoint_auth_signing_alg_values_supported`]===void 0&&(t.token_endpoint_auth_methods_supported&&(t[`${n}_endpoint_auth_methods_supported`]=t.token_endpoint_auth_methods_supported),t.token_endpoint_auth_signing_alg_values_supported&&(t[`${n}_endpoint_auth_signing_alg_values_supported`]=t.token_endpoint_auth_signing_alg_values_supported))}),Object.entries(t).forEach(([n,i])=>{Ft(this).get("metadata").set(n,i),this[n]||Object.defineProperty(this,n,{get(){return Ft(this).get("metadata").get(n)},enumerable:!0})}),Ft(this).set("cache",new wH({max:100})),Ea.set(this.issuer,this),Object.defineProperty(this,"Client",{value:bH(this,r)}),Object.defineProperty(this,"FAPIClient",{value:class extends this.Client{}})}async keystore(t=!1){vH(this,"jwks_uri");let r=Ft(this).get("keystore"),n=Ft(this).get("cache");if(t||!r){n.reset();let i=await Sa.call(this,{method:"GET",json:!0,url:this.jwks_uri}),s=va(i),o=Sk.JWKS.asKeyStore(s,{ignoreErrors:!0});return n.set("throttle",!0,60*1e3),Ft(this).set("keystore",o),o}return r}async queryKeyStore({kid:t,kty:r,alg:n,use:i,key_ops:s},{allowMulti:o=!1}={}){let c=Ft(this).get("cache"),a={kid:t,kty:r,alg:n,use:i,key_ops:s},l=kk(a,{algorithm:"sha256",ignoreUnknown:!0,unorderedArrays:!0,unorderedSets:!0}),f=c.get(l)||c.get("throttle"),u=await this.keystore(!f),d=u.all(a);if(d.length===0)throw new Yr({printf:["no valid key found in issuer's jwks_uri for key parameters %j",a],jwks:u});if(!o&&d.length>1&&!t)throw new Yr({printf:["multiple matching keys found in issuer's jwks_uri for key parameters %j, kid must be provided in this case",a],jwks:u});return c.set(l,!0),new Sk.JWKS.KeyStore(d)}get metadata(){let t={};return Ft(this).get("metadata").forEach((r,n)=>{t[n]=r}),t}static async webfinger(t){let r=EH(t),{host:n}=ey.parse(r),i=`https://${n}${SH}`,s=await Sa.call(this,{method:"GET",url:i,json:!0,query:{resource:r,rel:qk},followRedirect:!0}),o=va(s),c=Array.isArray(o.links)&&o.links.find(f=>typeof f=="object"&&f.rel===qk&&f.href);if(!c)throw new Yr({message:"no issuer found in webfinger response",body:o});if(typeof c.href!="string"||!c.href.startsWith("https://"))throw new Yr({printf:["invalid issuer location %s",c.href],body:o});let a=c.href;if(Ea.has(a))return Ea.get(a);let l=await this.discover(a);if(l.issuer!==a)throw Ea.delete(l.issuer),new Yr("discovered issuer mismatch, expected %s, got: %s",a,l.issuer);return l}static async discover(t){let r=ey.parse(t);if(r.pathname.includes("/.well-known/")){let i=await Sa.call(this,{method:"GET",json:!0,url:t}),s=va(i);return new Vr({...xk,...s,[xa]:!!Ok.find(o=>t.startsWith(o))})}let n=[];return r.pathname==="/"?n.push(`${Ak}`):n.push(`${Ak}${r.pathname}`),r.pathname.endsWith("/")?n.push(`${r.pathname}${Tk.substring(1)}`):n.push(`${r.pathname}${Tk}`),_H(n.map(async i=>{let s=ey.format({...r,pathname:i}),o=await Sa.call(this,{method:"GET",json:!0,url:s}),c=va(o);return new Vr({...xk,...c,[xa]:!!Ok.find(a=>s.startsWith(a))})}))}[vk.custom](){return`${this.constructor.name} ${vk(this.metadata,{depth:1/0,colors:process.stdout.isTTY,compact:!1,sorted:!0})}`}};Vr.prototype.key=gH(async function({kid:t,kty:r,alg:n,use:i,key_ops:s},o=!1){let c=Ft(this).get("cache"),a={kid:t,kty:r,alg:n,use:i,key_ops:s},l=kk(a,{algorithm:"sha256",ignoreUnknown:!0,unorderedArrays:!0,unorderedSets:!0}),f=c.get(l)||c.get("throttle"),u=await this.keystore(!f),d=u.all(a);if(d.length===0)throw new Yr({printf:["no valid key found in issuer's jwks_uri for key parameters %j",a],jwks:u});if(!o){if(d.length!==1)throw new Yr({printf:["multiple matching keys found in issuer's jwks_uri for key parameters %j, kid must be provided in this case",a],jwks:u});c.set(l,!0)}return d[0]},"issuer.key is not only a private API, it is also deprecated");Ck.exports=Vr});var Kk=h((wee,Rk)=>{Rk.exports=e=>JSON.parse(JSON.stringify(e))});var Mk=h((bee,jk)=>{var Ik=g("url"),{format:xH}=g("util"),TH=Kk(),{RPError:Bk,OPError:AH}=Hr(),{BaseClient:qH}=Zp(),{random:ty,codeChallenge:OH}=ps(),kH=Mp(),{resolveResponseType:CH,resolveRedirectUri:PH}=_a();function RH(e,t,r={}){e?this.error(e):t?this.success(t,r):this.fail(r)}function Nk({client:e,params:t={},passReqToCallback:r=!1,sessionKey:n,usePKCE:i=!1}={},s){if(!(e instanceof qH))throw new TypeError("client must be an instance of openid-client Client");if(typeof s!="function")throw new TypeError("verify callback must be a function");if(!e.issuer||!e.issuer.issuer)throw new TypeError("client must have an issuer with an identifier");if(this._client=e,this._issuer=e.issuer,this._verify=s,this._passReqToCallback=r,this._usePKCE=i,this._key=n||`oidc:${Ik.parse(this._issuer.issuer).hostname}`,this._params=TH(t),this._usePKCE===!0){let o=this._issuer.code_challenge_methods_supported;if(!Array.isArray(o))throw new TypeError("code_challenge_methods_supported is not properly set on issuer");if(o.includes("S256"))this._usePKCE="S256";else if(o.includes("plain"))this._usePKCE="plain";else throw new TypeError("neither supported code_challenge_method is supported by the issuer")}else if(typeof this._usePKCE=="string"&&!["plain","S256"].includes(this._usePKCE))throw new TypeError(`${this._usePKCE} is not valid/implemented PKCE code_challenge_method`);this.name=Ik.parse(e.issuer.issuer).hostname,this._params.response_type||(this._params.response_type=CH.call(e)),this._params.redirect_uri||(this._params.redirect_uri=PH.call(e)),this._params.scope||(this._params.scope="openid")}Nk.prototype.authenticate=function(t,r){(async()=>{let n=this._client;if(!t.session)throw new TypeError("authentication requires session support");let i=n.callbackParams(t),s=this._key;if(Object.keys(i).length===0){let w={state:ty(),...this._params,...r};if(!w.nonce&&w.response_type.includes("id_token")&&(w.nonce=ty()),t.session[s]=kH(w,"nonce","state","max_age","response_type"),this._usePKCE){let v=ty();switch(t.session[s].code_verifier=v,this._usePKCE){case"S256":w.code_challenge=OH(v),w.code_challenge_method="S256";break;case"plain":w.code_challenge=v;break}}this.redirect(n.authorizationUrl(w));return}let o=t.session[s];if(Object.keys(o||{}).length===0)throw new Error(xH('did not find expected authorization request details in session, req.session["%s"] is %j',s,o));let{state:c,nonce:a,max_age:l,code_verifier:f,response_type:u}=o;try{delete t.session[s]}catch{}let d={redirect_uri:this._params.redirect_uri,...r},p={state:c,nonce:a,max_age:l,code_verifier:f,response_type:u},m=await n.callback(d.redirect_uri,i,p),y=this._passReqToCallback,_=this._verify.length>(y?3:2)&&n.issuer.userinfo_endpoint,b=[m,RH.bind(this)];if(_){if(!m.access_token)throw new Bk({message:"expected access_token to be returned when asking for userinfo in verify callback",tokenset:m});let w=await n.userinfo(m);b.splice(1,0,w)}y&&b.unshift(t),this._verify(...b)})().catch(n=>{n instanceof AH&&n.error!=="server_error"&&!n.error.startsWith("invalid")||n instanceof Bk?this.fail(n):this.error(n)})};jk.exports=Nk});var Jk=h((Eee,Dk)=>{var KH=Pk(),{OPError:IH,RPError:BH}=Hr(),NH=ga(),jH=Mk(),MH=pa(),{CLOCK_TOLERANCE:DH,HTTP_OPTIONS:JH}=ms(),LH=ps(),{setDefaults:$H}=gs();Dk.exports={Issuer:KH,Registry:NH,Strategy:jH,TokenSet:MH,errors:{OPError:IH,RPError:BH},custom:{setHttpOptionsDefaults:$H,http_options:JH,clock_tolerance:DH},generators:LH}});var RC=h(Zr=>{Zr.parse=Zr.decode=dz;Zr.stringify=Zr.encode=kC;Zr.safe=zn;Zr.unsafe=Pa;var vy=typeof process<"u"&&process.platform==="win32"?`\r
`:`
`;function kC(e,t){var r=[],n="";typeof t=="string"?t={section:t,whitespace:!1}:(t=t||{},t.whitespace=t.whitespace===!0);var i=t.whitespace?" = ":"=";return Object.keys(e).forEach(function(s,o,c){var a=e[s];a&&Array.isArray(a)?a.forEach(function(l){n+=zn(s+"[]")+i+zn(l)+`
`}):a&&typeof a=="object"?r.push(s):n+=zn(s)+i+zn(a)+vy}),t.section&&n.length&&(n="["+zn(t.section)+"]"+vy+n),r.forEach(function(s,o,c){var a=CC(s).join("\\."),l=(t.section?t.section+".":"")+a,f=kC(e[s],{section:l,whitespace:t.whitespace});n.length&&f.length&&(n+=vy),n+=f}),n}function CC(e){return e.replace(/\1/g,"LITERAL\\1LITERAL").replace(/\\\./g,"").split(/\./).map(function(t){return t.replace(/\1/g,"\\.").replace(/\2LITERAL\\1LITERAL\2/g,"")})}function dz(e){var t={},r=t,n=null,i=/^\[([^\]]*)\]$|^([^=]+)(=(.*))?$/i,s=e.split(/[\r\n]+/g);return s.forEach(function(o,c,a){if(!(!o||o.match(/^\s*[;#]/))){var l=o.match(i);if(!!l){if(l[1]!==void 0){if(n=Pa(l[1]),n==="__proto__"){r={};return}r=t[n]=t[n]||{};return}var f=Pa(l[2]);if(f!=="__proto__"){var u=l[3]?Pa(l[4]):!0;switch(u){case"true":case"false":case"null":u=JSON.parse(u)}if(f.length>2&&f.slice(-2)==="[]"){if(f=f.substring(0,f.length-2),f==="__proto__")return;r[f]?Array.isArray(r[f])||(r[f]=[r[f]]):r[f]=[]}Array.isArray(r[f])?r[f].push(u):r[f]=u}}}}),Object.keys(t).filter(function(o,c,a){if(!t[o]||typeof t[o]!="object"||Array.isArray(t[o]))return!1;var l=CC(o),f=t,u=l.pop(),d=u.replace(/\\\./g,".");return l.forEach(function(p,m,y){p!=="__proto__"&&((!f[p]||typeof f[p]!="object")&&(f[p]={}),f=f[p])}),f===t&&d===u?!1:(f[d]=t[o],!0)}).forEach(function(o,c,a){delete t[o]}),t}function PC(e){return e.charAt(0)==='"'&&e.slice(-1)==='"'||e.charAt(0)==="'"&&e.slice(-1)==="'"}function zn(e){return typeof e!="string"||e.match(/[=\r\n]/)||e.match(/^\[/)||e.length>1&&PC(e)||e!==e.trim()?JSON.stringify(e):e.replace(/;/g,"\\;").replace(/#/g,"\\#")}function Pa(e,t){if(e=(e||"").trim(),PC(e)){e.charAt(0)==="'"&&(e=e.substr(1,e.length-2));try{e=JSON.parse(e)}catch{}}else{for(var r=!1,n="",i=0,s=e.length;i<s;i++){var o=e.charAt(i);if(r)"\\;#".indexOf(o)!==-1?n+=o:n+="\\"+o,r=!1;else{if(";#".indexOf(o)!==-1)break;o==="\\"?r=!0:n+=o}}return r&&(n+="\\"),n.trim()}return e}});var DC=h((Lee,MC)=>{"use strict";var je=function(e){if(e=e||{},this.Promise=e.Promise||Promise,this.queues=Object.create(null),this.domainReentrant=e.domainReentrant||!1,this.domainReentrant){if(typeof process>"u"||typeof process.domain>"u")throw new Error("Domain-reentrant locks require `process.domain` to exist. Please flip `opts.domainReentrant = false`, use a NodeJS version that still implements Domain, or install a browser polyfill.");this.domains=Object.create(null)}this.timeout=e.timeout||je.DEFAULT_TIMEOUT,this.maxOccupationTime=e.maxOccupationTime||je.DEFAULT_MAX_OCCUPATION_TIME,this.maxExecutionTime=e.maxExecutionTime||je.DEFAULT_MAX_EXECUTION_TIME,e.maxPending===1/0||Number.isInteger(e.maxPending)&&e.maxPending>=0?this.maxPending=e.maxPending:this.maxPending=je.DEFAULT_MAX_PENDING};je.DEFAULT_TIMEOUT=0;je.DEFAULT_MAX_OCCUPATION_TIME=0;je.DEFAULT_MAX_EXECUTION_TIME=0;je.DEFAULT_MAX_PENDING=1e3;je.prototype.acquire=function(e,t,r,n){if(Array.isArray(e))return this._acquireBatch(e,t,r,n);if(typeof t!="function")throw new Error("You must pass a function to execute");var i=null,s=null,o=null;typeof r!="function"&&(n=r,r=null,o=new this.Promise(function(w,v){i=w,s=v})),n=n||{};var c=!1,a=null,l=null,f=null,u=this,d=function(w,v,S){l&&(clearTimeout(l),l=null),f&&(clearTimeout(f),f=null),w&&(!!u.queues[e]&&u.queues[e].length===0&&delete u.queues[e],u.domainReentrant&&delete u.domains[e]),c||(o?v?s(v):i(S):typeof r=="function"&&r(v,S),c=!0),w&&!!u.queues[e]&&u.queues[e].length>0&&u.queues[e].shift()()},p=function(w){if(c)return d(w);a&&(clearTimeout(a),a=null),u.domainReentrant&&w&&(u.domains[e]=process.domain);var v=n.maxExecutionTime||u.maxExecutionTime;if(v&&(f=setTimeout(function(){u.queues[e]&&d(w,new Error("Maximum execution time is exceeded "+e))},v)),t.length===1){var S=!1;try{t(function(E,x){S||(S=!0,d(w,E,x))})}catch(E){S||(S=!0,d(w,E))}}else u._promiseTry(function(){return t()}).then(function(E){d(w,void 0,E)},function(E){d(w,E)})};u.domainReentrant&&!!process.domain&&(p=process.domain.bind(p));var m=n.maxPending||u.maxPending;if(!u.queues[e])u.queues[e]=[],p(!0);else if(u.domainReentrant&&!!process.domain&&process.domain===u.domains[e])p(!1);else if(u.queues[e].length>=m)d(!1,new Error("Too many pending tasks in queue "+e));else{var y=function(){p(!0)};n.skipQueue?u.queues[e].unshift(y):u.queues[e].push(y);var _=n.timeout||u.timeout;_&&(a=setTimeout(function(){a=null,d(!1,new Error("async-lock timed out in queue "+e))},_))}var b=n.maxOccupationTime||u.maxOccupationTime;if(b&&(l=setTimeout(function(){u.queues[e]&&d(!1,new Error("Maximum occupation time is exceeded in queue "+e))},b)),o)return o};je.prototype._acquireBatch=function(e,t,r,n){typeof r!="function"&&(n=r,r=null);var i=this,s=function(c,a){return function(l){i.acquire(c,a,l,n)}},o=e.reduceRight(function(c,a){return s(a,c)},t);if(typeof r=="function")o(r);else return new this.Promise(function(c,a){o.length===1?o(function(l,f){l?a(l):c(f)}):c(o())})};je.prototype.isBusy=function(e){return e?!!this.queues[e]:Object.keys(this.queues).length>0};je.prototype._promiseTry=function(e){try{return this.Promise.resolve(e())}catch(t){return this.Promise.reject(t)}};MC.exports=je});var LC=h(($ee,JC)=>{"use strict";JC.exports=DC()});var Ez={};YC(Ez,{default:()=>wz});var ks=g("@yarnpkg/core"),zt=Ge(rm()),UC=Ge(bS());var ry=Ge(Jk()),ny=class extends ry.Issuer{static async discover(t="common"){return await ry.Issuer.discover(`https://login.microsoftonline.com/${t}/v2.0/.well-known/openid-configuration`)}},iy=ny;var sy=class{constructor(t){this.token_endpoint_auth_method="none";this.response_types=["code"];this.client_id=t}},oy=sy;var BC=Ge(g("os")),NC=Ge(g("url")),Os=Ge(g("path"));var pr=Ge(g("fs"));function rC(e){return typeof e>"u"||e===null}function UH(e){return typeof e=="object"&&e!==null}function WH(e){return Array.isArray(e)?e:rC(e)?[]:[e]}function HH(e,t){var r,n,i,s;if(t)for(s=Object.keys(t),r=0,n=s.length;r<n;r+=1)i=s[r],e[i]=t[i];return e}function FH(e,t){var r="",n;for(n=0;n<t;n+=1)r+=e;return r}function GH(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}var zH=rC,YH=UH,VH=WH,XH=FH,QH=GH,ZH=HH,te={isNothing:zH,isObject:YH,toArray:VH,repeat:XH,isNegativeZero:QH,extend:ZH};function nC(e,t){var r="",n=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(r+='in "'+e.mark.name+'" '),r+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(r+=`

`+e.mark.snippet),n+" "+r):n}function xs(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=nC(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}xs.prototype=Object.create(Error.prototype);xs.prototype.constructor=xs;xs.prototype.toString=function(t){return this.name+": "+nC(this,t)};var ke=xs;function cy(e,t,r,n,i){var s="",o="",c=Math.floor(i/2)-1;return n-t>c&&(s=" ... ",t=n-c+s.length),r-n>c&&(o=" ...",r=n+c-o.length),{str:s+e.slice(t,r).replace(/\t/g,"\u2192")+o,pos:n-t+s.length}}function ay(e,t){return te.repeat(" ",t-e.length)+e}function eF(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),typeof t.indent!="number"&&(t.indent=1),typeof t.linesBefore!="number"&&(t.linesBefore=3),typeof t.linesAfter!="number"&&(t.linesAfter=2);for(var r=/\r?\n|\r|\0/g,n=[0],i=[],s,o=-1;s=r.exec(e.buffer);)i.push(s.index),n.push(s.index+s[0].length),e.position<=s.index&&o<0&&(o=n.length-2);o<0&&(o=n.length-1);var c="",a,l,f=Math.min(e.line+t.linesAfter,i.length).toString().length,u=t.maxLength-(t.indent+f+3);for(a=1;a<=t.linesBefore&&!(o-a<0);a++)l=cy(e.buffer,n[o-a],i[o-a],e.position-(n[o]-n[o-a]),u),c=te.repeat(" ",t.indent)+ay((e.line-a+1).toString(),f)+" | "+l.str+`
`+c;for(l=cy(e.buffer,n[o],i[o],e.position,u),c+=te.repeat(" ",t.indent)+ay((e.line+1).toString(),f)+" | "+l.str+`
`,c+=te.repeat("-",t.indent+f+3+l.pos)+`^
`,a=1;a<=t.linesAfter&&!(o+a>=i.length);a++)l=cy(e.buffer,n[o+a],i[o+a],e.position-(n[o]-n[o+a]),u),c+=te.repeat(" ",t.indent)+ay((e.line+a+1).toString(),f)+" | "+l.str+`
`;return c.replace(/\n$/,"")}var tF=eF,rF=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],nF=["scalar","sequence","mapping"];function iF(e){var t={};return e!==null&&Object.keys(e).forEach(function(r){e[r].forEach(function(n){t[String(n)]=r})}),t}function sF(e,t){if(t=t||{},Object.keys(t).forEach(function(r){if(rF.indexOf(r)===-1)throw new ke('Unknown option "'+r+'" is met in definition of "'+e+'" YAML type.')}),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(r){return r},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=iF(t.styleAliases||null),nF.indexOf(this.kind)===-1)throw new ke('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}var ge=sF;function Lk(e,t){var r=[];return e[t].forEach(function(n){var i=r.length;r.forEach(function(s,o){s.tag===n.tag&&s.kind===n.kind&&s.multi===n.multi&&(i=o)}),r[i]=n}),r}function oF(){var e={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},t,r;function n(i){i.multi?(e.multi[i.kind].push(i),e.multi.fallback.push(i)):e[i.kind][i.tag]=e.fallback[i.tag]=i}for(t=0,r=arguments.length;t<r;t+=1)arguments[t].forEach(n);return e}function ly(e){return this.extend(e)}ly.prototype.extend=function(t){var r=[],n=[];if(t instanceof ge)n.push(t);else if(Array.isArray(t))n=n.concat(t);else if(t&&(Array.isArray(t.implicit)||Array.isArray(t.explicit)))t.implicit&&(r=r.concat(t.implicit)),t.explicit&&(n=n.concat(t.explicit));else throw new ke("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");r.forEach(function(s){if(!(s instanceof ge))throw new ke("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(s.loadKind&&s.loadKind!=="scalar")throw new ke("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(s.multi)throw new ke("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),n.forEach(function(s){if(!(s instanceof ge))throw new ke("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var i=Object.create(ly.prototype);return i.implicit=(this.implicit||[]).concat(r),i.explicit=(this.explicit||[]).concat(n),i.compiledImplicit=Lk(i,"implicit"),i.compiledExplicit=Lk(i,"explicit"),i.compiledTypeMap=oF(i.compiledImplicit,i.compiledExplicit),i};var cF=ly,aF=new ge("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return e!==null?e:""}}),uF=new ge("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return e!==null?e:[]}}),lF=new ge("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return e!==null?e:{}}}),fF=new cF({explicit:[aF,uF,lF]});function dF(e){if(e===null)return!0;var t=e.length;return t===1&&e==="~"||t===4&&(e==="null"||e==="Null"||e==="NULL")}function hF(){return null}function pF(e){return e===null}var yF=new ge("tag:yaml.org,2002:null",{kind:"scalar",resolve:dF,construct:hF,predicate:pF,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function mF(e){if(e===null)return!1;var t=e.length;return t===4&&(e==="true"||e==="True"||e==="TRUE")||t===5&&(e==="false"||e==="False"||e==="FALSE")}function gF(e){return e==="true"||e==="True"||e==="TRUE"}function _F(e){return Object.prototype.toString.call(e)==="[object Boolean]"}var wF=new ge("tag:yaml.org,2002:bool",{kind:"scalar",resolve:mF,construct:gF,predicate:_F,represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function bF(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function EF(e){return 48<=e&&e<=55}function vF(e){return 48<=e&&e<=57}function SF(e){if(e===null)return!1;var t=e.length,r=0,n=!1,i;if(!t)return!1;if(i=e[r],(i==="-"||i==="+")&&(i=e[++r]),i==="0"){if(r+1===t)return!0;if(i=e[++r],i==="b"){for(r++;r<t;r++)if(i=e[r],i!=="_"){if(i!=="0"&&i!=="1")return!1;n=!0}return n&&i!=="_"}if(i==="x"){for(r++;r<t;r++)if(i=e[r],i!=="_"){if(!bF(e.charCodeAt(r)))return!1;n=!0}return n&&i!=="_"}if(i==="o"){for(r++;r<t;r++)if(i=e[r],i!=="_"){if(!EF(e.charCodeAt(r)))return!1;n=!0}return n&&i!=="_"}}if(i==="_")return!1;for(;r<t;r++)if(i=e[r],i!=="_"){if(!vF(e.charCodeAt(r)))return!1;n=!0}return!(!n||i==="_")}function xF(e){var t=e,r=1,n;if(t.indexOf("_")!==-1&&(t=t.replace(/_/g,"")),n=t[0],(n==="-"||n==="+")&&(n==="-"&&(r=-1),t=t.slice(1),n=t[0]),t==="0")return 0;if(n==="0"){if(t[1]==="b")return r*parseInt(t.slice(2),2);if(t[1]==="x")return r*parseInt(t.slice(2),16);if(t[1]==="o")return r*parseInt(t.slice(2),8)}return r*parseInt(t,10)}function TF(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!te.isNegativeZero(e)}var AF=new ge("tag:yaml.org,2002:int",{kind:"scalar",resolve:SF,construct:xF,predicate:TF,represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),qF=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function OF(e){return!(e===null||!qF.test(e)||e[e.length-1]==="_")}function kF(e){var t,r;return t=e.replace(/_/g,"").toLowerCase(),r=t[0]==="-"?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),t===".inf"?r===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:t===".nan"?NaN:r*parseFloat(t,10)}var CF=/^[-+]?[0-9]+e/;function PF(e,t){var r;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(te.isNegativeZero(e))return"-0.0";return r=e.toString(10),CF.test(r)?r.replace("e",".e"):r}function RF(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||te.isNegativeZero(e))}var KF=new ge("tag:yaml.org,2002:float",{kind:"scalar",resolve:OF,construct:kF,predicate:RF,represent:PF,defaultStyle:"lowercase"}),IF=fF.extend({implicit:[yF,wF,AF,KF]}),BF=IF,iC=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),sC=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function NF(e){return e===null?!1:iC.exec(e)!==null||sC.exec(e)!==null}function jF(e){var t,r,n,i,s,o,c,a=0,l=null,f,u,d;if(t=iC.exec(e),t===null&&(t=sC.exec(e)),t===null)throw new Error("Date resolve error");if(r=+t[1],n=+t[2]-1,i=+t[3],!t[4])return new Date(Date.UTC(r,n,i));if(s=+t[4],o=+t[5],c=+t[6],t[7]){for(a=t[7].slice(0,3);a.length<3;)a+="0";a=+a}return t[9]&&(f=+t[10],u=+(t[11]||0),l=(f*60+u)*6e4,t[9]==="-"&&(l=-l)),d=new Date(Date.UTC(r,n,i,s,o,c,a)),l&&d.setTime(d.getTime()-l),d}function MF(e){return e.toISOString()}var DF=new ge("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:NF,construct:jF,instanceOf:Date,represent:MF});function JF(e){return e==="<<"||e===null}var LF=new ge("tag:yaml.org,2002:merge",{kind:"scalar",resolve:JF}),yy=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function $F(e){if(e===null)return!1;var t,r,n=0,i=e.length,s=yy;for(r=0;r<i;r++)if(t=s.indexOf(e.charAt(r)),!(t>64)){if(t<0)return!1;n+=6}return n%8===0}function UF(e){var t,r,n=e.replace(/[\r\n=]/g,""),i=n.length,s=yy,o=0,c=[];for(t=0;t<i;t++)t%4===0&&t&&(c.push(o>>16&255),c.push(o>>8&255),c.push(o&255)),o=o<<6|s.indexOf(n.charAt(t));return r=i%4*6,r===0?(c.push(o>>16&255),c.push(o>>8&255),c.push(o&255)):r===18?(c.push(o>>10&255),c.push(o>>2&255)):r===12&&c.push(o>>4&255),new Uint8Array(c)}function WF(e){var t="",r=0,n,i,s=e.length,o=yy;for(n=0;n<s;n++)n%3===0&&n&&(t+=o[r>>18&63],t+=o[r>>12&63],t+=o[r>>6&63],t+=o[r&63]),r=(r<<8)+e[n];return i=s%3,i===0?(t+=o[r>>18&63],t+=o[r>>12&63],t+=o[r>>6&63],t+=o[r&63]):i===2?(t+=o[r>>10&63],t+=o[r>>4&63],t+=o[r<<2&63],t+=o[64]):i===1&&(t+=o[r>>2&63],t+=o[r<<4&63],t+=o[64],t+=o[64]),t}function HF(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}var FF=new ge("tag:yaml.org,2002:binary",{kind:"scalar",resolve:$F,construct:UF,predicate:HF,represent:WF}),GF=Object.prototype.hasOwnProperty,zF=Object.prototype.toString;function YF(e){if(e===null)return!0;var t=[],r,n,i,s,o,c=e;for(r=0,n=c.length;r<n;r+=1){if(i=c[r],o=!1,zF.call(i)!=="[object Object]")return!1;for(s in i)if(GF.call(i,s))if(!o)o=!0;else return!1;if(!o)return!1;if(t.indexOf(s)===-1)t.push(s);else return!1}return!0}function VF(e){return e!==null?e:[]}var XF=new ge("tag:yaml.org,2002:omap",{kind:"sequence",resolve:YF,construct:VF}),QF=Object.prototype.toString;function ZF(e){if(e===null)return!0;var t,r,n,i,s,o=e;for(s=new Array(o.length),t=0,r=o.length;t<r;t+=1){if(n=o[t],QF.call(n)!=="[object Object]"||(i=Object.keys(n),i.length!==1))return!1;s[t]=[i[0],n[i[0]]]}return!0}function eG(e){if(e===null)return[];var t,r,n,i,s,o=e;for(s=new Array(o.length),t=0,r=o.length;t<r;t+=1)n=o[t],i=Object.keys(n),s[t]=[i[0],n[i[0]]];return s}var tG=new ge("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:ZF,construct:eG}),rG=Object.prototype.hasOwnProperty;function nG(e){if(e===null)return!0;var t,r=e;for(t in r)if(rG.call(r,t)&&r[t]!==null)return!1;return!0}function iG(e){return e!==null?e:{}}var sG=new ge("tag:yaml.org,2002:set",{kind:"mapping",resolve:nG,construct:iG}),oC=BF.extend({implicit:[DF,LF],explicit:[FF,XF,tG,sG]}),hr=Object.prototype.hasOwnProperty,Ta=1,cC=2,aC=3,Aa=4,uy=1,oG=2,$k=3,cG=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,aG=/[\x85\u2028\u2029]/,uG=/[,\[\]\{\}]/,uC=/^(?:!|!!|![a-z\-]+!)$/i,lC=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function Uk(e){return Object.prototype.toString.call(e)}function At(e){return e===10||e===13}function Qr(e){return e===9||e===32}function Ce(e){return e===9||e===32||e===10||e===13}function Hn(e){return e===44||e===91||e===93||e===123||e===125}function lG(e){var t;return 48<=e&&e<=57?e-48:(t=e|32,97<=t&&t<=102?t-97+10:-1)}function fG(e){return e===120?2:e===117?4:e===85?8:0}function dG(e){return 48<=e&&e<=57?e-48:-1}function Wk(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"\x85":e===95?"\xA0":e===76?"\u2028":e===80?"\u2029":""}function hG(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}var fC=new Array(256),dC=new Array(256);for(Xr=0;Xr<256;Xr++)fC[Xr]=Wk(Xr)?1:0,dC[Xr]=Wk(Xr);var Xr;function pG(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||oC,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function hC(e,t){var r={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return r.snippet=tF(r),new ke(t,r)}function O(e,t){throw hC(e,t)}function qa(e,t){e.onWarning&&e.onWarning.call(null,hC(e,t))}var Hk={YAML:function(t,r,n){var i,s,o;t.version!==null&&O(t,"duplication of %YAML directive"),n.length!==1&&O(t,"YAML directive accepts exactly one argument"),i=/^([0-9]+)\.([0-9]+)$/.exec(n[0]),i===null&&O(t,"ill-formed argument of the YAML directive"),s=parseInt(i[1],10),o=parseInt(i[2],10),s!==1&&O(t,"unacceptable YAML version of the document"),t.version=n[0],t.checkLineBreaks=o<2,o!==1&&o!==2&&qa(t,"unsupported YAML version of the document")},TAG:function(t,r,n){var i,s;n.length!==2&&O(t,"TAG directive accepts exactly two arguments"),i=n[0],s=n[1],uC.test(i)||O(t,"ill-formed tag handle (first argument) of the TAG directive"),hr.call(t.tagMap,i)&&O(t,'there is a previously declared suffix for "'+i+'" tag handle'),lC.test(s)||O(t,"ill-formed tag prefix (second argument) of the TAG directive");try{s=decodeURIComponent(s)}catch{O(t,"tag prefix is malformed: "+s)}t.tagMap[i]=s}};function dr(e,t,r,n){var i,s,o,c;if(t<r){if(c=e.input.slice(t,r),n)for(i=0,s=c.length;i<s;i+=1)o=c.charCodeAt(i),o===9||32<=o&&o<=1114111||O(e,"expected valid JSON character");else cG.test(c)&&O(e,"the stream contains non-printable characters");e.result+=c}}function Fk(e,t,r,n){var i,s,o,c;for(te.isObject(r)||O(e,"cannot merge mappings; the provided source object is unacceptable"),i=Object.keys(r),o=0,c=i.length;o<c;o+=1)s=i[o],hr.call(t,s)||(t[s]=r[s],n[s]=!0)}function Fn(e,t,r,n,i,s,o,c,a){var l,f;if(Array.isArray(i))for(i=Array.prototype.slice.call(i),l=0,f=i.length;l<f;l+=1)Array.isArray(i[l])&&O(e,"nested arrays are not supported inside keys"),typeof i=="object"&&Uk(i[l])==="[object Object]"&&(i[l]="[object Object]");if(typeof i=="object"&&Uk(i)==="[object Object]"&&(i="[object Object]"),i=String(i),t===null&&(t={}),n==="tag:yaml.org,2002:merge")if(Array.isArray(s))for(l=0,f=s.length;l<f;l+=1)Fk(e,t,s[l],r);else Fk(e,t,s,r);else!e.json&&!hr.call(r,i)&&hr.call(t,i)&&(e.line=o||e.line,e.lineStart=c||e.lineStart,e.position=a||e.position,O(e,"duplicated mapping key")),i==="__proto__"?Object.defineProperty(t,i,{configurable:!0,enumerable:!0,writable:!0,value:s}):t[i]=s,delete r[i];return t}function my(e){var t;t=e.input.charCodeAt(e.position),t===10?e.position++:t===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):O(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function Z(e,t,r){for(var n=0,i=e.input.charCodeAt(e.position);i!==0;){for(;Qr(i);)i===9&&e.firstTabInLine===-1&&(e.firstTabInLine=e.position),i=e.input.charCodeAt(++e.position);if(t&&i===35)do i=e.input.charCodeAt(++e.position);while(i!==10&&i!==13&&i!==0);if(At(i))for(my(e),i=e.input.charCodeAt(e.position),n++,e.lineIndent=0;i===32;)e.lineIndent++,i=e.input.charCodeAt(++e.position);else break}return r!==-1&&n!==0&&e.lineIndent<r&&qa(e,"deficient indentation"),n}function Ca(e){var t=e.position,r;return r=e.input.charCodeAt(t),!!((r===45||r===46)&&r===e.input.charCodeAt(t+1)&&r===e.input.charCodeAt(t+2)&&(t+=3,r=e.input.charCodeAt(t),r===0||Ce(r)))}function gy(e,t){t===1?e.result+=" ":t>1&&(e.result+=te.repeat(`
`,t-1))}function yG(e,t,r){var n,i,s,o,c,a,l,f,u=e.kind,d=e.result,p;if(p=e.input.charCodeAt(e.position),Ce(p)||Hn(p)||p===35||p===38||p===42||p===33||p===124||p===62||p===39||p===34||p===37||p===64||p===96||(p===63||p===45)&&(i=e.input.charCodeAt(e.position+1),Ce(i)||r&&Hn(i)))return!1;for(e.kind="scalar",e.result="",s=o=e.position,c=!1;p!==0;){if(p===58){if(i=e.input.charCodeAt(e.position+1),Ce(i)||r&&Hn(i))break}else if(p===35){if(n=e.input.charCodeAt(e.position-1),Ce(n))break}else{if(e.position===e.lineStart&&Ca(e)||r&&Hn(p))break;if(At(p))if(a=e.line,l=e.lineStart,f=e.lineIndent,Z(e,!1,-1),e.lineIndent>=t){c=!0,p=e.input.charCodeAt(e.position);continue}else{e.position=o,e.line=a,e.lineStart=l,e.lineIndent=f;break}}c&&(dr(e,s,o,!1),gy(e,e.line-a),s=o=e.position,c=!1),Qr(p)||(o=e.position+1),p=e.input.charCodeAt(++e.position)}return dr(e,s,o,!1),e.result?!0:(e.kind=u,e.result=d,!1)}function mG(e,t){var r,n,i;if(r=e.input.charCodeAt(e.position),r!==39)return!1;for(e.kind="scalar",e.result="",e.position++,n=i=e.position;(r=e.input.charCodeAt(e.position))!==0;)if(r===39)if(dr(e,n,e.position,!0),r=e.input.charCodeAt(++e.position),r===39)n=e.position,e.position++,i=e.position;else return!0;else At(r)?(dr(e,n,i,!0),gy(e,Z(e,!1,t)),n=i=e.position):e.position===e.lineStart&&Ca(e)?O(e,"unexpected end of the document within a single quoted scalar"):(e.position++,i=e.position);O(e,"unexpected end of the stream within a single quoted scalar")}function gG(e,t){var r,n,i,s,o,c;if(c=e.input.charCodeAt(e.position),c!==34)return!1;for(e.kind="scalar",e.result="",e.position++,r=n=e.position;(c=e.input.charCodeAt(e.position))!==0;){if(c===34)return dr(e,r,e.position,!0),e.position++,!0;if(c===92){if(dr(e,r,e.position,!0),c=e.input.charCodeAt(++e.position),At(c))Z(e,!1,t);else if(c<256&&fC[c])e.result+=dC[c],e.position++;else if((o=fG(c))>0){for(i=o,s=0;i>0;i--)c=e.input.charCodeAt(++e.position),(o=lG(c))>=0?s=(s<<4)+o:O(e,"expected hexadecimal character");e.result+=hG(s),e.position++}else O(e,"unknown escape sequence");r=n=e.position}else At(c)?(dr(e,r,n,!0),gy(e,Z(e,!1,t)),r=n=e.position):e.position===e.lineStart&&Ca(e)?O(e,"unexpected end of the document within a double quoted scalar"):(e.position++,n=e.position)}O(e,"unexpected end of the stream within a double quoted scalar")}function _G(e,t){var r=!0,n,i,s,o=e.tag,c,a=e.anchor,l,f,u,d,p,m=Object.create(null),y,_,b,w;if(w=e.input.charCodeAt(e.position),w===91)f=93,p=!1,c=[];else if(w===123)f=125,p=!0,c={};else return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=c),w=e.input.charCodeAt(++e.position);w!==0;){if(Z(e,!0,t),w=e.input.charCodeAt(e.position),w===f)return e.position++,e.tag=o,e.anchor=a,e.kind=p?"mapping":"sequence",e.result=c,!0;r?w===44&&O(e,"expected the node content, but found ','"):O(e,"missed comma between flow collection entries"),_=y=b=null,u=d=!1,w===63&&(l=e.input.charCodeAt(e.position+1),Ce(l)&&(u=d=!0,e.position++,Z(e,!0,t))),n=e.line,i=e.lineStart,s=e.position,Gn(e,t,Ta,!1,!0),_=e.tag,y=e.result,Z(e,!0,t),w=e.input.charCodeAt(e.position),(d||e.line===n)&&w===58&&(u=!0,w=e.input.charCodeAt(++e.position),Z(e,!0,t),Gn(e,t,Ta,!1,!0),b=e.result),p?Fn(e,c,m,_,y,b,n,i,s):u?c.push(Fn(e,null,m,_,y,b,n,i,s)):c.push(y),Z(e,!0,t),w=e.input.charCodeAt(e.position),w===44?(r=!0,w=e.input.charCodeAt(++e.position)):r=!1}O(e,"unexpected end of the stream within a flow collection")}function wG(e,t){var r,n,i=uy,s=!1,o=!1,c=t,a=0,l=!1,f,u;if(u=e.input.charCodeAt(e.position),u===124)n=!1;else if(u===62)n=!0;else return!1;for(e.kind="scalar",e.result="";u!==0;)if(u=e.input.charCodeAt(++e.position),u===43||u===45)uy===i?i=u===43?$k:oG:O(e,"repeat of a chomping mode identifier");else if((f=dG(u))>=0)f===0?O(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):o?O(e,"repeat of an indentation width identifier"):(c=t+f-1,o=!0);else break;if(Qr(u)){do u=e.input.charCodeAt(++e.position);while(Qr(u));if(u===35)do u=e.input.charCodeAt(++e.position);while(!At(u)&&u!==0)}for(;u!==0;){for(my(e),e.lineIndent=0,u=e.input.charCodeAt(e.position);(!o||e.lineIndent<c)&&u===32;)e.lineIndent++,u=e.input.charCodeAt(++e.position);if(!o&&e.lineIndent>c&&(c=e.lineIndent),At(u)){a++;continue}if(e.lineIndent<c){i===$k?e.result+=te.repeat(`
`,s?1+a:a):i===uy&&s&&(e.result+=`
`);break}for(n?Qr(u)?(l=!0,e.result+=te.repeat(`
`,s?1+a:a)):l?(l=!1,e.result+=te.repeat(`
`,a+1)):a===0?s&&(e.result+=" "):e.result+=te.repeat(`
`,a):e.result+=te.repeat(`
`,s?1+a:a),s=!0,o=!0,a=0,r=e.position;!At(u)&&u!==0;)u=e.input.charCodeAt(++e.position);dr(e,r,e.position,!1)}return!0}function Gk(e,t){var r,n=e.tag,i=e.anchor,s=[],o,c=!1,a;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=s),a=e.input.charCodeAt(e.position);a!==0&&(e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,O(e,"tab characters must not be used in indentation")),!(a!==45||(o=e.input.charCodeAt(e.position+1),!Ce(o))));){if(c=!0,e.position++,Z(e,!0,-1)&&e.lineIndent<=t){s.push(null),a=e.input.charCodeAt(e.position);continue}if(r=e.line,Gn(e,t,aC,!1,!0),s.push(e.result),Z(e,!0,-1),a=e.input.charCodeAt(e.position),(e.line===r||e.lineIndent>t)&&a!==0)O(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break}return c?(e.tag=n,e.anchor=i,e.kind="sequence",e.result=s,!0):!1}function bG(e,t,r){var n,i,s,o,c,a,l=e.tag,f=e.anchor,u={},d=Object.create(null),p=null,m=null,y=null,_=!1,b=!1,w;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=u),w=e.input.charCodeAt(e.position);w!==0;){if(!_&&e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,O(e,"tab characters must not be used in indentation")),n=e.input.charCodeAt(e.position+1),s=e.line,(w===63||w===58)&&Ce(n))w===63?(_&&(Fn(e,u,d,p,m,null,o,c,a),p=m=y=null),b=!0,_=!0,i=!0):_?(_=!1,i=!0):O(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,w=n;else{if(o=e.line,c=e.lineStart,a=e.position,!Gn(e,r,cC,!1,!0))break;if(e.line===s){for(w=e.input.charCodeAt(e.position);Qr(w);)w=e.input.charCodeAt(++e.position);if(w===58)w=e.input.charCodeAt(++e.position),Ce(w)||O(e,"a whitespace character is expected after the key-value separator within a block mapping"),_&&(Fn(e,u,d,p,m,null,o,c,a),p=m=y=null),b=!0,_=!1,i=!1,p=e.tag,m=e.result;else if(b)O(e,"can not read an implicit mapping pair; a colon is missed");else return e.tag=l,e.anchor=f,!0}else if(b)O(e,"can not read a block mapping entry; a multiline key may not be an implicit key");else return e.tag=l,e.anchor=f,!0}if((e.line===s||e.lineIndent>t)&&(_&&(o=e.line,c=e.lineStart,a=e.position),Gn(e,t,Aa,!0,i)&&(_?m=e.result:y=e.result),_||(Fn(e,u,d,p,m,y,o,c,a),p=m=y=null),Z(e,!0,-1),w=e.input.charCodeAt(e.position)),(e.line===s||e.lineIndent>t)&&w!==0)O(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return _&&Fn(e,u,d,p,m,null,o,c,a),b&&(e.tag=l,e.anchor=f,e.kind="mapping",e.result=u),b}function EG(e){var t,r=!1,n=!1,i,s,o;if(o=e.input.charCodeAt(e.position),o!==33)return!1;if(e.tag!==null&&O(e,"duplication of a tag property"),o=e.input.charCodeAt(++e.position),o===60?(r=!0,o=e.input.charCodeAt(++e.position)):o===33?(n=!0,i="!!",o=e.input.charCodeAt(++e.position)):i="!",t=e.position,r){do o=e.input.charCodeAt(++e.position);while(o!==0&&o!==62);e.position<e.length?(s=e.input.slice(t,e.position),o=e.input.charCodeAt(++e.position)):O(e,"unexpected end of the stream within a verbatim tag")}else{for(;o!==0&&!Ce(o);)o===33&&(n?O(e,"tag suffix cannot contain exclamation marks"):(i=e.input.slice(t-1,e.position+1),uC.test(i)||O(e,"named tag handle cannot contain such characters"),n=!0,t=e.position+1)),o=e.input.charCodeAt(++e.position);s=e.input.slice(t,e.position),uG.test(s)&&O(e,"tag suffix cannot contain flow indicator characters")}s&&!lC.test(s)&&O(e,"tag name cannot contain such characters: "+s);try{s=decodeURIComponent(s)}catch{O(e,"tag name is malformed: "+s)}return r?e.tag=s:hr.call(e.tagMap,i)?e.tag=e.tagMap[i]+s:i==="!"?e.tag="!"+s:i==="!!"?e.tag="tag:yaml.org,2002:"+s:O(e,'undeclared tag handle "'+i+'"'),!0}function vG(e){var t,r;if(r=e.input.charCodeAt(e.position),r!==38)return!1;for(e.anchor!==null&&O(e,"duplication of an anchor property"),r=e.input.charCodeAt(++e.position),t=e.position;r!==0&&!Ce(r)&&!Hn(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&O(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function SG(e){var t,r,n;if(n=e.input.charCodeAt(e.position),n!==42)return!1;for(n=e.input.charCodeAt(++e.position),t=e.position;n!==0&&!Ce(n)&&!Hn(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&O(e,"name of an alias node must contain at least one character"),r=e.input.slice(t,e.position),hr.call(e.anchorMap,r)||O(e,'unidentified alias "'+r+'"'),e.result=e.anchorMap[r],Z(e,!0,-1),!0}function Gn(e,t,r,n,i){var s,o,c,a=1,l=!1,f=!1,u,d,p,m,y,_;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,s=o=c=Aa===r||aC===r,n&&Z(e,!0,-1)&&(l=!0,e.lineIndent>t?a=1:e.lineIndent===t?a=0:e.lineIndent<t&&(a=-1)),a===1)for(;EG(e)||vG(e);)Z(e,!0,-1)?(l=!0,c=s,e.lineIndent>t?a=1:e.lineIndent===t?a=0:e.lineIndent<t&&(a=-1)):c=!1;if(c&&(c=l||i),(a===1||Aa===r)&&(Ta===r||cC===r?y=t:y=t+1,_=e.position-e.lineStart,a===1?c&&(Gk(e,_)||bG(e,_,y))||_G(e,y)?f=!0:(o&&wG(e,y)||mG(e,y)||gG(e,y)?f=!0:SG(e)?(f=!0,(e.tag!==null||e.anchor!==null)&&O(e,"alias node should not have any properties")):yG(e,y,Ta===r)&&(f=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):a===0&&(f=c&&Gk(e,_))),e.tag===null)e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);else if(e.tag==="?"){for(e.result!==null&&e.kind!=="scalar"&&O(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),u=0,d=e.implicitTypes.length;u<d;u+=1)if(m=e.implicitTypes[u],m.resolve(e.result)){e.result=m.construct(e.result),e.tag=m.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else if(e.tag!=="!"){if(hr.call(e.typeMap[e.kind||"fallback"],e.tag))m=e.typeMap[e.kind||"fallback"][e.tag];else for(m=null,p=e.typeMap.multi[e.kind||"fallback"],u=0,d=p.length;u<d;u+=1)if(e.tag.slice(0,p[u].tag.length)===p[u].tag){m=p[u];break}m||O(e,"unknown tag !<"+e.tag+">"),e.result!==null&&m.kind!==e.kind&&O(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+m.kind+'", not "'+e.kind+'"'),m.resolve(e.result,e.tag)?(e.result=m.construct(e.result,e.tag),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):O(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||f}function xG(e){var t=e.position,r,n,i,s=!1,o;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(o=e.input.charCodeAt(e.position))!==0&&(Z(e,!0,-1),o=e.input.charCodeAt(e.position),!(e.lineIndent>0||o!==37));){for(s=!0,o=e.input.charCodeAt(++e.position),r=e.position;o!==0&&!Ce(o);)o=e.input.charCodeAt(++e.position);for(n=e.input.slice(r,e.position),i=[],n.length<1&&O(e,"directive name must not be less than one character in length");o!==0;){for(;Qr(o);)o=e.input.charCodeAt(++e.position);if(o===35){do o=e.input.charCodeAt(++e.position);while(o!==0&&!At(o));break}if(At(o))break;for(r=e.position;o!==0&&!Ce(o);)o=e.input.charCodeAt(++e.position);i.push(e.input.slice(r,e.position))}o!==0&&my(e),hr.call(Hk,n)?Hk[n](e,n,i):qa(e,'unknown document directive "'+n+'"')}if(Z(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,Z(e,!0,-1)):s&&O(e,"directives end mark is expected"),Gn(e,e.lineIndent-1,Aa,!1,!0),Z(e,!0,-1),e.checkLineBreaks&&aG.test(e.input.slice(t,e.position))&&qa(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&Ca(e)){e.input.charCodeAt(e.position)===46&&(e.position+=3,Z(e,!0,-1));return}if(e.position<e.length-1)O(e,"end of the stream or a document separator is expected");else return}function pC(e,t){e=String(e),t=t||{},e.length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));var r=new pG(e,t),n=e.indexOf("\0");for(n!==-1&&(r.position=n,O(r,"null byte is not allowed in input")),r.input+="\0";r.input.charCodeAt(r.position)===32;)r.lineIndent+=1,r.position+=1;for(;r.position<r.length-1;)xG(r);return r.documents}function TG(e,t,r){t!==null&&typeof t=="object"&&typeof r>"u"&&(r=t,t=null);var n=pC(e,r);if(typeof t!="function")return n;for(var i=0,s=n.length;i<s;i+=1)t(n[i])}function AG(e,t){var r=pC(e,t);if(r.length!==0){if(r.length===1)return r[0];throw new ke("expected a single document in the stream, but found more")}}var qG=TG,OG=AG,yC={loadAll:qG,load:OG},mC=Object.prototype.toString,gC=Object.prototype.hasOwnProperty,_y=65279,kG=9,Ts=10,CG=13,PG=32,RG=33,KG=34,fy=35,IG=37,BG=38,NG=39,jG=42,_C=44,MG=45,Oa=58,DG=61,JG=62,LG=63,$G=64,wC=91,bC=93,UG=96,EC=123,WG=124,vC=125,_e={};_e[0]="\\0";_e[7]="\\a";_e[8]="\\b";_e[9]="\\t";_e[10]="\\n";_e[11]="\\v";_e[12]="\\f";_e[13]="\\r";_e[27]="\\e";_e[34]='\\"';_e[92]="\\\\";_e[133]="\\N";_e[160]="\\_";_e[8232]="\\L";_e[8233]="\\P";var HG=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],FG=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function GG(e,t){var r,n,i,s,o,c,a;if(t===null)return{};for(r={},n=Object.keys(t),i=0,s=n.length;i<s;i+=1)o=n[i],c=String(t[o]),o.slice(0,2)==="!!"&&(o="tag:yaml.org,2002:"+o.slice(2)),a=e.compiledTypeMap.fallback[o],a&&gC.call(a.styleAliases,c)&&(c=a.styleAliases[c]),r[o]=c;return r}function zG(e){var t,r,n;if(t=e.toString(16).toUpperCase(),e<=255)r="x",n=2;else if(e<=65535)r="u",n=4;else if(e<=4294967295)r="U",n=8;else throw new ke("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+r+te.repeat("0",n-t.length)+t}var YG=1,As=2;function VG(e){this.schema=e.schema||oC,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=te.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=GG(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType=e.quotingType==='"'?As:YG,this.forceQuotes=e.forceQuotes||!1,this.replacer=typeof e.replacer=="function"?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function zk(e,t){for(var r=te.repeat(" ",t),n=0,i=-1,s="",o,c=e.length;n<c;)i=e.indexOf(`
`,n),i===-1?(o=e.slice(n),n=c):(o=e.slice(n,i+1),n=i+1),o.length&&o!==`
`&&(s+=r),s+=o;return s}function dy(e,t){return`
`+te.repeat(" ",e.indent*t)}function XG(e,t){var r,n,i;for(r=0,n=e.implicitTypes.length;r<n;r+=1)if(i=e.implicitTypes[r],i.resolve(t))return!0;return!1}function ka(e){return e===PG||e===kG}function qs(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==_y||65536<=e&&e<=1114111}function Yk(e){return qs(e)&&e!==_y&&e!==CG&&e!==Ts}function Vk(e,t,r){var n=Yk(e),i=n&&!ka(e);return(r?n:n&&e!==_C&&e!==wC&&e!==bC&&e!==EC&&e!==vC)&&e!==fy&&!(t===Oa&&!i)||Yk(t)&&!ka(t)&&e===fy||t===Oa&&i}function QG(e){return qs(e)&&e!==_y&&!ka(e)&&e!==MG&&e!==LG&&e!==Oa&&e!==_C&&e!==wC&&e!==bC&&e!==EC&&e!==vC&&e!==fy&&e!==BG&&e!==jG&&e!==RG&&e!==WG&&e!==DG&&e!==JG&&e!==NG&&e!==KG&&e!==IG&&e!==$G&&e!==UG}function ZG(e){return!ka(e)&&e!==Oa}function Ss(e,t){var r=e.charCodeAt(t),n;return r>=55296&&r<=56319&&t+1<e.length&&(n=e.charCodeAt(t+1),n>=56320&&n<=57343)?(r-55296)*1024+n-56320+65536:r}function SC(e){var t=/^\n* /;return t.test(e)}var xC=1,hy=2,TC=3,AC=4,Wn=5;function ez(e,t,r,n,i,s,o,c){var a,l=0,f=null,u=!1,d=!1,p=n!==-1,m=-1,y=QG(Ss(e,0))&&ZG(Ss(e,e.length-1));if(t||o)for(a=0;a<e.length;l>=65536?a+=2:a++){if(l=Ss(e,a),!qs(l))return Wn;y=y&&Vk(l,f,c),f=l}else{for(a=0;a<e.length;l>=65536?a+=2:a++){if(l=Ss(e,a),l===Ts)u=!0,p&&(d=d||a-m-1>n&&e[m+1]!==" ",m=a);else if(!qs(l))return Wn;y=y&&Vk(l,f,c),f=l}d=d||p&&a-m-1>n&&e[m+1]!==" "}return!u&&!d?y&&!o&&!i(e)?xC:s===As?Wn:hy:r>9&&SC(e)?Wn:o?s===As?Wn:hy:d?AC:TC}function tz(e,t,r,n,i){e.dump=function(){if(t.length===0)return e.quotingType===As?'""':"''";if(!e.noCompatMode&&(HG.indexOf(t)!==-1||FG.test(t)))return e.quotingType===As?'"'+t+'"':"'"+t+"'";var s=e.indent*Math.max(1,r),o=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-s),c=n||e.flowLevel>-1&&r>=e.flowLevel;function a(l){return XG(e,l)}switch(ez(t,c,e.indent,o,a,e.quotingType,e.forceQuotes&&!n,i)){case xC:return t;case hy:return"'"+t.replace(/'/g,"''")+"'";case TC:return"|"+Xk(t,e.indent)+Qk(zk(t,s));case AC:return">"+Xk(t,e.indent)+Qk(zk(rz(t,o),s));case Wn:return'"'+nz(t)+'"';default:throw new ke("impossible error: invalid scalar style")}}()}function Xk(e,t){var r=SC(e)?String(t):"",n=e[e.length-1]===`
`,i=n&&(e[e.length-2]===`
`||e===`
`),s=i?"+":n?"":"-";return r+s+`
`}function Qk(e){return e[e.length-1]===`
`?e.slice(0,-1):e}function rz(e,t){for(var r=/(\n+)([^\n]*)/g,n=function(){var l=e.indexOf(`
`);return l=l!==-1?l:e.length,r.lastIndex=l,Zk(e.slice(0,l),t)}(),i=e[0]===`
`||e[0]===" ",s,o;o=r.exec(e);){var c=o[1],a=o[2];s=a[0]===" ",n+=c+(!i&&!s&&a!==""?`
`:"")+Zk(a,t),i=s}return n}function Zk(e,t){if(e===""||e[0]===" ")return e;for(var r=/ [^ ]/g,n,i=0,s,o=0,c=0,a="";n=r.exec(e);)c=n.index,c-i>t&&(s=o>i?o:c,a+=`
`+e.slice(i,s),i=s+1),o=c;return a+=`
`,e.length-i>t&&o>i?a+=e.slice(i,o)+`
`+e.slice(o+1):a+=e.slice(i),a.slice(1)}function nz(e){for(var t="",r=0,n,i=0;i<e.length;r>=65536?i+=2:i++)r=Ss(e,i),n=_e[r],!n&&qs(r)?(t+=e[i],r>=65536&&(t+=e[i+1])):t+=n||zG(r);return t}function iz(e,t,r){var n="",i=e.tag,s,o,c;for(s=0,o=r.length;s<o;s+=1)c=r[s],e.replacer&&(c=e.replacer.call(r,String(s),c)),(Gt(e,t,c,!1,!1)||typeof c>"u"&&Gt(e,t,null,!1,!1))&&(n!==""&&(n+=","+(e.condenseFlow?"":" ")),n+=e.dump);e.tag=i,e.dump="["+n+"]"}function eC(e,t,r,n){var i="",s=e.tag,o,c,a;for(o=0,c=r.length;o<c;o+=1)a=r[o],e.replacer&&(a=e.replacer.call(r,String(o),a)),(Gt(e,t+1,a,!0,!0,!1,!0)||typeof a>"u"&&Gt(e,t+1,null,!0,!0,!1,!0))&&((!n||i!=="")&&(i+=dy(e,t)),e.dump&&Ts===e.dump.charCodeAt(0)?i+="-":i+="- ",i+=e.dump);e.tag=s,e.dump=i||"[]"}function sz(e,t,r){var n="",i=e.tag,s=Object.keys(r),o,c,a,l,f;for(o=0,c=s.length;o<c;o+=1)f="",n!==""&&(f+=", "),e.condenseFlow&&(f+='"'),a=s[o],l=r[a],e.replacer&&(l=e.replacer.call(r,a,l)),Gt(e,t,a,!1,!1)&&(e.dump.length>1024&&(f+="? "),f+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),Gt(e,t,l,!1,!1)&&(f+=e.dump,n+=f));e.tag=i,e.dump="{"+n+"}"}function oz(e,t,r,n){var i="",s=e.tag,o=Object.keys(r),c,a,l,f,u,d;if(e.sortKeys===!0)o.sort();else if(typeof e.sortKeys=="function")o.sort(e.sortKeys);else if(e.sortKeys)throw new ke("sortKeys must be a boolean or a function");for(c=0,a=o.length;c<a;c+=1)d="",(!n||i!=="")&&(d+=dy(e,t)),l=o[c],f=r[l],e.replacer&&(f=e.replacer.call(r,l,f)),Gt(e,t+1,l,!0,!0,!0)&&(u=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024,u&&(e.dump&&Ts===e.dump.charCodeAt(0)?d+="?":d+="? "),d+=e.dump,u&&(d+=dy(e,t)),Gt(e,t+1,f,!0,u)&&(e.dump&&Ts===e.dump.charCodeAt(0)?d+=":":d+=": ",d+=e.dump,i+=d));e.tag=s,e.dump=i||"{}"}function tC(e,t,r){var n,i,s,o,c,a;for(i=r?e.explicitTypes:e.implicitTypes,s=0,o=i.length;s<o;s+=1)if(c=i[s],(c.instanceOf||c.predicate)&&(!c.instanceOf||typeof t=="object"&&t instanceof c.instanceOf)&&(!c.predicate||c.predicate(t))){if(r?c.multi&&c.representName?e.tag=c.representName(t):e.tag=c.tag:e.tag="?",c.represent){if(a=e.styleMap[c.tag]||c.defaultStyle,mC.call(c.represent)==="[object Function]")n=c.represent(t,a);else if(gC.call(c.represent,a))n=c.represent[a](t,a);else throw new ke("!<"+c.tag+'> tag resolver accepts not "'+a+'" style');e.dump=n}return!0}return!1}function Gt(e,t,r,n,i,s,o){e.tag=null,e.dump=r,tC(e,r,!1)||tC(e,r,!0);var c=mC.call(e.dump),a=n,l;n&&(n=e.flowLevel<0||e.flowLevel>t);var f=c==="[object Object]"||c==="[object Array]",u,d;if(f&&(u=e.duplicates.indexOf(r),d=u!==-1),(e.tag!==null&&e.tag!=="?"||d||e.indent!==2&&t>0)&&(i=!1),d&&e.usedDuplicates[u])e.dump="*ref_"+u;else{if(f&&d&&!e.usedDuplicates[u]&&(e.usedDuplicates[u]=!0),c==="[object Object]")n&&Object.keys(e.dump).length!==0?(oz(e,t,e.dump,i),d&&(e.dump="&ref_"+u+e.dump)):(sz(e,t,e.dump),d&&(e.dump="&ref_"+u+" "+e.dump));else if(c==="[object Array]")n&&e.dump.length!==0?(e.noArrayIndent&&!o&&t>0?eC(e,t-1,e.dump,i):eC(e,t,e.dump,i),d&&(e.dump="&ref_"+u+e.dump)):(iz(e,t,e.dump),d&&(e.dump="&ref_"+u+" "+e.dump));else if(c==="[object String]")e.tag!=="?"&&tz(e,e.dump,t,s,a);else{if(c==="[object Undefined]")return!1;if(e.skipInvalid)return!1;throw new ke("unacceptable kind of an object to dump "+c)}e.tag!==null&&e.tag!=="?"&&(l=encodeURI(e.tag[0]==="!"?e.tag.slice(1):e.tag).replace(/!/g,"%21"),e.tag[0]==="!"?l="!"+l:l.slice(0,18)==="tag:yaml.org,2002:"?l="!!"+l.slice(18):l="!<"+l+">",e.dump=l+" "+e.dump)}return!0}function cz(e,t){var r=[],n=[],i,s;for(py(e,r,n),i=0,s=n.length;i<s;i+=1)t.duplicates.push(r[n[i]]);t.usedDuplicates=new Array(s)}function py(e,t,r){var n,i,s;if(e!==null&&typeof e=="object")if(i=t.indexOf(e),i!==-1)r.indexOf(i)===-1&&r.push(i);else if(t.push(e),Array.isArray(e))for(i=0,s=e.length;i<s;i+=1)py(e[i],t,r);else for(n=Object.keys(e),i=0,s=n.length;i<s;i+=1)py(e[n[i]],t,r)}function az(e,t){t=t||{};var r=new VG(t);r.noRefs||cz(e,r);var n=e;return r.replacer&&(n=r.replacer.call({"":n},"",n)),Gt(r,0,n,!0,!0)?r.dump+`
`:""}var uz=az,lz={dump:uz};function wy(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}var qC=yC.load,Oee=yC.loadAll,by=lz.dump;var kee=wy("safeLoad","load"),Cee=wy("safeLoadAll","loadAll"),Pee=wy("safeDump","dump");var Ey=class{constructor(t,r=!1){this.get=t=>this.config[t];this.set=(t,r)=>this.config[t]=r;this.save=()=>pr.writeFileSync(this.filePath,by(this.config));this.load=()=>this.config=qC(pr.readFileSync(this.filePath,"utf8"));this.filePath=t,this.config={},!pr.existsSync(t)&&r&&pr.writeFileSync(t,by({})),pr.existsSync(t)&&this.load()}},OC=Ey;var jC=g("child_process");var Ka=Ge(g("url")),IC=Ge(g("path"));var yr=Ge(g("fs")),Ra=Ge(RC()),Sy=class{constructor(t,r=!1){this.get=t=>this.config[t];this.set=(t,r)=>this.config[t]=r;this.save=()=>yr.writeFileSync(this.filePath,Ra.encode(this.config));this.load=()=>this.config=Ra.parse(yr.readFileSync(this.filePath,"utf8"));this.filePath=t,this.config={},!yr.existsSync(t)&&r&&yr.writeFileSync(t,JSON.stringify({})),yr.existsSync(t)&&this.load()}},KC=Sy;var Ia=class extends KC{constructor(t,r=!1){if(!t)throw new Error("No base path defined for .npmrc file.");t.endsWith(".npmrc")||(t=IC.join(t,".npmrc")),super(t,r)}getRegistries(){return Object.keys(this.config).filter(t=>t.includes("registry")).map(t=>this.get(t))}getRegistryRefreshToken(t){let r=Ka.parse(t);return this.get(`//${r.hostname}${r.pathname}:_refreshToken`)}setRegistryAuthToken(t,r){let n=Ka.parse(t);this.set(`//${n.hostname}${n.pathname}:_authToken`,r),this.save()}setRegistryRefreshToken(t,r){let n=Ka.parse(t);this.set(`//${n.hostname}${n.pathname}:_refreshToken`,r),this.save()}};var xy=class extends OC{constructor(r,n=!1){if(!r)throw new Error("No base path defined for .yarnrc.yml file.");let i=r;i.endsWith(".yarnrc.yml")||(i=Os.join(i,".yarnrc.yml"));super(i,n);let s=r;s.endsWith(".yarnrc.yml")&&(s=Os.join(s.substring(0,s.length-11),".npmrc")),this.npmConfig=new Ia(s,n)}getRegistries(){return this.getRegistriesHelper(this.config)}getRegistriesHelper(r){let n=Object.keys(r),i=[];return n.forEach(s=>{let o=r[s];typeof o=="object"?i.push(...this.getRegistriesHelper(o)):s.indexOf("npmRegistryServer")>-1&&i.push(o)}),i}getRegistryRefreshToken(r){return this.npmConfig.getRegistryRefreshToken(r)}setRegistryAuthToken(r,n){let i=NC.parse(r),s=`${i.hostname}${i.pathname}`;this.set("npmRegistries",{...typeof this.get("npmRegistries")=="object"?this.get("npmRegistries"):{},[s]:{npmAuthToken:n}}),this.save()}setRegistryRefreshToken(r,n){return this.npmConfig.setRegistryRefreshToken(r,n)}},Ba=class extends xy{constructor(t=!0){let r;try{r=(0,jC.execSync)("npm config get userconfig",{stdio:["pipe","pipe","ignore"]}).toString().trim()}catch{r=BC.homedir()}r.endsWith(".npmrc")?r=Os.join(r.substring(0,r.length-6),".yarnrc.yml"):r=Os.join(r,".yarnrc.yml"),super(r,t)}};var hz=LC(),pz="499b84ac-1321-427f-aa17-267ca6975798",yz="d5a56ea4-7369-46b8-a538-c370805301bf",mz="common",gz=new hz,$C=new Map;function Yn(e,t){ks.StreamReport.start({configuration:e.configuration,stdout:process.stdout},async r=>{let n=e.ident?`${zt.hex("#87afff")("[azure-devops-auth]")} ${e.ident.scope?zt.hex("#d75f00")(`@${e.ident.scope}/`):""}${zt.hex("#d7875f")(e.ident.name)} ${t}`:t;r.reportInfo(null,n)}).then()}var _z={configuration:{azDevOpsAuthClientId:{description:"The client-id to use for connecting to the authentication provider",type:ks.SettingsType.STRING,default:null},azDevOpsAuthTenantId:{description:"The tenant-id to use for connecting to the authentication provider",type:ks.SettingsType.STRING,default:null}},hooks:{async getNpmAuthenticationHeader(e,t,r){if(!t.startsWith("https://pkgs.dev.azure.com")&&!t.startsWith("http://pkgs.dev.azure.com"))return;if(process.env.SYSTEM_ACCESSTOKEN)return`Bearer ${process.env.SYSTEM_ACCESSTOKEN}`;if(r.configuration.isCI){Yn(r,"Skipped auth due to running in CI environment");return}let n=$C.get(t);return n&&!n.expired()?`Bearer ${n.access_token}`:await gz.acquire("azDevOps",async()=>{let i=r.configuration.get("azDevOpsAuthClientId")??yz,s=r.configuration.get("azDevOpsAuthTenantId")??mz,o=new Ba,c=await iy.discover(s),a=new c.Client(new oy(i));a[UC.custom.http_options]=function(u){return u.timeout=5e3,u};let l,f=o.getRegistryRefreshToken(t);if(f)try{Yn(r,"Trying to use refresh token..."),l=await a.refresh(f)}catch(u){switch(u.error){case"invalid_grant":Yn(r,zt.yellow("Refresh token is invalid or expired."));break;case"interaction_required":Yn(r,zt.yellow("Interaction required."));break;default:throw u}}if(!l)try{l=await bz(a,r)}catch(u){throw Yn(r,zt.red(`Failure during OAuth with tenant-id ${s} and client-id ${i}`)),u}return o.setRegistryRefreshToken(t,l.refresh_token),$C.set(t,l),`Bearer ${l.access_token}`})}}},wz=_z;async function bz(e,t){let r=await e.deviceAuthorization({scope:`${pz}/.default offline_access`});return Yn(t,`To sign in, use a web browser to open the page ${r.verification_uri} and enter the code ${r.user_code} to authenticate.`),await r.poll()}return VC(Ez);})();
/*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT */
return plugin;
}
};
